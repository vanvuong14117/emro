!function(t){function e(n){if(r[n])return r[n].exports;var i=r[n]={exports:{},id:n,loaded:!1};return t[n].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var r={};return e.m=t,e.c=r,e.p="",e(0)}([function(t,e,r){window.ytcrypto=r(1)},function(t,e,r){function n(t){switch(t=t.toLowerCase()){case"seed":return i.seed;case"aes":return i.aes;case"des":return i.des;case"aria":return i.aria;default:throw"not supported blockCipher Algorithm:"+t}}var i={};i.getVersion=function(){return"2.8.8"},i.getLicense=function(){return"JSRose - Public Key Infrastructure & Cryptography ToolKit\nCopyright All rights reserved by YettieSoft(c).\n\nVersion - 2.8.8\nDate - 2022.5.25\n\nContributors\n - lovian@yettiesoft.com\n".split("\n")},i.error=function(t,e){void 0===e&&(e=t,t=void 0),this.code=t,this.reason=[e],this.getCode=function(){return this.code},this.getReason=function(){return this.reason},this.pushReason=function(t){this.reason.push(t)}},i.crypto=i.crypto||{},i.crypto.rsa={},i.crypto.blockCipher=function(t){this.cipher=t},i.crypto.blockCipher.prototype.start=function(t,e){return this.cipher.start(t,e)},i.crypto.blockCipher.prototype.update=function(t){return"string"==typeof t&&(t=i.util.createBuffer(t)),this.cipher.update(t)},i.crypto.blockCipher.prototype.output=null,i.crypto.blockCipher.prototype.finish=function(t){var e;return e=this.cipher.finish(t),this.output=this.cipher.output,e},i.crypto.blockCipher.createEncryptionCipher=function(t,e,r){var a;return a=n(t),new i.crypto.blockCipher(a.createEncryptionCipher(e,r))},i.crypto.blockCipher.createDecryptionCipher=function(t,e,r){var a;return a=n(t),new i.crypto.blockCipher(a.createDecryptionCipher(e,r))},i.crypto.random={},i.crypto.random.getBytes=function(t){return i.random.getBytesSync(t)},i.crypto.util={},"undefined"==typeof Uint8Array&&(Uint8Array=Array),i.crypto.util.stringToArray=function(t){var e;return t.split("").map(function(t){if(e=t.charCodeAt(0),e>255)throw"input string is non ascii string";return e})},i.crypto.util.stringToArrayBuffer=function(t){var e;return new Uint8Array(t.split("").map(function(t){if(e=t.charCodeAt(0),e>255)throw"input string is non ascii string";return e}))},i.crypto.util.hexToArrayBuffer=function(t){return new Uint8Array(t.match(/(..)/g).map(function(t){return parseInt(t,16)}))},i.crypto.util.arrayToString=function(t){return Array.prototype.map.call(t,function(t){return String.fromCharCode(t)}).join("")},i.crypto.util.arrayBufferToString=function(t){return Array.prototype.map.call(new Uint8Array(t),function(t){return String.fromCharCode(t)}).join("")},i.crypto.util.arrayBufferToHex=function(t){return Array.prototype.map.call(new Uint8Array(t),function(t){return("0"+t.toString(16)).slice(-2)}).join("")},i.crypto.util.encode64url=function(t){var e=i.util.encode64(t);return e=e.split("=")[0],e=e.replace(/\+/g,"-"),e=e.replace(/\//g,"_")},i.crypto.util.decode64url=function(t){switch(t=t.replace(/\-/g,"+"),t=t.replace(/\_/g,"/"),t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new yt.error("illegal base64url string")}return t=i.util.decode64(t)},i.crypto.handlers={},i.crypto.setHandler=function(t,e){if("undefined"==typeof e)return void delete i.crypto.handlers[t];switch(t){case"generateKey":i.crypto.handlers[t]=e;break;default:throw"not supported handler - "+t}};var a={};a.create=function(){return{start:function(t,e){e.length>8&&(e=e.substring(0,8)),this._cipher=t.startEncrypting(i.util.createBuffer(e),i.util.hexToBytes("0000000000000000"))},update:function(t){"string"==typeof t&&(t=i.util.createBuffer(t)),this._cipher.update(t)},getMac:function(){var t,e;return this._cipher.finish(function(t,r,n){var i;return i=t-r.length()%t,r.fillWithByte(0,i),e=t,!0}),this._cipher.output.read=this._cipher.output.length()-e,t=this._cipher.output.getBytes(e),i.util.createBuffer(t)}}},i.cmac=a,t.exports=i,r(2),r(3),r(4),r(5),r(11),r(13),r(14),r(15),r(16),r(18),r(19),r(20),r(21),r(22),r(23),r(24),r(25),r(26),r(27),r(28),r(29),r(30),r(31),r(32),r(24),r(33),r(34),r(35),r(39)},function(t,e,r){function n(t,e){this.n=t||this.DEFAULT_LENGTH,this.taps=a[this.n],e||(e=this._defaultSeed(this.n));var r=parseInt(Array(this.n+1).join("1"),2);this.register=e&r}var i=r(1);i.base={};var a={2:[2,1],3:[3,2],4:[4,3],5:[5,3],6:[6,5],7:[7,6],8:[8,6,5,4],9:[9,5],10:[10,7],11:[11,9],12:[12,11,10,4],13:[13,12,11,8],14:[14,13,12,2],15:[15,14],16:[16,14,13,11],17:[17,14],18:[18,11],19:[19,18,17,14],20:[20,17],21:[21,19],22:[22,21],23:[23,18],24:[24,23,22,17],25:[25,22],26:[26,6,2,1],27:[27,5,2,1],28:[28,25],29:[29,27],30:[30,6,4,1],31:[31,28]};n.prototype={TAPS:a,DEFAULT_LENGTH:31,shift:function(){var t,e=this.taps.length,r=this.register>>this.n-this.taps[0];for(t=1;t<e;t++)r^=this.register>>this.n-this.taps[t];return r&=1,this.register=this.register>>1|r<<this.n-1,1&r},seq:function(t){for(var e=0,r=0;r<t;r++)e=e<<1|this.shift();return e},seqString:function(t){for(var e="",r=0;r<t;r++)e+=this.shift();return e},maxSeqLen:function(){var t=this.register,e=0;do this.shift(),e++;while(t!=this.register);return e},_defaultSeed:function(t){if(!t)throw new Error("n is required");var e=new n(8,92914);return e.seq(t)}};var o=new n(31,(new Date).getTime()),s=function(){var t=o.seq(31);return t="0."+t,parseFloat(t)};i.base.srnd=s,t.exports=i.base},function(t,e,r){var n,i,a,o=r(1),s={browserName:null,supportWebCrypto:!1,exportWebCryptoPublicKeyMethod:"spki",importWebCryptoPrivateKeyMethod:"pkcs8",exportWebCryptoPrivateKeyMethod:"pkcs8",wrapWebCryptoArrayBuffer:!1,useSJCL:!1};o.getSettings=function(){var t={};for(var e in s)t[e]=s[e];return"getVersion"in o?t.version=o.getVersion():t.version="dev version",t},o.error=function(t,e){void 0===e&&(e=t,t=void 0),this.code=t,this.reason=[e],this.getCode=function(){return this.code},this.getReason=function(){return this.reason},this.pushReason=function(t){this.reason.push(t)}},"undefined"!=typeof window&&(n=window.msCrypto||window.crypto),n&&(i=n.subtle||n.webkitSubtle);var u="";do{for(var f="undefined"!=typeof navigator?navigator.userAgent:"",h="undefined"!=typeof navigator?navigator.appVersion:"",c=h.split(" "),p={},l=0;l<c.length;++l)c[l].indexOf("Chrome/")==-1?c[l].indexOf("Safari/")==-1?c[l].indexOf("Edge/")==-1?c[l].indexOf("Version/")==-1?c[l].indexOf("AppleWebKit/")==-1||(p.AppleWebKit=c[l].split("/")[1],s.webkitVersion=p.AppleWebKit):p.Version=c[l].split("/")[1]:p.Edge=c[l].split("/")[1]:p.Safari=c[l].split("/")[1]:p.Chrome=c[l].split("/")[1];if(-1!=h.indexOf("OPR/")){u="Opera",s.importWebCryptoPrivateKeyMethod="jwk",s.exportWebCryptoPrivateKeyMethod="jwk",s.exportWebCryptoPublicKeyMethod="jwk";break}if(p.hasOwnProperty("Edge")){u="Edge",s.browserVersion=p.Edge,s.importWebCryptoPrivateKeyMethod="jwk",s.exportWebCryptoPrivateKeyMethod="jwk",s.exportWebCryptoPublicKeyMethod="jwk";break}if(p.hasOwnProperty("Chrome")){u="Chrome",s.browserVersion=p.Chrome,s.importWebCryptoPrivateKeyMethod="jwk",s.exportWebCryptoPrivateKeyMethod="jwk",s.exportWebCryptoPublicKeyMethod="jwk",parseInt(p.Chrome)<37&&(u="Chrome under 37",i=void 0);break}if(p.hasOwnProperty("Safari")){u="Safari",s.browserVersion=p.Version,s.importWebCryptoPrivateKeyMethod="jwk",s.exportWebCryptoPrivateKeyMethod="jwk",s.exportWebCryptoPublicKeyMethod="jwk",s.wrapWebCryptoArrayBuffer=!0,s.useSJCL=!0,parseInt(s.browserVersion)>=11?s.wrapWebCryptoArrayBuffer=!1:parseInt(s.browserVersion)<=9&&(i=void 0);break}if(a=h.indexOf("Trident"),a!=-1){u="Internet Explorer",s.importWebCryptoPrivateKeyMethod="jwk",s.exportWebCryptoPrivateKeyMethod="jwk",s.exportWebCryptoPublicKeyMethod="jwk",s.wrapWebCryptoArrayBuffer=!0;break}if(-1!=f.indexOf("Firefox")){u="FireFox",s.importWebCryptoPrivateKeyMethod="jwk",s.exportWebCryptoPublicKeyMethod="jwk",s.exportWebCryptoPrivateKeyMethod="jwk";break}}while(!1);"undefined"!=typeof location&&"https:"!=location.protocol&&(i=void 0,o.consoleLog),s.browserName=u,s.supportWebCrypto=!!i,"undefined"==typeof i?(delete s.importWebCryptoPrivateKeyMethod,delete s.exportWebCryptoPrivateKeyMethod,delete s.exportWebCryptoPublicKeyMethod,delete s.wrapWebCryptoArrayBuffer):s.subtle=i,o.useWebCrypto=!0,t.exports=s},function(t,e,r){var n=r(1),i=n.util=n.util||{};i.setImmediate=function(t){setTimeout(t,0)},i.nextTick=i.setImmediate,i.isArray=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},i.isArrayBuffer=function(t){return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer};var a=[];"undefined"!=typeof Int8Array&&a.push(Int8Array),"undefined"!=typeof Uint8Array&&a.push(Uint8Array),"undefined"!=typeof Uint8ClampedArray&&a.push(Uint8ClampedArray),"undefined"!=typeof Int16Array&&a.push(Int16Array),"undefined"!=typeof Uint16Array&&a.push(Uint16Array),"undefined"!=typeof Int32Array&&a.push(Int32Array),"undefined"!=typeof Uint32Array&&a.push(Uint32Array),"undefined"!=typeof Float32Array&&a.push(Float32Array),"undefined"!=typeof Float64Array&&a.push(Float64Array),i.isArrayBufferView=function(t){for(var e=0;e<a.length;++e)if(t instanceof a[e])return!0;return!1},i.ByteBuffer=function(t){if(this.data="",this.read=0,"string"==typeof t)this.data=t;else if(i.isArrayBuffer(t)||i.isArrayBufferView(t)){var e=new Uint8Array(t);try{this.data=String.fromCharCode.apply(null,e)}catch(t){for(var r=0;r<e.length;++r)this.putByte(e[r])}}},i.ByteBuffer.prototype.length=function(){return this.data.length-this.read},i.ByteBuffer.prototype.isEmpty=function(){return this.length()<=0},i.ByteBuffer.prototype.putByte=function(t){return this.data+=String.fromCharCode(t),this},i.ByteBuffer.prototype.fillWithByte=function(t,e){t=String.fromCharCode(t);for(var r=this.data;e>0;)1&e&&(r+=t),e>>>=1,e>0&&(t+=t);return this.data=r,this},i.ByteBuffer.prototype.putBytes=function(t){return this.data+=t,this},i.ByteBuffer.prototype.putString=function(t){return this.data+=i.encodeUtf8(t),this},i.ByteBuffer.prototype.putInt16=function(t){return this.data+=String.fromCharCode(t>>8&255)+String.fromCharCode(255&t),this},i.ByteBuffer.prototype.putInt24=function(t){return this.data+=String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(255&t),this},i.ByteBuffer.prototype.putInt32=function(t){return this.data+=String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(255&t),this},i.ByteBuffer.prototype.putInt16Le=function(t){return this.data+=String.fromCharCode(255&t)+String.fromCharCode(t>>8&255),this},i.ByteBuffer.prototype.putInt24Le=function(t){return this.data+=String.fromCharCode(255&t)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255),this},i.ByteBuffer.prototype.putInt32Le=function(t){return this.data+=String.fromCharCode(255&t)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>24&255),this},i.ByteBuffer.prototype.putInt=function(t,e){do e-=8,this.data+=String.fromCharCode(t>>e&255);while(e>0);return this},i.ByteBuffer.prototype.putSignedInt=function(t,e){return t<0&&(t+=2<<e-1),this.putInt(t,e)},i.ByteBuffer.prototype.putBuffer=function(t){return this.data+=t.getBytes(),this},i.ByteBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)},i.ByteBuffer.prototype.getInt16=function(){var t=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,t},i.ByteBuffer.prototype.getInt24=function(){var t=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,t},i.ByteBuffer.prototype.getInt32=function(){var t=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,t},i.ByteBuffer.prototype.getInt16Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,t},i.ByteBuffer.prototype.getInt24Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,t},i.ByteBuffer.prototype.getInt32Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,t},i.ByteBuffer.prototype.getInt=function(t){var e=0;do e=(e<<8)+this.data.charCodeAt(this.read++),t-=8;while(t>0);return e},i.ByteBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e},i.ByteBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):0===t?e="":(e=0===this.read?this.data:this.data.slice(this.read),this.clear()),e},i.ByteBuffer.prototype.bytes=function(t){return"undefined"==typeof t?this.data.slice(this.read):this.data.slice(this.read,this.read+t)},i.ByteBuffer.prototype.at=function(t){return this.data.charCodeAt(this.read+t)},i.ByteBuffer.prototype.setAt=function(t,e){return this.data=this.data.substr(0,this.read+t)+String.fromCharCode(e)+this.data.substr(this.read+t+1),this},i.ByteBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)},i.ByteBuffer.prototype.copy=function(){var t=i.createBuffer(this.data);return t.read=this.read,t},i.ByteBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this},i.ByteBuffer.prototype.clear=function(){return this.data="",this.read=0,this},i.ByteBuffer.prototype.truncate=function(t){var e=Math.max(0,this.length()-t);return this.data=this.data.substr(this.read,e),this.read=0,this},i.ByteBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.length;++e){var r=this.data.charCodeAt(e);r<16&&(t+="0"),t+=r.toString(16)}return t},i.ByteBuffer.prototype.toString=function(){return i.decodeUtf8(this.bytes())},i.createBuffer=function(t,e){return e=e||"raw",void 0!==t&&"utf8"===e&&(t=i.encodeUtf8(t)),new i.ByteBuffer(t)},i.fillString=function(t,e){for(var r="";e>0;)1&e&&(r+=t),e>>>=1,e>0&&(t+=t);return r},i.xorBytes=function(t,e,r){for(var n="",i="",a="",o=0,s=0;r>0;--r,++o)i=t.charCodeAt(o)^e.charCodeAt(o),s>=10&&(n+=a,a="",s=0),a+=String.fromCharCode(i),++s;return n+=a},i.hexToBytes=function(t){var e="",r=0;for(t.length&!0&&(r=1,e+=String.fromCharCode(parseInt(t[0],16)));r<t.length;r+=2)e+=String.fromCharCode(parseInt(t.substr(r,2),16));return e},i.bytesToHex=function(t){return i.createBuffer(t).toHex()},i.int32ToBytes=function(t){return String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(255&t)};var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",s=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];i.encode64=function(t,e){for(var r,n,i,a="",s="",u=0;u<t.length;)r=t.charCodeAt(u++),n=t.charCodeAt(u++),i=t.charCodeAt(u++),a+=o.charAt(r>>2),a+=o.charAt((3&r)<<4|n>>4),isNaN(n)?a+="==":(a+=o.charAt((15&n)<<2|i>>6),a+=isNaN(i)?"=":o.charAt(63&i)),e&&a.length>e&&(s+=a.substr(0,e)+"\r\n",a=a.substr(e));return s+=a},i.decode64=function(t){t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var e,r,n,i,a="",o=0;o<t.length;)e=s[t.charCodeAt(o++)-43],r=s[t.charCodeAt(o++)-43],n=s[t.charCodeAt(o++)-43],i=s[t.charCodeAt(o++)-43],a+=String.fromCharCode(e<<2|r>>4),64!==n&&(a+=String.fromCharCode((15&r)<<4|n>>2),64!==i&&(a+=String.fromCharCode((3&n)<<6|i)));return a},i.encodeUtf8=function(t){return unescape(encodeURIComponent(t))},i.decodeUtf8=function(t){return decodeURIComponent(escape(t))},i.deflate=function(t,e,r){if(e=i.decode64(t.deflate(i.encode64(e)).rval),r){var n=2,a=e.charCodeAt(1);32&a&&(n=6),e=e.substring(n,e.length-4)}return e},i.inflate=function(t,e,r){var n=t.inflate(i.encode64(e)).rval;return null===n?null:i.decode64(n)};var u=function(t,e,r){if(!t)throw{message:"WebStorage not available."};var n;if(null===r?n=t.removeItem(e):(r=i.encode64(JSON.stringify(r)),n=t.setItem(e,r)),"undefined"!=typeof n&&n.rval!==!0)throw n.error},f=function(t,e){if(!t)throw{message:"WebStorage not available."};var r=t.getItem(e);if(t.init)if(null===r.rval){if(r.error)throw r.error;r=null}else r=r.rval;return null!==r&&(r=JSON.parse(i.decode64(r))),r},h=function(t,e,r,n){var i=f(t,e);null===i&&(i={}),i[r]=n,u(t,e,i)},c=function(t,e,r){var n=f(t,e);return null!==n&&(n=r in n?n[r]:null),n},p=function(t,e,r){var n=f(t,e);if(null!==n&&r in n){delete n[r];var i=!0;for(var a in n){i=!1;break}i&&(n=null),u(t,e,n)}},l=function(t,e){u(t,e,null)},d=function(t,e,r){var n=null;"undefined"==typeof r&&(r=["web","flash"]);var i,a=!1,o=null;for(var s in r){i=r[s];try{if("flash"===i||"both"===i){if(null===e[0])throw{message:"Flash local storage not available."};n=t.apply(this,e),a="flash"===i}"web"!==i&&"both"!==i||(e[0]=localStorage,n=t.apply(this,e),a=!0)}catch(t){o=t}if(a)break}if(!a)throw o;return n};i.setItem=function(t,e,r,n,i){d(h,arguments,i)},i.getItem=function(t,e,r,n){return d(c,arguments,n)},i.removeItem=function(t,e,r,n){d(p,arguments,n)},i.clearItems=function(t,e,r){d(l,arguments,r)},i.parseUrl=function(t){var e=/^(https?):\/\/([^:&^\/]*):?(\d*)(.*)$/g;e.lastIndex=0;var r=e.exec(t),n=null===r?null:{full:t,scheme:r[1],host:r[2],port:r[3],path:r[4]};return n&&(n.fullHost=n.host,n.port?80!==n.port&&"http"===n.scheme?n.fullHost+=":"+n.port:443!==n.port&&"https"===n.scheme&&(n.fullHost+=":"+n.port):"http"===n.scheme?n.port=80:"https"===n.scheme&&(n.port=443),n.full=n.scheme+"://"+n.fullHost),n};var y=null;i.getQueryVariables=function(t){var e,r=function(t){for(var e={},r=t.split("&"),n=0;n<r.length;n++){var i,a,o=r[n].indexOf("=");o>0?(i=r[n].substring(0,o),a=r[n].substring(o+1)):(i=r[n],a=null),i in e||(e[i]=[]),i in Object.prototype||null===a||e[i].push(unescape(a))}return e};return"undefined"==typeof t?(null===y&&(y="undefined"==typeof window?{}:r(window.location.search.substring(1))),e=y):e=r(t),e},i.parseFragment=function(t){var e=t,r="",n=t.indexOf("?");n>0&&(e=t.substring(0,n),r=t.substring(n+1));var a=e.split("/");a.length>0&&""===a[0]&&a.shift();var o=""===r?{}:i.getQueryVariables(r);return{pathString:e,queryString:r,path:a,query:o}},i.makeRequest=function(t){var e=i.parseFragment(t),r={path:e.pathString,query:e.queryString,getPath:function(t){return"undefined"==typeof t?e.path:e.path[t]},getQuery:function(t,r){var n;return"undefined"==typeof t?n=e.query:(n=e.query[t],n&&"undefined"!=typeof r&&(n=n[r])),n},getQueryLast:function(t,e){var n,i=r.getQuery(t);return n=i?i[i.length-1]:e}};return r},i.makeLink=function(t,e,r){t=jQuery.isArray(t)?t.join("/"):t;var n=jQuery.param(e||{});return r=r||"",t+(n.length>0?"?"+n:"")+(r.length>0?"#"+r:"")},i.setPath=function(t,e,r){if("object"==typeof t&&null!==t)for(var n=0,i=e.length;n<i;){var a=e[n++];if(n==i)t[a]=r;else{var o=a in t;(!o||o&&"object"!=typeof t[a]||o&&null===t[a])&&(t[a]={}),t=t[a]}}},i.getPath=function(t,e,r){for(var n=0,i=e.length,a=!0;a&&n<i&&"object"==typeof t&&null!==t;){var o=e[n++];a=o in t,a&&(t=t[o])}return a?t:r},i.deletePath=function(t,e){if("object"==typeof t&&null!==t)for(var r=0,n=e.length;r<n;){var i=e[r++];if(r==n)delete t[i];else{if(!(i in t)||"object"!=typeof t[i]||null===t[i])break;t=t[i]}}},i.isEmpty=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0},i.format=function(t){for(var e,r,n=/%./g,i=0,a=[],o=0;e=n.exec(t);){r=t.substring(o,n.lastIndex-2),r.length>0&&a.push(r),o=n.lastIndex;var s=e[0][1];switch(s){case"s":case"o":i<arguments.length?a.push(arguments[i++ +1]):a.push("<?>");break;case"%":a.push("%");break;default:a.push("<%"+s+"?>")}}return a.push(t.substring(o)),a.join("")},i.formatNumber=function(t,e,r,n){var i=t,a=isNaN(e=Math.abs(e))?2:e,o=void 0===r?",":r,s=void 0===n?".":n,u=i<0?"-":"",f=parseInt(i=Math.abs(+i||0).toFixed(a),10)+"",h=f.length>3?f.length%3:0;return u+(h?f.substr(0,h)+s:"")+f.substr(h).replace(/(\d{3})(?=\d)/g,"$1"+s)+(a?o+Math.abs(i-f).toFixed(a).slice(2):"")},i.formatSize=function(t){return t=t>=1073741824?i.formatNumber(t/1073741824,2,".","")+" GiB":t>=1048576?i.formatNumber(t/1048576,2,".","")+" MiB":t>=1024?i.formatNumber(t/1024,0)+" KiB":i.formatNumber(t,0)+" bytes"},i.bytesFromIP=function(t){return t.indexOf(".")!==-1?i.bytesFromIPv4(t):t.indexOf(":")!==-1?i.bytesFromIPv6(t):null},i.bytesFromIPv4=function(t){if(t=t.split("."),4!==t.length)return null;for(var e=i.createBuffer(),r=0;r<t.length;++r){var n=parseInt(t[r],10);if(isNaN(n))return null;e.putByte(n)}return e.getBytes()},i.bytesFromIPv6=function(t){var e=0;t=t.split(":").filter(function(t){return 0===t.length&&++e,!0});for(var r=2*(8-t.length+e),n=i.createBuffer(),a=0;a<8;++a)if(t[a]&&0!==t[a].length){var o=i.hexToBytes(t[a]);o.length<2&&n.putByte(0),n.putBytes(o)}else n.fillWithByte(0,r),r=0;return n.getBytes()},i.bytesToIP=function(t){return 4===t.length?i.bytesToIPv4(t):16===t.length?i.bytesToIPv6(t):null},i.bytesToIPv4=function(t){if(4!==t.length)return null;for(var e=[],r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e.join(".")},i.bytesToIPv6=function(t){if(16!==t.length)return null;for(var e=[],r=[],n=0,a=0;a<t.length;a+=2){for(var o=i.bytesToHex(t[a]+t[a+1]);"0"===o[0]&&"0"!==o;)o=o.substr(1);if("0"===o){var s=r[r.length-1],u=e.length;s&&u===s.end+1?(s.end=u,s.end-s.start>r[n].end-r[n].start&&(n=r.length-1)):r.push({start:u,end:u})}e.push(o)}if(r.length>0){var f=r[n];f.end-f.start>0&&(e.splice(f.start,f.end-f.start+1,""),0===f.start&&e.unshift(""),7===f.end&&e.push(""))}return e.join(":")},i.estimateCores=function(t,e){function r(t,s,u){if(0===s){var f=Math.floor(t.reduce(function(t,e){return t+e},0)/t.length);return i.cores=Math.max(1,f),URL.revokeObjectURL(o),e(null,i.cores)}n(u,function(e,n){t.push(a(u,n)),r(t,s-1,u)})}function n(t,e){for(var r=[],n=[],i=0;i<t;++i){var a=new Worker(o);a.addEventListener("message",function(i){if(n.push(i.data),n.length===t){for(var a=0;a<t;++a)r[a].terminate();e(null,n)}}),r.push(a)}for(var i=0;i<t;++i)r[i].postMessage(i)}function a(t,e){for(var r=[],n=0;n<t;++n)for(var i=e[n],a=r[n]=[],o=0;o<t;++o)if(n!==o){var s=e[o];(i.st>s.st&&i.st<s.et||s.st>i.st&&s.st<i.et)&&a.push(o)}return r.reduce(function(t,e){return Math.max(t,e.length)},0)}if("function"==typeof t&&(e=t,t={}),t=t||{},"cores"in i&&!t.update)return e(null,i.cores);if(void 0===typeof Worker)return i.cores=1,e(null,i.cores);if(void 0===typeof Blob)return i.cores=2,e(null,i.cores);var o=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(t){for(var e=Date.now(),r=e+4;Date.now()<r;);self.postMessage({st:e,et:r})})}.toString(),")()"],{type:"application/javascript"}));r([],5,16)},t.exports=n.util},function(t,e,r){var n=r(1);n.md=n.md||{},r(6),r(7),r(8),r(9),r(10);var i=n.getSettings();i.useSJCL&&(n.sha256=n.sha256_sjcl),n.md.algorithms={md5:n.md5,sha1:n.sha1,sha224:n.sha224,sha256:n.sha256},n.md.md5=n.md5,n.md.sha1=n.sha1,n.md.sha224=n.sha224,n.md.sha256=n.sha256,n.md.sha256_sjcl=n.sha256_sjcl,t.exports=n.md},function(t,e,r){var n=r(1),i=n.md5=n.md5||{};n.md=n.md||{},n.md.algorithms=n.md.algorithms||{},n.md.md5=n.md.algorithms.md5=i;var a=null,o=null,s=null,u=null,f=!1,h=function(){a=String.fromCharCode(128),a+=n.util.fillString(String.fromCharCode(0),64),o=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,1,6,11,0,5,10,15,4,9,14,3,8,13,2,7,12,5,8,11,14,1,4,7,10,13,0,3,6,9,12,15,2,0,7,14,5,12,3,10,1,8,15,6,13,4,11,2,9],s=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21],u=new Array(64);for(var t=0;t<64;++t)u[t]=Math.floor(4294967296*Math.abs(Math.sin(t+1)));f=!0},c=function(t,e,r){for(var n,i,a,f,h,c,p,l,d=r.length();d>=64;){for(i=t.h0,a=t.h1,f=t.h2,h=t.h3,l=0;l<16;++l)e[l]=r.getInt32Le(),c=h^a&(f^h),n=i+c+u[l]+e[l],p=s[l],i=h,h=f,f=a,a+=n<<p|n>>>32-p;for(;l<32;++l)c=f^h&(a^f),n=i+c+u[l]+e[o[l]],p=s[l],i=h,h=f,f=a,a+=n<<p|n>>>32-p;for(;l<48;++l)c=a^f^h,n=i+c+u[l]+e[o[l]],p=s[l],i=h,h=f,f=a,a+=n<<p|n>>>32-p;for(;l<64;++l)c=f^(a|~h),n=i+c+u[l]+e[o[l]],p=s[l],i=h,h=f,f=a,a+=n<<p|n>>>32-p;t.h0=t.h0+i&4294967295,t.h1=t.h1+a&4294967295,t.h2=t.h2+f&4294967295,t.h3=t.h3+h&4294967295,d-=64}};i.create=function(){f||h();var t=null,e=n.util.createBuffer(),r=new Array(16),i={algorithm:"md5",blockLength:64,digestLength:16,messageLength:0};return i.start=function(){return i.messageLength=0,e=n.util.createBuffer(),t={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878},i},i.start(),i.update=function(a,o){return"utf8"===o&&(a=n.util.encodeUtf8(a)),i.messageLength+=a.length,e.putBytes(a),c(t,r,e),(e.read>2048||0===e.length())&&e.compact(),i},i.digest=function(){var o=i.messageLength,s=n.util.createBuffer();s.putBytes(e.bytes()),s.putBytes(a.substr(0,64-(o+8)%64)),s.putInt32Le(o<<3&4294967295),s.putInt32Le(o>>>29&255);var u={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3};c(u,r,s);var f=n.util.createBuffer();return f.putInt32Le(u.h0),f.putInt32Le(u.h1),f.putInt32Le(u.h2),f.putInt32Le(u.h3),f},i},t.exports=i},function(t,e,r){var n=r(1),i=n.sha1=n.sha1||{};n.md=n.md||{},n.md.algorithms=n.md.algorithms||{},n.md.sha1=n.md.algorithms.sha1=i;var a=null,o=!1,s=function(){a=String.fromCharCode(128),a+=n.util.fillString(String.fromCharCode(0),64),o=!0},u=function(t,e,r){for(var n,i,a,o,s,u,f,h,c=r.length();c>=64;){for(i=t.h0,a=t.h1,o=t.h2,s=t.h3,u=t.h4,h=0;h<16;++h)n=r.getInt32(),e[h]=n,f=s^a&(o^s),n=(i<<5|i>>>27)+f+u+1518500249+n,u=s,s=o,o=a<<30|a>>>2,a=i,i=n;for(;h<20;++h)n=e[h-3]^e[h-8]^e[h-14]^e[h-16],n=n<<1|n>>>31,e[h]=n,f=s^a&(o^s),n=(i<<5|i>>>27)+f+u+1518500249+n,u=s,s=o,o=a<<30|a>>>2,a=i,i=n;for(;h<32;++h)n=e[h-3]^e[h-8]^e[h-14]^e[h-16],n=n<<1|n>>>31,e[h]=n,f=a^o^s,n=(i<<5|i>>>27)+f+u+1859775393+n,u=s,s=o,o=a<<30|a>>>2,a=i,i=n;for(;h<40;++h)n=e[h-6]^e[h-16]^e[h-28]^e[h-32],n=n<<2|n>>>30,e[h]=n,f=a^o^s,n=(i<<5|i>>>27)+f+u+1859775393+n,u=s,s=o,o=a<<30|a>>>2,a=i,i=n;for(;h<60;++h)n=e[h-6]^e[h-16]^e[h-28]^e[h-32],n=n<<2|n>>>30,e[h]=n,f=a&o|s&(a^o),n=(i<<5|i>>>27)+f+u+2400959708+n,u=s,s=o,o=a<<30|a>>>2,a=i,i=n;for(;h<80;++h)n=e[h-6]^e[h-16]^e[h-28]^e[h-32],n=n<<2|n>>>30,e[h]=n,f=a^o^s,n=(i<<5|i>>>27)+f+u+3395469782+n,u=s,s=o,o=a<<30|a>>>2,a=i,i=n;t.h0+=i,t.h1+=a,t.h2+=o,t.h3+=s,t.h4+=u,c-=64}};i.create=function(){o||s();var t=null,e=n.util.createBuffer(),r=new Array(80),i={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0};return i.start=function(){return i.messageLength=0,e=n.util.createBuffer(),t={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},i},i.start(),i.update=function(a,o){return"utf8"===o&&(a=n.util.encodeUtf8(a)),i.messageLength+=a.length,e.putBytes(a),u(t,r,e),(e.read>2048||0===e.length())&&e.compact(),i},i.digest=function(){var o=i.messageLength,s=n.util.createBuffer();s.putBytes(e.bytes()),s.putBytes(a.substr(0,64-(o+8)%64)),s.putInt32(o>>>29&255),s.putInt32(o<<3&4294967295);var f={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4};u(f,r,s);var h=n.util.createBuffer();return h.putInt32(f.h0),h.putInt32(f.h1),h.putInt32(f.h2),h.putInt32(f.h3),h.putInt32(f.h4),h},i},t.exports=i},function(t,e,r){var n=r(1),i=n.sha224=n.sha224||{};n.md=n.md||{},n.md.algorithms=n.md.algorithms||{},n.md.sha224=n.md.algorithms.sha224=i;var a=null,o=!1,s=null,u=function(){a=String.fromCharCode(128),a+=n.util.fillString(String.fromCharCode(0),64),s=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],o=!0},f=function(t,e,r){for(var n,i,a,o,u,f,h,c,p,l,d,y,g,F,v,m=r.length();m>=64;){for(h=0;h<16;++h)e[h]=r.getInt32();for(;h<64;++h)n=e[h-2],n=(n>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,i=e[h-15],i=(i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,e[h]=n+e[h-7]+i+e[h-16]&4294967295;for(c=t.h0,p=t.h1,l=t.h2,d=t.h3,y=t.h4,g=t.h5,F=t.h6,v=t.h7,h=0;h<64;++h)o=(y>>>6|y<<26)^(y>>>11|y<<21)^(y>>>25|y<<7),u=F^y&(g^F),a=(c>>>2|c<<30)^(c>>>13|c<<19)^(c>>>22|c<<10),f=c&p|l&(c^p),n=v+o+u+s[h]+e[h],i=a+f,v=F,F=g,g=y,y=d+n&4294967295,d=l,l=p,p=c,c=n+i&4294967295;t.h0=t.h0+c&4294967295,t.h1=t.h1+p&4294967295,t.h2=t.h2+l&4294967295,t.h3=t.h3+d&4294967295,t.h4=t.h4+y&4294967295,t.h5=t.h5+g&4294967295,t.h6=t.h6+F&4294967295,t.h7=t.h7+v&4294967295,m-=64}};i.create=function(){o||u();var t=null,e=n.util.createBuffer(),r=new Array(64),i={algorithm:"sha224",blockLength:64,digestLength:28,messageLength:0};return i.start=function(){return i.messageLength=0,e=n.util.createBuffer(),t={h0:3238371032,h1:914150663,h2:812702999,h3:4144912697,h4:4290775857,h5:1750603025,h6:1694076839,h7:3204075428},i},i.start(),i.update=function(a,o){return"utf8"===o&&(a=n.util.encodeUtf8(a)),i.messageLength+=a.length,e.putBytes(a),f(t,r,e),(e.read>2048||0===e.length())&&e.compact(),i},i.digest=function(){var o=i.messageLength,s=n.util.createBuffer();s.putBytes(e.bytes()),s.putBytes(a.substr(0,64-(o+8)%64)),s.putInt32(o>>>29&255),s.putInt32(o<<3&4294967295);var u={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4,h5:t.h5,h6:t.h6,h7:t.h7};f(u,r,s);var h=n.util.createBuffer();return h.putInt32(u.h0),h.putInt32(u.h1),h.putInt32(u.h2),h.putInt32(u.h3),h.putInt32(u.h4),h.putInt32(u.h5),h.putInt32(u.h6),h},i},t.exports=i},function(t,e,r){var n=r(1),i=n.sha256=n.sha256||{};n.md=n.md||{},n.md.algorithms=n.md.algorithms||{},n.md.sha256=n.md.algorithms.sha256=i;var a=null,o=!1,s=null,u=function(){a=String.fromCharCode(128),a+=n.util.fillString(String.fromCharCode(0),64),s=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],o=!0},f=function(t,e,r){for(var n,i,a,o,u,f,h,c,p,l,d,y,g,F,v,m=r.length();m>=64;){for(h=0;h<16;++h)e[h]=r.getInt32();for(;h<64;++h)n=e[h-2],n=(n>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,i=e[h-15],i=(i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,e[h]=n+e[h-7]+i+e[h-16]&4294967295;for(c=t.h0,p=t.h1,l=t.h2,d=t.h3,y=t.h4,g=t.h5,F=t.h6,v=t.h7,h=0;h<64;++h)o=(y>>>6|y<<26)^(y>>>11|y<<21)^(y>>>25|y<<7),u=F^y&(g^F),a=(c>>>2|c<<30)^(c>>>13|c<<19)^(c>>>22|c<<10),f=c&p|l&(c^p),n=v+o+u+s[h]+e[h],i=a+f,v=F,F=g,g=y,y=d+n&4294967295,d=l,l=p,p=c,c=n+i&4294967295;t.h0=t.h0+c&4294967295,t.h1=t.h1+p&4294967295,t.h2=t.h2+l&4294967295,t.h3=t.h3+d&4294967295,t.h4=t.h4+y&4294967295,t.h5=t.h5+g&4294967295,t.h6=t.h6+F&4294967295,t.h7=t.h7+v&4294967295,m-=64}};i.create=function(){o||u();var t=null,e=n.util.createBuffer(),r=new Array(64),i={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0};return i.start=function(){return i.messageLength=0,e=n.util.createBuffer(),t={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},i},i.start(),i.update=function(a,o){return"utf8"===o&&(a=n.util.encodeUtf8(a)),i.messageLength+=a.length,e.putBytes(a),f(t,r,e),(e.read>2048||0===e.length())&&e.compact(),i},i.digest=function(){var o=i.messageLength,s=n.util.createBuffer();s.putBytes(e.bytes()),s.putBytes(a.substr(0,64-(o+8)%64)),
s.putInt32(o>>>29&255),s.putInt32(o<<3&4294967295);var u={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4,h5:t.h5,h6:t.h6,h7:t.h7};f(u,r,s);var h=n.util.createBuffer();return h.putInt32(u.h0),h.putInt32(u.h1),h.putInt32(u.h2),h.putInt32(u.h3),h.putInt32(u.h4),h.putInt32(u.h5),h.putInt32(u.h6),h.putInt32(u.h7),h},i},t.exports=i},function(t,e,r){var n=r(1),i={};i.bitArray={bitSlice:function(t,e,r){return t=i.bitArray._shiftRight(t.slice(e/32),32-(31&e)).slice(1),void 0===r?t:i.bitArray.clamp(t,r-e)},extract:function(t,e,r){var n,i=Math.floor(-e-r&31);return n=(e+r-1^e)&-32?t[e/32|0]<<32-i^t[e/32+1|0]>>>i:t[e/32|0]>>>i,n&(1<<r)-1},concat:function(t,e){if(0===t.length||0===e.length)return t.concat(e);var r=t[t.length-1],n=i.bitArray.getPartial(r);return 32===n?t.concat(e):i.bitArray._shiftRight(e,n,0|r,t.slice(0,t.length-1))},bitLength:function(t){var e,r=t.length;return 0===r?0:(e=t[r-1],32*(r-1)+i.bitArray.getPartial(e))},clamp:function(t,e){if(32*t.length<e)return t;t=t.slice(0,Math.ceil(e/32));var r=t.length;return e&=31,r>0&&e&&(t[r-1]=i.bitArray.partial(e,t[r-1]&2147483648>>e-1,1)),t},partial:function(t,e,r){return 32===t?e:(r?0|e:e<<32-t)+1099511627776*t},getPartial:function(t){return Math.round(t/1099511627776)||32},equal:function(t,e){if(i.bitArray.bitLength(t)!==i.bitArray.bitLength(e))return!1;var r,n=0;for(r=0;r<t.length;r++)n|=t[r]^e[r];return 0===n},_shiftRight:function(t,e,r,n){var a,o,s=0;for(void 0===n&&(n=[]);e>=32;e-=32)n.push(r),r=0;if(0===e)return n.concat(t);for(a=0;a<t.length;a++)n.push(r|t[a]>>>e),r=t[a]<<32-e;return s=t.length?t[t.length-1]:0,o=i.bitArray.getPartial(s),n.push(i.bitArray.partial(e+o&31,e+o>32?r:n.pop(),1)),n},_xor4:function(t,e){return[t[0]^e[0],t[1]^e[1],t[2]^e[2],t[3]^e[3]]},byteswapM:function(t){var e,r,n=65280;for(e=0;e<t.length;++e)r=t[e],t[e]=r>>>24|r>>>8&n|(r&n)<<8|r<<24;return t}},i.codec={},i.codec.hex={fromBits:function(t){var e,r="";for(e=0;e<t.length;e++)r+=((0|t[e])+0xf00000000000).toString(16).substr(4);return r.substr(0,i.bitArray.bitLength(t)/4)},toBits:function(t){var e,r,n=[];for(t=t.replace(/\s|0x/g,""),r=t.length,t+="00000000",e=0;e<t.length;e+=8)n.push(0^parseInt(t.substr(e,8),16));return i.bitArray.clamp(n,4*r)}},i.codec.utf8String={fromBits:function(t){var e,r,n="",a=i.bitArray.bitLength(t);for(e=0;e<a/8;e++)0===(3&e)&&(r=t[e/4]),n+=String.fromCharCode(r>>>8>>>8>>>8),r<<=8;return decodeURIComponent(escape(n))},toBits:function(t){t=unescape(encodeURIComponent(t));var e,r=[],n=0;for(e=0;e<t.length;e++)n=n<<8|t.charCodeAt(e),3===(3&e)&&(r.push(n),n=0);return 3&e&&r.push(i.bitArray.partial(8*(3&e),n)),r}},i.hash={},i.hash.sha256=function(t){this._zl[0]||this._precompute(),t?(this._h=t._h.slice(0),this._buffer=t._buffer.slice(0),this._length=t._length):this.reset()},i.hash.sha256.hash=function(t){return(new i.hash.sha256).update(t).finalize()},i.hash.sha256.prototype={blockSize:512,reset:function(){return this._h=this._init.slice(0),this._buffer=[],this._length=0,this},update:function(t){"string"==typeof t&&(t=i.codec.utf8String.toBits(t));var e,r=this._buffer=i.bitArray.concat(this._buffer,t),n=this._length,a=this._length=n+i.bitArray.bitLength(t);if(a>9007199254740991)throw new i.exception.invalid("Cannot hash more than 2^53 - 1 bits");if("undefined"!=typeof Uint32Array){var o=new Uint32Array(r),s=0;for(e=512+n-(512+n&511);e<=a;e+=512)this._block(o.subarray(16*s,16*(s+1))),s+=1;r.splice(0,16*s)}else for(e=512+n-(512+n&511);e<=a;e+=512)this._block(r.splice(0,16));return this},finalize:function(){var t,e=this._buffer,r=this._h;for(e=i.bitArray.concat(e,[i.bitArray.partial(1,1)]),t=e.length+2;15&t;t++)e.push(0);for(e.push(Math.floor(this._length/4294967296)),e.push(0|this._length);e.length;)this._block(e.splice(0,16));return r},_init:[],_zl:[],_precompute:function(){function t(t){return 4294967296*(t-Math.floor(t))|0}for(var e,r,n=0,i=2;n<64;i++){for(r=!0,e=2;e*e<=i;e++)if(i%e===0){r=!1;break}r&&(n<8&&(this._init[n]=t(Math.pow(i,.5))),this._zl[n]=t(Math.pow(i,1/3)),n++)}},_block:function(t){var e,r,n,i,a=this._h,o=this._zl,s=a[0],u=a[1],f=a[2],h=a[3],c=a[4],p=a[5],l=a[6],d=a[7];for(e=0;e<64;e++)e<16?r=t[e]:(n=t[e+1&15],i=t[e+14&15],r=t[15&e]=(n>>>7^n>>>18^n>>>3^n<<25^n<<14)+(i>>>17^i>>>19^i>>>10^i<<15^i<<13)+t[15&e]+t[e+9&15]|0),r=r+d+(c>>>6^c>>>11^c>>>25^c<<26^c<<21^c<<7)+(l^c&(p^l))+o[e],d=l,l=p,p=c,c=h+r|0,h=f,f=u,u=s,s=r+(u&f^h&(u^f))+(u>>>2^u>>>13^u>>>22^u<<30^u<<19^u<<10)|0;a[0]=a[0]+s|0,a[1]=a[1]+u|0,a[2]=a[2]+f|0,a[3]=a[3]+h|0,a[4]=a[4]+c|0,a[5]=a[5]+p|0,a[6]=a[6]+l|0,a[7]=a[7]+d|0}};var a={};a.create=function(){var t=new i.hash.sha256;return t.reset(),{algorithm:"sha256",blockLength:64,digestLength:32,start:function(){t.reset()},update:function(e){return e=n.util.bytesToHex(e),e=i.codec.hex.toBits(e),t.update(e),this},digest:function(){var e;return e=t.finalize(),e=i.codec.hex.fromBits(e),e=n.util.hexToBytes(e),e=n.util.createBuffer(e)}}},n.sha256_sjcl=a,n.md.sha256_sjcl=a,t.exports=n.sha256_sjcl},function(t,e,r){(function(e){var n=r(1),i="undefined"!=typeof e&&e.versions&&e.versions.node,a=null;!n.disableNativeCode&&i;var o=n.prng=n.prng||{};o.create=function(t){function e(t){if(s.pools[0].messageLength>=32)return i(),t();var e=32-s.pools[0].messageLength<<5;s.seedFile(e,function(e,r){return e?t(e):(s.collect(r),i(),void t())})}function r(){if(s.pools[0].messageLength>=32)return i();var t=32-s.pools[0].messageLength<<5;s.collect(s.seedFileSync(t)),i()}function i(){var t=n.md.sha1.create();t.update(s.pools[0].digest().getBytes()),s.pools[0].start();for(var e=1,r=1;r<32;++r)e=31===e?2147483648:e<<2,e%s.reseeds===0&&(t.update(s.pools[r].digest().getBytes()),s.pools[r].start());var i=t.digest().getBytes();t.start(),t.update(i);var a=t.digest().getBytes();s.zl=s.plugin.formatKey(i),s.seed=s.plugin.formatSeed(a),++s.reseeds,s.generated=0,s.time=+new Date}function o(t){var e=null;if("undefined"!=typeof window){var r=window.crypto||window.msCrypto;r&&r.getRandomValues&&(e=function(t){return r.getRandomValues(t)})}var i=n.util.createBuffer();if(e)for(;i.length()<t;){var a=Math.max(1,Math.min(t-i.length(),65536)/4),o=new Uint32Array(Math.floor(a));try{e(o);for(var s=0;s<o.length;++s)i.putInt32(o[s])}catch(t){if(!("undefined"!=typeof QuotaExceededError&&t instanceof QuotaExceededError))throw t}}if(i.length()<t)for(var u,f,h,c=Math.floor(65536*ytcrypto.base.srnd());i.length()<t;){f=16807*(65535&c),u=16807*(c>>16),f+=(32767&u)<<16,f+=u>>15,f=(2147483647&f)+(f>>31),c=4294967295&f;for(var s=0;s<3;++s)h=c>>>(s<<3),h^=Math.floor(256*ytcrypto.base.srnd()),i.putByte(String.fromCharCode(255&h))}return i.getBytes(t)}for(var s={plugin:t,zl:null,seed:null,time:null,reseeds:0,generated:0},u=t.md,f=new Array(32),h=0;h<32;++h)f[h]=u.create();return s.pools=f,s.pool=0,s.generate=function(t,r){function i(c){if(c)return r(c);if(h.length()>=t)return r(null,h.getBytes(t));if(s.generated>=1048576){var p=+new Date;(null===s.time||p-s.time>100)&&(s.zl=null)}if(null===s.zl)return e(i);var l=a(s.zl,s.seed);s.generated+=l.length,h.putBytes(l),s.zl=u(a(s.zl,o(s.seed))),s.seed=f(a(s.zl,s.seed)),n.util.setImmediate(i)}if(!r)return s.generateSync(t);var a=s.plugin.cipher,o=s.plugin.increment,u=s.plugin.formatKey,f=s.plugin.formatSeed,h=n.util.createBuffer();i()},s.generateSync=function(t){for(var e=s.plugin.cipher,i=s.plugin.increment,a=s.plugin.formatKey,o=s.plugin.formatSeed,u=n.util.createBuffer();u.length()<t;){if(s.generated>=1048576){var f=+new Date;(null===s.time||f-s.time>100)&&(s.zl=null)}null===s.zl&&r();var h=e(s.zl,s.seed);s.generated+=h.length,u.putBytes(h),s.zl=a(e(s.zl,i(s.seed))),s.seed=o(e(s.zl,s.seed))}return u.getBytes(t)},a?(s.seedFile=function(t,e){a.randomBytes(t,function(t,r){return t?e(t):void e(null,r.toString())})},s.seedFileSync=function(t){return a.randomBytes(t).toString()}):(s.seedFile=function(t,e){try{e(null,o(t))}catch(t){e(t)}},s.seedFileSync=o),s.collect=function(t){for(var e=t.length,r=0;r<e;++r)s.pools[s.pool].update(t.substr(r,1)),s.pool=31===s.pool?0:s.pool+1},s.collectInt=function(t,e){for(var r="",n=0;n<e;n+=8)r+=String.fromCharCode(t>>n&255);s.collect(r)},s.registerWorker=function(t){function e(e){var r=e.data;r.yt&&r.yt.prng&&s.seedFile(r.yt.prng.needed,function(e,r){t.postMessage({yt:{prng:{err:e,bytes:r}}})})}t===self?s.seedFile=function(t,e){function r(t){var n=t.data;n.yt&&n.yt.prng&&(self.removeEventListener("message",r),e(n.yt.prng.err,n.yt.prng.bytes))}self.addEventListener("message",r),self.postMessage({yt:{prng:{needed:t}}})}:t.addEventListener("message",e)},s},t.exports=n.prng}).call(e,r(12))},function(t,e){function r(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function i(t){if(h===setTimeout)return setTimeout(t,0);if((h===r||!h)&&setTimeout)return h=setTimeout,setTimeout(t,0);try{return h(t,0)}catch(e){try{return h.call(null,t,0)}catch(e){return h.call(this,t,0)}}}function a(t){if(c===clearTimeout)return clearTimeout(t);if((c===n||!c)&&clearTimeout)return c=clearTimeout,clearTimeout(t);try{return c(t)}catch(e){try{return c.call(null,t)}catch(e){return c.call(this,t)}}}function o(){y&&l&&(y=!1,l.length?d=l.concat(d):g=-1,d.length&&s())}function s(){if(!y){var t=i(o);y=!0;for(var e=d.length;e;){for(l=d,d=[];++g<e;)l&&l[g].run();g=-1,e=d.length}l=null,y=!1,a(t)}}function u(t,e){this.fun=t,this.array=e}function f(){}var h,c,p=t.exports={};!function(){try{h="function"==typeof setTimeout?setTimeout:r}catch(t){h=r}try{c="function"==typeof clearTimeout?clearTimeout:n}catch(t){c=n}}();var l,d=[],y=!1,g=-1;p.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];d.push(new u(t,e)),1!==d.length||y||i(s)},u.prototype.run=function(){this.fun.apply(null,this.array)},p.title="browser",p.browser=!0,p.env={},p.argv=[],p.version="",p.versions={},p.on=f,p.addListener=f,p.once=f,p.off=f,p.removeListener=f,p.removeAllListeners=f,p.emit=f,p.prependListener=f,p.prependOnceListener=f,p.listeners=function(t){return[]},p.binding=function(t){throw new Error("process.binding is not supported")},p.cwd=function(){return"/"},p.chdir=function(t){throw new Error("process.chdir is not supported")},p.umask=function(){return 0}},function(t,e,r){(function(e){var n=r(1),i={},a=new Array(4),o=n.util.createBuffer();i.formatKey=function(t){var e=n.util.createBuffer(t);return t=new Array(4),t[0]=e.getInt32(),t[1]=e.getInt32(),t[2]=e.getInt32(),t[3]=e.getInt32(),n.aes._expandKey(t,!1)},i.formatSeed=function(t){var e=n.util.createBuffer(t);return t=new Array(4),t[0]=e.getInt32(),t[1]=e.getInt32(),t[2]=e.getInt32(),t[3]=e.getInt32(),t},i.cipher=function(t,e){return n.aes._updateBlock(t,e,a,!1),o.putInt32(a[0]),o.putInt32(a[1]),o.putInt32(a[2]),o.putInt32(a[3]),o.getBytes()},i.increment=function(t){return++t[3],t},i.md=n.md.sha1;var s=n.prng.create(i),u=("undefined"!=typeof e&&e.versions&&e.versions.node,null);if("undefined"!=typeof window){var f=window.crypto||window.msCrypto;f&&f.getRandomValues&&(u=function(t){return f.getRandomValues(t)})}if(n.random)for(var h in s)n.random[h]=s[h];else n.random=s;n.random.getBytes=function(t,e){return n.random.generate(t,e)},n.random.getBytesSync=function(t){return n.random.generate(t)},t.exports=n.random}).call(e,r(12))},function(t,e,r){var n=r(1),i=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],a=[1,2,3,5],o=function(t,e){return t<<e&65535|(65535&t)>>16-e},s=function(t,e){return(65535&t)>>e|t<<16-e&65535};n.rc2=n.rc2||{},n.rc2.expandKey=function(t,e){"string"==typeof t&&(t=n.util.createBuffer(t)),e=e||128;var r,a=t,o=t.length(),s=e,u=Math.ceil(s/8),f=255>>(7&s);for(r=o;r<128;r++)a.putByte(i[a.at(r-1)+a.at(r-o)&255]);for(a.setAt(128-u,i[a.at(128-u)&f]),r=127-u;r>=0;r--)a.setAt(r,i[a.at(r+1)^a.at(r+u)]);return a};var u=function(t,e,r){var i,u,f,h,c=!1,p=null,l=null,d=null,y=[];for(t=n.rc2.expandKey(t,e),f=0;f<64;f++)y.push(t.getInt16Le());r?(i=function(t){for(f=0;f<4;f++)t[f]+=y[h]+(t[(f+3)%4]&t[(f+2)%4])+(~t[(f+3)%4]&t[(f+1)%4]),t[f]=o(t[f],a[f]),h++},u=function(t){for(f=0;f<4;f++)t[f]+=y[63&t[(f+3)%4]]}):(i=function(t){for(f=3;f>=0;f--)t[f]=s(t[f],a[f]),t[f]-=y[h]+(t[(f+3)%4]&t[(f+2)%4])+(~t[(f+3)%4]&t[(f+1)%4]),h--},u=function(t){for(f=3;f>=0;f--)t[f]-=y[63&t[(f+3)%4]]});var g=function(t){var e=[];for(f=0;f<4;f++){var n=p.getInt16Le();null!==d&&(r?n^=d.getInt16Le():d.putInt16Le(n)),e.push(65535&n)}h=r?0:63;for(var i=0;i<t.length;i++)for(var a=0;a<t[i][0];a++)t[i][1](e);for(f=0;f<4;f++)null!==d&&(r?d.putInt16Le(e[f]):e[f]^=d.getInt16Le()),l.putInt16Le(e[f])},F=null;return F={start:function(t,e){t&&"string"==typeof t&&(t=n.util.createBuffer(t)),c=!1,p=n.util.createBuffer(),l=e||new n.util.createBuffer,d=t,F.output=l},update:function(t){for(c||p.putBuffer(t);p.length()>=8;)g([[5,i],[1,u],[6,i],[1,u],[5,i]])},finish:function(t){var e=!0;if(r)if(t)e=t(8,p,!r);else{var n=8===p.length()?8:8-p.length();p.fillWithByte(n,n)}if(e&&(c=!0,F.update()),!r&&(e=0===p.length()))if(t)e=t(8,l,!r);else{var i=l.length(),a=l.at(i-1);a>i?e=!1:l.truncate(a)}return e}}};n.rc2.startEncrypting=function(t,e,r){var i=n.rc2.createEncryptionCipher(t,128);return i.start(e,r),i},n.rc2.createEncryptionCipher=function(t,e){return u(t,e,!0)},n.rc2.startDecrypting=function(t,e,r){var i=n.rc2.createDecryptionCipher(t,128);return i.start(e,r),i},n.rc2.createDecryptionCipher=function(t,e){return u(t,e,!1)},t.exports=n.rc2},function(t,e,r){var n,i,a,o,s,u=r(1),f=!1,h=4,c=function(){f=!0,a=[0,1,2,4,8,16,32,64,128,27,54];for(var t=new Array(256),e=0;e<128;++e)t[e]=e<<1,t[e+128]=e+128<<1^283;n=new Array(256),i=new Array(256),o=new Array(4),s=new Array(4);for(var e=0;e<4;++e)o[e]=new Array(256),s[e]=new Array(256);for(var r,u,h,c,p,l,d,y=0,g=0,e=0;e<256;++e){c=g^g<<1^g<<2^g<<3^g<<4,c=c>>8^255&c^99,n[y]=c,i[c]=y,p=t[c],r=t[y],u=t[r],h=t[u],l=p<<24^c<<16^c<<8^(c^p),d=(r^u^h)<<24^(y^h)<<16^(y^u^h)<<8^(y^r^h);for(var F=0;F<4;++F)o[F][y]=l,s[F][c]=d,l=l<<24|l>>>8,d=d<<24|d>>>8;0===y?y=g=1:(y=r^t[t[t[r^h]]],g^=t[t[g]])}},p=function(t,e){for(var r,i=t.slice(0),o=1,u=i.length,f=u+6+1,c=h*f,p=u;p<c;++p)r=i[p-1],p%u===0?(r=n[r>>>16&255]<<24^n[r>>>8&255]<<16^n[255&r]<<8^n[r>>>24]^a[o]<<24,o++):u>6&&p%u===4&&(r=n[r>>>24]<<24^n[r>>>16&255]<<16^n[r>>>8&255]<<8^n[255&r]),i[p]=i[p-u]^r;if(e){for(var l,d=s[0],y=s[1],g=s[2],F=s[3],v=i.slice(0),c=i.length,p=0,m=c-h;p<c;p+=h,m-=h)if(0===p||p===c-h)v[p]=i[m],v[p+1]=i[m+3],v[p+2]=i[m+2],v[p+3]=i[m+1];else for(var B=0;B<h;++B)l=i[m+B],v[p+(3&-B)]=d[n[l>>>24]]^y[n[l>>>16&255]]^g[n[l>>>8&255]]^F[n[255&l]];i=v}return i},l=function(t,e,r,a){var u,f,h,c,p,l=t.length/4-1;a?(u=s[0],f=s[1],h=s[2],c=s[3],p=i):(u=o[0],f=o[1],h=o[2],c=o[3],p=n);var d,y,g,F,v,m,B;d=e[0]^t[0],y=e[a?3:1]^t[1],g=e[2]^t[2],F=e[a?1:3]^t[3];for(var C=3,b=1;b<l;++b)v=u[d>>>24]^f[y>>>16&255]^h[g>>>8&255]^c[255&F]^t[++C],m=u[y>>>24]^f[g>>>16&255]^h[F>>>8&255]^c[255&d]^t[++C],B=u[g>>>24]^f[F>>>16&255]^h[d>>>8&255]^c[255&y]^t[++C],F=u[F>>>24]^f[d>>>16&255]^h[y>>>8&255]^c[255&g]^t[++C],d=v,y=m,g=B;r[0]=p[d>>>24]<<24^p[y>>>16&255]<<16^p[g>>>8&255]<<8^p[255&F]^t[++C],r[a?3:1]=p[y>>>24]<<24^p[g>>>16&255]<<16^p[F>>>8&255]<<8^p[255&d]^t[++C],r[2]=p[g>>>24]<<24^p[F>>>16&255]<<16^p[d>>>8&255]<<8^p[255&y]^t[++C],r[a?1:3]=p[F>>>24]<<24^p[d>>>16&255]<<16^p[y>>>8&255]<<8^p[255&g]^t[++C]},d=function(t,e,r,n,i){function a(){for(var t=0;t<h;++t)b[t]=B.getInt32();l(R,b,E,n);for(var t=0;t<h;++t)C.putInt32(E[t])}function o(){if(n)for(var t=0;t<h;++t)b[t]=B.getInt32();else for(var t=0;t<h;++t)b[t]=S[t]^B.getInt32();if(l(R,b,E,n),n){for(var t=0;t<h;++t)C.putInt32(S[t]^E[t]);S=b.slice(0)}else{for(var t=0;t<h;++t)C.putInt32(E[t]);S=E}}function s(){l(R,b,E,!1);for(var t=0;t<h;++t)b[t]=B.getInt32();for(var t=0;t<h;++t){var e=b[t]^E[t];n||(b[t]=e),C.putInt32(e)}}function d(){l(R,b,E,!1);for(var t=0;t<h;++t)b[t]=B.getInt32();for(var t=0;t<h;++t)C.putInt32(b[t]^E[t]),b[t]=E[t]}function y(){l(R,b,E,!1);for(var t=h-1;t>=0;--t){if(4294967295!==b[t]){++b[t];break}b[t]=0}for(var t=0;t<h;++t)C.putInt32(B.getInt32()^E[t])}var g=null;if(f||c(),i=(i||"CBC").toUpperCase(),"string"!=typeof t||16!==t.length&&24!==t.length&&32!==t.length){if(u.util.isArray(t)&&(16===t.length||24===t.length||32===t.length))for(var F=t,t=u.util.createBuffer(),v=0;v<F.length;++v)t.putByte(F[v])}else t=u.util.createBuffer(t);if(!u.util.isArray(t)){var F=t;t=[];var m=F.length();if(16===m||24===m||32===m){m>>>=2;for(var v=0;v<m;++v)t.push(F.getInt32())}}if(!u.util.isArray(t)||4!==t.length&&6!==t.length&&8!==t.length)return g;var B,C,b,E,S,A,I,T=["CFB","OFB","CTR"].indexOf(i)!==-1,w="CBC"===i,R=p(t,n&&!T),L=h<<2;if(g={output:null},"CBC"===i)I=o;else if("CFB"===i)I=s;else if("OFB"===i)I=d;else if("CTR"===i)I=y;else{if("ECB"!==i)throw{message:'Unsupported block cipher mode of operation: "'+i+'"'};I=a}return g.update=function(t){for(A||B.putBuffer(t);B.length()>=L||B.length()>0&&A;)I()},g.finish=function(t){var e=!0,r=B.length()%L;if(!n)if(t)e=t(L,B,n);else if(w){var i=B.length()===L?L:L-B.length();B.fillWithByte(i,i)}if(e&&(A=!0,g.update()),n&&(w&&(e=0===r),e))if(t)e=t(L,C,n);else if(w){var a=C.length(),o=C.at(a-1);o>h<<2?e=!1:C.truncate(o)}return!w&&!t&&r>0&&C.truncate(L-r),e},g.start=function(t,e){if(null===t&&(t=S.slice(0)),"undefined"==typeof t&&(t="0000000000000000"),"string"==typeof t&&16===t.length)t=u.util.createBuffer(t);else if(u.util.isArray(t)&&16===t.length)for(var r=t,t=u.util.createBuffer(),n=0;n<16;++n)t.putByte(r[n]);if(!u.util.isArray(t)){var r=t;t=new Array(4),t[0]=r.getInt32(),t[1]=r.getInt32(),t[2]=r.getInt32(),t[3]=r.getInt32()}if(B=u.util.createBuffer(),C=e||u.util.createBuffer(),S=t.slice(0),b=new Array(h),E=new Array(h),A=!1,g.output=C,["CFB","OFB","CTR"].indexOf(i)!==-1){for(var n=0;n<h;++n)b[n]=S[n];S=null}},null!==e&&g.start(e,r),g};u.aes=u.aes||{},u.aes.startEncrypting=function(t,e,r,n){return d(t,e,r,!1,n)},u.aes.createEncryptionCipher=function(t,e){return d(t,null,null,!1,e)},u.aes.startDecrypting=function(t,e,r,n){return d(t,e,r,!0,n)},u.aes.createDecryptionCipher=function(t,e){return d(t,null,null,!0,e)},u.aes._expandKey=function(t,e){return f||c(),p(t,e)},u.aes._updateBlock=l,t.exports=u.aes},function(t,e,r){function n(t){for(var e,r=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],n=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],i=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],a=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],o=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],s=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],u=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],f=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],h=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],c=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],p=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],l=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],d=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],y=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],g=t.length()>8?3:1,F=[],v=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],m=0,B=0;B<g;B++){var C=t.getInt32(),b=t.getInt32();e=252645135&(C>>>4^b),b^=e,C^=e<<4,e=65535&(b>>>-16^C),C^=e,b^=e<<-16,e=858993459&(C>>>2^b),b^=e,C^=e<<2,e=65535&(b>>>-16^C),C^=e,b^=e<<-16,e=1431655765&(C>>>1^b),b^=e,C^=e<<1,e=16711935&(b>>>8^C),C^=e,b^=e<<8,e=1431655765&(C>>>1^b),b^=e,C^=e<<1,e=C<<8|b>>>20&240,C=b<<24|b<<8&16711680|b>>>8&65280|b>>>24&240,b=e;for(var E=0;E<v.length;E++){v[E]?(C=C<<2|C>>>26,b=b<<2|b>>>26):(C=C<<1|C>>>27,b=b<<1|b>>>27),C&=-15,b&=-15;var S=r[C>>>28]|n[C>>>24&15]|i[C>>>20&15]|a[C>>>16&15]|o[C>>>12&15]|s[C>>>8&15]|u[C>>>4&15],A=f[b>>>28]|h[b>>>24&15]|c[b>>>20&15]|p[b>>>16&15]|l[b>>>12&15]|d[b>>>8&15]|y[b>>>4&15];e=65535&(A>>>16^S),F[m++]=S^e,F[m++]=A^e<<16}}return F}var i=r(1),a=r(17),o=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],s=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],u=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],f=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],h=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],c=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],p=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],l=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696],d=function(t,e,r){function d(t,e,r){var n,i,a=t[0],d=t[1];i=3===C?r?[0,32,2]:[30,-2,-2]:r?[0,32,2,62,30,-2,64,96,2]:[94,62,-2,32,64,2,30,-2,-2],n=252645135&(a>>>4^d),d^=n,a^=n<<4,n=65535&(a>>>16^d),d^=n,a^=n<<16,n=858993459&(d>>>2^a),a^=n,d^=n<<2,n=16711935&(d>>>8^a),a^=n,d^=n<<8,n=1431655765&(a>>>1^d),d^=n,a^=n<<1,a=a<<1|a>>>31,d=d<<1|d>>>31;for(var g=0;g<C;g+=3){for(var F=i[g+1],v=i[g+2],m=i[g];m!=F;m+=v){var B=d^y[m],b=(d>>>4|d<<28)^y[m+1];n=a,a=d,d=n^(s[B>>>24&63]|f[B>>>16&63]|c[B>>>8&63]|l[63&B]|o[b>>>24&63]|u[b>>>16&63]|h[b>>>8&63]|p[63&b])}n=a,a=d,d=n}a=a>>>1|a<<31,d=d>>>1|d<<31,n=1431655765&(a>>>1^d),d^=n,a^=n<<1,n=16711935&(d>>>8^a),a^=n,d^=n<<8,n=858993459&(d>>>2^a),a^=n,d^=n<<2,n=65535&(a>>>16^d),d^=n,a^=n<<16,n=252645135&(a>>>4^d),d^=n,a^=n<<4,e[0]=a,e[1]=d}"string"!=typeof t||8!==t.length&&24!==t.length||(t=i.util.createBuffer(t));var y=n(t),r=r?r.toLowerCase():"cbc",g=null,F=[],v=!1,m=null,B=null,C=32===y.length?3:9,b=null;return b={start:function(t,e){if(t?("string"==typeof t&&8===t.length&&(t=i.util.createBuffer(t)),F[0]=t.getInt32(),F[1]=t.getInt32(),g=a.getModeFunction(r,2,F)):g=a.getModeFunction("ecb",2,null),null==g)throw"unsupported mode:"+r;v=!1,m=i.util.createBuffer(),B=e||i.util.createBuffer(),b.output=B},update:function(t){v||m.putBuffer(t),g(d,m,B,!e)},finish:function(t){var n=!0;if(e&&"ofb8"!==r)if(t)n=t(8,m,!e);else{var i=8===m.length()?8:8-m.length();m.fillWithByte(i,i)}if("ofb8"===r&&(n=!1),n&&(v=!0,g(d,m,B,!e)),!e&&(n=0===m.length()))if(t)n=t(8,B,!e);else{var a=B.length(),o=B.at(a-1);o>a?n=!1:B.truncate(o)}return n}}};i.des=i.des||{},i.des.startEncrypting=function(t,e,r,n){var i=d(t,!0,n);return i.start(e,r),i},i.des.createEncryptionCipher=function(t,e){return d(t,!0,e)},i.des.startDecrypting=function(t,e,r,n){var i=d(t,!1,n);return i.start(e,r),i},i.des.createDecryptionCipher=function(t,e){return d(t,!1,e)},t.exports=i.des},function(t,e,r){var n=r(1),i=function(){};i.prototype.cbc=function(t,e){for(var r=[],n=0;n<t;++n)r[n]=e[n];return function(e,n,i,a){for(var o=[],s=[];n.length()>=4*t;){for(var u=0;u<t;++u)o[u]=n.getInt32();if(!a)for(var u=0;u<t;++u)o[u]=r[u]^o[u];if(e(o,s,!a),a){for(var u=0;u<t;++u)i.putInt32(r[u]^s[u]);r=o.slice(0)}else for(var u=0;u<t;++u)i.putInt32(s[u]),r[u]=s[u]}}},i.prototype.ofb=function(t,e,r){var i=e,a=[],o=[];return function(e,s,u,f){for(var h;s.length()>=r/8;){if(i.length>0)for(h=0;h<t;++h)a[h]=i.shift();for(e(a,o,!0),_tempBlock=n.util.createBuffer(),h=0;h<2*t;++h)h<t?_tempBlock.putInt32(a[h]):_tempBlock.putInt32(o[h%t]);for(h=0;h<r/8;++h)_tempBlock.getByte();for(h=0;h<t;++h)a[h]=_tempBlock.getInt32();for(_tempBlock=n.util.createBuffer(),h=0;h<t;++h)_tempBlock.putInt32(o[h]);for(_tempBlock=_tempBlock.getBytes(),h=0;h<r/8;++h)u.putByte(s.getByte()^_tempBlock.charCodeAt(h))}}},i.prototype.getModeFunction=function(t,e,r){if(arguments.length<3)throw"bad input! need more parameter";if(t=t.toLowerCase(),"cbc"===t)return this.cbc(e,r);if(t.indexOf("ofb")!=-1){var n=0;return n=parseInt(t.substr(3)),n=isNaN(n)?8:n,this.ofb(e,r,n)}return null},t.exports=new i},function(t,e,r){function n(t){return o[3][t>>>24&255]^o[2][t>>>16&255]^o[1][t>>>8&255]^o[0][255&t]}function i(t,e){var r=t[0],i=t[1],a=[];return a[0]=i[0]^e[0],a[1]=i[1]^e[1],a[1]^=a[0],a[1]=n(a[1]),a[0]+=a[1],a[0]=n(a[0]),a[1]+=a[0],a[1]=n(a[1]),a[0]+=a[1],r[0]^=a[0],r[1]^=a[1],[i,r]}var a=r(1);a.seed=a.seed||{};var o=[[696885672,92635524,382128852,331600848,340021332,487395612,747413676,621093156,491606364,54739776,403181592,504238620,289493328,1020063996,181060296,591618912,671621160,71581764,536879136,495817116,549511392,583197408,147374280,386339604,629514660,261063564,50529024,994800504,999011256,318968592,314757840,785310444,809529456,210534540,1057960764,680042664,839004720,500027868,919007988,876900468,751624428,361075092,185271048,390550356,474763356,457921368,1032696252,16843008,604250148,470552604,860058480,411603096,268439568,214745292,851636976,432656856,738992172,667411428,843215472,58950528,462132120,297914832,109478532,164217288,541089888,272650320,595829664,734782440,218956044,914797236,512660124,256852812,931640244,441078360,113689284,944271480,646357668,302125584,797942700,365285844,557932896,63161280,881111220,21053760,306336336,1028485500,227377548,134742024,521081628,428446104,0,420024600,67371012,323179344,935850996,566354400,1036907004,910586484,789521196,654779172,813740208,193692552,235799052,730571688,578986656,776888940,327390096,223166796,692674920,1011642492,151585032,168428040,1066382268,802153452,868479984,96846276,126321540,335810580,1053750012,608460900,516870876,772678188,189481800,436867608,101057028,553722144,726360936,642146916,33686016,902164980,310547088,176849544,202113036,864269232,1045328508,281071824,977957496,122110788,377918100,633725412,637936164,8421504,764256684,533713884,562143648,805318704,923218740,781099692,906375732,352653588,570565152,940060728,885321972,663200676,88424772,206323788,25264512,701096424,75792516,394761108,889532724,197903304,248431308,1007431740,826372464,285282576,130532292,160006536,893743476,1003222008,449499864,952692984,344232084,424235352,42107520,80003268,1070593020,155795784,956903736,658989924,12632256,265274316,398971860,948482232,252642060,244220556,37896768,587408160,293704080,743202924,466342872,612671652,872689716,834793968,138952776,46318272,793731948,1024274748,755835180,4210752,1049539260,1041117756,1015853244,29475264,713728680,982168248,240009804,356864340,990589752,483184860,675831912,1062171516,478974108,415813848,172638792,373707348,927429492,545300640,768467436,105267780,897954228,722150184,625303908,986379e3,600040416,965325240,830583216,529503132,508449372,969535992,650568420,847426224,822161712,717939432,760045932,525292380,616882404,817950960,231588300,143163528,369496596,973746744,407392344,348442836,574775904,688464168,117900036,855847728,684253416,453710616,84214020,961114488,276861072,709517928,705307176,445289112],[943196208,3894986976,741149985,2753988258,3423588291,3693006546,2956166067,3090712752,2888798115,1612726368,1410680145,3288844227,1141130304,1815039843,1747667811,1478183763,3221472195,1612857954,808649523,3023406513,673777953,2686484640,3760374498,2754054051,3490956243,2417066385,269549841,67503618,471600144,3158084784,875955762,1208699715,3962556387,2282260608,1814842464,2821228704,337053459,3288646848,336987666,4097098992,3221406402,1141196097,3760308705,3558262482,1010765619,1010634033,2349764226,2551744656,673712160,1276005954,4097230578,1010699826,2753922465,4164536817,202181889,3693072339,3625502928,673909539,1680229986,2017086066,606537507,741281571,4029792753,1882342002,1073889858,3558130896,1073824065,3221274816,1882407795,1680295779,2888600736,2282457987,4097296371,2888666529,2147516544,471797523,3356150466,741084192,2821360290,875824176,3490890450,134941443,3962490594,3895052769,1545424209,2484372624,404228112,4164471024,1410811731,2888732322,134744064,3288712641,269681427,3423456705,2215020162,3090778545,4232040435,2084392305,3221340609,808517937,4097164785,2282392194,1747602018,2956034481,3490824657,538968096,3558328275,131586,539099682,67372032,1747470432,1882276209,67569411,3625700307,2619182481,2551810449,1612792161,3158216370,3827746530,1478052177,3692940753,1343308113,2417000592,3692874960,2551876242,2686682019,2821426083,3490758864,2147582337,202313475,1141327683,404359698,3760440291,3962359008,2349698433,3158282163,2484504210,2017151859,1545358416,2686616226,2686550433,1612923747,539165475,1275940161,3356018880,2619248274,2619116688,943327794,202116096,741215778,3090844338,1814974050,2619314067,1478117970,4029858546,2417132178,4029924339,1208568129,2016954480,3423390912,336921873,4164668403,1882210416,1949648241,2084523891,875889969,269484048,197379,1680098400,1814908257,3288778434,1949582448,3558196689,3023340720,3895118562,134809857,1949714034,404293905,4231974642,1073758272,269615634,3760242912,3158150577,67437825,4164602610,65793,4029726960,673843746,1545490002,2821294497,1410745938,1073955651,2214954369,336856080,2282326401,2551942035,2955968688,3827680737,1208502336,2017020273,2484570003,4231843056,471731730,2147648130,539033889,2349632640,404425491,1545555795,1949779827,1410614352,2956100274,471665937,606405921,1276071747,0,1141261890,3962424801,1477986384,1343373906,3895184355,2084458098,3625634514,3356084673,4231908849,808452144,2484438417,1680164193,1010568240,3023472306,3827614944,3090910131,2084326512,202247682,1343242320,943262001,606471714,808583730,2214888576,1747536225,2417197971,876021555,3827812323,606340128,2753856672,3356216259,1343439699,134875650,2215085955,3625568721,1275874368,2147713923,2349830019,3423522498,943393587,1208633922,3023538099],[2712152457,2172913029,3537114822,3553629123,1347687492,287055117,2695638156,556016901,1364991309,1128268611,270014472,303832590,1364201793,4043062476,3267889866,1667244867,539502600,1078199364,538976256,2442927501,3772784832,3806339778,3234334920,320083719,2711889285,2206994319,50332419,1937259339,3015195531,319820547,3536851650,3807129294,1886400576,2156661900,859586319,2695374984,842019330,3520863693,4076091078,1886663748,3773574348,2442401157,50858763,1398019911,1348213836,1398283083,2981903757,16777473,539239428,270277644,1936732995,2425886856,269488128,3234598092,4075827906,3520600521,539765772,3823380423,1919955522,2206204803,2476219275,3520074177,2189690502,3251112393,1616912448,1347424320,2745181059,3823643595,17566989,2998154886,2459704974,1129058127,3014932359,1381505610,3267626694,1886926920,2728666758,303043074,2745970575,3520337349,1633689921,3284140995,2964599940,1094713665,1380979266,1903967565,2173439373,526344,320610063,2442664329,0,286791945,263172,1397756739,4092868551,3789562305,4059839949,1920218694,590098191,589571847,2964336768,2206731147,34344462,2745707403,2728403586,1651256910,2475692931,1095503181,1634216265,1887190092,17303817,34081290,3015458703,3823906767,4092605379,3250849221,2206467975,269751300,4076617422,1617175620,3537641166,573320718,1128794955,303569418,33818118,555753729,1667771211,1650730566,33554946,4059313605,2458915458,2189953674,789516,3014669187,1920745038,3503296704,1920481866,1128531783,2459178630,3789825477,572794374,2155872384,2712415629,3554418639,2711626113,808464384,859059975,2729193102,842282502,286528773,572531202,808990728,4042536132,2745444231,1094976837,1078725708,2172649857,3790088649,2156135556,2475956103,825505029,3284667339,3268153038,809253900,1903178049,286265601,3284404167,2173176201,1903441221,4093131723,3537377994,4042799304,2425623684,1364728137,2189427330,3234071748,4093394895,1095240009,825768201,1667508039,3233808576,3284930511,3553892295,2964863112,51121935,2190216846,1111491138,589308675,2442137985,1617701964,3554155467,2695111812,808727556,4059050433,1078462536,3267363522,1668034383,826031373,556543245,1077936192,2998681230,842808846,2965126284,3250586049,2728929930,2998418058,1112280654,1364464965,859323147,3504086220,1617438792,1937522511,2426150028,3503823048,1112017482,1381242438,1936996167,2694848640,3790351821,1111754310,2981377413,589835019,1633953093,4076354250,3823117251,2981640585,2981114241,2476482447,1381768782,4059576777,3806602950,2997891714,825241857,3806866122,1634479437,1398546255,3773048004,4042272960,3251375565,2156398728,303306246,842545674,1347950664,3503559876,1650467394,556280073,50595591,858796803,3773311176,320346891,17040645,1903704393,2425360512,1650993738,573057546,2459441802],[137377848,3370182696,220277805,2258805798,3485715471,3469925406,2209591347,2293282872,2409868335,1080057888,1162957845,3351495687,1145062404,1331915823,1264805931,1263753243,3284385795,1113743394,53686323,2243015733,153167913,2158010400,3269648418,2275648551,3285438483,2173800465,17895441,100795398,202382364,2360392764,103953462,1262700555,3487820847,2290124808,1281387564,2292230184,118690839,3300967428,101848086,3304125492,3267543042,1161905157,3252805665,3335705622,255015999,221330493,2390920206,2291177496,136325160,1312967694,3337810998,238173246,2241963045,3388078137,218172429,3486768159,3369130008,186853419,1180853286,1249015866,119743527,253963311,3253858353,1114796082,1111638018,3302020116,1094795265,3233857536,1131638835,1197696039,2359340076,2340653067,3354653751,2376182829,2155905024,252910623,3401762826,203435052,2325915690,70267956,3268595730,184748043,3470978094,3387025449,1297177629,2224067604,135272472,3371235384,1196643351,2393025582,134219784,3317810181,51580947,3452029965,2256700422,2310125625,3488873535,1299283005,3250700289,20000817,3320968245,2323810314,1247963178,2175905841,3251752977,2105376,3352548375,33685506,35790882,67109892,1214277672,1097953329,117638151,3419658267,2375130141,2308020249,1096900641,2394078270,3336758310,1230067737,3453082653,1095847953,2156957712,3436239900,2324863002,2208538659,2342758443,3234910224,2172747777,251857935,1195590663,168957978,3286491171,3437292588,2374077453,2410921023,2257753110,1265858619,1280334876,2191695906,2174853153,1130586147,52633635,1296124941,3368077320,2391972894,2358287388,171063354,201329676,237120558,2326968378,1315073070,2408815647,1246910490,3270701106,2190643218,3287543859,1229015049,1215330360,3435187212,85005333,3421763643,1081110576,1165063221,1332968511,87110709,1052688,50528259,1147167780,1298230317,3334652934,1148220468,3318862869,2226172980,3403868202,151062537,1181905974,152115225,3472030782,1077952512,34738194,3235962912,2377235517,83952645,3404920890,16842753,3237015600,170010666,1314020382,2309072937,1179800598,1128480771,2239857669,68162580,2306967561,2341705755,2159063088,3319915557,1212172296,1232173113,2274595863,3438345276,236067870,2189590530,18948129,2357234700,185800731,1330863135,1198748727,1146115092,2192748594,219225117,86058021,1329810447,0,1178747910,3454135341,1213224984,1112690706,3420710955,1316125758,3402815514,3384920073,3455188029,3158064,2240910357,1164010533,204487740,2259858486,3303072804,2343811131,1282440252,235015182,1079005200,154220601,102900774,36843570,2223014916,1231120425,2207485971,120796215,3353601063,69215268,2225120292,3418605579,1129533459,167905290,2273543175,3385972761,1279282188,2206433283,2407762959,3468872718,187906107,1245857802,2276701239]],s=[2654435769,1013904243,2027808486,4055616972,3816266649,3337566003,2380164711,465362127,930724254,1861448508,3722897016,3150826737,2006686179,4013372358,3731777421,3168587547],u=function(t,e,r){
for(var n=0,a=t.slice(n,n+2),o=t.slice(n+2,n+4),s=[a,o],u=0;u<16;u++)s=i(s,e[u]);s.reverse(),r.splice(n,4,s[0][0],s[0][1],s[1][0],s[1][1])},f=function(t,e,r,n){u(e,t,r)},h=function(t,e,r,i,o){function u(){var t;if(t=m._roundKeys,i){t=m._invRoundKeys;for(var e=0;e<4;++e)l[e]=c.getInt32()}else for(var e=0;e<4;++e)l[e]=F[e]^c.getInt32();if(f(t,l,d,i),i){for(var e=0;e<4;++e)p.putInt32(F[e]^d[e]);F=l.slice(0)}else{for(var e=0;e<4;++e)p.putInt32(d[e]);F=d}}var h,c,p,l,d,y,g,F,v="CBC"===o,m=null,B=16;if("string"!=typeof t||16!=t.length)throw"bad key";return m={_key:t,output:null},g=u,m.update=function(t){for(y||c.putBuffer(t);c.length()>=B||c.length()>0&&y;)g()},m.finish=function(t){var e=!0,r=c.length()%B;if(!i)if(t)e=t(B,c,i);else if(v){var n=c.length()===B?B:B-c.length();c.fillWithByte(n,n)}if(e&&(y=!0,m.update()),i&&(v&&(e=0===r),e))if(t)e=t(B,p,i);else if(v){var a=p.length(),o=p.at(a-1);o>16?e=!1:p.truncate(o)}return!v&&!t&&r>0&&p.truncate(B-r),e},m.start=function(t,e){if(h=t,"string"==typeof t&&16===t.length)t=a.util.createBuffer(t);else if(a.util.isArray(t)&&16===t.length){var r=t;t=a.util.createBuffer();for(var i=0;i<16;++i)t.putByte(r[i])}if(c=a.util.createBuffer(),p=e||a.util.createBuffer(),F=[],F.splice(0,4,t.getInt32(),t.getInt32(),t.getInt32(),t.getInt32()),l=new Array(4),d=new Array(4),y=!1,m.output=p,["CFB","OFB","CTR"].indexOf(o)!==-1){for(i=0;i<4;++i)l[i]=F[i];F=null}var u=a.util.createBuffer(this._key),f=u.getInt32(),g=u.getInt32(),v=u.getInt32(),B=u.getInt32(),C=[];for(i=0;i<16;i++)if(C[i]=[],C[i][0]=n(f+v-s[i]),C[i][1]=n(g-B+s[i]),i%2==0){var b=f;f=f>>>8|g<<24,g=g>>>8|b<<24}else{var E=v;v=v<<8|B>>>24,B=B<<8|E>>>24}this._roundKeys=C,this._invRoundKeys=C.slice().reverse()},null!==e&&m.start(e,r),m};a.seed.createEncryptionCipher=function(t,e){return h(t,null,null,!1,e)},a.seed.createDecryptionCipher=function(t,e){return h(t,null,null,!0,e)},t.exports=a.seed},function(t,e,r){function n(t,e){for(var r=[],n=0;n<t.length;++n)r[n]=t[n]^e[n];return r=a(1,r),r=o(r)}function i(t,e){for(var r=[],n=0;n<t.length;++n)r[n]=t[n]^e[n];return r=a(2,r),r=o(r)}function a(t,e){var r=[];X=u.util.createBuffer();for(var n=0;n<e.length;++n)X.putInt32(e[n]);if(1==t)r[0]=l[X.getByte()],r[0]<<=8,r[0]|=d[X.getByte()],r[0]<<=8,r[0]|=y[X.getByte()],r[0]<<=8,r[0]|=g[X.getByte()],r[1]=l[X.getByte()],r[1]<<=8,r[1]|=d[X.getByte()],r[1]<<=8,r[1]|=y[X.getByte()],r[1]<<=8,r[1]|=g[X.getByte()],r[2]=l[X.getByte()],r[2]<<=8,r[2]|=d[X.getByte()],r[2]<<=8,r[2]|=y[X.getByte()],r[2]<<=8,r[2]|=g[X.getByte()],r[3]=l[X.getByte()],r[3]<<=8,r[3]|=d[X.getByte()],r[3]<<=8,r[3]|=y[X.getByte()],r[3]<<=8,r[3]|=g[X.getByte()];else{if(2!=t)throw"internal error";r[0]=y[X.getByte()],r[0]<<=8,r[0]|=g[X.getByte()],r[0]<<=8,r[0]|=l[X.getByte()],r[0]<<=8,r[0]|=d[X.getByte()],r[1]=y[X.getByte()],r[1]<<=8,r[1]|=g[X.getByte()],r[1]<<=8,r[1]|=l[X.getByte()],r[1]<<=8,r[1]|=d[X.getByte()],r[2]=y[X.getByte()],r[2]<<=8,r[2]|=g[X.getByte()],r[2]<<=8,r[2]|=l[X.getByte()],r[2]<<=8,r[2]|=d[X.getByte()],r[3]=y[X.getByte()],r[3]<<=8,r[3]|=g[X.getByte()],r[3]<<=8,r[3]|=l[X.getByte()],r[3]<<=8,r[3]|=d[X.getByte()]}return r}function o(t){var e=[];if(t.length<16){var r=u.util.createBuffer();for(t.map(function(t){r.putInt32(t)}),t=[];r.length()>0;)t.push(r.getByte())}return e[0]=t[3]^t[4]^t[6]^t[8]^t[9]^t[13]^t[14],e[0]<<=8,e[0]|=t[2]^t[5]^t[7]^t[8]^t[9]^t[12]^t[15],e[0]<<=8,e[0]|=t[1]^t[4]^t[6]^t[10]^t[11]^t[12]^t[15],e[0]<<=8,e[0]|=t[0]^t[5]^t[7]^t[10]^t[11]^t[13]^t[14],e[1]=t[0]^t[2]^t[5]^t[8]^t[11]^t[14]^t[15],e[1]<<=8,e[1]|=t[1]^t[3]^t[4]^t[9]^t[10]^t[14]^t[15],e[1]<<=8,e[1]|=t[0]^t[2]^t[7]^t[9]^t[10]^t[12]^t[13],e[1]<<=8,e[1]|=t[1]^t[3]^t[6]^t[8]^t[11]^t[12]^t[13],e[2]=t[0]^t[1]^t[4]^t[7]^t[10]^t[13]^t[15],e[2]<<=8,e[2]|=t[0]^t[1]^t[5]^t[6]^t[11]^t[12]^t[14],e[2]<<=8,e[2]|=t[2]^t[3]^t[5]^t[6]^t[8]^t[13]^t[15],e[2]<<=8,e[2]|=t[2]^t[3]^t[4]^t[7]^t[9]^t[12]^t[14],e[3]=t[1]^t[2]^t[6]^t[7]^t[9]^t[11]^t[12],e[3]<<=8,e[3]|=t[0]^t[3]^t[6]^t[7]^t[8]^t[10]^t[13],e[3]<<=8,e[3]|=t[0]^t[3]^t[4]^t[5]^t[9]^t[11]^t[14],e[3]<<=8,e[3]|=t[1]^t[2]^t[4]^t[5]^t[8]^t[10]^t[15],e}function s(t,e,r){var n=[],i=4-parseInt(r/32),a=r%32,o=32-a;return n[0]=e[i%4]>>>a^e[(i+3)%4]<<o^t[0],n[1]=e[(i+1)%4]>>>a^e[i%4]<<o^t[1],n[2]=e[(i+2)%4]>>>a^e[(i+1)%4]<<o^t[2],n[3]=e[(i+3)%4]>>>a^e[(i+2)%4]<<o^t[3],n}var u=r(1);u.aria=u.aria||{};var f=4,h=[1367130551,656542356,4262702056,4204424928],c=[1840335564,2653014048,4280857045,4015907504],p=[3683792669,556198256,52729717,82364686],l=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22],d=[226,78,84,252,148,194,74,204,98,13,106,70,60,77,139,209,94,250,100,203,180,151,190,43,188,119,46,3,211,25,89,193,29,6,65,107,85,240,153,105,234,156,24,174,99,223,231,187,0,115,102,251,150,76,133,228,58,9,69,170,15,238,16,235,45,127,244,41,172,207,173,145,141,120,200,149,249,47,206,205,8,122,136,56,92,131,42,40,71,219,184,199,147,164,18,83,255,135,14,49,54,33,88,72,1,142,55,116,50,202,233,177,183,171,12,215,196,86,66,38,7,152,96,217,182,185,17,64,236,32,140,189,160,201,132,4,73,35,241,79,80,31,19,220,216,192,158,87,227,195,123,101,59,2,143,62,232,37,146,229,21,221,253,23,169,191,212,154,126,197,57,103,254,118,157,67,167,225,208,245,104,242,27,52,112,5,163,138,213,121,134,168,48,198,81,75,30,166,39,246,53,210,110,36,22,130,95,218,230,117,162,239,44,178,28,159,93,111,128,10,114,68,155,108,144,11,91,51,125,90,82,243,97,161,247,176,214,63,124,109,237,20,224,165,61,34,179,248,137,222,113,26,175,186,181,129],y=[82,9,106,213,48,54,165,56,191,64,163,158,129,243,215,251,124,227,57,130,155,47,255,135,52,142,67,68,196,222,233,203,84,123,148,50,166,194,35,61,238,76,149,11,66,250,195,78,8,46,161,102,40,217,36,178,118,91,162,73,109,139,209,37,114,248,246,100,134,104,152,22,212,164,92,204,93,101,182,146,108,112,72,80,253,237,185,218,94,21,70,87,167,141,157,132,144,216,171,0,140,188,211,10,247,228,88,5,184,179,69,6,208,44,30,143,202,63,15,2,193,175,189,3,1,19,138,107,58,145,17,65,79,103,220,234,151,242,207,206,240,180,230,115,150,172,116,34,231,173,53,133,226,249,55,232,28,117,223,110,71,241,26,113,29,41,197,137,111,183,98,14,170,24,190,27,252,86,62,75,198,210,121,32,154,219,192,254,120,205,90,244,31,221,168,51,136,7,199,49,177,18,16,89,39,128,236,95,96,81,127,169,25,181,74,13,45,229,122,159,147,201,156,239,160,224,59,77,174,42,245,176,200,235,187,60,131,83,153,97,23,43,4,126,186,119,214,38,225,105,20,99,85,33,12,125],g=[48,104,153,27,135,185,33,120,80,57,219,225,114,9,98,60,62,126,94,142,241,160,204,163,42,29,251,182,214,32,196,141,129,101,245,137,203,157,119,198,87,67,86,23,212,64,26,77,192,99,108,227,183,200,100,106,83,170,56,152,12,244,155,237,127,34,118,175,221,58,11,88,103,136,6,195,53,13,1,139,140,194,230,95,2,36,117,147,102,30,229,226,84,216,16,206,122,232,8,44,18,151,50,171,180,39,10,35,223,239,202,217,184,250,220,49,107,209,173,25,73,189,81,150,238,228,168,65,218,255,205,85,134,54,190,97,82,248,187,14,130,72,105,154,224,71,158,92,4,75,52,21,121,38,167,222,41,174,146,215,132,233,210,186,93,243,197,176,191,164,59,113,68,70,43,252,235,111,213,246,20,254,124,112,90,125,253,47,24,131,22,165,145,31,5,149,116,169,193,91,74,133,109,19,7,79,78,69,178,15,201,28,166,188,236,115,144,123,207,89,143,161,249,45,242,177,0,148,55,159,208,46,156,110,40,63,128,240,61,211,37,138,181,231,66,179,199,234,247,76,17,51,3,162,172,96],F=function(t,e,r,o){var s=[],u=[];s[0]=t;for(var f=1;f<o;++f)f%2==1?s[f]=n(s[f-1],e[f]):s[f]=i(s[f-1],e[f]);for(var f=0;f<s[o-1].length;++f)u[f]=s[o-1][f]^e[o][f];u=a(2,u);for(var f=0;f<u.length;++f)r[f]=u[f]^e[o+1][f]},v=function(t,e,r,a,l){function d(){var t,e,r,f,h,c,p,l=[0,0,0,0];for(t=I._key.slice(0,4),e=I._key.slice(4),e=e.concat(l).slice(0,4),r=t,f=n(r,R),p=0;p<f.length;++p)f[p]=f[p]^e[p];for(h=i(f,L),p=0;p<f.length;++p)h[p]=h[p]^r[p];for(c=n(h,N),p=0;p<f.length;++p)c[p]=c[p]^f[p];var d;d=u.util.createBuffer(),r.map(function(t){d.putInt32(t)}),u.consoleLog,d=u.util.createBuffer(),f.map(function(t){d.putInt32(t)}),u.consoleLog,d=u.util.createBuffer(),h.map(function(t){d.putInt32(t)}),u.consoleLog,d=u.util.createBuffer(),c.map(function(t){d.putInt32(t)}),u.consoleLog,I.W0=r,I.W1=f,I.W2=h,I.W3=c;var y=[];for(y[1]=s(r,f,19),y[2]=s(f,h,19),y[3]=s(h,c,19),y[4]=s(c,r,19),y[5]=s(r,f,31),y[6]=s(f,h,31),y[7]=s(h,c,31),y[8]=s(c,r,31),y[9]=s(r,f,67),y[10]=s(f,h,67),y[11]=s(h,c,67),y[12]=s(c,r,67),y[13]=s(r,f,97),y[14]=s(f,h,97),y[15]=s(h,c,97),y[16]=s(c,r,97),y[17]=s(r,f,109),p=1;p<y.length;++p){var d=u.util.createBuffer();y[p].map(function(t){d.putInt32(t)}),u.consoleLog}if(I._roundKeys=y,a){var g=[];for(p=1;p<w+2;++p)g[p]=y[w+2-p],1!=p&&p!=w+1&&(g[p]=o(g[p]));for(p=1;p<g.length;++p){var d=u.util.createBuffer();g[p].map(function(t){d.putInt32(t)}),u.consoleLog}I._roundKeys=g}}function y(){var t;t=I._roundKeys;for(var e=0;e<f;++e)B[e]=v.getInt32();P(t,B,C,a);for(var e=0;e<f;++e)m.putInt32(C[e])}function g(){var t;if(t=I._roundKeys,a)for(var e=0;e<4;++e)B[e]=v.getInt32();else for(var e=0;e<4;++e)B[e]=S[e]^v.getInt32();if(P(t,B,C,a),a){for(var e=0;e<4;++e)m.putInt32(S[e]^C[e]);S=B.slice(0)}else{for(var e=0;e<4;++e)m.putInt32(C[e]);S=C}}l=(l||"CBC").toUpperCase();var v,m,B,C,b,E,S,A="CBC"===l,I=null,T=16,w=0;I={_key:t,output:null};var R,L,N;if(16==t.length)w=12,R=h,L=c,N=p;else if(24==t.length)w=14,R=c,L=p,N=h;else{if(32!=t.length)throw"bad key length";w=16,R=p,L=h,N=c}if("CBC"===l)E=g;else if("CFB"===l)E=cfbOp;else if("OFB"===l)E=ofbOp;else if("CTR"===l)E=ctrOp;else{if("ECB"!==l)throw{message:'Unsupported block cipher mode of operation: "'+l+'"'};E=y}for(I._key=[],t=u.util.createBuffer(t);t.length()>0;)I._key.push(t.getInt32());d();var P=function(t,e,r,n){F(e,t,r,w)};return I.update=function(t){for(b||v.putBuffer(t);v.length()>=T||v.length()>0&&b;)E()},I.finish=function(t){var e=!0,r=v.length()%T;if(!a)if(t)e=t(T,v,a);else if(A){var n=v.length()===T?T:T-v.length();v.fillWithByte(n,n)}if(e&&(b=!0,I.update()),a&&(A&&(e=0===r),e))if(t)e=t(T,m,a);else if(A){var i=m.length(),o=m.at(i-1);o>16?e=!1:m.truncate(o)}return!A&&!t&&r>0&&m.truncate(T-r),e},I.start=function(t,e){if("undefined"==typeof t&&(t="0000000000000000"),null===t&&(t=S.slice(0)),"string"==typeof t&&16===t.length)t=u.util.createBuffer(t);else if(u.util.isArray(t)&&16===t.length)for(var r=t,t=u.util.createBuffer(),n=0;n<16;++n)t.putByte(r[n]);if(!u.util.isArray(t)){var r=t;t=new Array(4),t[0]=r.getInt32(),t[1]=r.getInt32(),t[2]=r.getInt32(),t[3]=r.getInt32()}if(v=u.util.createBuffer(),m=e||u.util.createBuffer(),S=t.slice(0),B=new Array(f),C=new Array(f),b=!1,I.output=m,["CFB","OFB","CTR"].indexOf(l)!==-1){for(var n=0;n<f;++n)B[n]=S[n];S=null}},null!==e&&I.start(e,r),I};u.aria.createEncryptionCipher=function(t,e){return v(t,null,null,!1,e)},u.aria.createDecryptionCipher=function(t,e){return v(t,null,null,!0,e)},t.exports=u.aria},function(t,e,r){var n=r(1),i=n.asn1=n.asn1||{};i.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192},i.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30},i.create=function(t,e,r,i){if(n.util.isArray(i)){for(var a=[],o=0;o<i.length;++o)void 0!==i[o]&&a.push(i[o]);i=a}return{tagClass:t,type:e,constructed:r,composed:r||n.util.isArray(i),value:i}};var a=function(t){var e=t.getByte();if(128!==e){var r,n=128&e;return r=n?t.getInt((127&e)<<3):e}};i.fromDer=function(t,e){if(void 0===e&&(e=!0),"string"==typeof t&&(t=n.util.createBuffer(t)),t.length()<2)throw{message:"Too few bytes to parse DER.",bytes:t.length()};var r=t.getByte(),o=192&r,s=31&r,u=a(t);if(t.length()<u){if(e)throw{message:"Too few bytes to read ASN.1 value.",detail:t.length()+" < "+u};u=t.length()}var f,h=32===(32&r),c=h;if(!c&&o===i.Class.UNIVERSAL&&s===i.Type.BITSTRING&&u>1){var p=t.read,l=t.getByte(),d=!1;if(0===l&&d){r=t.getByte();var y=192&r;if(y===i.Class.UNIVERSAL||y===i.Class.CONTEXT_SPECIFIC)try{var g=a(t);c=g===u-(t.read-p),c&&(++p,--u)}catch(t){}}t.read=p}if(c)if(f=[],void 0===u)for(;;){if(t.bytes(2)===String.fromCharCode(0,0)){t.getBytes(2);break}f.push(i.fromDer(t,e))}else for(var F=t.length();u>0;)f.push(i.fromDer(t,e)),u-=F-t.length(),F=t.length();else{if(void 0===u){if(e)throw{message:"Non-constructed ASN.1 object of indefinite length."};u=t.length()}if(s===i.Type.BMPSTRING){f="";for(var v=0;v<u;v+=2)f+=String.fromCharCode(t.getInt16())}else f=t.getBytes(u)}return i.create(o,s,h,f)},i.toDer=function(t){var e=n.util.createBuffer(),r=t.tagClass|t.type,a=n.util.createBuffer();if(t.composed){t.constructed?r|=32:a.putByte(0);for(var o=0;o<t.value.length;++o)void 0!==t.value[o]&&a.putBuffer(i.toDer(t.value[o]))}else if(t.type===i.Type.BMPSTRING)for(var o=0;o<t.value.length;++o)a.putInt16(t.value.charCodeAt(o));else a.putBytes(t.value);if(e.putByte(r),a.length()<=127)e.putByte(127&a.length());else{var s=a.length(),u="";do u+=String.fromCharCode(255&s),s>>>=8;while(s>0);e.putByte(128|u.length);for(var o=u.length-1;o>=0;--o)e.putByte(u.charCodeAt(o))}return e.putBuffer(a),e},i.oidToDer=function(t){var e=t.split("."),r=n.util.createBuffer();r.putByte(40*parseInt(e[0],10)+parseInt(e[1],10));for(var i,a,o,s,u=2;u<e.length;++u){i=!0,a=[],o=parseInt(e[u],10);do s=127&o,o>>>=7,i||(s|=128),a.push(s),i=!1;while(o>0);for(var f=a.length-1;f>=0;--f)r.putByte(a[f])}return r},i.derToOid=function(t){var e;"string"==typeof t&&(t=n.util.createBuffer(t));var r=t.getByte();e=Math.floor(r/40)+"."+r%40;for(var i=0;t.length()>0;)r=t.getByte(),i<<=7,128&r?i+=127&r:(e+="."+(i+r),i=0);return e},i.utcTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(t.substr(2,2),10)-1,i=parseInt(t.substr(4,2),10),a=parseInt(t.substr(6,2),10),o=parseInt(t.substr(8,2),10),s=0;if(t.length>11){var u=t.charAt(10),f=10;"+"!==u&&"-"!==u&&(s=parseInt(t.substr(10,2),10),f+=2)}if(e.setUTCFullYear(r,n,i),e.setUTCHours(a,o,s,0),f&&(u=t.charAt(f),"+"===u||"-"===u)){var h=parseInt(t.substr(f+1,2),10),c=parseInt(t.substr(f+4,2),10),p=60*h+c;p*=6e4,"+"===u?e.setTime(+e-p):e.setTime(+e+p)}return e},i.generalizedTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,4),10),n=parseInt(t.substr(4,2),10)-1,i=parseInt(t.substr(6,2),10),a=parseInt(t.substr(8,2),10),o=parseInt(t.substr(10,2),10),s=parseInt(t.substr(12,2),10),u=0,f=0,h=!1;"Z"===t.charAt(t.length-1)&&(h=!0);var c=t.length-5,p=t.charAt(c);if("+"===p||"-"===p){var l=parseInt(t.substr(c+1,2),10),d=parseInt(t.substr(c+4,2),10);f=60*l+d,f*=6e4,"+"===p&&(f*=-1),h=!0}return"."===t.charAt(14)&&(u=1e3*parseFloat(t.substr(14),10)),h?(e.setUTCFullYear(r,n,i),e.setUTCHours(a,o,s,u),e.setTime(+e+f)):(e.setFullYear(r,n,i),e.setHours(a,o,s,u)),e},i.dateToUtcTime=function(t){var e="",r=[];r.push((""+t.getUTCFullYear()).substr(2)),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z"},i.integerToDer=function(t){var e=n.util.createBuffer();if(t>=-128&&t<128)return e.putSignedInt(t,8);if(t>=-32768&&t<32768)return e.putSignedInt(t,16);if(t>=-8388608&&t<8388608)return e.putSignedInt(t,24);if(t>=-2147483648&&t<2147483648)return e.putSignedInt(t,32);throw{message:"Integer too large; max is 32-bits.",integer:t}},i.derToInteger=function(t){"string"==typeof t&&(t=n.util.createBuffer(t));var e=8*t.length();if(e>32)throw{message:"Integer too large; max is 32-bits."};return t.getSignedInt(e)},i.validate=function(t,e,r,a){var o=!1;if(t.tagClass!==e.tagClass&&"undefined"!=typeof e.tagClass||t.type!==e.type&&"undefined"!=typeof e.type)a&&(t.tagClass!==e.tagClass&&a.push("["+e.name+'] Expected tag class "'+e.tagClass+'", got "'+t.tagClass+'"'),t.type!==e.type&&a.push("["+e.name+'] Expected type "'+e.type+'", got "'+t.type+'"'));else if(t.constructed===e.constructed||"undefined"==typeof e.constructed){if(o=!0,e.value&&n.util.isArray(e.value))for(var s=0,u=0;o&&u<e.value.length;++u)o=e.value[u].optional||!1,t.value[s]&&(o=i.validate(t.value[s],e.value[u],r,a),o?++s:e.value[u].optional&&(o=!0)),!o&&a&&a.push("["+e.name+'] Tag class "'+e.tagClass+'", type "'+e.type+'" expected value length "'+e.value.length+'", got "'+t.value.length+'"');o&&r&&(e.capture&&(r[e.capture]=t.value),e.captureAsn1&&(r[e.captureAsn1]=t))}else a&&a.push("["+e.name+'] Expected constructed "'+e.constructed+'", got "'+t.constructed+'"');return o};var o=/[^\\u0000-\\u00ff]/;i.prettyPrint=function(t,e,r){var a="";e=e||0,r=r||2,e>0&&(a+="\n");for(var s="",u=0;u<e*r;++u)s+=" ";switch(a+=s+"Tag: ",t.tagClass){case i.Class.UNIVERSAL:a+="Universal:";break;case i.Class.APPLICATION:a+="Application:";break;case i.Class.CONTEXT_SPECIFIC:a+="Context-Specific:";break;case i.Class.PRIVATE:a+="Private:"}if(t.tagClass===i.Class.UNIVERSAL)switch(a+=t.type,t.type){case i.Type.NONE:a+=" (None)";break;case i.Type.BOOLEAN:a+=" (Boolean)";break;case i.Type.BITSTRING:a+=" (Bit string)";break;case i.Type.INTEGER:a+=" (Integer)";break;case i.Type.OCTETSTRING:a+=" (Octet string)";break;case i.Type.NULL:a+=" (Null)";break;case i.Type.OID:a+=" (Object Identifier)";break;case i.Type.ODESC:a+=" (Object Descriptor)";break;case i.Type.EXTERNAL:a+=" (External or Instance of)";break;case i.Type.REAL:a+=" (Real)";break;case i.Type.ENUMERATED:a+=" (Enumerated)";break;case i.Type.EMBEDDED:a+=" (Embedded PDV)";break;case i.Type.UTF8:a+=" (UTF8)";break;case i.Type.ROID:a+=" (Relative Object Identifier)";break;case i.Type.SEQUENCE:a+=" (Sequence)";break;case i.Type.SET:a+=" (Set)";break;case i.Type.PRINTABLESTRING:a+=" (Printable String)";break;case i.Type.IA5String:a+=" (IA5String (ASCII))";break;case i.Type.UTCTIME:a+=" (UTC time)";break;case i.Type.GENERALIZEDTIME:a+=" (Generalized time)";break;case i.Type.BMPSTRING:a+=" (BMP String)"}else a+=t.type;if(a+="\n",a+=s+"Constructed: "+t.constructed+"\n",t.composed){for(var f=0,h="",u=0;u<t.value.length;++u)void 0!==t.value[u]&&(f+=1,h+=i.prettyPrint(t.value[u],e+1,r),u+1<t.value.length&&(h+=","));a+=s+"Sub values: "+f+h}else{if(a+=s+"Value: ",t.type===i.Type.OID){var c=i.derToOid(t.value);a+=c,n.pki&&n.pki.oids&&c in n.pki.oids&&(a+=" ("+n.pki.oids[c]+")")}if(t.type===i.Type.INTEGER)try{a+=i.derToInteger(t.value)}catch(e){a+="0x"+n.util.bytesToHex(t.value)}else a+=o.test(t.value)?"0x"+n.util.createBuffer(t.value,"utf8").toHex():0===t.value.length?"[null]":t.value}return a},i.generateBitString=function(t,e){function r(t){return(128&t)>>7|(64&t)>>5|(32&t)>>3|(16&t)>>1|(8&t)<<1|(4&t)<<3|(2&t)<<5|(1&t)<<7}var n=ytcrypto.jsbn.BigInteger.ZERO;n=n.setBit(e);var i=[],a=n.toByteArrayUnsigned();a.forEach(function(t){i.unshift(r(t))});var o=n.bitLength()%8;return 0!=o&&(o=8-o),i.unshift(o),i=i.map(function(t){return String.fromCharCode(t)}),i=i.join("")},t.exports=i},function(t,e,r){function n(t,e,r){this.data=[],null!=t&&("number"==typeof t?this.fromNumber(t,e,r):null==e&&"string"!=typeof t?this.fromString(t,256):this.fromString(t,e))}function i(){return new n(null)}function a(t,e,r,n,i,a){for(;--a>=0;){var o=e*this.data[t++]+r.data[n]+i;i=Math.floor(o/67108864),r.data[n++]=67108863&o}return i}function o(t,e,r,n,i,a){for(var o=32767&e,s=e>>15;--a>=0;){var u=32767&this.data[t],f=this.data[t++]>>15,h=s*u+f*o;u=o*u+((32767&h)<<15)+r.data[n]+(1073741823&i),i=(u>>>30)+(h>>>15)+s*f+(i>>>30),r.data[n++]=1073741823&u}return i}function s(t,e,r,n,i,a){for(var o=16383&e,s=e>>14;--a>=0;){var u=16383&this.data[t],f=this.data[t++]>>14,h=s*u+f*o;u=o*u+((16383&h)<<14)+r.data[n]+i,i=(u>>28)+(h>>14)+s*f,r.data[n++]=268435455&u}return i}function u(t){return fe.charAt(t)}function f(t,e){var r=he[t.charCodeAt(e)];return null==r?-1:r}function h(t){for(var e=this.t-1;e>=0;--e)t.data[e]=this.data[e];t.t=this.t,t.s=this.s}function c(t){this.t=1,this.s=t<0?-1:0,t>0?this.data[0]=t:t<-1?this.data[0]=t+this.DV:this.t=0}function p(t){var e=i();return e.fromInt(t),e}function l(t,e){var r;if(16==e)r=4;else if(8==e)r=3;else if(256==e)r=8;else if(2==e)r=1;else if(32==e)r=5;else{if(4!=e)return void this.fromRadix(t,e);r=2}this.t=0,this.s=0;for(var i=t.length,a=!1,o=0;--i>=0;){var s;if(s=8==r?t.charCodeAt?t.charCodeAt(i):t[i]:f(t,i),s>=256)throw"input data is not binary";s<0?t.charAt?"-"==t.charAt(i)&&(a=!0):"-"==t[i]&&(a=!0):(a=!1,0==o?this.data[this.t++]=s:o+r>this.DB?(this.data[this.t-1]|=(s&(1<<this.DB-o)-1)<<o,this.data[this.t++]=s>>this.DB-o):this.data[this.t-1]|=s<<o,o+=r,o>=this.DB&&(o-=this.DB))}8==r&&0!=(128&t[0])&&(this.s=-1,o>0&&(this.data[this.t-1]|=(1<<this.DB-o)-1<<o)),this.clamp(),a&&n.ZERO.subTo(this,this)}function d(){for(var t=this.s&this.DM;this.t>0&&this.data[this.t-1]==t;)--this.t}function y(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(16==t)e=4;else if(8==t)e=3;else if(2==t)e=1;else if(32==t)e=5;else{if(4!=t)return this.toRadix(t);e=2}var r,n=(1<<e)-1,i=!1,a="",o=this.t,s=this.DB-o*this.DB%e;if(o-- >0)for(s<this.DB&&(r=this.data[o]>>s)>0&&(i=!0,a=u(r));o>=0;)s<e?(r=(this.data[o]&(1<<s)-1)<<e-s,r|=this.data[--o]>>(s+=this.DB-e)):(r=this.data[o]>>(s-=e)&n,s<=0&&(s+=this.DB,--o)),r>0&&(i=!0),i&&(a+=u(r));return i?a:"0"}function g(){var t=i();return n.ZERO.subTo(this,t),t}function F(){return this.s<0?this.negate():this}function v(t){var e=this.s-t.s;if(0!=e)return e;var r=this.t;if(e=r-t.t,0!=e)return this.s<0?-e:e;for(;--r>=0;)if(0!=(e=this.data[r]-t.data[r]))return e;return 0}function m(t){var e,r=1;return 0!=(e=t>>>16)&&(t=e,r+=16),0!=(e=t>>8)&&(t=e,r+=8),0!=(e=t>>4)&&(t=e,r+=4),0!=(e=t>>2)&&(t=e,r+=2),0!=(e=t>>1)&&(t=e,r+=1),r}function B(){return this.t<=0?0:this.DB*(this.t-1)+m(this.data[this.t-1]^this.s&this.DM)}function C(t,e){var r;for(r=this.t-1;r>=0;--r)e.data[r+t]=this.data[r];for(r=t-1;r>=0;--r)e.data[r]=0;e.t=this.t+t,e.s=this.s}function b(t,e){for(var r=t;r<this.t;++r)e.data[r-t]=this.data[r];e.t=Math.max(this.t-t,0),e.s=this.s}function E(t,e){var r,n=t%this.DB,i=this.DB-n,a=(1<<i)-1,o=Math.floor(t/this.DB),s=this.s<<n&this.DM;for(r=this.t-1;r>=0;--r)e.data[r+o+1]=this.data[r]>>i|s,s=(this.data[r]&a)<<n;for(r=o-1;r>=0;--r)e.data[r]=0;e.data[o]=s,e.t=this.t+o+1,e.s=this.s,e.clamp()}function S(t,e){e.s=this.s;var r=Math.floor(t/this.DB);if(r>=this.t)return void(e.t=0);var n=t%this.DB,i=this.DB-n,a=(1<<n)-1;e.data[0]=this.data[r]>>n;for(var o=r+1;o<this.t;++o)e.data[o-r-1]|=(this.data[o]&a)<<i,e.data[o-r]=this.data[o]>>n;n>0&&(e.data[this.t-r-1]|=(this.s&a)<<i),e.t=this.t-r,e.clamp()}function A(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]-t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n-=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n-=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n-=t.s}e.s=n<0?-1:0,n<-1?e.data[r++]=this.DV+n:n>0&&(e.data[r++]=n),e.t=r,e.clamp()}function I(t,e){var r=this.abs(),i=t.abs(),a=r.t;for(e.t=a+i.t;--a>=0;)e.data[a]=0;for(a=0;a<i.t;++a)e.data[a+r.t]=r.am(0,i.data[a],e,a,0,r.t);e.s=0,e.clamp(),this.s!=t.s&&n.ZERO.subTo(e,e)}function T(t){for(var e=this.abs(),r=t.t=2*e.t;--r>=0;)t.data[r]=0;for(r=0;r<e.t-1;++r){var n=e.am(r,e.data[r],t,2*r,0,1);(t.data[r+e.t]+=e.am(r+1,2*e.data[r],t,2*r+1,n,e.t-r-1))>=e.DV&&(t.data[r+e.t]-=e.DV,t.data[r+e.t+1]=1)}t.t>0&&(t.data[t.t-1]+=e.am(r,e.data[r],t,2*r,0,1)),t.s=0,t.clamp()}function w(t,e,r){var a=t.abs();if(!(a.t<=0)){var o=this.abs();if(o.t<a.t)return null!=e&&e.fromInt(0),void(null!=r&&this.copyTo(r));null==r&&(r=i());var s=i(),u=this.s,f=t.s,h=this.DB-m(a.data[a.t-1]);h>0?(a.lShiftTo(h,s),o.lShiftTo(h,r)):(a.copyTo(s),o.copyTo(r));var c=s.t,p=s.data[c-1];if(0!=p){var l=p*(1<<this.F1)+(c>1?s.data[c-2]>>this.F2:0),d=this.FV/l,y=(1<<this.F1)/l,g=1<<this.F2,F=r.t,v=F-c,B=null==e?i():e;for(s.dlShiftTo(v,B),r.compareTo(B)>=0&&(r.data[r.t++]=1,r.subTo(B,r)),n.ONE.dlShiftTo(c,B),B.subTo(s,s);s.t<c;)s.data[s.t++]=0;for(;--v>=0;){var C=r.data[--F]==p?this.DM:Math.floor(r.data[F]*d+(r.data[F-1]+g)*y);if((r.data[F]+=s.am(0,C,r,v,0,c))<C)for(s.dlShiftTo(v,B),r.subTo(B,r);r.data[F]<--C;)r.subTo(B,r)}null!=e&&(r.drShiftTo(c,e),u!=f&&n.ZERO.subTo(e,e)),r.t=c,r.clamp(),h>0&&r.rShiftTo(h,r),u<0&&n.ZERO.subTo(r,r)}}}function R(t){var e=i();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(n.ZERO)>0&&t.subTo(e,e),e}function L(t){this.m=t}function N(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function P(t){return t}function D(t){t.divRemTo(this.m,null,t)}function K(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function x(t,e){t.squareTo(e),this.reduce(e)}function k(){if(this.t<1)return 0;var t=this.data[0];if(0==(1&t))return 0;var e=3&t;return e=e*(2-(15&t)*e)&15,e=e*(2-(255&t)*e)&255,e=e*(2-((65535&t)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}function U(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function O(t){var e=i();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(n.ZERO)>0&&this.m.subTo(e,e),e}function V(t){var e=i();return t.copyTo(e),this.reduce(e),e}function q(t){for(;t.t<=this.mt2;)t.data[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=32767&t.data[e],n=r*this.mpl+((r*this.mph+(t.data[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(r=e+this.m.t,t.data[r]+=this.m.am(0,n,t,e,0,this.m.t);t.data[r]>=t.DV;)t.data[r]-=t.DV,t.data[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function M(t,e){t.squareTo(e),this.reduce(e)}function _(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function H(){return 0==(this.t>0?1&this.data[0]:this.s)}function G(t,e){if(t>4294967295||t<1)return n.ONE;var r=i(),a=i(),o=e.convert(this),s=m(t)-1;for(o.copyTo(r);--s>=0;)if(e.sqrTo(r,a),(t&1<<s)>0)e.mulTo(a,o,r);else{var u=r;r=a,a=u}return e.revert(r)}function j(t,e){var r;return r=t<256||e.isEven()?new L(e):new U(e),this.exp(t,r)}function W(){var t=i();return this.copyTo(t),t}function X(){if(this.s<0){if(1==this.t)return this.data[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this.data[0];if(0==this.t)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function Q(){return 0==this.t?this.s:this.data[0]<<24>>24}function z(){return 0==this.t?this.s:this.data[0]<<16>>16}function Z(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function Y(){return this.s<0?-1:this.t<=0||1==this.t&&this.data[0]<=0?0:1}function J(t){if(null==t&&(t=10),0==this.signum()||t<2||t>36)return"0";var e=this.chunkSize(t),r=Math.pow(t,e),n=p(r),a=i(),o=i(),s="";for(this.divRemTo(n,a,o);a.signum()>0;)s=(r+o.intValue()).toString(t).substr(1)+s,a.divRemTo(n,a,o);return o.intValue().toString(t)+s}function $(t,e){this.fromInt(0),null==e&&(e=10);for(var r=this.chunkSize(e),i=Math.pow(e,r),a=!1,o=0,s=0,u=0;u<t.length;++u){var h=f(t,u);h<0?"-"==t.charAt(u)&&0==this.signum()&&(a=!0):(s=e*s+h,++o>=r&&(this.dMultiply(i),this.dAddOffset(s,0),o=0,s=0))}o>0&&(this.dMultiply(Math.pow(e,o)),this.dAddOffset(s,0)),a&&n.ZERO.subTo(this,this)}function tt(t,e,r){if("number"==typeof e)if(t<2)this.fromInt(1);else for(this.fromNumber(t,r),this.testBit(t-1)||this.bitwiseTo(n.ONE.shiftLeft(t-1),ut,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(n.ONE.shiftLeft(t-1),this);else{var i=new Array,a=7&t;i.length=(t>>3)+1,e.nextBytes(i),a>0?i[0]&=(1<<a)-1:i[0]=0,this.fromString(i,256)}}function et(){var t=this.t,e=new Array;e[0]=this.s;var r,n=this.DB-t*this.DB%8,i=0;if(t-- >0)for(n<this.DB&&(r=this.data[t]>>n)!=(this.s&this.DM)>>n&&(e[i++]=r|this.s<<this.DB-n);t>=0;)n<8?(r=(this.data[t]&(1<<n)-1)<<8-n,r|=this.data[--t]>>(n+=this.DB-8)):(r=this.data[t]>>(n-=8)&255,n<=0&&(n+=this.DB,--t)),0!=(128&r)&&(r|=-256),0==i&&(128&this.s)!=(128&r)&&++i,(i>0||r!=this.s)&&(e[i++]=r);return e}function rt(t){return 0==this.compareTo(t)}function nt(t){return this.compareTo(t)<0?this:t}function it(t){return this.compareTo(t)>0?this:t}function at(t,e,r){var n,i,a=Math.min(t.t,this.t);for(n=0;n<a;++n)r.data[n]=e(this.data[n],t.data[n]);if(t.t<this.t){for(i=t.s&this.DM,n=a;n<this.t;++n)r.data[n]=e(this.data[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=a;n<t.t;++n)r.data[n]=e(i,t.data[n]);r.t=t.t}r.s=e(this.s,t.s),r.clamp()}function ot(t,e){return t&e}function st(t){var e=i();return this.bitwiseTo(t,ot,e),e}function ut(t,e){return t|e}function ft(t){var e=i();return this.bitwiseTo(t,ut,e),e}function ht(t,e){return t^e}function ct(t){var e=i();return this.bitwiseTo(t,ht,e),e}function pt(t,e){return t&~e}function lt(t){var e=i();return this.bitwiseTo(t,pt,e),e}function dt(){for(var t=i(),e=0;e<this.t;++e)t.data[e]=this.DM&~this.data[e];return t.t=this.t,t.s=~this.s,t}function yt(t){var e=i();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function gt(t){var e=i();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function Ft(t){if(0==t)return-1;var e=0;return 0==(65535&t)&&(t>>=16,e+=16),0==(255&t)&&(t>>=8,e+=8),0==(15&t)&&(t>>=4,e+=4),0==(3&t)&&(t>>=2,e+=2),0==(1&t)&&++e,e}function vt(){for(var t=0;t<this.t;++t)if(0!=this.data[t])return t*this.DB+Ft(this.data[t]);return this.s<0?this.t*this.DB:-1}function mt(t){for(var e=0;0!=t;)t&=t-1,++e;return e}function Bt(){for(var t=0,e=this.s&this.DM,r=0;r<this.t;++r)t+=mt(this.data[r]^e);return t}function Ct(t){var e=Math.floor(t/this.DB);return e>=this.t?0!=this.s:0!=(this.data[e]&1<<t%this.DB)}function bt(t,e){var r=n.ONE.shiftLeft(t);return this.bitwiseTo(r,e,r),r}function Et(t){return this.changeBit(t,ut)}function St(t){return this.changeBit(t,pt)}function At(t){return this.changeBit(t,ht)}function It(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]+t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n+=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n+=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=t.s}e.s=n<0?-1:0,n>0?e.data[r++]=n:n<-1&&(e.data[r++]=this.DV+n),e.t=r,e.clamp()}function Tt(t){var e=i();return this.addTo(t,e),e}function wt(t){var e=i();return this.subTo(t,e),e}function Rt(t){var e=i();return this.multiplyTo(t,e),e}function Lt(){var t=i();return this.squareTo(t),t}function Nt(t){var e=i();return this.divRemTo(t,e,null),e}function Pt(t){var e=i();return this.divRemTo(t,null,e),e}function Dt(t){var e=i(),r=i();return this.divRemTo(t,e,r),new Array(e,r)}function Kt(t){this.data[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function xt(t,e){if(0!=t){for(;this.t<=e;)this.data[this.t++]=0;for(this.data[e]+=t;this.data[e]>=this.DV;)this.data[e]-=this.DV,++e>=this.t&&(this.data[this.t++]=0),++this.data[e]}}function kt(){}function Ut(t){return t}function Ot(t,e,r){t.multiplyTo(e,r)}function Vt(t,e){t.squareTo(e)}function qt(t){return this.exp(t,new kt)}function Mt(t,e,r){var n=Math.min(this.t+t.t,e);for(r.s=0,r.t=n;n>0;)r.data[--n]=0;var i;for(i=r.t-this.t;n<i;++n)r.data[n+this.t]=this.am(0,t.data[n],r,n,0,this.t);for(i=Math.min(t.t,e);n<i;++n)this.am(0,t.data[n],r,n,0,e-n);r.clamp()}function _t(t,e,r){--e;var n=r.t=this.t+t.t-e;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(e-this.t,0);n<t.t;++n)r.data[this.t+n-e]=this.am(e-n,t.data[n],r,0,0,this.t+n-e);r.clamp(),r.drShiftTo(1,r)}function Ht(t){this.r2=i(),this.q3=i(),n.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t;
}function Gt(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=i();return t.copyTo(e),this.reduce(e),e}function jt(t){return t}function Wt(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function Xt(t,e){t.squareTo(e),this.reduce(e)}function Qt(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function zt(t,e){var r,n,a=t.bitLength(),o=p(1);if(a<=0)return o;r=a<18?1:a<48?3:a<144?4:a<768?5:6,n=a<8?new L(e):e.isEven()?new Ht(e):new U(e);var s=new Array,u=3,f=r-1,h=(1<<r)-1;if(s[1]=n.convert(this),r>1){var c=i();for(n.sqrTo(s[1],c);u<=h;)s[u]=i(),n.mulTo(c,s[u-2],s[u]),u+=2}var l,d,y=t.t-1,g=!0,F=i();for(a=m(t.data[y])-1;y>=0;){for(a>=f?l=t.data[y]>>a-f&h:(l=(t.data[y]&(1<<a+1)-1)<<f-a,y>0&&(l|=t.data[y-1]>>this.DB+a-f)),u=r;0==(1&l);)l>>=1,--u;if((a-=u)<0&&(a+=this.DB,--y),g)s[l].copyTo(o),g=!1;else{for(;u>1;)n.sqrTo(o,F),n.sqrTo(F,o),u-=2;u>0?n.sqrTo(o,F):(d=o,o=F,F=d),n.mulTo(F,s[l],o)}for(;y>=0&&0==(t.data[y]&1<<a);)n.sqrTo(o,F),d=o,o=F,F=d,--a<0&&(a=this.DB-1,--y)}return n.revert(o)}function Zt(t){var e=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(e.compareTo(r)<0){var n=e;e=r,r=n}var i=e.getLowestSetBit(),a=r.getLowestSetBit();if(a<0)return e;for(i<a&&(a=i),a>0&&(e.rShiftTo(a,e),r.rShiftTo(a,r));e.signum()>0;)(i=e.getLowestSetBit())>0&&e.rShiftTo(i,e),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),e.compareTo(r)>=0?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return a>0&&r.lShiftTo(a,r),r}function Yt(t){if(t<=0)return 0;var e=this.DV%t,r=this.s<0?t-1:0;if(this.t>0)if(0==e)r=this.data[0]%t;else for(var n=this.t-1;n>=0;--n)r=(e*r+this.data[n])%t;return r}function Jt(t){var e=t.isEven();if(this.isEven()&&e||0==t.signum())return n.ZERO;for(var r=t.clone(),i=this.clone(),a=p(1),o=p(0),s=p(0),u=p(1);0!=r.signum();){for(;r.isEven();)r.rShiftTo(1,r),e?(a.isEven()&&o.isEven()||(a.addTo(this,a),o.subTo(t,o)),a.rShiftTo(1,a)):o.isEven()||o.subTo(t,o),o.rShiftTo(1,o);for(;i.isEven();)i.rShiftTo(1,i),e?(s.isEven()&&u.isEven()||(s.addTo(this,s),u.subTo(t,u)),s.rShiftTo(1,s)):u.isEven()||u.subTo(t,u),u.rShiftTo(1,u);r.compareTo(i)>=0?(r.subTo(i,r),e&&a.subTo(s,a),o.subTo(u,o)):(i.subTo(r,i),e&&s.subTo(a,s),u.subTo(o,u))}return 0!=i.compareTo(n.ONE)?n.ZERO:u.compareTo(t)>=0?u.subtract(t):u.signum()<0?(u.addTo(t,u),u.signum()<0?u.add(t):u):u}function $t(t){var e,r=this.abs();if(1==r.t&&r.data[0]<=ce[ce.length-1]){for(e=0;e<ce.length;++e)if(r.data[0]==ce[e])return!0;return!1}if(r.isEven())return!1;for(e=1;e<ce.length;){for(var n=ce[e],i=e+1;i<ce.length&&n<pe;)n*=ce[i++];for(n=r.modInt(n);e<i;)if(n%ce[e++]==0)return!1}return r.millerRabin(t)}function te(t){var e=this.subtract(n.ONE),r=e.getLowestSetBit();if(r<=0)return!1;for(var i,a=e.shiftRight(r),o=ee(),s=0;s<t;++s){do i=new n(this.bitLength(),o);while(i.compareTo(n.ONE)<=0||i.compareTo(e)>=0);var u=i.modPow(a,this);if(0!=u.compareTo(n.ONE)&&0!=u.compareTo(e)){for(var f=1;f++<r&&0!=u.compareTo(e);)if(u=u.modPowInt(2,this),0==u.compareTo(n.ONE))return!1;if(0!=u.compareTo(e))return!1}}return!0}function ee(){return{nextBytes:function(t){for(var e=0;e<t.length;++e)t[e]=Math.floor(255*ne.base.srnd())}}}var re,ne=r(1),ie=0xdeadbeefcafe,ae=15715070==(16777215&ie);"undefined"==typeof navigator?(n.prototype.am=s,re=28):ae&&"Microsoft Internet Explorer"==navigator.appName?(n.prototype.am=o,re=30):ae&&"Netscape"!=navigator.appName?(n.prototype.am=a,re=26):(n.prototype.am=s,re=28),n.prototype.DB=re,n.prototype.DM=(1<<re)-1,n.prototype.DV=1<<re;var oe=52;n.prototype.FV=Math.pow(2,oe),n.prototype.F1=oe-re,n.prototype.F2=2*re-oe;var se,ue,fe="0123456789abcdefghijklmnopqrstuvwxyz",he=new Array;for(se="0".charCodeAt(0),ue=0;ue<=9;++ue)he[se++]=ue;for(se="a".charCodeAt(0),ue=10;ue<36;++ue)he[se++]=ue;for(se="A".charCodeAt(0),ue=10;ue<36;++ue)he[se++]=ue;L.prototype.convert=N,L.prototype.revert=P,L.prototype.reduce=D,L.prototype.mulTo=K,L.prototype.sqrTo=x,U.prototype.convert=O,U.prototype.revert=V,U.prototype.reduce=q,U.prototype.mulTo=_,U.prototype.sqrTo=M,n.prototype.copyTo=h,n.prototype.fromInt=c,n.prototype.fromString=l,n.prototype.clamp=d,n.prototype.dlShiftTo=C,n.prototype.drShiftTo=b,n.prototype.lShiftTo=E,n.prototype.rShiftTo=S,n.prototype.subTo=A,n.prototype.multiplyTo=I,n.prototype.squareTo=T,n.prototype.divRemTo=w,n.prototype.invDigit=k,n.prototype.isEven=H,n.prototype.exp=G,n.prototype.toString=y,n.prototype.negate=g,n.prototype.abs=F,n.prototype.compareTo=v,n.prototype.bitLength=B,n.prototype.mod=R,n.prototype.modPowInt=j,n.ZERO=p(0),n.ONE=p(1),kt.prototype.convert=Ut,kt.prototype.revert=Ut,kt.prototype.mulTo=Ot,kt.prototype.sqrTo=Vt,Ht.prototype.convert=Gt,Ht.prototype.revert=jt,Ht.prototype.reduce=Wt,Ht.prototype.mulTo=Qt,Ht.prototype.sqrTo=Xt;var ce=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],pe=(1<<26)/ce[ce.length-1];n.prototype.chunkSize=Z,n.prototype.toRadix=J,n.prototype.fromRadix=$,n.prototype.fromNumber=tt,n.prototype.bitwiseTo=at,n.prototype.changeBit=bt,n.prototype.addTo=It,n.prototype.dMultiply=Kt,n.prototype.dAddOffset=xt,n.prototype.multiplyLowerTo=Mt,n.prototype.multiplyUpperTo=_t,n.prototype.modInt=Yt,n.prototype.millerRabin=te,n.prototype.clone=W,n.prototype.intValue=X,n.prototype.byteValue=Q,n.prototype.shortValue=z,n.prototype.signum=Y,n.prototype.toByteArray=et,n.prototype.equals=rt,n.prototype.min=nt,n.prototype.max=it,n.prototype.and=st,n.prototype.or=ft,n.prototype.xor=ct,n.prototype.andNot=lt,n.prototype.not=dt,n.prototype.shiftLeft=yt,n.prototype.shiftRight=gt,n.prototype.getLowestSetBit=vt,n.prototype.bitCount=Bt,n.prototype.testBit=Ct,n.prototype.setBit=Et,n.prototype.clearBit=St,n.prototype.flipBit=At,n.prototype.add=Tt,n.prototype.subtract=wt,n.prototype.multiply=Rt,n.prototype.divide=Nt,n.prototype.remainder=Pt,n.prototype.divideAndRemainder=Dt,n.prototype.modPow=zt,n.prototype.modInverse=Jt,n.prototype.pow=qt,n.prototype.gcd=Zt,n.prototype.isProbablePrime=$t,n.prototype.square=Lt,n.fromByteArrayUnsigned=function(t){return t.length?new n(128&t[0]?[0].concat(t):t):new n.valueOf(0)},n.fromByteArraySigned=function(t){return 128&t[0]?(t[0]&=127,n.fromByteArrayUnsigned(t).negate()):n.fromByteArrayUnsigned(t)},n.prototype.toByteArrayUnsigned=function(){var t=this.abs().toByteArray();if(!t.length)return t;0===t[0]&&(t=t.slice(1));for(var e=0;e<t.length;++e)t[e]=t[e]<0?t[e]+256:t[e];return t},n.prototype.toByteArraySigned=function(){var t=this.toByteArrayUnsigned(),e=this.s<0;return 128&t[0]?t.unshift(e?128:0):e&&(t[0]|=128),t},n.prototype.toBinary=function(t){var e,r=[];for(e=this.toByteArrayUnsigned();8*(r.length+e.length)<t;)r=[String.fromCharCode(0)].concat(r);return e.map(function(t,e){r.push(String.fromCharCode(t))}),r.join("")},n.prototype.print=function(t){for(var e=0;e<this.t;++e);},ne.jsbn=ne.jsbn||{},ne.jsbn.BigInteger=n,ne.jsbn.Barrett=Ht,t.exports=ne.jsbn},function(t,e,r){var n=r(1);n.pki=n.pki||{};var i=n.pki.oids=n.oids=n.oids||{};i["1.2.840.113549.1.1.1"]="rsaEncryption",i.rsaEncryption="1.2.840.113549.1.1.1",i["1.2.840.113549.1.1.4"]="md5WithRSAEncryption",i.md5WithRSAEncryption="1.2.840.113549.1.1.4",i["1.2.840.113549.1.1.5"]="sha1WithRSAEncryption",i.sha1WithRSAEncryption="1.2.840.113549.1.1.5",i["1.2.840.113549.1.1.7"]="RSAES-OAEP",i["RSAES-OAEP"]="1.2.840.113549.1.1.7",i["1.2.840.113549.1.1.8"]="mgf1",i.mgf1="1.2.840.113549.1.1.8",i["1.2.840.113549.1.1.9"]="pSpecified",i.pSpecified="1.2.840.113549.1.1.9",i["1.2.840.113549.1.1.10"]="RSASSA-PSS",i["RSASSA-PSS"]="1.2.840.113549.1.1.10",i["1.2.840.113549.1.1.11"]="sha256WithRSAEncryption",i.sha256WithRSAEncryption="1.2.840.113549.1.1.11",i["1.2.840.113549.1.1.12"]="sha384WithRSAEncryption",i.sha384WithRSAEncryption="1.2.840.113549.1.1.12",i["1.2.840.113549.1.1.13"]="sha512WithRSAEncryption",i.sha512WithRSAEncryption="1.2.840.113549.1.1.13",i["1.3.14.3.2.7"]="desCBC",i.desCBC="1.3.14.3.2.7",i["1.3.14.3.2.26"]="sha1",i.sha1="1.3.14.3.2.26",i["2.16.840.1.101.3.4.2.1"]="sha256",i.sha256="2.16.840.1.101.3.4.2.1",i["2.16.840.1.101.3.4.2.2"]="sha384",i.sha384="2.16.840.1.101.3.4.2.2",i["2.16.840.1.101.3.4.2.3"]="sha512",i.sha512="2.16.840.1.101.3.4.2.3",i["1.2.840.113549.2.5"]="md5",i.md5="1.2.840.113549.2.5",i.kcdsa="1.2.410.200004.1.21",i["1.2.410.200004.1.21"]="kcdsa",i.ecdsa="1.2.840.10045.2.1",i["1.2.840.10045.2.1"]="ecdsa",i.secp256r1="1.2.840.10045.3.1.7",i["1.2.840.10045.3.1.7"]="secp256r1",t.exports=i},function(t,e,r){function n(t,e,r){r||(r=i.md.sha1.create());for(var n="",a=Math.ceil(e/r.digestLength),o=0;o<a;++o){var s=String.fromCharCode(o>>24&255,o>>16&255,o>>8&255,255&o);r.start(),r.update(t+s),n+=r.digest().getBytes()}return n.substring(0,e)}var i=r(1),a=i.asn1,o=i.pki,s=i.pkcs1=i.pkcs1||{};s.encode_rsa_oaep=function(t,e,r){var a=void 0,o=void 0,s=void 0,u=void 0;"string"==typeof r?(a=r,o=arguments[3]||void 0,s=arguments[4]||void 0):r&&(a=r.label||void 0,o=r.seed||void 0,s=r.md||void 0,r.mgf1&&r.mgf1.md&&(u=r.mgf1.md)),s?s.start():s=i.md.sha1.create(),u||(u=s);var f=Math.ceil(t.n.bitLength()/8),h=f-2*s.digestLength-2;if(e.length>h)throw{message:"RSAES-OAEP input message length is too long.",length:e.length,maxLength:h};a||(a=""),s.update(a,"raw");for(var c=s.digest(),p="",l=h-e.length,d=0;d<l;d++)p+="\0";var y=c.getBytes()+p+""+e;if(o){if(o.length!==s.digestLength)throw{message:"Invalid RSAES-OAEP seed. The seed length must match the digest length.",seedLength:o.length,digestLength:s.digestLength}}else o=i.random.getBytes(s.digestLength);var g=n(o,f-s.digestLength-1,u),F=i.util.xorBytes(y,g,y.length),v=n(F,s.digestLength,u),m=i.util.xorBytes(o,v,o.length);return"\0"+m+F},s.decode_rsa_oaep=function(t,e,r){var a=void 0,o=void 0,s=void 0;"string"==typeof r?(a=r,o=arguments[3]||void 0):r&&(a=r.label||void 0,o=r.md||void 0,r.mgf1&&r.mgf1.md&&(s=r.mgf1.md));var u=Math.ceil(t.n.bitLength()/8);if(e.length!==u)throw{message:"RSAES-OAEP encoded message length is invalid.",length:e.length,expectedLength:u};if(void 0===o?o=i.md.sha1.create():o.start(),s||(s=o),u<2*o.digestLength+2)throw{message:"RSAES-OAEP key is too short for the hash function."};a||(a=""),o.update(a,"raw");for(var f=o.digest().getBytes(),h=e.charAt(0),c=e.substring(1,o.digestLength+1),p=e.substring(1+o.digestLength),l=n(p,o.digestLength,s),d=i.util.xorBytes(c,l,c.length),y=n(d,u-o.digestLength-1,s),g=i.util.xorBytes(p,y,p.length),F=g.substring(0,o.digestLength),v="\0"!==h,m=0;m<o.digestLength;++m)v|=f.charAt(m)!==F.charAt(m);for(var B=1,C=o.digestLength,b=o.digestLength;b<g.length;b++){var E=g.charCodeAt(b),S=1&E^1,A=B?65534:0;v|=E&A,B&=S,C+=B}if(v||1!==g.charCodeAt(C))throw{message:"Invalid RSAES-OAEP padding."};return g.substring(C+1)},s.createDigestInfo=function(t,e,r){var n;if(arguments.length<2){if(!(t.algorithm in o.oids))throw{message:"Unknown message digest algorithm.",algorithm:t.algorithm};if(n=o.oids[t.algorithm],t.hasOwnProperty("parameter")){if(8!=t.parameter.length)throw"invalid parameter length(must be 8 bytes)";r=a.create(a.Class.UNIVERSAL,a.Type,OCTETSTRING,!1,t.parameter)}e=t.digest().getBytes()}else if(n=t,"undefined"==typeof e)throw{message:"invalid input need digest value"};"undefined"==typeof r&&(r=a.create(a.Class.UNIVERSAL,a.Type.NULL,!1,""));var i=a.oidToDer(n).getBytes(),s=a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[]),u=a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[]);u.value.push(a.create(a.Class.UNIVERSAL,a.Type.OID,!1,i)),u.value.push(r);var e=a.create(a.Class.UNIVERSAL,a.Type.OCTETSTRING,!1,e);return s.value.push(u),s.value.push(e),a.toDer(s).getBytes()},t.exports=s},function(t,e,r){function n(t,e,r){var n=s.util.createBuffer(),i=Math.ceil(e.n.bitLength()/8);if(t.length>i-11)throw{message:"Message is too long for PKCS#1 v1.5 padding.",length:t.length,max:i-11};n.putByte(0),n.putByte(r);var a,o=i-3-t.length;if(0===r||1===r){a=0===r?0:255;for(var u=0;u<o;++u)n.putByte(a)}else for(;o>0;){for(var f=0,h=s.random.getBytes(o),u=0;u<o;++u)a=h.charCodeAt(u),0===a?++f:n.putByte(a);o=f}return n.putByte(0),n.putBytes(t),n}function i(t,e,r,n){var i=Math.ceil(e.n.bitLength()/8),a=s.util.createBuffer(t),o=a.getByte(),u=a.getByte();if(0!==o||r&&0!==u&&1!==u||!r&&2!=u||r&&0===u&&"undefined"==typeof n)throw{message:"Encryption block is invalid."};var f=0;if(0===u){f=i-3-n;for(var h=0;h<f;++h)if(0!==a.getByte())throw{message:"Encryption block is invalid."}}else if(1===u)for(f=0;a.length()>1;){if(255!==a.getByte()){--a.read;break}++f}else if(2===u)for(f=0;a.length()>1;){if(0===a.getByte()){--a.read;break}++f}var c=a.getByte();if(0!==c||f!==i-3-a.length())throw{message:"Encryption block is invalid."};return a.getBytes()}function a(t,e,r){function n(){return h.rsa.stepKeyPairGenerationState(t,10)?r(null,t.keys):void s.util.setImmediate(n)}function i(){f=Math.max(1,f),a(t.pBits,function(e,n){return e?r(e):(t.p=n,void a(t.qBits,o))})}function a(e,r){function n(){var r=e-1,n=new u(e,t.rng);return n.testBit(r)||n.bitwiseTo(u.ONE.shiftLeft(r),y,n),n.dAddOffset(31-n.mod(d).byteValue(),0),n}function i(i){if(!g){--s;var o=i.data;if(o.found){for(var f=0;f<a.length;++f)a[f].terminate();return g=!0,r(null,new u(o.prime,16))}h.bitLength()>e&&(h=n());var l=h.toString(16);i.target.postMessage({e:t.eInt,hex:l,workLoad:c}),h.dAddOffset(p,0)}}for(var a=[],o=0;o<f;++o)a[o]=new Worker(l);for(var s=f,h=n(),o=0;o<f;++o)a[o].addEventListener("message",i);var g=!1}function o(e,n){if(t.q=n,t.p.compareTo(t.q)<0){var s=t.p;t.p=t.q,t.q=s}if(t.p1=t.p.subtract(u.ONE),t.q1=t.q.subtract(u.ONE),t.phi=t.p1.multiply(t.q1),0!==t.phi.gcd(t.e).compareTo(u.ONE))return t.p=t.q=null,void i();if(t.n=t.p.multiply(t.q),t.n.bitLength()!==t.bits)return t.q=null,void a(t.qBits,o);var f=t.e.modInverse(t.phi);t.keys={privateKey:h.rsa.setPrivateKey(t.n,t.e,f,t.p,t.q,f.mod(t.p1),f.mod(t.q1),t.q.modInverse(t.p)),publicKey:h.rsa.setPublicKey(t.n,t.e)},r(null,t.keys)}if("function"==typeof e&&(r=e,e={}),"undefined"==typeof Worker)return n();var f=e.workers||2,c=e.workLoad||100,p=30*c/8,l=e.workerScript||"yt/prime.worker.js",d=new u(null);d.fromInt(30);var y=function(t,e){return t|e};return f===-1?s.util.estimateCores(function(t,e){t&&(e=2),f=e-1,i()}):void i()}function o(t){return t<=100?27:t<=150?18:t<=200?15:t<=250?12:t<=300?9:t<=350?8:t<=400?7:t<=500?6:t<=600?5:t<=800?4:t<=1250?3:2}var s=r(1);if("undefined"==typeof u)var u=s.jsbn.BigInteger;var f=s.asn1;s.pki=s.pki||{},s.pki.rsa=s.rsa=s.rsa||{};var h=s.pki,c=[6,4,2,4,2,4,6,2],p=function(t){var e;if(!(t.algorithm in h.oids))throw{message:"Unknown message digest algorithm.",algorithm:t.algorithm};e=h.oids[t.algorithm];var r=f.oidToDer(e).getBytes(),n=f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[]),i=f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[]);if(i.value.push(f.create(f.Class.UNIVERSAL,f.Type.OID,!1,r)),t.hasOwnProperty("parameter")){if(8!=t.parameter.length)throw"invalid parameter length(must be 8 bytes)";i.value.push(f.create(f.Class.UNIVERSAL,f.Type.OCTETSTRING,!1,t.parameter))}else i.value.push(f.create(f.Class.UNIVERSAL,f.Type.NULL,!1,""));var a=f.create(f.Class.UNIVERSAL,f.Type.OCTETSTRING,!1,t.digest().getBytes());return n.value.push(i),n.value.push(a),f.toDer(n).getBytes()},l=function(t,e,r){var n;if(r)n=t.modPow(e.e,e.n);else if(e.p&&e.q){e.dP||(e.dP=e.d.mod(e.p.subtract(u.ONE))),e.dQ||(e.dQ=e.d.mod(e.q.subtract(u.ONE))),e.qInv||(e.qInv=e.q.modInverse(e.p));for(var i=t.mod(e.p).modPow(e.dP,e.p),a=t.mod(e.q).modPow(e.dQ,e.q);i.compareTo(a)<0;)i=i.add(e.p);n=i.subtract(a).multiply(e.qInv).mod(e.p).multiply(e.q).add(a)}else n=t.modPow(e.d,e.n);return n};h.rsa.encrypt=function(t,e,r){var i,a=r,o=Math.ceil(e.n.bitLength()/8);r!==!1&&r!==!0?(a=2===r,i=n(t,e,r)):(i=s.util.createBuffer(),i.putBytes(t));for(var f=new u(i.toHex(),16),h=l(f,e,a),c=h.toString(16),p=s.util.createBuffer(),d=o-Math.ceil(c.length/2);d>0;)p.putByte(0),--d;return p.putBytes(s.util.hexToBytes(c)),p.getBytes()},h.rsa.decrypt=function(t,e,r,n){var a=Math.ceil(e.n.bitLength()/8);if(t.length!==a)throw{message:"Encrypted message length is invalid.",length:t.length,expected:a};var o=new u(s.util.createBuffer(t).toHex(),16);if(o.compareTo(e.n)>=0)throw{message:"Encrypted message is invalid."};for(var f=l(o,e,r),h=f.toString(16),c=s.util.createBuffer(),p=a-Math.ceil(h.length/2);p>0;)c.putByte(0),--p;return c.putBytes(s.util.hexToBytes(h)),n!==!1?i(c.getBytes(),e,r):c.getBytes()},h.rsa.createKeyPairGenerationState=function(t,e){"string"==typeof t&&(t=parseInt(t,10)),t=t||2048;var r={nextBytes:function(t){for(var e=s.random.getBytes(t.length),r=0;r<t.length;++r)t[r]=e.charCodeAt(r)}},n={state:0,bits:t,rng:r,eInt:e||65537,e:new u(null),p:null,q:null,qBits:t>>1,pBits:t-(t>>1),pqState:0,num:null,keys:null};return n.e.fromInt(n.eInt),n},h.rsa.stepKeyPairGenerationState=function(t,e){var r=new u(null);r.fromInt(30);for(var n,i=0,a=function(t,e){return t|e},s=+new Date,f=0;null===t.keys&&(e<=0||f<e);){if(0===t.state){var p=null===t.p?t.pBits:t.qBits,l=p-1;0===t.pqState?(t.num=new u(p,t.rng),t.num.testBit(l)||t.num.bitwiseTo(u.ONE.shiftLeft(l),a,t.num),t.num.dAddOffset(31-t.num.mod(r).byteValue(),0),i=0,++t.pqState):1===t.pqState?t.num.bitLength()>p?t.pqState=0:t.num.isProbablePrime(o(t.num.bitLength()))?++t.pqState:t.num.dAddOffset(c[i++%8],0):2===t.pqState?t.pqState=0===t.num.subtract(u.ONE).gcd(t.e).compareTo(u.ONE)?3:0:3===t.pqState&&(t.pqState=0,null===t.p?t.p=t.num:t.q=t.num,null!==t.p&&null!==t.q&&++t.state,t.num=null)}else if(1===t.state)t.p.compareTo(t.q)<0&&(t.num=t.p,t.p=t.q,t.q=t.num),++t.state;else if(2===t.state)t.p1=t.p.subtract(u.ONE),t.q1=t.q.subtract(u.ONE),t.phi=t.p1.multiply(t.q1),++t.state;else if(3===t.state)0===t.phi.gcd(t.e).compareTo(u.ONE)?++t.state:(t.p=null,t.q=null,t.state=0);else if(4===t.state)t.n=t.p.multiply(t.q),t.n.bitLength()===t.bits?++t.state:(t.q=null,t.state=0);else if(5===t.state){var d=t.e.modInverse(t.phi);t.keys={privateKey:h.rsa.setPrivateKey(t.n,t.e,d,t.p,t.q,d.mod(t.p1),d.mod(t.q1),t.q.modInverse(t.p)),publicKey:h.rsa.setPublicKey(t.n,t.e)}}n=+new Date,f+=n-s,s=n}return null!==t.keys},h.rsa.generateKeyPair=function(t,e,r,n){1===arguments.length?"object"==typeof t?(r=t,t=void 0):"function"==typeof t&&(n=t,t=void 0):2===arguments.length?("number"==typeof t?"function"==typeof e?n=e:r=e:(r=t,n=e,t=void 0),e=void 0):3===arguments.length&&("number"==typeof e?"function"==typeof r&&(n=r,r=void 0):(n=r,r=e,e=void 0)),r=r||{},void 0===t&&(t=r.bits||2048),void 0===e&&(e=r.e||65537);var i=h.rsa.createKeyPairGenerationState(t,e);return n?void a(i,r,n):(h.rsa.stepKeyPairGenerationState(i,0),i.keys)},h.setRsaPublicKey=h.rsa.setPublicKey=function(t,e,r){var a={oid:h.oids.rsaEncryption,n:t,e:e,params:r};return a.encrypt=function(t,e,r){if("string"==typeof e?e=e.toUpperCase():void 0===e&&(e="RSAES-PKCS1-V1_5"),"RSAES-PKCS1-V1_5"===e)e={encode:function(t,e,r){return n(t,e,2).getBytes()}};else if("RSA-OAEP"===e||"RSAES-OAEP"===e)e={encode:function(t,e){return s.pkcs1.encode_rsa_oaep(e,t,r)}};else{if(["RAW","NONE","NULL",null].indexOf(e)===-1)throw{message:'Unsupported encryption scheme: "'+e+'".'};e={encode:function(t){return t}}}var i=e.encode(t,a,!0);return h.rsa.encrypt(i,a,!0)},a.verify=function(t,e,r){"string"==typeof r?r=r.toUpperCase():void 0===r&&(r="RSASSA-PKCS1-V1_5"),"RSASSA-PKCS1-V1_5"===r?r={verify:function(t,e){e=i(e,a,!0);var r=f.fromDer(e);return t===r.value[1].value}}:"NONE"!==r&&"NULL"!==r&&null!==r||(r={verify:function(t,e){return e=i(e,a,!0),t===e}});var n=h.rsa.decrypt(e,a,!0,!1);return s.consoleLog,r.verify(t,n,a.n.bitLength())},a},h.kcdsa={},h.setKcdsaPublicKey=h.kcdsa.setPublicKey=function(t,e,r,n){var i={oid:h.oids.kcdsa,y:t,params:{P:e,Q:r,G:n}};return i.verify=function(t,e){throw"not supported"},i},h.setRsaPrivateKey=h.rsa.setPrivateKey=function(t,e,r,n,a,o,u,f){var c={oid:h.oids.rsaEncryption,n:t,e:e,d:r,p:n,q:a,dP:o,dQ:u,qInv:f};return c.decrypt=function(t,e,r){"string"==typeof e?e=e.toUpperCase():void 0===e&&(e="RSAES-PKCS1-V1_5");var n=h.rsa.decrypt(t,c,!1,!1);if("RSAES-PKCS1-V1_5"===e)e={decode:i};else if("RSA-OAEP"===e||"RSAES-OAEP"===e)e={decode:function(t,e){return s.pkcs1.decode_rsa_oaep(e,t,r)}};else{if(["RAW","NONE","NULL",null].indexOf(e)===-1)throw{message:'Unsupported encryption scheme: "'+e+'".'};e={decode:function(t){return t}}}return e.decode(n,c,!1)},c.sign=function(t,e){var r=!1;"string"==typeof e&&(e=e.toUpperCase()),void 0===e||"RSASSA-PKCS1-V1_5"===e?(e={encode:p},r=1):"NONE"!==e&&"NULL"!==e&&null!==e||(e={encode:function(){return t}},r=1);var n=e.encode(t,c.n.bitLength());return s.consoleLog,h.rsa.encrypt(n,c,r)},c},h.wrapRsaPrivateKey=function(t){return f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.INTEGER,!1,f.integerToDer(0).getBytes()),f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(h.oids.rsaEncryption).getBytes()),f.create(f.Class.UNIVERSAL,f.Type.NULL,!1,"")]),f.create(f.Class.UNIVERSAL,f.Type.OCTETSTRING,!1,f.toDer(t).getBytes())])},t.exports=s.rsa},function(t,e,r){var n=r(1);n.mgf=n.mgf||{};var i=n.mgf.mgf1=n.mgf1=n.mgf1||{};i.create=function(t){var e={generate:function(e,r){for(var i=new n.util.ByteBuffer,a=Math.ceil(r/t.digestLength),o=0;o<a;o++){var s=new n.util.ByteBuffer;s.putInt32(o),t.start(),t.update(e+s.getBytes()),i.putBuffer(t.digest())}return i.truncate(i.length()-r),i.getBytes()}};return e},t.exports=n.mgf1},function(t,e,r){var n=r(1);n.mgf=n.mgf||{},n.mgf.mgf1=n.mgf1,t.exports=n.mgf},function(t,e,r){var n=r(1),i=n.pss=n.pss||{};i.create=function(t,e,r){var i=t.digestLength,a={};return a.verify=function(a,o,s){var u,f=s-1,h=Math.ceil(f/8);if(o=o.substr(-h),h<i+r+2)throw{message:"Inconsistent parameters to PSS signature verification."};if(188!==o.charCodeAt(h-1))throw{message:"Encoded message does not end in 0xBC."};var c=h-i-1,p=o.substr(0,c),l=o.substr(c,i),d=65280>>8*h-f&255;if(0!==(p.charCodeAt(0)&d))throw{message:"Bits beyond keysize not zero as expected."};var y=e.generate(l,c),g="";for(u=0;u<c;u++)g+=String.fromCharCode(p.charCodeAt(u)^y.charCodeAt(u));g=String.fromCharCode(g.charCodeAt(0)&~d)+g.substr(1);var F=h-i-r-2;for(u=0;u<F;u++)if(0!==g.charCodeAt(u))throw{message:"Leftmost octets not zero as expected"};if(1!==g.charCodeAt(F))throw{message:"Inconsistent PSS signature, 0x01 marker not found"};var v=g.substring(g.length-r,g.length),m=new n.util.ByteBuffer;m.fillWithByte(0,8),m.putBytes(a),m.putBytes(v),t.start(),t.update(m.getBytes());var B=t.digest().getBytes();return l===B},a.encode=function(a,o){var s,u=o-1,f=Math.ceil(u/8),h=a.digest().getBytes();if(f<i+r+2)throw{message:"Message is too long to encrypt"};var c=n.random.getBytes(r),p=new n.util.ByteBuffer;p.fillWithByte(0,8),p.putBytes(h),p.putBytes(c),t.start(),t.update(p.getBytes());var l=t.digest().getBytes(),d=new n.util.ByteBuffer;d.fillWithByte(0,f-r-i-2),d.putByte(1),d.putBytes(c);var y=d.getBytes(),g=f-i-1,F=e.generate(l,g),v="";for(s=0;s<g;s++)v+=String.fromCharCode(y.charCodeAt(s)^F.charCodeAt(s));var m=65280>>8*f-u&255;return v=String.fromCharCode(v.charCodeAt(0)&~m)+v.substr(1),v+l+String.fromCharCode(188)},a},t.exports=n.pss},function(t,e,r){function n(t,e){this.x=e,this.q=t}function i(t){return t==this||this.q.equals(t.q)&&this.x.equals(t.x)}function a(){return this.x}function o(){return new n(this.q,this.x.negate().mod(this.q))}function s(t){return new n(this.q,this.x.add(t.toBigInteger()).mod(this.q))}function u(t){return new n(this.q,this.x.subtract(t.toBigInteger()).mod(this.q))}function f(t){return new n(this.q,this.x.multiply(t.toBigInteger()).mod(this.q))}function h(){return new n(this.q,this.x.square().mod(this.q))}function c(t){return new n(this.q,this.x.multiply(t.toBigInteger().modInverse(this.q)).mod(this.q))}function p(t,e,r,n){this.curve=t,this.x=e,this.y=r,null==n?this.z=D.ONE:this.z=n,this.zinv=null}function l(){null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q));var t=this.x.toBigInteger().multiply(this.zinv);return this.curve.reduce(t),this.curve.fromBigInteger(t)}function d(){null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q));var t=this.y.toBigInteger().multiply(this.zinv);return this.curve.reduce(t),this.curve.fromBigInteger(t)}function y(t){if(t==this)return!0;if(this.isInfinity())return t.isInfinity();if(t.isInfinity())return this.isInfinity();var e,r;return e=t.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(t.z)).mod(this.curve.q),!!e.equals(D.ZERO)&&(r=t.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(t.z)).mod(this.curve.q),r.equals(D.ZERO))}function g(){return null==this.x&&null==this.y||this.z.equals(D.ZERO)&&!this.y.toBigInteger().equals(D.ZERO)}function F(){return new p(this.curve,this.x,this.y.negate(),this.z)}function v(t){if(this.isInfinity())return t;if(t.isInfinity())return this;var e=t.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(t.z)).mod(this.curve.q),r=t.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(t.z)).mod(this.curve.q);if(D.ZERO.equals(r))return D.ZERO.equals(e)?this.twice():this.curve.getInfinity();var n=new D("3"),i=this.x.toBigInteger(),a=this.y.toBigInteger(),o=(t.x.toBigInteger(),t.y.toBigInteger(),r.square()),s=o.multiply(r),u=i.multiply(o),f=e.square().multiply(this.z),h=f.subtract(u.shiftLeft(1)).multiply(t.z).subtract(s).multiply(r).mod(this.curve.q),c=u.multiply(n).multiply(e).subtract(a.multiply(s)).subtract(f.multiply(e)).multiply(t.z).add(e.multiply(s)).mod(this.curve.q),l=s.multiply(this.z).multiply(t.z).mod(this.curve.q);return new p(this.curve,this.curve.fromBigInteger(h),this.curve.fromBigInteger(c),l)}function m(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var t=new D("3"),e=this.x.toBigInteger(),r=this.y.toBigInteger(),n=r.multiply(this.z),i=n.multiply(r).mod(this.curve.q),a=this.curve.a.toBigInteger(),o=e.square().multiply(t);D.ZERO.equals(a)||(o=o.add(this.z.square().multiply(a))),o=o.mod(this.curve.q);var s=o.square().subtract(e.shiftLeft(3).multiply(i)).shiftLeft(1).multiply(n).mod(this.curve.q),u=o.multiply(t).multiply(e).subtract(i.shiftLeft(1)).shiftLeft(2).multiply(i).subtract(o.square().multiply(o)).mod(this.curve.q),f=n.square().multiply(n).shiftLeft(3).mod(this.curve.q);return new p(this.curve,this.curve.fromBigInteger(s),this.curve.fromBigInteger(u),f)}function B(t){if(this.isInfinity())return this;if(0==t.signum())return this.curve.getInfinity();var e,r=t,n=r.multiply(new D("3")),i=this.negate(),a=this;for(e=n.bitLength()-2;e>0;--e){a=a.twice();var o=n.testBit(e),s=r.testBit(e);o!=s&&(a=a.add(o?this:i))}return a}function C(t,e,r){var n;n=t.bitLength()>r.bitLength()?t.bitLength()-1:r.bitLength()-1;for(var i=this.curve.getInfinity(),a=this.add(e);n>=0;)i=i.twice(),t.testBit(n)?i=r.testBit(n)?i.add(a):i.add(this):r.testBit(n)&&(i=i.add(e)),--n;return i}function b(t,e,r){this.q=t,this.a=this.fromBigInteger(e),this.b=this.fromBigInteger(r),this.infinity=new p(this,null,null),this.reducer=new K(this.q)}function E(){return this.q}function S(){return this.a}function A(){return this.b}function I(t){return t==this||this.q.equals(t.q)&&this.a.equals(t.a)&&this.b.equals(t.b)}function T(){return this.infinity}function w(t){return new n(this.q,t)}function R(t){this.reducer.reduce(t)}function L(t){switch(parseInt(t.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:return null;case 4:case 6:case 7:var e=(t.length-2)/2,r=t.substr(2,e),n=t.substr(e+2,e);return new p(this,this.fromBigInteger(new D(r,16)),this.fromBigInteger(new D(n,16)));default:return null}}function N(t){if(t.isInfinity())return"00";var e=t.getX().toBigInteger().toString(16),r=t.getY().toBigInteger().toString(16),n=this.getQ().toString(16).length;for(n%2!=0&&n++;e.length<n;)e="0"+e;for(;r.length<n;)r="0"+r;return"04"+e+r}var P=r(1),D=P.jsbn.BigInteger,K=P.jsbn.Barrett;P.ec={},n.prototype.equals=i,n.prototype.toBigInteger=a,n.prototype.negate=o,n.prototype.add=s,n.prototype.subtract=u,n.prototype.multiply=f,n.prototype.square=h,n.prototype.divide=c,p.decodeFrom=function(t,e){var r=e[0],n=e.length-1;if(4!=r)throw"not supported ECPoint encoding:"+r;var i=e.slice(1,1+n/2),a=e.slice(1+n/2,1+n);i.unshift(0),a.unshift(0);var o=new D(i),s=new D(a);return new p(t,t.fromBigInteger(o),t.fromBigInteger(s))},p.prototype.getX=l,p.prototype.getY=d,p.prototype.equals=y,p.prototype.isInfinity=g,p.prototype.negate=F,p.prototype.add=v,p.prototype.twice=m,p.prototype.multiply=B,p.prototype.multiplyTwo=C,P.ec.ECPointFp=p,b.prototype.getQ=E,b.prototype.getA=S,b.prototype.getB=A,b.prototype.equals=I,b.prototype.getInfinity=T,b.prototype.fromBigInteger=w,b.prototype.reduce=R,b.prototype.decodePointHex=L,b.prototype.encodePointHex=N,P.ec.ECCurveFp=b,t.exports=P.ec},function(t,e,r){function n(t){this.privateKey=t.privateKey,this.publicKey=t.publicKey}var i=r(1),a=i.ec.ECPointFp;n.prototype.computeSharedData=function(t){var e=i.ECParameterDB.getByName("P-256"),r=t.raw.Q.toByteArrayUnsigned();if(!e.h.equals(i.jsbn.BigInteger.ONE))throw"need more calculation(h inverse) but not implemented";r=a.decodeFrom(e.curve,r);var n=r.multiply(this.privateKey.raw.d),o=i.crypto.util.arrayToString(n.getX().toBigInteger().toByteArrayUnsigned());return o},i.ecdh=n,t.exports=i.ecdh},function(t,e,r){var n=r(1),i=n.jsbn.BigInteger,a=n.ec.ECCurveFp;n.ECParameterDB=new function(){function t(t){return new i(t,16)}var e={},r={};this.getByName=function(t){var n=t;if("undefined"!=typeof r[n]&&(n=r[t]),"undefined"!=typeof e[n])return e[n];throw"unregistered EC curve name: "+n},this.regist=function(n,i,o,s,u,f,h,c,p,l,d,y){e[n]={};var g=t(o),F=t(s),v=t(u),m=t(f),B=t(h),C=new a(g,F,v),b=C.decodePointHex("04"+c+p);e[n].name=n,e[n].keylen=i,e[n].curve=C,e[n].G=b,e[n].n=m,e[n].h=B,e[n].oid=d,e[n].info=y;for(var E=0;E<l.length;E++)r[l[E]]=n}},n.ECParameterDB.regist("secp128r1",128,"FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFC","E87579C11079F43DD824993C2CEE5ED3","FFFFFFFE0000000075A30D1B9038A115","1","161FF7528B899B2D0C28607CA52C5B86","CF5AC8395BAFEB13C02DA292DDED7A83",[],"","secp128r1 : SECG curve over a 128 bit prime field"),n.ECParameterDB.regist("secp160k1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFAC73","0","7","0100000000000000000001B8FA16DFAB9ACA16B6B3","1","3B4C382CE37AA192A4019E763036F4F5DD4D7EBB","938CF935318FDCED6BC28286531733C3F03C4FEE",[],"","secp160k1 : SECG curve over a 160 bit prime field"),n.ECParameterDB.regist("secp160r1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFC","1C97BEFC54BD7A8B65ACF89F81D4D4ADC565FA45","0100000000000000000001F4C8F927AED3CA752257","1","4A96B5688EF573284664698968C38BB913CBFC82","23A628553168947D59DCC912042351377AC5FB32",[],"","secp160r1 : SECG curve over a 160 bit prime field"),n.ECParameterDB.regist("secp192k1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFEE37","0","3","FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8D","1","DB4FF10EC057E9AE26B07D0280B7F4341DA5D1B1EAE06C7D","9B2F2F6D9C5628A7844163D015BE86344082AA88D95E2F9D",[]),n.ECParameterDB.regist("secp192r1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC","64210519E59C80E70FA7E9AB72243049FEB8DEECC146B9B1","FFFFFFFFFFFFFFFFFFFFFFFF99DEF836146BC9B1B4D22831","1","188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF1012","07192B95FFC8DA78631011ED6B24CDD573F977A11E794811",[]),n.ECParameterDB.regist("secp224r1",224,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE","B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4","FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D","1","B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21","BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34",[]),
n.ECParameterDB.regist("secp256k1",256,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F","0","7","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141","1","79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798","483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8",[]),n.ECParameterDB.regist("secp256r1",256,"FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC","5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B","FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551","1","6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296","4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5",["NIST P-256","P-256","prime256v1"]),n.ECParameterDB.regist("secp384r1",384,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFC","B3312FA7E23EE7E4988E056BE3F82D19181D9C6EFE8141120314088F5013875AC656398D8A2ED19D2A85C8EDD3EC2AEF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC7634D81F4372DDF581A0DB248B0A77AECEC196ACCC52973","1","AA87CA22BE8B05378EB1C71EF320AD746E1D3B628BA79B9859F741E082542A385502F25DBF55296C3A545E3872760AB7","3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f",["NIST P-384","P-384"]),n.ECParameterDB.regist("secp521r1",521,"1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC","051953EB9618E1C9A1F929A21A0B68540EEA2DA725B99B315F3B8B489918EF109E156193951EC7E937B1652C0BD3BB1BF073573DF883D2C34F1EF451FD46B503F00","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA51868783BF2F966B7FCC0148F709A5D03BB5C9B8899C47AEBB6FB71E91386409","1","C6858E06B70404E9CD9E3ECB662395B4429C648139053FB521F828AF606B4D3DBAA14B5E77EFE75928FE1DC127A2FFA8DE3348B3C1856A429BF97E7E31C2E5BD66","011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650",["NIST P-521","P-521"]),t.exports=n.ECParameterDB},function(t,e,r){function n(){this.i=0,this.j=0,this.S=new Array}function i(t){var e,r,n;for(e=0;e<256;++e)this.S[e]=e;for(r=0,e=0;e<256;++e)r=r+this.S[e]+t[e%t.length]&255,n=this.S[e],this.S[e]=this.S[r],this.S[r]=n;this.i=0,this.j=0}function a(){var t;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,t=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=t,this.S[t+this.S[this.i]&255]}function o(){return new n}function s(t){m[B++]^=255&t,m[B++]^=t>>8&255,m[B++]^=t>>16&255,m[B++]^=t>>24&255,B>=C&&(B-=C)}function u(){s((new Date).getTime())}function f(){if(null==v){for(u(),v=o(),v.init(m),B=0;B<m.length;++B)m[B]=0;B=0}return v.next()}function h(t){var e;for(e=0;e<t.length;++e)t[e]=f()}function c(){}function p(t){return T.forEach(function(e){if(e.curveName==I.getName(t))return e}),T.push(new I({curve:t})),T[T.length-1]}function l(){}var d=r(1),y=d.jsbn.BigInteger,g=d.ec.ECPointFp,F=d.pki;n.prototype.init=i,n.prototype.next=a;var v,m,B,C=256;if(null==m){m=new Array,B=0;var b;if("undefined"!=typeof window&&(void 0!==window.crypto||void 0!==window.msCrypto)){var E=window.crypto||window.msCrypto;if(E.getRandomValues){var S=new Uint8Array(32);for(E.getRandomValues(S),b=0;b<32;++b)m[B++]=S[b]}else if("Netscape"==navigator.appName&&navigator.appVersion<"5"){var A=window.crypto.random(32);for(b=0;b<A.length;++b)m[B++]=255&A.charCodeAt(b)}}for(;B<C;)b=Math.floor(65536*Math.random()),m[B++]=b>>>8,m[B++]=255&b;B=0,u()}c.prototype.nextBytes=h;var I=function(t){var e="secp256r1",r=new c;this.type="EC",this.isPrivate=!1,this.isPublic=!1,this.getBigRandom=function(t){var e;return e=new y(t.bitLength(),r).mod(t.subtract(y.ONE)).add(y.ONE),e.bitLength()!=t.bitLength()&&(e=e.setBit(t.bitLength()-1)),e},this.checkBigRandom=function(t,e){var r=e;if(r.bitLength()!=t.bitLength())throw new d.error("mismatch number bits (need "+t.bitLength()+" bits)");r.mod(t.subtract(y.ONE)).add(y.ONE)},this.setNamedCurve=function(t){this.ecparams=d.ECParameterDB.getByName(t),this.prvKeyHex=null,this.pubKeyHex=null,this.curveName=t},this.setPrivateKeyHex=function(t){this.isPrivate=!0,this.prvKeyHex=t},this.setPublicKeyHex=function(t){this.isPublic=!0,this.pubKeyHex=t},this.getPublicKeyXYHex=function(){var t=this.pubKeyHex;if("04"!==t.substr(0,2))throw"this method supports uncompressed format(04) only";var e=this.ecparams.keylen/4;if(t.length!==2+2*e)throw"malformed public key hex length";var r={};return r.x=t.substr(2,e),r.y=t.substr(2+e),r},this.getShortNISTPCurveName=function(){var t=this.curveName;return"secp256r1"===t||"NIST P-256"===t||"P-256"===t||"prime256v1"===t?"P-256":"secp384r1"===t||"NIST P-384"===t||"P-384"===t?"P-384":null},this.generateKeyPairHex=function(t){var e,r=this.ecparams.n;"undefined"==typeof t?(e=this.getBigRandom(r),this.checkBigRandom(r,e)):(this.checkBigRandom(r,t),e=t);var n=this.ecparams.G.multiply(e),i=n.getX().toBigInteger(),a=n.getY().toBigInteger(),o=this.ecparams.keylen/4,s=("0000000000"+e.toString(16)).slice(-o),u=("0000000000"+i.toString(16)).slice(-o),f=("0000000000"+a.toString(16)).slice(-o),h="04"+u+f;return this.setPrivateKeyHex(s),this.setPublicKeyHex(h),{ecprvhex:s,ecpubhex:h}},this.signWithMessageHash=function(t){return this.signHex(t,this.prvKeyHex)},this.signHex=function(t,e){var r=new y(e,16),n=this.ecparams.n,i=new y(t,16);do var a=this.getBigRandom(n),o=this.ecparams.G,s=o.multiply(a),u=s.getX().toBigInteger().mod(n);while(u.compareTo(y.ZERO)<=0);var f=a.modInverse(n).multiply(i.add(r.multiply(u))).mod(n);return d.ECDSA.biRSSigToASN1Sig(u,f)},this.sign=function(t,e,r){var n=e,i=this.ecparams.n,a=y.fromByteArrayUnsigned(t);do{var o=this.getBigRandom(i);r.hasOwnProperty("k")&&(o=new y(d.util.bytesToHex(r.k),16));var s=this.ecparams.G,u=s.multiply(o),f=u.getX().toBigInteger().mod(i)}while(f.compareTo(y.ZERO)<=0);var h=o.modInverse(i).multiply(a.add(n.multiply(f))).mod(i);return this.serializeSig(f,h)},this.verifyWithMessageHash=function(t,e){return this.verifyHex(t,e,this.pubKeyHex)},this.verifyHex=function(t,e,r){var n,i,a=d.ECDSA.parseSigHex(e);n=a.r,i=a.s;var o;o=g.decodeFromHex(this.ecparams.curve,r);var s=new y(t,16);return this.verifyRaw(s,n,i,o)},this.verify=function(t,e,r){var n,i;if(d.util.isArray(e)||d.util.isArrayBuffer){var a=this.parseSig(e);n=a.r,i=a.s}else{if("object"!=typeof e||!e.r||!e.s)throw"Invalid value for signature";n=e.r,i=e.s}var o;if(r instanceof g)o=r;else{if(!d.util.isArray(r)&&!d.util.isArrayBuffer(r))throw"Invalid format for pubkey value, must be byte array or ECPointFp";o=g.decodeFrom(this.ecparams.curve,r)}var s=y.fromByteArrayUnsigned(t);return this.verifyRaw(s,n,i,o)},this.verifyRaw=function(t,e,r,n){var i=this.ecparams.n,a=this.ecparams.G;if(e.compareTo(y.ONE)<0||e.compareTo(i)>=0)return!1;if(r.compareTo(y.ONE)<0||r.compareTo(i)>=0)return!1;var o=r.modInverse(i),s=t.multiply(o).mod(i),u=e.multiply(o).mod(i),f=a.multiply(s).add(n.multiply(u)),h=f.getX().toBigInteger().mod(i);return h.equals(e)},this.serializeSig=function(t,e){var r=t.toByteArraySigned(),n=e.toByteArraySigned(),i=[];return i.push(2),i.push(r.length),i=i.concat(r),i.push(2),i.push(n.length),i=i.concat(n),i.unshift(i.length),i.unshift(48),i},this.parseSig=function(t){var e;if(48!=t[0])throw new Error("Signature not a valid DERSequence");if(e=2,2!=t[e])throw new Error("First element in signature must be a DERInteger");var r=t.slice(e+2,e+2+t[e+1]);if(e+=2+t[e+1],2!=t[e])throw new Error("Second element in signature must be a DERInteger");var n=t.slice(e+2,e+2+t[e+1]);e+=2+t[e+1];var i=y.fromByteArrayUnsigned(r),a=y.fromByteArrayUnsigned(n);return{r:i,s:a}},this.parseSigCompact=function(t){if(65!==t.length)throw"Signature has the wrong length";var e=t[0]-27;if(e<0||e>7)throw"Invalid signature type";var r=this.ecparams.n,n=y.fromByteArrayUnsigned(t.slice(1,33)).mod(r),i=y.fromByteArrayUnsigned(t.slice(33,65)).mod(r);return{r:n,s:i,i:e}},this.readPKCS5PrvKeyHex=function(t){var e=ASN1HEX,r=d.ECDSA.getName,n=e.getVbyList;if(e.isASN1HEX(t)===!1)throw"not ASN.1 hex string";var i,a,o;try{i=n(t,0,[2,0],"06"),a=n(t,0,[1],"04");try{o=n(t,0,[3,0],"03").substr(2)}catch(t){}}catch(t){throw"malformed PKCS#1/5 plain ECC private key"}if(this.curveName=r(i),void 0===this.curveName)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(o),this.setPrivateKeyHex(a),this.isPublic=!1},this.readPKCS8PrvKeyHex=function(t){var e=ASN1HEX,r=d.ECDSA.getName,n=e.getVbyList;if(e.isASN1HEX(t)===!1)throw"not ASN.1 hex string";var i,a,o,s;try{i=n(t,0,[1,0],"06"),a=n(t,0,[1,1],"06"),o=n(t,0,[2,0,1],"04");try{s=n(t,0,[2,0,2,0],"03").substr(2)}catch(t){}}catch(t){throw"malformed PKCS#8 plain ECC private key"}if(this.curveName=r(a),void 0===this.curveName)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(s),this.setPrivateKeyHex(o),this.isPublic=!1},this.readPKCS8PubKeyHex=function(t){var e=ASN1HEX,r=d.ECDSA.getName,n=e.getVbyList;if(e.isASN1HEX(t)===!1)throw"not ASN.1 hex string";var i,a,o;try{i=n(t,0,[0,0],"06"),a=n(t,0,[0,1],"06"),o=n(t,0,[1],"03").substr(2)}catch(t){throw"malformed PKCS#8 ECC public key"}if(this.curveName=r(a),null===this.curveName)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(o)},this.readCertPubKeyHex=function(t,e){5!==e&&(e=6);var r=ASN1HEX,n=I.getName,i=r.getVbyList;if(r.isASN1HEX(t)===!1)throw"not ASN.1 hex string";var a,o;try{a=i(t,0,[0,e,0,1],"06"),o=i(t,0,[0,e,1],"03").substr(2)}catch(t){throw"malformed X.509 certificate ECC public key"}if(this.curveName=n(a),null===this.curveName)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(o)},void 0!==t&&void 0!==t.curve&&(this.curveName=t.curve),void 0===this.curveName&&(this.curveName=e),this.setNamedCurve(this.curveName),void 0!==t&&(void 0!==t.prv&&this.setPrivateKeyHex(t.prv),void 0!==t.pub&&this.setPublicKeyHex(t.pub))};I.parseSigHex=function(t){var e=d.ECDSA.parseSigHexInHexRS(t),r=new y(e.r,16),n=new y(e.s,16);return{r:r,s:n}},I.parseSigHexInHexRS=function(t){var e=ASN1HEX,r=e.getChildIdx,n=e.getV;if("30"!=t.substr(0,2))throw"signature is not a ASN.1 sequence";var i=r(t,0);if(2!=i.length)throw"number of signature ASN.1 sequence elements seem wrong";var a=i[0],o=i[1];if("02"!=t.substr(a,2))throw"1st item of sequene of signature is not ASN.1 integer";if("02"!=t.substr(o,2))throw"2nd item of sequene of signature is not ASN.1 integer";var s=n(t,a),u=n(t,o);return{r:s,s:u}},I.asn1SigToConcatSig=function(t){var e=d.ECDSA.parseSigHexInHexRS(t),r=e.r,n=e.s;if("00"==r.substr(0,2)&&r.length/2*8%128==8&&(r=r.substr(2)),"00"==n.substr(0,2)&&n.length/2*8%128==8&&(n=n.substr(2)),r.length/2*8%128!=0)throw"unknown ECDSA sig r length error";if(n.length/2*8%128!=0)throw"unknown ECDSA sig s length error";return r+n},I.concatSigToASN1Sig=function(t){if(t.length/2*8%128!=0)throw"unknown ECDSA concatinated r-s sig  length error";var e=t.substr(0,t.length/2),r=t.substr(t.length/2);return d.ECDSA.hexRSSigToASN1Sig(e,r)},I.hexRSSigToASN1Sig=function(t,e){var r=new y(t,16),n=new y(e,16);return d.ECDSA.biRSSigToASN1Sig(r,n)},I.biRSSigToASN1Sig=function(t,e){var r=KJUR.asn1,n=new r.DERInteger({bigint:t}),i=new r.DERInteger({bigint:e}),a=new r.DERSequence({array:[n,i]});return a.getEncodedHex()},I.getName=function(t){return"2a8648ce3d030107"===t?"secp256r1":"2b8104000a"===t?"secp256k1":"2b81040022"===t?"secp384r1":"|secp256r1|NIST P-256|P-256|prime256v1|".indexOf(t)!==-1?"secp256r1":"|secp256k1|".indexOf(t)!==-1?"secp256k1":"|secp384r1|NIST P-384|P-384|".indexOf(t)!==-1?"secp384r1":null};var T=[];d.ecdsa=new l,l.prototype.generateKeyPair=function(t,e){var r,n;return r=p(t),"undefined"==typeof e&&(e={}),n=r.generateKeyPairHex(e.privateKey),{privateKey:F.setECPrivateKey(t,new y(n.ecprvhex,16),new y(n.ecpubhex,16)),publicKey:F.setECPublicKey(t,new y(n.ecpubhex,16))}},l.prototype.sign=function(t,e,r,n){var i,a,o=n||{};if(i=p(t.namedCurve),!i)throw"not supported curve";e=d.crypto.util.stringToArray(e),a=i.sign(e,t.d,o),a=d.crypto.util.arrayToString(a),r(a)},l.prototype.verify=function(t,e,r,n){var i,a,o=n||{};if(i=p(r.namedCurve),!i)throw"not supported curve";return t=d.crypto.util.stringToArray(t),e=d.crypto.util.stringToArray(e),r=r.Q.toByteArrayUnsigned(),a=i.verify(t,e,r,o)},t.exports=d.ecdsa},function(t,e,r){function n(t,e,r){var n,i,a=0,o=8*r.digestLength,s=e/o,u=e%o,h=0;for(r.start(),t=f.util.hexToBytes(t.toRadix(16));0==t.charCodeAt(h);)++h;for(i=c.ZERO,a=0;a<=s;++a)r.update(t,h,t.length-h),r.update(String.fromCharCode(a)),n=r.digest(),n=n.getBytes(),V_i=new c(n,256),V_i.signum()<0&&(V_i=V_i.negate()),a==s&&(mod=c.ZERO.setBit(u),V_i=V_i.mod(mod)),0!=a&&(mod=c.ZERO.setBit(a*o),V_i=V_i.mod(mod)),i=i.add(V_i);return i}function i(t,e,r){for(var i;;)if(i=f.random.getBytes(t/8),i=new c(i,256),i.setBit(t),!(i.bitLength()<e.bitLength()))break;return KSEED=n(new c(f.random.getBytes(t/8),256),t,r),{KKEY:i,KSEED:KSEED}}function a(t,e){var r,a,o,s=t.bitLength(),u={};switch(s){case 224:r=f.md.sha224.create();break;case 256:r=f.md.sha256.create();break;default:throw"not supported parameter Q length:"+s}if(e.hasOwnProperty("KKEY")&&e.hasOwnProperty("KSEED"))u.KKEY=e.KKEY,u.KSEED=e.KSEED,a=new c(u.KKEY,256),o=new c(u.KSEED,256);else{var h=i(s,t,r);a=h.KKEY,o=h.KSEED}var p,l,d=a.add(o),y=c.ZERO.setBit(s);return f.consoleLog,f.consoleLog,d=d.mod(y),f.consoleLog,p=n(d,s,r),f.consoleLog,p=p.mod(t),f.consoleLog,l=n(p.add(o.mod(y)),s,r),a=a.add(l.mod(y)),p}function o(t,e){return e=parseInt(e/8),t.substring(t.length-e)}function s(t,e){var r=t.modInverse(e.Q);return e.G.modPow(r,e.P)}function u(){this.KKEY=null,this.KSEED=null}var f=r(1),h=f.asn1,c=f.jsbn.BigInteger;u.prototype.encodeRS=function(t,e){var r,n=[],i=[];return n=String.fromCharCode(0)+t.R.toBinary(e),i=t.S.toBinary(),i.charCodeAt(0)>128&&(i=String.fromCharCode(0)+i),r=h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.BITSTRING,!1,n),h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,i)]),r=h.toDer(r),r.getBytes()},u.prototype.decodeRS=function(t){var e={};return t=f.asn1.fromDer(t),e.R=new c(t.value[0].value.substring(1),256),e.S=new c(t.value[1].value,256),e},u.prototype.sign=function(t,e,r,n){var i,u,h,p,l,d,y,g=0,F=n.digest;y=8*F.blockLength,i=t.params.P,u=t.params.Q,h=t.params.G,g=u.bitLength();var v=a(u,n),m=h.modPow(v,i);l=m.toBinary(),d=0,F.start(),F.update(l,d,l.length-d),p=F.digest().getBytes(),f.consoleLog,p=o(p,g),f.consoleLog,Y=s(t.X,t.params),f.consoleLog,l=f.util.hexToBytes(Y.toRadix(16)),d=l.length-y/8,l=l.substr(d),f.consoleLog,F.start(),F.update(l,0,l.length),F.update(e,0,e.length),H=F.digest().getBytes(),f.consoleLog,H=o(H,g),f.consoleLog,p=new c(p,256),p.signum()<0&&(p=p.negate()),H=new c(H,256),H.signum()<0&&(H=H.negate());var B=p.xor(H);E=B.mod(u),f.consoleLog,S=v.subtract(E).multiply(t.X).mod(u),f.consoleLog,RS={R:p,S:S},r(RS)},u.prototype.verify=function(t,e,r,n,i){var a,s,u,h,p,l,d,y,g,F,v=n.digest;if(a=t.params.P,s=t.params.Q,u=t.params.G,p=8*v.blockLength,h=s.bitLength(),p>h){if(h/8!=parseInt((r.R.bitLength()+7)/8))return void i(!1)}else if(p/8!=parseInt((r.R.bitLength()+7)/8))return void i(!1);return c.ZERO.max(r.S)!=r.S||r.S.max(s)!=s?void i(!1):(l=Y.toRadix(16),l=f.util.hexToBytes(l),l=l.substr(l.length-parseInt(p/8)),f.consoleLog,v.start(),v.update(l),v.update(e),y=v.digest().getBytes(),y=o(y,h),y=new c(y,256),f.consoleLog,g=r.R.xor(y).mod(s),f.consoleLog,F=Y.modPow(r.S,a),F=F.multiply(u.modPow(g,a)),F=F.mod(a),f.consoleLog,l=F.toRadix(16),l=f.util.hexToBytes(l),v.start(),v.update(l),l=v.digest().getBytes(),f.consoleLog,l=o(l,h),f.consoleLog,d=new c(l,256),0!=r.R.compareTo(d)?void i(!1):void i(!0))},f.kcdsa=new u,t.exports=f.kcdsa},function(t,e,r){function n(t){var e=t.toString(16);return e[0]>="8"&&(e="00"+e),s.util.hexToBytes(e)}function i(t,e){var r=s.util.createBuffer(t.publicKeyModulus).toHex(),n=s.util.createBuffer(t.publicKeyExponent).toHex();return u.setRsaPublicKey(new h(r,16),new h(n,16),e)}function a(t,e){var r=s.util.createBuffer(t.y).toHex(),n=[];if(!f.validate(e,l,t,n))throw{message:"Cannot read public key parameter. ASN.1 object does not contain an KCDSAPublicKey Parameter.",errors:n};var i=s.util.createBuffer(t.P).toHex(),a=s.util.createBuffer(t.Q).toHex(),o=s.util.createBuffer(t.G).toHex();return u.setKcdsaPublicKey(new h(r,16),new h(i,16),new h(a,16),new h(o,16))}function o(t,e){var r=s.util.createBuffer(t.q).toHex();if(e.type==f.Type.OID){var n=f.derToOid(e.value);return n=u.oids[n],u.setECPublicKey(n,new h(r,16))}throw{message:"not implemented choice, only support oid type"}}var s=r(1),u=s.pki,f=s.asn1,h=s.jsbn.BigInteger,c={name:"RSAPublicKey",tagClass:f.Class.UNIVERSAL,type:f.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:f.Class.UNIVERSAL,type:f.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:f.Class.UNIVERSAL,type:f.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},p={name:"KCDSAPublicKey",tagClass:f.Class.UNIVERSAL,type:f.Type.INTEGER,constructed:!1,capture:"y"},l={name:"KCDSAParameter",tagClass:f.Class.UNIVERSAL,type:f.Type.SEQUENCE,constructed:!0,value:[{name:"KCDSAParameter.P",tagClass:f.Class.UNIVERSAL,type:f.Type.INTEGER,constructed:!1,capture:"P"},{name:"KCDSAParameter.Q",tagClass:f.Class.UNIVERSAL,type:f.Type.INTEGER,constructed:!1,capture:"Q"},{name:"KCDSAParameter.G",tagClass:f.Class.UNIVERSAL,type:f.Type.INTEGER,constructed:!1,capture:"G"}]},d={name:"ECDSAPublicKey",tagClass:f.Class.UNIVERSAL,type:f.Type.OCTETSTRING,construncted:!0,capture:"q"},y={name:"SubjectPublicKeyInfo",tagClass:f.Class.UNIVERSAL,type:f.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:f.Class.UNIVERSAL,type:f.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:f.Class.UNIVERSAL,type:f.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:f.Class.UNIVERSAL,type:f.Type.BITSTRING,constructed:!1,capture:"publicKey"}]};u.publicKeyValidator=y,u.publicKeyFromAsn1=function(t,e,r){var n,s,h,l={},g=[];if(e)e==u.oids.rsaEncryption&&(s=c);else{if(!f.validate(t,y,l,g))throw{message:"can not read public key.",errors:g};var e=f.derToOid(l.publicKeyOid);switch(e){case u.oids.rsaEncryption:s=c;break;case u.oids.kcdsa:s=p;break;case u.oids.ecdsa:s=d;break;default:throw{message:"Cannot read public key. Unknown OID.",oid:e}}t.value[0].value.length>1&&(n=t.value[0].value[1]),h=l.publicKey.substring(1)}if(s==d)l.q=h;else{var F=h?f.fromDer(h):t;if(g=[],!f.validate(F,s,l,g))throw{message:"Cannot read public key. ASN.1 object does not contain an ECPublicKey.",errors:g}}switch(s){default:case c:return i(l,n);case p:return a(l,n);case d:return o(l,n)}},u.setECPublicKey=function(t,e){var r={};return r.oid=u.oids.ecdsa,r.type="public",r.namedCurve=t,e instanceof h?r.Q=e:r.Q=new h(s.util.bytesToHex(e),16),r},u.setKCDSAPublicKey=function(t,e,r,n,i,a){function o(){this.oid=s.pki.oids.kcdsa,this.type="public",this.params={}}var u=new o;if("undefined"==typeof t||"undefined"==typeof e||"undefined"==typeof r||"undefined"==typeof n)throw"need mandatory parameters (Y, P, Q, G)";return t instanceof h?u.Y=t:u.Y=new h(t,256),e instanceof h?u.params.P=e:u.params.P=new h(e,256),r instanceof h?u.params.Q=r:u.params.Q=new h(r,256),n instanceof h?u.params.G=n:u.params.G=new h(n,256),i&&(i instanceof h?u.params.J=i:u.params.J=new h(i,256)),a&&(u.params.validation=a),u},u.publicKeyToAsn1=u.publicKeyToSubjectPublicKeyInfo=function(t){var e,r,i;switch(t.oid){case u.oids.rsaEncryption:i=f.create(f.Class.UNIVERSAL,f.Type.NULL,!1,""),r=f.create(f.Class.UNIVERSAL,f.Type.BITSTRING,!1,String.fromCharCode(0)+f.toDer(u.publicKeyToRSAPublicKey(t)).bytes());break;case u.oids.kcdsa:i=f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[]),i.value.push(f.create(f.Class.UNIVERSAL,f.Type.INTEGER,!1,n(t.params.P))),i.value.push(f.create(f.Class.UNIVERSAL,f.Type.INTEGER,!1,n(t.params.Q))),i.value.push(f.create(f.Class.UNIVERSAL,f.Type.INTEGER,!1,n(t.params.G))),r=f.create(f.Class.UNIVERSAL,f.Type.BITSTRING,!1,String.fromCharCode(0)+f.toDer(u.publicKeyToKCDSAPublicKey(t)).bytes());break;case u.oids.ecdsa:i=f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(s.pki.oids.secp256r1).getBytes()),r=f.create(f.Class.UNIVERSAL,f.Type.BITSTRING,!1,String.fromCharCode(0)+u.publicKeyToECPublicKey(t));break;default:throw"unknown public key oid:"+t.oid}return e=f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(t.oid).getBytes()),i])]),e.value.push(r),e},u.publicKeyFromRSAPublicKeyAsn1=function(t){var e=i(t);f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.INTEGER,!1,n(e.n)),f.create(f.Class.UNIVERSAL,f.Type.INTEGER,!1,n(e.e))])},u.publicKeyToRSAPublicKey=function(t){return f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.INTEGER,!1,n(t.n)),f.create(f.Class.UNIVERSAL,f.Type.INTEGER,!1,n(t.e))])},u.publicKeyToKCDSAPublicKey=function(t){return f.create(f.Class.UNIVERSAL,f.Type.INTEGER,!1,n(t.y))},u.publicKeyToECPublicKey=function(t){return n(t.Q)},t.exports=u},function(t,e,r){function n(t){var e=t.toString(16);return e[0]>="8"&&(e="00"+e),s.util.hexToBytes(e)}function i(t,e){var r={},n=[];if(!f.validate(t,p,r,n))throw{message:"Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.",errors:n};var i,a,o,c,l,d,y,g;return i=s.util.createBuffer(r.privateKeyModulus).toHex(),a=s.util.createBuffer(r.privateKeyPublicExponent).toHex(),o=s.util.createBuffer(r.privateKeyPrivateExponent).toHex(),c=s.util.createBuffer(r.privateKeyPrime1).toHex(),l=s.util.createBuffer(r.privateKeyPrime2).toHex(),d=s.util.createBuffer(r.privateKeyExponent1).toHex(),y=s.util.createBuffer(r.privateKeyExponent2).toHex(),g=s.util.createBuffer(r.privateKeyCoefficient).toHex(),u.setRsaPrivateKey(new h(i,16),new h(a,16),new h(o,16),new h(c,16),new h(l,16),new h(d,16),new h(y,16),new h(g,16))}function a(t){if(1!=f.derToInteger(t.privateKeyVersion))throw"unknown ecprivatekey version";var e=f.derToOid(t.namedCurve);switch(e=u.oids[e]){case"secp256r1":e="P-256";break;default:throw"not implemented curve name:"+e}return u.setECPrivateKey(e,t.privateKey)}function o(t,e){var r,n,i,a,o,s;return r=new h(t.value,256),n=new h(e[0].value,256),i=new h(e[1].value,256),a=new h(e[2].value,256),e.length>3,u.setKCDSAPrivateKey(r,n,i,a,o,s)}var s=r(1),u=s.pki,f=s.asn1,h=s.jsbn.BigInteger,c={name:"PrivateKeyInfo",tagClass:f.Class.UNIVERSAL,type:f.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:f.Class.UNIVERSAL,type:f.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:f.Class.UNIVERSAL,type:f.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:f.Class.UNIVERSAL,type:f.Type.OID,constructed:!1,capture:"privateKeyOid"},{name:"AlgorithmIdentifier.parameter",tagClass:f.Class.UNIVERSAL,type:f.Type.ANY,constructed:!1,capture:"keyParameter",optional:!0}]},{name:"PrivateKeyInfo",tagClass:f.Class.UNIVERSAL,type:f.Type.OCTETSTRING,constructed:!1,capture:"privateKey"},{name:"PrivateKeyInfo.attributes",tagClass:f.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,captureAsn1:"attributes",optional:!0}]},p={name:"RSAPrivateKey",tagClass:f.Class.UNIVERSAL,type:f.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:f.Class.UNIVERSAL,type:f.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:f.Class.UNIVERSAL,type:f.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:f.Class.UNIVERSAL,type:f.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:f.Class.UNIVERSAL,type:f.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:f.Class.UNIVERSAL,type:f.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:f.Class.UNIVERSAL,type:f.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:f.Class.UNIVERSAL,type:f.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:f.Class.UNIVERSAL,type:f.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:f.Class.UNIVERSAL,type:f.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},l={name:"ECPrivateKey",tagClass:f.Class.UNIVERSAL,type:f.Type.SEQUENCE,constructed:!0,value:[{name:"ECPrivateKey.version",tagClass:f.Class.UNIVERSAL,type:f.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"ECPrivateKey.privateKey",tagClass:f.Class.UNIVERSAL,type:f.Type.OCTETSTRING,constructed:!1,capture:"privateKey"},{name:"ECPrivateKey.parameters",tagClass:f.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"ECPrivateKey.namedCurve",tagClass:f.Class.UNIVERSAL,type:f.Type.OID,capture:"namedCurve"}]},{name:"ECPrivateKey.publicKey",tagClass:f.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"ECPrivateKey.publicKey",tagClass:f.Class.UNIVERSAL,type:f.Type.BITSTRING,capture:"publicKey"}]}]};u.privateKeyToAsn1=function(t){switch(t.oid){case s.pki.oids.rsaEncryption:return u.privateKeyToRSAPrivateKey(t);case s.pki.oids.ecdsa:return u.privateKeyToECPrivateKey(t);default:throw"not implemented oid:"+t.oid}},u.privateKeyToRSAPrivateKey=function(t){return f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.INTEGER,!1,f.integerToDer(0).getBytes()),f.create(f.Class.UNIVERSAL,f.Type.INTEGER,!1,n(t.n)),f.create(f.Class.UNIVERSAL,f.Type.INTEGER,!1,n(t.e)),f.create(f.Class.UNIVERSAL,f.Type.INTEGER,!1,n(t.d)),f.create(f.Class.UNIVERSAL,f.Type.INTEGER,!1,n(t.p)),f.create(f.Class.UNIVERSAL,f.Type.INTEGER,!1,n(t.q)),f.create(f.Class.UNIVERSAL,f.Type.INTEGER,!1,n(t.dP)),f.create(f.Class.UNIVERSAL,f.Type.INTEGER,!1,n(t.dQ)),f.create(f.Class.UNIVERSAL,f.Type.INTEGER,!1,n(t.qInv))])},u.privateKeyToECPrivateKey=function(t){var e,r,i,a;switch(t.namedCurve){default:case"P-256":i="secp256r1"}return i=u.oids[i],r=f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(i).getBytes()),t.hasOwnProperty("Q")&&(e=f.create(f.Class.UNIVERSAL,f.Type.BITSTRING,!1,String.fromCharCode(0)+n(t.Q))),a=f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.INTEGER,!1,f.integerToDer(1)),f.create(f.Class.UNIVERSAL,f.Type.OCTETSTRING,!1,n(t.d)),f.create(f.Class.CONTEXT_SPECIFIC,0,!0,[r]),e?f.create(f.Class.CONTEXT_SPECIFIC,1,!0,[e]):void 0])},u.setECPrivateKey=function(t,e,r){var n={};return n.oid=s.pki.oids.ecdsa,n.type="private",n.namedCurve=t,e instanceof h?n.d=e:n.d=new h(s.util.bytesToHex(e),16),r instanceof h?n.Q=r:n.Q=new h(s.util.bytesToHex(r),16),n},u.setKCDSAPrivateKey=function(t,e,r,n,i,a){var o={};if("undefined"==typeof t||"undefined"==typeof e||"undefined"==typeof r||"undefined"==typeof n)throw"need mandatory parameters (X, P, Q, G)";return o.oid=s.pki.oids.kcdsa,o.type="private",o.params={},t instanceof h?o.X=t:o.X=new h(t,256),e instanceof h?o.params.P=e:o.params.P=new h(e,256),r instanceof h?o.params.Q=r:o.params.Q=new h(r,256),n instanceof h?o.params.G=n:o.params.G=new h(n,256),i&&(i instanceof h?o.params.J=i:o.params.J=new h(i,256)),a&&(o.params.validation=a),o},u.privateKeyFromAsn1=function(t,e,r){var n={},u=[];return e==s.oids.kcdsa?o(t,r):(f.validate(t,c,n,u)&&(t=f.fromDer(s.util.createBuffer(n.privateKey)),"undefined"==typeof e&&n.privateKeyOid&&(e=f.derToOid(n.privateKeyOid)),n.keyParameter&&!r&&(r=n.keyParameter)),u=[],n=[],f.validate(t,l,n,u)?a(n):i(t,e))},t.exports=u},function(t,e,r){var n=r(1),i=(r(36),r(37)),a=r(38),o=n.getSettings(),s=o.subtle,u=function(t,e,r){return t.then?t.then(e,r):(t.onerror=r,t.oncomplete=function(){1==arguments.length&&arguments[0]instanceof Event&&(arguments[0]=arguments[0].target.result),e.apply(this,arguments)},t)};n.Promise=u,n.crypto.key=function(t,e,r){function s(t,e,r,o){var s,u=0;if(n.consoleLog,n.consoleLog,e.hasOwnProperty("saltLength")?u=e.saltLength:(u=32,"RSA-PSS"===e.name&&(e.saltLength=u)),n.consoleLog,e.hash.hasOwnProperty("parameter")&&(s=e.hash.parameter),n.useWebCrypto&&t.webcrypto){if("undefined"!=typeof s)return void o(new n.error("webcrypto object does not support sign with parameter"));i.sign(t.raw,e,r,function(t){return t instanceof n.error?void o(t):void o(t)})}else a.sign(t.raw,e,r,function(t){return t instanceof n.error?void o(t):void o(t)})}function u(t,e,r,a,o){var s,u=0;if(n.consoleLog,s=n.md.algorithms[e.hash.name.replace("-","").toLowerCase()],e.hasOwnProperty("saltLength")?u=e.saltLength:(u=32,"RSA-PSS"===e.name&&(e.saltLength=u)),n.consoleLog,n.useWebCrypto&&t.webcrypto)return void i.verify(t.raw,e,r,a,o);var f,h=s.create();if(n.consoleLog,n.consoleLog,e.inputTypeDigestInfo){var c=n.asn1.fromDer(a);f=c.value[1].value}else h=n.md.algorithms[e.hash.name.replace("-","").toLowerCase()].create(),h.update(a),f=h.digest().getBytes();n.consoleLog;try{var p;"RSA-PSS"===e.name&&(p=n.pss.create(h,n.mgf.mgf1.create(s.create()),u));var l=t.raw.verify(f,r,p)}catch(t){return n.consoleLog,void o(new n.error(t.message?t.message:t))}o(l)}function f(t,e,r,i,a){var o,s,u=!1;"RAW"!==e.hash?(o=n.md.algorithms[e.hash.name.replace("-","").toLowerCase()],o=o.create(),o.update(i),s=o.digest().getBytes()):s=i,u=n.ecdsa.verify(s,r,t.raw),a(u)}function h(t,e,r,i,a){var o,s={};if("RAW"===e.hash)throw"not supported hash algorithm raw";o=n.md.algorithms[e.hash.name.replace("-","").toLowerCase()],s.digest=o.create(),r=n.kcdsa.decodeRS(r),n.kcdsa.verify(t.raw,i,r,s,function(t){a(t)})}if("undefined"!=typeof t){var c,p=0;if(this.raw=t,this.type=e,this.webcrypto=!("undefined"==typeof r||!r),this.webcrypto)"undefined"==typeof e&&"type"in t&&(this.type=t.type);else switch(t.oid){case n.pki.oids.rsaEncryption:if(c="RSA",!t.hasOwnProperty("n")||!t.hasOwnProperty("e"))throw new n.error("bad rsa publickey");t.hasOwnProperty("p")&&t.hasOwnProperty("q")?this.type="private":this.type="public",p=t.n.bitLength();break;case n.pki.oids.kcdsa:c="KCDSA",p=t.params.P.bitLength(),t.hasOwnProperty("y")?this.type="public":this.type="private";break;case n.pki.oids.ecdsa:c="ECDSA",this.namedCurve=t.namedCurve,t.hasOwnProperty("type")&&(this.type=t.type);break;default:throw new n.error("not supported key")}this.getKeyAlgorithm=function(){return c},this.getKeySize=function(){return p},this.encrypt=function(t,e,r){var o,s;if("undefined"!=typeof e&&"RSA-OAEP"===e.name&&(o="RSA-OAEP","label"in e))throw new n.error("not supported OAEP label");return n.useWebCrypto&&this.webcrypto?void(this.raw.extractable?i.exportKeyInfo.call(this,function(e){return e=n.pki.publicKeyFromAsn1(n.asn1.fromDer(e)),a.encrypt(e,t,o,s,r)}):i.encrypt.apply(this,arguments)):a.encrypt(this.raw,t,o,s,r)},this.decrypt=function(t,e,r){var i,a,o;if("undefined"!=typeof e&&"RSA-OAEP"===e.name&&(a="RSA-OAEP","label"in e))throw new n.error("not supported OAEP label");if(n.useWebCrypto&&this.webcrypto){if(this.raw.extractable)return void this.exportKeyInfo(function(e){e=n.pki.privateKeyFromAsn1(n.asn1.fromDer(e)),i=e.decrypt(t,a,o),r(i)});throw new yt.error("need extractable webcrypto key.")}try{i=this.raw.decrypt(t,a,o)}catch(t){if(r)return void r(new n.error(t))}return"undefined"==typeof r?i:void r(i)},this.sign=function(t,e,r,i){if("private"!==this.type)return void r(new n.error("publicKey can not sign a data"));if(t.name.indexOf("RSA")!=-1)return void s(this,t,e,r);if("ECDSA"==t.name)return void a.signECDSA(this.raw,t,e,r,i);
if("KCDSA"==t.name)return void a.signKCDSA(this.raw,t,e,r,i);throw"unknown algorithm:"+t.name},this.verify=function(t,e,r,i){return"public"!==this.type?void i(new n.error("privateKey can not verify a signature")):void(t.name.indexOf("RSA")!=-1?u(this,t,e,r,i):"ECDSA"==t.name?f(this,t,e,r,i):"KCDSA"==t.name&&h(this,t,e,r,i))},this.exportKeyInfo=function(t,e){function r(r,i){var a,o;if(i.hasOwnProperty("namedCurve")&&(a=n.asn1.oidToDer(n.pki.oids.secp256r1).getBytes()),"public"==r){if(o=n.pki.publicKeyToAsn1(i),e.rawPublicKey){var s;return n.consoleLog,s=o.value[1].value.substring(1),void t(s,a)}}else"private"==r&&(o=n.pki.privateKeyToAsn1(i));t(n.asn1.toDer(o).getBytes(),a)}var a=this;if(e=e||{},n.useWebCrypto===!1||this.webcrypto===!1)return void r(this.type,this.raw);var s="";s="public"==this.type?o.exportWebCryptoPublicKeyMethod:o.exportWebCryptoPrivateKeyMethod,i.exportKey(this.raw,s,function(e){return e instanceof n.error?void t(e):void r(a.type,e)})}}},n.crypto.key.fromBytes=function(t,e,r,o){var u,f,h="public",c=!0;"undefined"==typeof r&&(r={}),c=r.autoImport,f=n.asn1.fromDer(t);try{u=n.pki.privateKeyFromAsn1(f,o),h="private"}catch(t){try{u=r.RSAPublicKey?n.pki.publicKeyFromAsn1(f,n.oids.rsaEncryption,null):n.pki.publicKeyFromAsn1(f),h="public"}catch(t){return n.consoleLog,void e(new n.error("알수 없는 키 입니다:"+JSON.stringify(t)))}}switch("undefined"==typeof o&&(o=u.oid),o){case n.pki.oids.kcdsa:break;case n.pki.oids.ecdsa:break;case n.pki.oids.rsaEncryption:default:if(n.useWebCrypto&&c&&s)return void i.keyFromAsn1(u,h,r,e)}a.keyFromAsn1(o,u,h,r,e)},n.crypto.key.fromString=function(t,e){return n.crypto.key.fromBytes(n.util.hexToBytes(t),e)},n.crypto.generateKey=function(t,e,r,a){var o,u;if(n.crypto.handlers.generateKey)return void n.crypto.handlers.generateKey(t,e,r,a);if(n.useWebCrypto&&s&&t.webcrypto&&"ECDSA"!=t.name)return void i.generateKey(t,e,r,a);var f;if(t.name.indexOf("RSA")!=-1)f=n.rsa.generateKeyPair(t.modulusLength,"undefined"!=typeof t.publicExponent?t.publicExponent:65537);else{if("ECDSA"!=t.name)throw"unsupported algorithm name:"+t.name;f=n.ecdsa.generateKeyPair(t.namedCurve,t.options)}n.consoleLog,o=new n.crypto.key(f.publicKey,"public"),u=new n.crypto.key(f.privateKey,"private"),a({publicKey:o,privateKey:u})},t.exports=n.crypto.key},function(t,e,r){function n(t){return t=o.crypto.util.decode64url(t),new o.jsbn.BigInteger(t,256)}function i(t){var e;return e=t.toString(16),o.crypto.util.encode64url(o.util.hexToBytes(e))}function a(){}var o=r(1);a.prototype.encode=function(t,e){var r={};return r.kty="RSA",r.alg="RS256","RSA-PSS"==t&&(r.alg="PS256"),r.n=i(e.n),r.e=i(e.e),e.hasOwnProperty("d")&&(r.d=i(e.d),r.p=i(e.p),r.q=i(e.q),r.dp=i(e.dP),r.dq=i(e.dQ),r.qi=i(e.qInv)),r},a.prototype.decode=function(t){return t.hasOwnProperty("d")===!1?o.pki.setRsaPublicKey(n(t.n),n(t.e)):o.pki.setRsaPrivateKey(n(t.n),n(t.e),n(t.d),n(t.p),n(t.q),n(t.dp),n(t.dq),n(t.qi))},t.exports=new a},function(t,e,r){function n(t,e,r,n){plain=o.crypto.util.stringToArrayBuffer(r),o.consoleLog,c(h.sign(e,t,plain.buffer),function(t){o.consoleLog,n(o.crypto.util.arrayBufferToString(t))},function(t){o.consoleLog,n(new o.error(t))})}function i(t,e,r,n,i){n=o.crypto.util.hexToArrayBuffer(o.util.bytesToHex(n)),r=o.crypto.util.hexToArrayBuffer(o.util.bytesToHex(r)),c(h.verify(e,t,r,n),function(t){o.consoleLog,i(t)},function(t){o.consoleLog,i(new o.error(t))})}function a(t,e,r){function n(t){o.consoleLog,r(new o.error(t))}function i(t){var n=t,i=null;if(f.wrapWebCryptoArrayBuffer){if(n=o.crypto.util.arrayBufferToString(t),"jwk"==e)try{i=JSON.parse(n)}catch(t){o.consoleLog}}else"jwk"==e&&(i=n);null!=i&&(n=s.decode(i)),r(n)}try{c(h.exportKey(e,t),i,n)}catch(t){n(t)}}var o=r(1),s=r(36),u={},f=o.getSettings(),h=f.subtle,c=function(t,e,r){return t.then?t.then(e,r):(t.onerror=r,t.oncomplete=function(){1==arguments.length&&arguments[0]instanceof Event&&(arguments[0]=arguments[0].target.result),e.apply(this,arguments)},t)};u.sign=n,u.verify=i,u.encrypt=function(t,e,r){t=o.crypto.util.stringToArrayBuffer(t),c(h.encrypt(e,this.raw,t),function(t){o.consoleLog,r(o.crypto.util.arrayBufferToString(t))},function(t){o.consoleLog,r(new o.error(t))})},u.generateKey=function(t,e,r,n){try{c(h.generateKey(t,e,r),function(t){publicKey=new o.crypto.key(t.publicKey,"public",!0),privateKey=new o.crypto.key(t.privateKey,"private",!0),o.consoleLog,n({publicKey:publicKey,privateKey:privateKey})},function(e){t===e&&(o.consoleLog,e="Unsupported Algorithm or Keysize(maybe)"),n(new o.error(e))})}catch(t){o.consoleLog,o.consoleLog,n(new o.error(t))}},u.exportKey=a,u.keyFromAsn1=function(t,e,r,n){function i(t,r,n){var i;switch(f.importWebCryptoPrivateKeyMethod){case"pkcs8":i=o.crypto.util.stringToArrayBuffer(r),keyFormat="pkcs8";break;case"jwk":var a=s.encode(t,_key);keyFormat="jwk",f.wrapWebCryptoArrayBuffer?(a=JSON.stringify(a),i=o.crypto.util.stringToArrayBuffer(a)):i=a;break;default:return void n(new o.error("not supported importKey method:"+f.importWebCryptoPrivateKeyMethod))}c(h.importKey(keyFormat,i,algs,extractable,keyUsage),function(t){n(new o.crypto.key(t,e,!0))},function(t){o.consoleLog,n(new o.error(t))})}if("private"==e)_key=t,asn=o.pki.privateKeyToAsn1(t),keyFormat="pkcs8",extractable=!1,forSigning?keyUsage.push("sign"):keyUsage.push("decrypt");else try{asn=o.pki.publicKeyToAsn1(t),_key=o.pki.publicKeyFromAsn1(asn),keyFormat="spki",forSigning?keyUsage.push("verify"):keyUsage.push("encrypt")}catch(t){return void n(new o.error("알수 없는 키 입니다:"+t))}_bytes=o.asn1.toDer(asn).getBytes(),i(algorithm,_bytes,n)},t.exports=u},function(t,e,r){function n(t,e,r,n){var i=r.algorithm,a={hash:{name:"SHA-256"}},s=!0;switch("undefined"==typeof i&&(i="RSASSA-PKCS1-v1_5"),i){case"RSA-PSS":a.name="RSA-PSS",a.saltLength=r.saltLength||32,s=!0;break;case"RSASSA-PKCS1-v1_5":a.name="RSASSA-PKCS1-v1_5",s=!0;break;case"RSAES-PKCS1-v1_5":a.name="RSAES-PKCS1-v1_5",s=!1;break;case"RSAES-OAEP":a.name="RSAES_OAEP",s=!1;break;default:return void n(new o.error("not supported algorithm for cms signing:"+i))}n(new o.crypto.key(t,e))}function i(t,e,r,n){r(new o.crypto.key(t,e))}function a(t,e,r){r(new o.crypto.key(t,e))}var o=r(1),s={};s.encrypt=function(t,e,r,n,i){return cipher=t.encrypt(e,r,n),"undefined"==typeof i?cipher:void i(cipher)},s.signECDSA=function(t,e,r,n,i){var a,s;"RAW"!==e.hash?(a=o.md.algorithms[e.hash.name.replace("-","").toLowerCase()],a=a.create(),a.update(r),s=a.digest().getBytes()):s=r,o.ecdsa.sign(t,s,n,i)},s.signKCDSA=function(t,e,r,n,i){var a,s={};if("RAW"===e.hash)throw"not supported hash";a=o.md.algorithms[e.hash.name.replace("-","").toLowerCase()],s.digest=a.create(),o.kcdsa.sign(t,r,function(t){t=o.kcdsa.encodeRS(t,self.raw.params.Q.bitLength()/8),n(t)},s)},s.sign=function(t,e,r,n){var i,a,s,u;e.inputTypeDigestInfo?(a=r,u=null):"RAW"!==e.hash?(i=o.md.algorithms[e.hash.name.replace("-","").toLowerCase()],a=i.create(),a.update(r),o.consoleLog,"undefined"!=typeof e.hash.parameter&&(a.parameter=e.hash.parameter),"RSA-PSS"===e.name&&(u=o.pss.create(a,o.mgf.mgf1.create(i.create()),e.saltLength))):a={algorithm:"RAW",digest:function(){return new ByteBuffer(r)}},s=t.sign(a,u),o.consoleLog,n(s)},s.keyFromAsn1=function(t,e,r,s,u){switch(t){case o.pki.oids.rsaEncryption:return n(e,r,s,u);case o.pki.oids.kcdsa:return i(e,r,u);case o.pki.oids.ecdsa:return a(e,r,u)}},t.exports=s},function(t,e,r){var n=r(1),i=n.hmac=n.hmac||{};i.create=function(){var t=null,e=null,r=null,i=null,a={};return a.start=function(a,o){if(null!==a)if("string"==typeof a){if(a=a.toLowerCase(),!(a in n.md.algorithms))throw'Unknown hash algorithm "'+a+'"';e=n.md.algorithms[a].create()}else e=a;if(null===o)o=t;else{if("string"==typeof o)o=n.util.createBuffer(o);else if(n.util.isArray(o)){var s=o;o=n.util.createBuffer();for(var u=0;u<s.length;++u)o.putByte(s[u])}var f=o.length();f>e.blockLength&&(e.start(),e.update(o.bytes()),o=e.digest()),r=n.util.createBuffer(),i=n.util.createBuffer(),f=o.length();for(var u=0;u<f;++u){var s=o.at(u);r.putByte(54^s),i.putByte(92^s)}if(f<e.blockLength)for(var s=e.blockLength-f,u=0;u<s;++u)r.putByte(54),i.putByte(92);t=o,r=r.bytes(),i=i.bytes()}e.start(),e.update(r)},a.update=function(t){e.update(t)},a.getMac=function(){var t=e.digest().bytes();return e.start(),e.update(i),e.update(t),e.digest()},a.digest=a.getMac,a},t.exports=i}]);