!function(e){function t(a){if(r[a])return r[a].exports;var n=r[a]={exports:{},id:a,loaded:!1};return e[a].call(n.exports,n,n.exports,t),n.loaded=!0,n.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){window.ytcrypto=r(1),window.yt=r(40),e.exports=yt},function(e,t,r){function a(e){switch(e=e.toLowerCase()){case"seed":return n.seed;case"aes":return n.aes;case"des":return n.des;case"aria":return n.aria;default:throw"not supported blockCipher Algorithm:"+e}}var n={};n.getVersion=function(){return"2.8.8"},n.getLicense=function(){return"JSRose - Public Key Infrastructure & Cryptography ToolKit\nCopyright All rights reserved by YettieSoft(c).\n\nVersion - 2.8.8\nDate - 2022.5.25\n\nContributors\n - lovian@yettiesoft.com\n".split("\n")},n.error=function(e,t){void 0===t&&(t=e,e=void 0),this.code=e,this.reason=[t],this.getCode=function(){return this.code},this.getReason=function(){return this.reason},this.pushReason=function(e){this.reason.push(e)}},n.crypto=n.crypto||{},n.crypto.rsa={},n.crypto.blockCipher=function(e){this.cipher=e},n.crypto.blockCipher.prototype.start=function(e,t){return this.cipher.start(e,t)},n.crypto.blockCipher.prototype.update=function(e){return"string"==typeof e&&(e=n.util.createBuffer(e)),this.cipher.update(e)},n.crypto.blockCipher.prototype.output=null,n.crypto.blockCipher.prototype.finish=function(e){var t;return t=this.cipher.finish(e),this.output=this.cipher.output,t},n.crypto.blockCipher.createEncryptionCipher=function(e,t,r){var i;return i=a(e),new n.crypto.blockCipher(i.createEncryptionCipher(t,r))},n.crypto.blockCipher.createDecryptionCipher=function(e,t,r){var i;return i=a(e),new n.crypto.blockCipher(i.createDecryptionCipher(t,r))},n.crypto.random={},n.crypto.random.getBytes=function(e){return n.random.getBytesSync(e)},n.crypto.util={},"undefined"==typeof Uint8Array&&(Uint8Array=Array),n.crypto.util.stringToArray=function(e){var t;return e.split("").map(function(e){if(t=e.charCodeAt(0),t>255)throw"input string is non ascii string";return t})},n.crypto.util.stringToArrayBuffer=function(e){var t;return new Uint8Array(e.split("").map(function(e){if(t=e.charCodeAt(0),t>255)throw"input string is non ascii string";return t}))},n.crypto.util.hexToArrayBuffer=function(e){return new Uint8Array(e.match(/(..)/g).map(function(e){return parseInt(e,16)}))},n.crypto.util.arrayToString=function(e){return Array.prototype.map.call(e,function(e){return String.fromCharCode(e)}).join("")},n.crypto.util.arrayBufferToString=function(e){return Array.prototype.map.call(new Uint8Array(e),function(e){return String.fromCharCode(e)}).join("")},n.crypto.util.arrayBufferToHex=function(e){return Array.prototype.map.call(new Uint8Array(e),function(e){return("0"+e.toString(16)).slice(-2)}).join("")},n.crypto.util.encode64url=function(e){var t=n.util.encode64(e);return t=t.split("=")[0],t=t.replace(/\+/g,"-"),t=t.replace(/\//g,"_")},n.crypto.util.decode64url=function(e){switch(e=e.replace(/\-/g,"+"),e=e.replace(/\_/g,"/"),e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw new yt.error("illegal base64url string")}return e=n.util.decode64(e)},n.crypto.handlers={},n.crypto.setHandler=function(e,t){if("undefined"==typeof t)return void delete n.crypto.handlers[e];switch(e){case"generateKey":n.crypto.handlers[e]=t;break;default:throw"not supported handler - "+e}};var i={};i.create=function(){return{start:function(e,t){t.length>8&&(t=t.substring(0,8)),this._cipher=e.startEncrypting(n.util.createBuffer(t),n.util.hexToBytes("0000000000000000"))},update:function(e){"string"==typeof e&&(e=n.util.createBuffer(e)),this._cipher.update(e)},getMac:function(){var e,t;return this._cipher.finish(function(e,r,a){var n;return n=e-r.length()%e,r.fillWithByte(0,n),t=e,!0}),this._cipher.output.read=this._cipher.output.length()-t,e=this._cipher.output.getBytes(t),n.util.createBuffer(e)}}},n.cmac=i,e.exports=n,r(2),r(3),r(4),r(5),r(11),r(13),r(14),r(15),r(16),r(18),r(19),r(20),r(21),r(22),r(23),r(24),r(25),r(26),r(27),r(28),r(29),r(30),r(31),r(32),r(24),r(33),r(34),r(35),r(39)},function(e,t,r){function a(e,t){this.n=e||this.DEFAULT_LENGTH,this.taps=i[this.n],t||(t=this._defaultSeed(this.n));var r=parseInt(Array(this.n+1).join("1"),2);this.register=t&r}var n=r(1);n.base={};var i={2:[2,1],3:[3,2],4:[4,3],5:[5,3],6:[6,5],7:[7,6],8:[8,6,5,4],9:[9,5],10:[10,7],11:[11,9],12:[12,11,10,4],13:[13,12,11,8],14:[14,13,12,2],15:[15,14],16:[16,14,13,11],17:[17,14],18:[18,11],19:[19,18,17,14],20:[20,17],21:[21,19],22:[22,21],23:[23,18],24:[24,23,22,17],25:[25,22],26:[26,6,2,1],27:[27,5,2,1],28:[28,25],29:[29,27],30:[30,6,4,1],31:[31,28]};a.prototype={TAPS:i,DEFAULT_LENGTH:31,shift:function(){var e,t=this.taps.length,r=this.register>>this.n-this.taps[0];for(e=1;e<t;e++)r^=this.register>>this.n-this.taps[e];return r&=1,this.register=this.register>>1|r<<this.n-1,1&r},seq:function(e){for(var t=0,r=0;r<e;r++)t=t<<1|this.shift();return t},seqString:function(e){for(var t="",r=0;r<e;r++)t+=this.shift();return t},maxSeqLen:function(){var e=this.register,t=0;do this.shift(),t++;while(e!=this.register);return t},_defaultSeed:function(e){if(!e)throw new Error("n is required");var t=new a(8,92914);return t.seq(e)}};var s=new a(31,(new Date).getTime()),o=function(){var e=s.seq(31);return e="0."+e,parseFloat(e)};n.base.srnd=o,e.exports=n.base},function(e,t,r){var a,n,i,s=r(1),o={browserName:null,supportWebCrypto:!1,exportWebCryptoPublicKeyMethod:"spki",importWebCryptoPrivateKeyMethod:"pkcs8",exportWebCryptoPrivateKeyMethod:"pkcs8",wrapWebCryptoArrayBuffer:!1,useSJCL:!1};s.getSettings=function(){var e={};for(var t in o)e[t]=o[t];return"getVersion"in s?e.version=s.getVersion():e.version="dev version",e},s.error=function(e,t){void 0===t&&(t=e,e=void 0),this.code=e,this.reason=[t],this.getCode=function(){return this.code},this.getReason=function(){return this.reason},this.pushReason=function(e){this.reason.push(e)}},"undefined"!=typeof window&&(a=window.msCrypto||window.crypto),a&&(n=a.subtle||a.webkitSubtle);var u="";do{for(var c="undefined"!=typeof navigator?navigator.userAgent:"",p="undefined"!=typeof navigator?navigator.appVersion:"",l=p.split(" "),f={},d=0;d<l.length;++d)l[d].indexOf("Chrome/")==-1?l[d].indexOf("Safari/")==-1?l[d].indexOf("Edge/")==-1?l[d].indexOf("Version/")==-1?l[d].indexOf("AppleWebKit/")==-1||(f.AppleWebKit=l[d].split("/")[1],o.webkitVersion=f.AppleWebKit):f.Version=l[d].split("/")[1]:f.Edge=l[d].split("/")[1]:f.Safari=l[d].split("/")[1]:f.Chrome=l[d].split("/")[1];if(-1!=p.indexOf("OPR/")){u="Opera",o.importWebCryptoPrivateKeyMethod="jwk",o.exportWebCryptoPrivateKeyMethod="jwk",o.exportWebCryptoPublicKeyMethod="jwk";break}if(f.hasOwnProperty("Edge")){u="Edge",o.browserVersion=f.Edge,o.importWebCryptoPrivateKeyMethod="jwk",o.exportWebCryptoPrivateKeyMethod="jwk",o.exportWebCryptoPublicKeyMethod="jwk";break}if(f.hasOwnProperty("Chrome")){u="Chrome",o.browserVersion=f.Chrome,o.importWebCryptoPrivateKeyMethod="jwk",o.exportWebCryptoPrivateKeyMethod="jwk",o.exportWebCryptoPublicKeyMethod="jwk",parseInt(f.Chrome)<37&&(u="Chrome under 37",n=void 0);break}if(f.hasOwnProperty("Safari")){u="Safari",o.browserVersion=f.Version,o.importWebCryptoPrivateKeyMethod="jwk",o.exportWebCryptoPrivateKeyMethod="jwk",o.exportWebCryptoPublicKeyMethod="jwk",o.wrapWebCryptoArrayBuffer=!0,o.useSJCL=!0,parseInt(o.browserVersion)>=11?o.wrapWebCryptoArrayBuffer=!1:parseInt(o.browserVersion)<=9&&(n=void 0);break}if(i=p.indexOf("Trident"),i!=-1){u="Internet Explorer",o.importWebCryptoPrivateKeyMethod="jwk",o.exportWebCryptoPrivateKeyMethod="jwk",o.exportWebCryptoPublicKeyMethod="jwk",o.wrapWebCryptoArrayBuffer=!0;break}if(-1!=c.indexOf("Firefox")){u="FireFox",o.importWebCryptoPrivateKeyMethod="jwk",o.exportWebCryptoPublicKeyMethod="jwk",o.exportWebCryptoPrivateKeyMethod="jwk";break}}while(!1);"undefined"!=typeof location&&"https:"!=location.protocol&&(n=void 0,s.consoleLog),o.browserName=u,o.supportWebCrypto=!!n,"undefined"==typeof n?(delete o.importWebCryptoPrivateKeyMethod,delete o.exportWebCryptoPrivateKeyMethod,delete o.exportWebCryptoPublicKeyMethod,delete o.wrapWebCryptoArrayBuffer):o.subtle=n,s.useWebCrypto=!0,e.exports=o},function(e,t,r){var a=r(1),n=a.util=a.util||{};n.setImmediate=function(e){setTimeout(e,0)},n.nextTick=n.setImmediate,n.isArray=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},n.isArrayBuffer=function(e){return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer};var i=[];"undefined"!=typeof Int8Array&&i.push(Int8Array),"undefined"!=typeof Uint8Array&&i.push(Uint8Array),"undefined"!=typeof Uint8ClampedArray&&i.push(Uint8ClampedArray),"undefined"!=typeof Int16Array&&i.push(Int16Array),"undefined"!=typeof Uint16Array&&i.push(Uint16Array),"undefined"!=typeof Int32Array&&i.push(Int32Array),"undefined"!=typeof Uint32Array&&i.push(Uint32Array),"undefined"!=typeof Float32Array&&i.push(Float32Array),"undefined"!=typeof Float64Array&&i.push(Float64Array),n.isArrayBufferView=function(e){for(var t=0;t<i.length;++t)if(e instanceof i[t])return!0;return!1},n.ByteBuffer=function(e){if(this.data="",this.read=0,"string"==typeof e)this.data=e;else if(n.isArrayBuffer(e)||n.isArrayBufferView(e)){var t=new Uint8Array(e);try{this.data=String.fromCharCode.apply(null,t)}catch(e){for(var r=0;r<t.length;++r)this.putByte(t[r])}}},n.ByteBuffer.prototype.length=function(){return this.data.length-this.read},n.ByteBuffer.prototype.isEmpty=function(){return this.length()<=0},n.ByteBuffer.prototype.putByte=function(e){return this.data+=String.fromCharCode(e),this},n.ByteBuffer.prototype.fillWithByte=function(e,t){e=String.fromCharCode(e);for(var r=this.data;t>0;)1&t&&(r+=e),t>>>=1,t>0&&(e+=e);return this.data=r,this},n.ByteBuffer.prototype.putBytes=function(e){return this.data+=e,this},n.ByteBuffer.prototype.putString=function(e){return this.data+=n.encodeUtf8(e),this},n.ByteBuffer.prototype.putInt16=function(e){return this.data+=String.fromCharCode(e>>8&255)+String.fromCharCode(255&e),this},n.ByteBuffer.prototype.putInt24=function(e){return this.data+=String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e),this},n.ByteBuffer.prototype.putInt32=function(e){return this.data+=String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e),this},n.ByteBuffer.prototype.putInt16Le=function(e){return this.data+=String.fromCharCode(255&e)+String.fromCharCode(e>>8&255),this},n.ByteBuffer.prototype.putInt24Le=function(e){return this.data+=String.fromCharCode(255&e)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255),this},n.ByteBuffer.prototype.putInt32Le=function(e){return this.data+=String.fromCharCode(255&e)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>24&255),this},n.ByteBuffer.prototype.putInt=function(e,t){do t-=8,this.data+=String.fromCharCode(e>>t&255);while(t>0);return this},n.ByteBuffer.prototype.putSignedInt=function(e,t){return e<0&&(e+=2<<t-1),this.putInt(e,t)},n.ByteBuffer.prototype.putBuffer=function(e){return this.data+=e.getBytes(),this},n.ByteBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)},n.ByteBuffer.prototype.getInt16=function(){var e=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,e},n.ByteBuffer.prototype.getInt24=function(){var e=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,e},n.ByteBuffer.prototype.getInt32=function(){var e=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,e},n.ByteBuffer.prototype.getInt16Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,e},n.ByteBuffer.prototype.getInt24Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,e},n.ByteBuffer.prototype.getInt32Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,e},n.ByteBuffer.prototype.getInt=function(e){var t=0;do t=(t<<8)+this.data.charCodeAt(this.read++),e-=8;while(e>0);return t},n.ByteBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),r=2<<e-2;return t>=r&&(t-=r<<1),t},n.ByteBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):0===e?t="":(t=0===this.read?this.data:this.data.slice(this.read),this.clear()),t},n.ByteBuffer.prototype.bytes=function(e){return"undefined"==typeof e?this.data.slice(this.read):this.data.slice(this.read,this.read+e)},n.ByteBuffer.prototype.at=function(e){return this.data.charCodeAt(this.read+e)},n.ByteBuffer.prototype.setAt=function(e,t){return this.data=this.data.substr(0,this.read+e)+String.fromCharCode(t)+this.data.substr(this.read+e+1),this},n.ByteBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)},n.ByteBuffer.prototype.copy=function(){var e=n.createBuffer(this.data);return e.read=this.read,e},n.ByteBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this},n.ByteBuffer.prototype.clear=function(){return this.data="",this.read=0,this},n.ByteBuffer.prototype.truncate=function(e){var t=Math.max(0,this.length()-e);return this.data=this.data.substr(this.read,t),this.read=0,this},n.ByteBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.length;++t){var r=this.data.charCodeAt(t);r<16&&(e+="0"),e+=r.toString(16)}return e},n.ByteBuffer.prototype.toString=function(){return n.decodeUtf8(this.bytes())},n.createBuffer=function(e,t){return t=t||"raw",void 0!==e&&"utf8"===t&&(e=n.encodeUtf8(e)),new n.ByteBuffer(e)},n.fillString=function(e,t){for(var r="";t>0;)1&t&&(r+=e),t>>>=1,t>0&&(e+=e);return r},n.xorBytes=function(e,t,r){for(var a="",n="",i="",s=0,o=0;r>0;--r,++s)n=e.charCodeAt(s)^t.charCodeAt(s),o>=10&&(a+=i,i="",o=0),i+=String.fromCharCode(n),++o;return a+=i},n.hexToBytes=function(e){var t="",r=0;for(e.length&!0&&(r=1,t+=String.fromCharCode(parseInt(e[0],16)));r<e.length;r+=2)t+=String.fromCharCode(parseInt(e.substr(r,2),16));return t},n.bytesToHex=function(e){return n.createBuffer(e).toHex()},n.int32ToBytes=function(e){return String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e)};var s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",o=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];n.encode64=function(e,t){for(var r,a,n,i="",o="",u=0;u<e.length;)r=e.charCodeAt(u++),a=e.charCodeAt(u++),n=e.charCodeAt(u++),i+=s.charAt(r>>2),i+=s.charAt((3&r)<<4|a>>4),isNaN(a)?i+="==":(i+=s.charAt((15&a)<<2|n>>6),i+=isNaN(n)?"=":s.charAt(63&n)),t&&i.length>t&&(o+=i.substr(0,t)+"\r\n",i=i.substr(t));return o+=i},n.decode64=function(e){e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var t,r,a,n,i="",s=0;s<e.length;)t=o[e.charCodeAt(s++)-43],r=o[e.charCodeAt(s++)-43],a=o[e.charCodeAt(s++)-43],n=o[e.charCodeAt(s++)-43],i+=String.fromCharCode(t<<2|r>>4),64!==a&&(i+=String.fromCharCode((15&r)<<4|a>>2),64!==n&&(i+=String.fromCharCode((3&a)<<6|n)));return i},n.encodeUtf8=function(e){return unescape(encodeURIComponent(e))},n.decodeUtf8=function(e){return decodeURIComponent(escape(e))},n.deflate=function(e,t,r){if(t=n.decode64(e.deflate(n.encode64(t)).rval),r){var a=2,i=t.charCodeAt(1);32&i&&(a=6),t=t.substring(a,t.length-4)}return t},n.inflate=function(e,t,r){var a=e.inflate(n.encode64(t)).rval;return null===a?null:n.decode64(a)};var u=function(e,t,r){if(!e)throw{message:"WebStorage not available."};var a;if(null===r?a=e.removeItem(t):(r=n.encode64(JSON.stringify(r)),a=e.setItem(t,r)),"undefined"!=typeof a&&a.rval!==!0)throw a.error},c=function(e,t){if(!e)throw{message:"WebStorage not available."};var r=e.getItem(t);if(e.init)if(null===r.rval){if(r.error)throw r.error;r=null}else r=r.rval;return null!==r&&(r=JSON.parse(n.decode64(r))),r},p=function(e,t,r,a){var n=c(e,t);null===n&&(n={}),n[r]=a,u(e,t,n)},l=function(e,t,r){var a=c(e,t);return null!==a&&(a=r in a?a[r]:null),a},f=function(e,t,r){var a=c(e,t);if(null!==a&&r in a){delete a[r];var n=!0;for(var i in a){n=!1;break}n&&(a=null),u(e,t,a)}},d=function(e,t){u(e,t,null)},h=function(e,t,r){var a=null;"undefined"==typeof r&&(r=["web","flash"]);var n,i=!1,s=null;for(var o in r){n=r[o];try{if("flash"===n||"both"===n){if(null===t[0])throw{message:"Flash local storage not available."};a=e.apply(this,t),i="flash"===n}"web"!==n&&"both"!==n||(t[0]=localStorage,a=e.apply(this,t),i=!0)}catch(e){s=e}if(i)break}if(!i)throw s;return a};n.setItem=function(e,t,r,a,n){h(p,arguments,n)},n.getItem=function(e,t,r,a){return h(l,arguments,a)},n.removeItem=function(e,t,r,a){h(f,arguments,a)},n.clearItems=function(e,t,r){h(d,arguments,r)},n.parseUrl=function(e){var t=/^(https?):\/\/([^:&^\/]*):?(\d*)(.*)$/g;t.lastIndex=0;var r=t.exec(e),a=null===r?null:{full:e,scheme:r[1],host:r[2],port:r[3],path:r[4]};return a&&(a.fullHost=a.host,a.port?80!==a.port&&"http"===a.scheme?a.fullHost+=":"+a.port:443!==a.port&&"https"===a.scheme&&(a.fullHost+=":"+a.port):"http"===a.scheme?a.port=80:"https"===a.scheme&&(a.port=443),a.full=a.scheme+"://"+a.fullHost),a};var y=null;n.getQueryVariables=function(e){var t,r=function(e){for(var t={},r=e.split("&"),a=0;a<r.length;a++){var n,i,s=r[a].indexOf("=");s>0?(n=r[a].substring(0,s),i=r[a].substring(s+1)):(n=r[a],i=null),n in t||(t[n]=[]),n in Object.prototype||null===i||t[n].push(unescape(i))}return t};return"undefined"==typeof e?(null===y&&(y="undefined"==typeof window?{}:r(window.location.search.substring(1))),t=y):t=r(e),t},n.parseFragment=function(e){var t=e,r="",a=e.indexOf("?");a>0&&(t=e.substring(0,a),r=e.substring(a+1));var i=t.split("/");i.length>0&&""===i[0]&&i.shift();var s=""===r?{}:n.getQueryVariables(r);return{pathString:t,queryString:r,path:i,query:s}},n.makeRequest=function(e){var t=n.parseFragment(e),r={path:t.pathString,query:t.queryString,getPath:function(e){return"undefined"==typeof e?t.path:t.path[e]},getQuery:function(e,r){var a;return"undefined"==typeof e?a=t.query:(a=t.query[e],a&&"undefined"!=typeof r&&(a=a[r])),a},getQueryLast:function(e,t){var a,n=r.getQuery(e);return a=n?n[n.length-1]:t}};return r},n.makeLink=function(e,t,r){e=jQuery.isArray(e)?e.join("/"):e;var a=jQuery.param(t||{});return r=r||"",e+(a.length>0?"?"+a:"")+(r.length>0?"#"+r:"")},n.setPath=function(e,t,r){if("object"==typeof e&&null!==e)for(var a=0,n=t.length;a<n;){var i=t[a++];if(a==n)e[i]=r;else{var s=i in e;(!s||s&&"object"!=typeof e[i]||s&&null===e[i])&&(e[i]={}),e=e[i]}}},n.getPath=function(e,t,r){for(var a=0,n=t.length,i=!0;i&&a<n&&"object"==typeof e&&null!==e;){var s=t[a++];i=s in e,i&&(e=e[s])}return i?e:r},n.deletePath=function(e,t){if("object"==typeof e&&null!==e)for(var r=0,a=t.length;r<a;){var n=t[r++];if(r==a)delete e[n];else{if(!(n in e)||"object"!=typeof e[n]||null===e[n])break;e=e[n]}}},n.isEmpty=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},n.format=function(e){for(var t,r,a=/%./g,n=0,i=[],s=0;t=a.exec(e);){r=e.substring(s,a.lastIndex-2),r.length>0&&i.push(r),s=a.lastIndex;var o=t[0][1];switch(o){case"s":case"o":n<arguments.length?i.push(arguments[n++ +1]):i.push("<?>");break;case"%":i.push("%");break;default:i.push("<%"+o+"?>")}}return i.push(e.substring(s)),i.join("")},n.formatNumber=function(e,t,r,a){var n=e,i=isNaN(t=Math.abs(t))?2:t,s=void 0===r?",":r,o=void 0===a?".":a,u=n<0?"-":"",c=parseInt(n=Math.abs(+n||0).toFixed(i),10)+"",p=c.length>3?c.length%3:0;return u+(p?c.substr(0,p)+o:"")+c.substr(p).replace(/(\d{3})(?=\d)/g,"$1"+o)+(i?s+Math.abs(n-c).toFixed(i).slice(2):"")},n.formatSize=function(e){return e=e>=1073741824?n.formatNumber(e/1073741824,2,".","")+" GiB":e>=1048576?n.formatNumber(e/1048576,2,".","")+" MiB":e>=1024?n.formatNumber(e/1024,0)+" KiB":n.formatNumber(e,0)+" bytes"},n.bytesFromIP=function(e){return e.indexOf(".")!==-1?n.bytesFromIPv4(e):e.indexOf(":")!==-1?n.bytesFromIPv6(e):null},n.bytesFromIPv4=function(e){if(e=e.split("."),4!==e.length)return null;for(var t=n.createBuffer(),r=0;r<e.length;++r){var a=parseInt(e[r],10);if(isNaN(a))return null;t.putByte(a)}return t.getBytes()},n.bytesFromIPv6=function(e){var t=0;e=e.split(":").filter(function(e){return 0===e.length&&++t,!0});for(var r=2*(8-e.length+t),a=n.createBuffer(),i=0;i<8;++i)if(e[i]&&0!==e[i].length){var s=n.hexToBytes(e[i]);s.length<2&&a.putByte(0),a.putBytes(s)}else a.fillWithByte(0,r),r=0;return a.getBytes()},n.bytesToIP=function(e){return 4===e.length?n.bytesToIPv4(e):16===e.length?n.bytesToIPv6(e):null},n.bytesToIPv4=function(e){if(4!==e.length)return null;for(var t=[],r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t.join(".")},n.bytesToIPv6=function(e){if(16!==e.length)return null;for(var t=[],r=[],a=0,i=0;i<e.length;i+=2){for(var s=n.bytesToHex(e[i]+e[i+1]);"0"===s[0]&&"0"!==s;)s=s.substr(1);if("0"===s){var o=r[r.length-1],u=t.length;o&&u===o.end+1?(o.end=u,o.end-o.start>r[a].end-r[a].start&&(a=r.length-1)):r.push({start:u,end:u})}t.push(s)}if(r.length>0){var c=r[a];c.end-c.start>0&&(t.splice(c.start,c.end-c.start+1,""),0===c.start&&t.unshift(""),7===c.end&&t.push(""))}return t.join(":")},n.estimateCores=function(e,t){function r(e,o,u){if(0===o){var c=Math.floor(e.reduce(function(e,t){return e+t},0)/e.length);return n.cores=Math.max(1,c),URL.revokeObjectURL(s),t(null,n.cores)}a(u,function(t,a){e.push(i(u,a)),r(e,o-1,u)})}function a(e,t){for(var r=[],a=[],n=0;n<e;++n){var i=new Worker(s);i.addEventListener("message",function(n){if(a.push(n.data),a.length===e){for(var i=0;i<e;++i)r[i].terminate();t(null,a)}}),r.push(i)}for(var n=0;n<e;++n)r[n].postMessage(n)}function i(e,t){for(var r=[],a=0;a<e;++a)for(var n=t[a],i=r[a]=[],s=0;s<e;++s)if(a!==s){var o=t[s];(n.st>o.st&&n.st<o.et||o.st>n.st&&o.st<n.et)&&i.push(s)}return r.reduce(function(e,t){return Math.max(e,t.length)},0)}if("function"==typeof e&&(t=e,e={}),e=e||{},"cores"in n&&!e.update)return t(null,n.cores);if(void 0===typeof Worker)return n.cores=1,t(null,n.cores);if(void 0===typeof Blob)return n.cores=2,t(null,n.cores);var s=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(e){for(var t=Date.now(),r=t+4;Date.now()<r;);self.postMessage({st:t,et:r})})}.toString(),")()"],{type:"application/javascript"}));r([],5,16)},e.exports=a.util},function(e,t,r){var a=r(1);a.md=a.md||{},r(6),r(7),r(8),r(9),r(10);var n=a.getSettings();n.useSJCL&&(a.sha256=a.sha256_sjcl),a.md.algorithms={md5:a.md5,sha1:a.sha1,sha224:a.sha224,sha256:a.sha256},a.md.md5=a.md5,a.md.sha1=a.sha1,a.md.sha224=a.sha224,a.md.sha256=a.sha256,a.md.sha256_sjcl=a.sha256_sjcl,e.exports=a.md},function(e,t,r){var a=r(1),n=a.md5=a.md5||{};a.md=a.md||{},a.md.algorithms=a.md.algorithms||{},a.md.md5=a.md.algorithms.md5=n;var i=null,s=null,o=null,u=null,c=!1,p=function(){i=String.fromCharCode(128),i+=a.util.fillString(String.fromCharCode(0),64),s=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,1,6,11,0,5,10,15,4,9,14,3,8,13,2,7,12,5,8,11,14,1,4,7,10,13,0,3,6,9,12,15,2,0,7,14,5,12,3,10,1,8,15,6,13,4,11,2,9],o=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21],u=new Array(64);for(var e=0;e<64;++e)u[e]=Math.floor(4294967296*Math.abs(Math.sin(e+1)));c=!0},l=function(e,t,r){for(var a,n,i,c,p,l,f,d,h=r.length();h>=64;){for(n=e.h0,i=e.h1,c=e.h2,p=e.h3,d=0;d<16;++d)t[d]=r.getInt32Le(),l=p^i&(c^p),a=n+l+u[d]+t[d],f=o[d],n=p,p=c,c=i,i+=a<<f|a>>>32-f;for(;d<32;++d)l=c^p&(i^c),a=n+l+u[d]+t[s[d]],f=o[d],n=p,p=c,c=i,i+=a<<f|a>>>32-f;for(;d<48;++d)l=i^c^p,a=n+l+u[d]+t[s[d]],f=o[d],n=p,p=c,c=i,i+=a<<f|a>>>32-f;for(;d<64;++d)l=c^(i|~p),a=n+l+u[d]+t[s[d]],f=o[d],n=p,p=c,c=i,i+=a<<f|a>>>32-f;e.h0=e.h0+n&4294967295,e.h1=e.h1+i&4294967295,e.h2=e.h2+c&4294967295,e.h3=e.h3+p&4294967295,h-=64}};n.create=function(){c||p();var e=null,t=a.util.createBuffer(),r=new Array(16),n={algorithm:"md5",blockLength:64,digestLength:16,messageLength:0};return n.start=function(){return n.messageLength=0,t=a.util.createBuffer(),e={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878},n},n.start(),n.update=function(i,s){return"utf8"===s&&(i=a.util.encodeUtf8(i)),n.messageLength+=i.length,t.putBytes(i),l(e,r,t),(t.read>2048||0===t.length())&&t.compact(),n},n.digest=function(){var s=n.messageLength,o=a.util.createBuffer();o.putBytes(t.bytes()),o.putBytes(i.substr(0,64-(s+8)%64)),o.putInt32Le(s<<3&4294967295),o.putInt32Le(s>>>29&255);var u={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3};l(u,r,o);var c=a.util.createBuffer();return c.putInt32Le(u.h0),c.putInt32Le(u.h1),c.putInt32Le(u.h2),c.putInt32Le(u.h3),c},n},e.exports=n},function(e,t,r){var a=r(1),n=a.sha1=a.sha1||{};a.md=a.md||{},a.md.algorithms=a.md.algorithms||{},a.md.sha1=a.md.algorithms.sha1=n;var i=null,s=!1,o=function(){i=String.fromCharCode(128),i+=a.util.fillString(String.fromCharCode(0),64),s=!0},u=function(e,t,r){for(var a,n,i,s,o,u,c,p,l=r.length();l>=64;){for(n=e.h0,i=e.h1,s=e.h2,o=e.h3,u=e.h4,p=0;p<16;++p)a=r.getInt32(),t[p]=a,c=o^i&(s^o),a=(n<<5|n>>>27)+c+u+1518500249+a,u=o,o=s,s=i<<30|i>>>2,i=n,n=a;for(;p<20;++p)a=t[p-3]^t[p-8]^t[p-14]^t[p-16],a=a<<1|a>>>31,t[p]=a,c=o^i&(s^o),a=(n<<5|n>>>27)+c+u+1518500249+a,u=o,o=s,s=i<<30|i>>>2,i=n,n=a;for(;p<32;++p)a=t[p-3]^t[p-8]^t[p-14]^t[p-16],a=a<<1|a>>>31,t[p]=a,c=i^s^o,a=(n<<5|n>>>27)+c+u+1859775393+a,u=o,o=s,s=i<<30|i>>>2,i=n,n=a;for(;p<40;++p)a=t[p-6]^t[p-16]^t[p-28]^t[p-32],a=a<<2|a>>>30,t[p]=a,c=i^s^o,a=(n<<5|n>>>27)+c+u+1859775393+a,u=o,o=s,s=i<<30|i>>>2,i=n,n=a;for(;p<60;++p)a=t[p-6]^t[p-16]^t[p-28]^t[p-32],a=a<<2|a>>>30,t[p]=a,c=i&s|o&(i^s),a=(n<<5|n>>>27)+c+u+2400959708+a,u=o,o=s,s=i<<30|i>>>2,i=n,n=a;for(;p<80;++p)a=t[p-6]^t[p-16]^t[p-28]^t[p-32],a=a<<2|a>>>30,t[p]=a,c=i^s^o,a=(n<<5|n>>>27)+c+u+3395469782+a,u=o,o=s,s=i<<30|i>>>2,i=n,n=a;e.h0+=n,e.h1+=i,e.h2+=s,e.h3+=o,e.h4+=u,l-=64}};n.create=function(){s||o();var e=null,t=a.util.createBuffer(),r=new Array(80),n={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0};return n.start=function(){return n.messageLength=0,t=a.util.createBuffer(),e={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},n},n.start(),n.update=function(i,s){return"utf8"===s&&(i=a.util.encodeUtf8(i)),n.messageLength+=i.length,t.putBytes(i),u(e,r,t),(t.read>2048||0===t.length())&&t.compact(),n},n.digest=function(){var s=n.messageLength,o=a.util.createBuffer();o.putBytes(t.bytes()),o.putBytes(i.substr(0,64-(s+8)%64)),o.putInt32(s>>>29&255),o.putInt32(s<<3&4294967295);var c={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4};u(c,r,o);var p=a.util.createBuffer();return p.putInt32(c.h0),p.putInt32(c.h1),p.putInt32(c.h2),p.putInt32(c.h3),p.putInt32(c.h4),p},n},e.exports=n},function(e,t,r){var a=r(1),n=a.sha224=a.sha224||{};a.md=a.md||{},a.md.algorithms=a.md.algorithms||{},a.md.sha224=a.md.algorithms.sha224=n;var i=null,s=!1,o=null,u=function(){i=String.fromCharCode(128),i+=a.util.fillString(String.fromCharCode(0),64),o=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],s=!0},c=function(e,t,r){for(var a,n,i,s,u,c,p,l,f,d,h,y,g,C,v,m=r.length();m>=64;){for(p=0;p<16;++p)t[p]=r.getInt32();for(;p<64;++p)a=t[p-2],a=(a>>>17|a<<15)^(a>>>19|a<<13)^a>>>10,n=t[p-15],n=(n>>>7|n<<25)^(n>>>18|n<<14)^n>>>3,t[p]=a+t[p-7]+n+t[p-16]&4294967295;for(l=e.h0,f=e.h1,d=e.h2,h=e.h3,y=e.h4,g=e.h5,C=e.h6,v=e.h7,p=0;p<64;++p)s=(y>>>6|y<<26)^(y>>>11|y<<21)^(y>>>25|y<<7),u=C^y&(g^C),i=(l>>>2|l<<30)^(l>>>13|l<<19)^(l>>>22|l<<10),c=l&f|d&(l^f),a=v+s+u+o[p]+t[p],n=i+c,v=C,C=g,g=y,y=h+a&4294967295,h=d,d=f,f=l,l=a+n&4294967295;e.h0=e.h0+l&4294967295,e.h1=e.h1+f&4294967295,e.h2=e.h2+d&4294967295,e.h3=e.h3+h&4294967295,e.h4=e.h4+y&4294967295,e.h5=e.h5+g&4294967295,e.h6=e.h6+C&4294967295,e.h7=e.h7+v&4294967295,m-=64}};n.create=function(){s||u();var e=null,t=a.util.createBuffer(),r=new Array(64),n={algorithm:"sha224",blockLength:64,digestLength:28,messageLength:0};return n.start=function(){return n.messageLength=0,t=a.util.createBuffer(),e={h0:3238371032,h1:914150663,h2:812702999,h3:4144912697,h4:4290775857,h5:1750603025,h6:1694076839,h7:3204075428},n},n.start(),n.update=function(i,s){return"utf8"===s&&(i=a.util.encodeUtf8(i)),n.messageLength+=i.length,t.putBytes(i),c(e,r,t),(t.read>2048||0===t.length())&&t.compact(),n},n.digest=function(){var s=n.messageLength,o=a.util.createBuffer();o.putBytes(t.bytes()),o.putBytes(i.substr(0,64-(s+8)%64)),o.putInt32(s>>>29&255),o.putInt32(s<<3&4294967295);var u={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4,h5:e.h5,h6:e.h6,h7:e.h7};c(u,r,o);var p=a.util.createBuffer();return p.putInt32(u.h0),p.putInt32(u.h1),p.putInt32(u.h2),p.putInt32(u.h3),p.putInt32(u.h4),p.putInt32(u.h5),p.putInt32(u.h6),p},n},e.exports=n},function(e,t,r){var a=r(1),n=a.sha256=a.sha256||{};a.md=a.md||{},a.md.algorithms=a.md.algorithms||{},a.md.sha256=a.md.algorithms.sha256=n;var i=null,s=!1,o=null,u=function(){i=String.fromCharCode(128),i+=a.util.fillString(String.fromCharCode(0),64),o=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],s=!0},c=function(e,t,r){for(var a,n,i,s,u,c,p,l,f,d,h,y,g,C,v,m=r.length();m>=64;){for(p=0;p<16;++p)t[p]=r.getInt32();for(;p<64;++p)a=t[p-2],a=(a>>>17|a<<15)^(a>>>19|a<<13)^a>>>10,n=t[p-15],n=(n>>>7|n<<25)^(n>>>18|n<<14)^n>>>3,t[p]=a+t[p-7]+n+t[p-16]&4294967295;for(l=e.h0,f=e.h1,d=e.h2,h=e.h3,y=e.h4,g=e.h5,C=e.h6,v=e.h7,p=0;p<64;++p)s=(y>>>6|y<<26)^(y>>>11|y<<21)^(y>>>25|y<<7),u=C^y&(g^C),i=(l>>>2|l<<30)^(l>>>13|l<<19)^(l>>>22|l<<10),c=l&f|d&(l^f),a=v+s+u+o[p]+t[p],n=i+c,v=C,C=g,g=y,y=h+a&4294967295,h=d,d=f,f=l,l=a+n&4294967295;e.h0=e.h0+l&4294967295,e.h1=e.h1+f&4294967295,e.h2=e.h2+d&4294967295,e.h3=e.h3+h&4294967295,e.h4=e.h4+y&4294967295,e.h5=e.h5+g&4294967295,e.h6=e.h6+C&4294967295,e.h7=e.h7+v&4294967295,m-=64}};n.create=function(){s||u();var e=null,t=a.util.createBuffer(),r=new Array(64),n={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0};return n.start=function(){return n.messageLength=0,t=a.util.createBuffer(),e={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},n},n.start(),n.update=function(i,s){return"utf8"===s&&(i=a.util.encodeUtf8(i)),n.messageLength+=i.length,t.putBytes(i),c(e,r,t),(t.read>2048||0===t.length())&&t.compact(),n},n.digest=function(){var s=n.messageLength,o=a.util.createBuffer();o.putBytes(t.bytes()),o.putBytes(i.substr(0,64-(s+8)%64)),
o.putInt32(s>>>29&255),o.putInt32(s<<3&4294967295);var u={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4,h5:e.h5,h6:e.h6,h7:e.h7};c(u,r,o);var p=a.util.createBuffer();return p.putInt32(u.h0),p.putInt32(u.h1),p.putInt32(u.h2),p.putInt32(u.h3),p.putInt32(u.h4),p.putInt32(u.h5),p.putInt32(u.h6),p.putInt32(u.h7),p},n},e.exports=n},function(e,t,r){var a=r(1),n={};n.bitArray={bitSlice:function(e,t,r){return e=n.bitArray._shiftRight(e.slice(t/32),32-(31&t)).slice(1),void 0===r?e:n.bitArray.clamp(e,r-t)},extract:function(e,t,r){var a,n=Math.floor(-t-r&31);return a=(t+r-1^t)&-32?e[t/32|0]<<32-n^e[t/32+1|0]>>>n:e[t/32|0]>>>n,a&(1<<r)-1},concat:function(e,t){if(0===e.length||0===t.length)return e.concat(t);var r=e[e.length-1],a=n.bitArray.getPartial(r);return 32===a?e.concat(t):n.bitArray._shiftRight(t,a,0|r,e.slice(0,e.length-1))},bitLength:function(e){var t,r=e.length;return 0===r?0:(t=e[r-1],32*(r-1)+n.bitArray.getPartial(t))},clamp:function(e,t){if(32*e.length<t)return e;e=e.slice(0,Math.ceil(t/32));var r=e.length;return t&=31,r>0&&t&&(e[r-1]=n.bitArray.partial(t,e[r-1]&2147483648>>t-1,1)),e},partial:function(e,t,r){return 32===e?t:(r?0|t:t<<32-e)+1099511627776*e},getPartial:function(e){return Math.round(e/1099511627776)||32},equal:function(e,t){if(n.bitArray.bitLength(e)!==n.bitArray.bitLength(t))return!1;var r,a=0;for(r=0;r<e.length;r++)a|=e[r]^t[r];return 0===a},_shiftRight:function(e,t,r,a){var i,s,o=0;for(void 0===a&&(a=[]);t>=32;t-=32)a.push(r),r=0;if(0===t)return a.concat(e);for(i=0;i<e.length;i++)a.push(r|e[i]>>>t),r=e[i]<<32-t;return o=e.length?e[e.length-1]:0,s=n.bitArray.getPartial(o),a.push(n.bitArray.partial(t+s&31,t+s>32?r:a.pop(),1)),a},_xor4:function(e,t){return[e[0]^t[0],e[1]^t[1],e[2]^t[2],e[3]^t[3]]},byteswapM:function(e){var t,r,a=65280;for(t=0;t<e.length;++t)r=e[t],e[t]=r>>>24|r>>>8&a|(r&a)<<8|r<<24;return e}},n.codec={},n.codec.hex={fromBits:function(e){var t,r="";for(t=0;t<e.length;t++)r+=((0|e[t])+0xf00000000000).toString(16).substr(4);return r.substr(0,n.bitArray.bitLength(e)/4)},toBits:function(e){var t,r,a=[];for(e=e.replace(/\s|0x/g,""),r=e.length,e+="00000000",t=0;t<e.length;t+=8)a.push(0^parseInt(e.substr(t,8),16));return n.bitArray.clamp(a,4*r)}},n.codec.utf8String={fromBits:function(e){var t,r,a="",i=n.bitArray.bitLength(e);for(t=0;t<i/8;t++)0===(3&t)&&(r=e[t/4]),a+=String.fromCharCode(r>>>8>>>8>>>8),r<<=8;return decodeURIComponent(escape(a))},toBits:function(e){e=unescape(encodeURIComponent(e));var t,r=[],a=0;for(t=0;t<e.length;t++)a=a<<8|e.charCodeAt(t),3===(3&t)&&(r.push(a),a=0);return 3&t&&r.push(n.bitArray.partial(8*(3&t),a)),r}},n.hash={},n.hash.sha256=function(e){this._zl[0]||this._precompute(),e?(this._h=e._h.slice(0),this._buffer=e._buffer.slice(0),this._length=e._length):this.reset()},n.hash.sha256.hash=function(e){return(new n.hash.sha256).update(e).finalize()},n.hash.sha256.prototype={blockSize:512,reset:function(){return this._h=this._init.slice(0),this._buffer=[],this._length=0,this},update:function(e){"string"==typeof e&&(e=n.codec.utf8String.toBits(e));var t,r=this._buffer=n.bitArray.concat(this._buffer,e),a=this._length,i=this._length=a+n.bitArray.bitLength(e);if(i>9007199254740991)throw new n.exception.invalid("Cannot hash more than 2^53 - 1 bits");if("undefined"!=typeof Uint32Array){var s=new Uint32Array(r),o=0;for(t=512+a-(512+a&511);t<=i;t+=512)this._block(s.subarray(16*o,16*(o+1))),o+=1;r.splice(0,16*o)}else for(t=512+a-(512+a&511);t<=i;t+=512)this._block(r.splice(0,16));return this},finalize:function(){var e,t=this._buffer,r=this._h;for(t=n.bitArray.concat(t,[n.bitArray.partial(1,1)]),e=t.length+2;15&e;e++)t.push(0);for(t.push(Math.floor(this._length/4294967296)),t.push(0|this._length);t.length;)this._block(t.splice(0,16));return r},_init:[],_zl:[],_precompute:function(){function e(e){return 4294967296*(e-Math.floor(e))|0}for(var t,r,a=0,n=2;a<64;n++){for(r=!0,t=2;t*t<=n;t++)if(n%t===0){r=!1;break}r&&(a<8&&(this._init[a]=e(Math.pow(n,.5))),this._zl[a]=e(Math.pow(n,1/3)),a++)}},_block:function(e){var t,r,a,n,i=this._h,s=this._zl,o=i[0],u=i[1],c=i[2],p=i[3],l=i[4],f=i[5],d=i[6],h=i[7];for(t=0;t<64;t++)t<16?r=e[t]:(a=e[t+1&15],n=e[t+14&15],r=e[15&t]=(a>>>7^a>>>18^a>>>3^a<<25^a<<14)+(n>>>17^n>>>19^n>>>10^n<<15^n<<13)+e[15&t]+e[t+9&15]|0),r=r+h+(l>>>6^l>>>11^l>>>25^l<<26^l<<21^l<<7)+(d^l&(f^d))+s[t],h=d,d=f,f=l,l=p+r|0,p=c,c=u,u=o,o=r+(u&c^p&(u^c))+(u>>>2^u>>>13^u>>>22^u<<30^u<<19^u<<10)|0;i[0]=i[0]+o|0,i[1]=i[1]+u|0,i[2]=i[2]+c|0,i[3]=i[3]+p|0,i[4]=i[4]+l|0,i[5]=i[5]+f|0,i[6]=i[6]+d|0,i[7]=i[7]+h|0}};var i={};i.create=function(){var e=new n.hash.sha256;return e.reset(),{algorithm:"sha256",blockLength:64,digestLength:32,start:function(){e.reset()},update:function(t){return t=a.util.bytesToHex(t),t=n.codec.hex.toBits(t),e.update(t),this},digest:function(){var t;return t=e.finalize(),t=n.codec.hex.fromBits(t),t=a.util.hexToBytes(t),t=a.util.createBuffer(t)}}},a.sha256_sjcl=i,a.md.sha256_sjcl=i,e.exports=a.sha256_sjcl},function(e,t,r){(function(t){var a=r(1),n="undefined"!=typeof t&&t.versions&&t.versions.node,i=null;!a.disableNativeCode&&n;var s=a.prng=a.prng||{};s.create=function(e){function t(e){if(o.pools[0].messageLength>=32)return n(),e();var t=32-o.pools[0].messageLength<<5;o.seedFile(t,function(t,r){return t?e(t):(o.collect(r),n(),void e())})}function r(){if(o.pools[0].messageLength>=32)return n();var e=32-o.pools[0].messageLength<<5;o.collect(o.seedFileSync(e)),n()}function n(){var e=a.md.sha1.create();e.update(o.pools[0].digest().getBytes()),o.pools[0].start();for(var t=1,r=1;r<32;++r)t=31===t?2147483648:t<<2,t%o.reseeds===0&&(e.update(o.pools[r].digest().getBytes()),o.pools[r].start());var n=e.digest().getBytes();e.start(),e.update(n);var i=e.digest().getBytes();o.zl=o.plugin.formatKey(n),o.seed=o.plugin.formatSeed(i),++o.reseeds,o.generated=0,o.time=+new Date}function s(e){var t=null;if("undefined"!=typeof window){var r=window.crypto||window.msCrypto;r&&r.getRandomValues&&(t=function(e){return r.getRandomValues(e)})}var n=a.util.createBuffer();if(t)for(;n.length()<e;){var i=Math.max(1,Math.min(e-n.length(),65536)/4),s=new Uint32Array(Math.floor(i));try{t(s);for(var o=0;o<s.length;++o)n.putInt32(s[o])}catch(e){if(!("undefined"!=typeof QuotaExceededError&&e instanceof QuotaExceededError))throw e}}if(n.length()<e)for(var u,c,p,l=Math.floor(65536*ytcrypto.base.srnd());n.length()<e;){c=16807*(65535&l),u=16807*(l>>16),c+=(32767&u)<<16,c+=u>>15,c=(2147483647&c)+(c>>31),l=4294967295&c;for(var o=0;o<3;++o)p=l>>>(o<<3),p^=Math.floor(256*ytcrypto.base.srnd()),n.putByte(String.fromCharCode(255&p))}return n.getBytes(e)}for(var o={plugin:e,zl:null,seed:null,time:null,reseeds:0,generated:0},u=e.md,c=new Array(32),p=0;p<32;++p)c[p]=u.create();return o.pools=c,o.pool=0,o.generate=function(e,r){function n(l){if(l)return r(l);if(p.length()>=e)return r(null,p.getBytes(e));if(o.generated>=1048576){var f=+new Date;(null===o.time||f-o.time>100)&&(o.zl=null)}if(null===o.zl)return t(n);var d=i(o.zl,o.seed);o.generated+=d.length,p.putBytes(d),o.zl=u(i(o.zl,s(o.seed))),o.seed=c(i(o.zl,o.seed)),a.util.setImmediate(n)}if(!r)return o.generateSync(e);var i=o.plugin.cipher,s=o.plugin.increment,u=o.plugin.formatKey,c=o.plugin.formatSeed,p=a.util.createBuffer();n()},o.generateSync=function(e){for(var t=o.plugin.cipher,n=o.plugin.increment,i=o.plugin.formatKey,s=o.plugin.formatSeed,u=a.util.createBuffer();u.length()<e;){if(o.generated>=1048576){var c=+new Date;(null===o.time||c-o.time>100)&&(o.zl=null)}null===o.zl&&r();var p=t(o.zl,o.seed);o.generated+=p.length,u.putBytes(p),o.zl=i(t(o.zl,n(o.seed))),o.seed=s(t(o.zl,o.seed))}return u.getBytes(e)},i?(o.seedFile=function(e,t){i.randomBytes(e,function(e,r){return e?t(e):void t(null,r.toString())})},o.seedFileSync=function(e){return i.randomBytes(e).toString()}):(o.seedFile=function(e,t){try{t(null,s(e))}catch(e){t(e)}},o.seedFileSync=s),o.collect=function(e){for(var t=e.length,r=0;r<t;++r)o.pools[o.pool].update(e.substr(r,1)),o.pool=31===o.pool?0:o.pool+1},o.collectInt=function(e,t){for(var r="",a=0;a<t;a+=8)r+=String.fromCharCode(e>>a&255);o.collect(r)},o.registerWorker=function(e){function t(t){var r=t.data;r.yt&&r.yt.prng&&o.seedFile(r.yt.prng.needed,function(t,r){e.postMessage({yt:{prng:{err:t,bytes:r}}})})}e===self?o.seedFile=function(e,t){function r(e){var a=e.data;a.yt&&a.yt.prng&&(self.removeEventListener("message",r),t(a.yt.prng.err,a.yt.prng.bytes))}self.addEventListener("message",r),self.postMessage({yt:{prng:{needed:e}}})}:e.addEventListener("message",t)},o},e.exports=a.prng}).call(t,r(12))},function(e,t){function r(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function n(e){if(p===setTimeout)return setTimeout(e,0);if((p===r||!p)&&setTimeout)return p=setTimeout,setTimeout(e,0);try{return p(e,0)}catch(t){try{return p.call(null,e,0)}catch(t){return p.call(this,e,0)}}}function i(e){if(l===clearTimeout)return clearTimeout(e);if((l===a||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(e);try{return l(e)}catch(t){try{return l.call(null,e)}catch(t){return l.call(this,e)}}}function s(){y&&d&&(y=!1,d.length?h=d.concat(h):g=-1,h.length&&o())}function o(){if(!y){var e=n(s);y=!0;for(var t=h.length;t;){for(d=h,h=[];++g<t;)d&&d[g].run();g=-1,t=h.length}d=null,y=!1,i(e)}}function u(e,t){this.fun=e,this.array=t}function c(){}var p,l,f=e.exports={};!function(){try{p="function"==typeof setTimeout?setTimeout:r}catch(e){p=r}try{l="function"==typeof clearTimeout?clearTimeout:a}catch(e){l=a}}();var d,h=[],y=!1,g=-1;f.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];h.push(new u(e,t)),1!==h.length||y||n(o)},u.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=c,f.addListener=c,f.once=c,f.off=c,f.removeListener=c,f.removeAllListeners=c,f.emit=c,f.prependListener=c,f.prependOnceListener=c,f.listeners=function(e){return[]},f.binding=function(e){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(e){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},function(e,t,r){(function(t){var a=r(1),n={},i=new Array(4),s=a.util.createBuffer();n.formatKey=function(e){var t=a.util.createBuffer(e);return e=new Array(4),e[0]=t.getInt32(),e[1]=t.getInt32(),e[2]=t.getInt32(),e[3]=t.getInt32(),a.aes._expandKey(e,!1)},n.formatSeed=function(e){var t=a.util.createBuffer(e);return e=new Array(4),e[0]=t.getInt32(),e[1]=t.getInt32(),e[2]=t.getInt32(),e[3]=t.getInt32(),e},n.cipher=function(e,t){return a.aes._updateBlock(e,t,i,!1),s.putInt32(i[0]),s.putInt32(i[1]),s.putInt32(i[2]),s.putInt32(i[3]),s.getBytes()},n.increment=function(e){return++e[3],e},n.md=a.md.sha1;var o=a.prng.create(n),u=("undefined"!=typeof t&&t.versions&&t.versions.node,null);if("undefined"!=typeof window){var c=window.crypto||window.msCrypto;c&&c.getRandomValues&&(u=function(e){return c.getRandomValues(e)})}if(a.random)for(var p in o)a.random[p]=o[p];else a.random=o;a.random.getBytes=function(e,t){return a.random.generate(e,t)},a.random.getBytesSync=function(e){return a.random.generate(e)},e.exports=a.random}).call(t,r(12))},function(e,t,r){var a=r(1),n=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],i=[1,2,3,5],s=function(e,t){return e<<t&65535|(65535&e)>>16-t},o=function(e,t){return(65535&e)>>t|e<<16-t&65535};a.rc2=a.rc2||{},a.rc2.expandKey=function(e,t){"string"==typeof e&&(e=a.util.createBuffer(e)),t=t||128;var r,i=e,s=e.length(),o=t,u=Math.ceil(o/8),c=255>>(7&o);for(r=s;r<128;r++)i.putByte(n[i.at(r-1)+i.at(r-s)&255]);for(i.setAt(128-u,n[i.at(128-u)&c]),r=127-u;r>=0;r--)i.setAt(r,n[i.at(r+1)^i.at(r+u)]);return i};var u=function(e,t,r){var n,u,c,p,l=!1,f=null,d=null,h=null,y=[];for(e=a.rc2.expandKey(e,t),c=0;c<64;c++)y.push(e.getInt16Le());r?(n=function(e){for(c=0;c<4;c++)e[c]+=y[p]+(e[(c+3)%4]&e[(c+2)%4])+(~e[(c+3)%4]&e[(c+1)%4]),e[c]=s(e[c],i[c]),p++},u=function(e){for(c=0;c<4;c++)e[c]+=y[63&e[(c+3)%4]]}):(n=function(e){for(c=3;c>=0;c--)e[c]=o(e[c],i[c]),e[c]-=y[p]+(e[(c+3)%4]&e[(c+2)%4])+(~e[(c+3)%4]&e[(c+1)%4]),p--},u=function(e){for(c=3;c>=0;c--)e[c]-=y[63&e[(c+3)%4]]});var g=function(e){var t=[];for(c=0;c<4;c++){var a=f.getInt16Le();null!==h&&(r?a^=h.getInt16Le():h.putInt16Le(a)),t.push(65535&a)}p=r?0:63;for(var n=0;n<e.length;n++)for(var i=0;i<e[n][0];i++)e[n][1](t);for(c=0;c<4;c++)null!==h&&(r?h.putInt16Le(t[c]):t[c]^=h.getInt16Le()),d.putInt16Le(t[c])},C=null;return C={start:function(e,t){e&&"string"==typeof e&&(e=a.util.createBuffer(e)),l=!1,f=a.util.createBuffer(),d=t||new a.util.createBuffer,h=e,C.output=d},update:function(e){for(l||f.putBuffer(e);f.length()>=8;)g([[5,n],[1,u],[6,n],[1,u],[5,n]])},finish:function(e){var t=!0;if(r)if(e)t=e(8,f,!r);else{var a=8===f.length()?8:8-f.length();f.fillWithByte(a,a)}if(t&&(l=!0,C.update()),!r&&(t=0===f.length()))if(e)t=e(8,d,!r);else{var n=d.length(),i=d.at(n-1);i>n?t=!1:d.truncate(i)}return t}}};a.rc2.startEncrypting=function(e,t,r){var n=a.rc2.createEncryptionCipher(e,128);return n.start(t,r),n},a.rc2.createEncryptionCipher=function(e,t){return u(e,t,!0)},a.rc2.startDecrypting=function(e,t,r){var n=a.rc2.createDecryptionCipher(e,128);return n.start(t,r),n},a.rc2.createDecryptionCipher=function(e,t){return u(e,t,!1)},e.exports=a.rc2},function(e,t,r){var a,n,i,s,o,u=r(1),c=!1,p=4,l=function(){c=!0,i=[0,1,2,4,8,16,32,64,128,27,54];for(var e=new Array(256),t=0;t<128;++t)e[t]=t<<1,e[t+128]=t+128<<1^283;a=new Array(256),n=new Array(256),s=new Array(4),o=new Array(4);for(var t=0;t<4;++t)s[t]=new Array(256),o[t]=new Array(256);for(var r,u,p,l,f,d,h,y=0,g=0,t=0;t<256;++t){l=g^g<<1^g<<2^g<<3^g<<4,l=l>>8^255&l^99,a[y]=l,n[l]=y,f=e[l],r=e[y],u=e[r],p=e[u],d=f<<24^l<<16^l<<8^(l^f),h=(r^u^p)<<24^(y^p)<<16^(y^u^p)<<8^(y^r^p);for(var C=0;C<4;++C)s[C][y]=d,o[C][l]=h,d=d<<24|d>>>8,h=h<<24|h>>>8;0===y?y=g=1:(y=r^e[e[e[r^p]]],g^=e[e[g]])}},f=function(e,t){for(var r,n=e.slice(0),s=1,u=n.length,c=u+6+1,l=p*c,f=u;f<l;++f)r=n[f-1],f%u===0?(r=a[r>>>16&255]<<24^a[r>>>8&255]<<16^a[255&r]<<8^a[r>>>24]^i[s]<<24,s++):u>6&&f%u===4&&(r=a[r>>>24]<<24^a[r>>>16&255]<<16^a[r>>>8&255]<<8^a[255&r]),n[f]=n[f-u]^r;if(t){for(var d,h=o[0],y=o[1],g=o[2],C=o[3],v=n.slice(0),l=n.length,f=0,m=l-p;f<l;f+=p,m-=p)if(0===f||f===l-p)v[f]=n[m],v[f+1]=n[m+3],v[f+2]=n[m+2],v[f+3]=n[m+1];else for(var E=0;E<p;++E)d=n[m+E],v[f+(3&-E)]=h[a[d>>>24]]^y[a[d>>>16&255]]^g[a[d>>>8&255]]^C[a[255&d]];n=v}return n},d=function(e,t,r,i){var u,c,p,l,f,d=e.length/4-1;i?(u=o[0],c=o[1],p=o[2],l=o[3],f=n):(u=s[0],c=s[1],p=s[2],l=s[3],f=a);var h,y,g,C,v,m,E;h=t[0]^e[0],y=t[i?3:1]^e[1],g=t[2]^e[2],C=t[i?1:3]^e[3];for(var S=3,I=1;I<d;++I)v=u[h>>>24]^c[y>>>16&255]^p[g>>>8&255]^l[255&C]^e[++S],m=u[y>>>24]^c[g>>>16&255]^p[C>>>8&255]^l[255&h]^e[++S],E=u[g>>>24]^c[C>>>16&255]^p[h>>>8&255]^l[255&y]^e[++S],C=u[C>>>24]^c[h>>>16&255]^p[y>>>8&255]^l[255&g]^e[++S],h=v,y=m,g=E;r[0]=f[h>>>24]<<24^f[y>>>16&255]<<16^f[g>>>8&255]<<8^f[255&C]^e[++S],r[i?3:1]=f[y>>>24]<<24^f[g>>>16&255]<<16^f[C>>>8&255]<<8^f[255&h]^e[++S],r[2]=f[g>>>24]<<24^f[C>>>16&255]<<16^f[h>>>8&255]<<8^f[255&y]^e[++S],r[i?1:3]=f[C>>>24]<<24^f[h>>>16&255]<<16^f[y>>>8&255]<<8^f[255&g]^e[++S]},h=function(e,t,r,a,n){function i(){for(var e=0;e<p;++e)I[e]=E.getInt32();d(R,I,T,a);for(var e=0;e<p;++e)S.putInt32(T[e])}function s(){if(a)for(var e=0;e<p;++e)I[e]=E.getInt32();else for(var e=0;e<p;++e)I[e]=A[e]^E.getInt32();if(d(R,I,T,a),a){for(var e=0;e<p;++e)S.putInt32(A[e]^T[e]);A=I.slice(0)}else{for(var e=0;e<p;++e)S.putInt32(T[e]);A=T}}function o(){d(R,I,T,!1);for(var e=0;e<p;++e)I[e]=E.getInt32();for(var e=0;e<p;++e){var t=I[e]^T[e];a||(I[e]=t),S.putInt32(t)}}function h(){d(R,I,T,!1);for(var e=0;e<p;++e)I[e]=E.getInt32();for(var e=0;e<p;++e)S.putInt32(I[e]^T[e]),I[e]=T[e]}function y(){d(R,I,T,!1);for(var e=p-1;e>=0;--e){if(4294967295!==I[e]){++I[e];break}I[e]=0}for(var e=0;e<p;++e)S.putInt32(E.getInt32()^T[e])}var g=null;if(c||l(),n=(n||"CBC").toUpperCase(),"string"!=typeof e||16!==e.length&&24!==e.length&&32!==e.length){if(u.util.isArray(e)&&(16===e.length||24===e.length||32===e.length))for(var C=e,e=u.util.createBuffer(),v=0;v<C.length;++v)e.putByte(C[v])}else e=u.util.createBuffer(e);if(!u.util.isArray(e)){var C=e;e=[];var m=C.length();if(16===m||24===m||32===m){m>>>=2;for(var v=0;v<m;++v)e.push(C.getInt32())}}if(!u.util.isArray(e)||4!==e.length&&6!==e.length&&8!==e.length)return g;var E,S,I,T,A,b,F,B=["CFB","OFB","CTR"].indexOf(n)!==-1,N="CBC"===n,R=f(e,a&&!B),w=p<<2;if(g={output:null},"CBC"===n)F=s;else if("CFB"===n)F=o;else if("OFB"===n)F=h;else if("CTR"===n)F=y;else{if("ECB"!==n)throw{message:'Unsupported block cipher mode of operation: "'+n+'"'};F=i}return g.update=function(e){for(b||E.putBuffer(e);E.length()>=w||E.length()>0&&b;)F()},g.finish=function(e){var t=!0,r=E.length()%w;if(!a)if(e)t=e(w,E,a);else if(N){var n=E.length()===w?w:w-E.length();E.fillWithByte(n,n)}if(t&&(b=!0,g.update()),a&&(N&&(t=0===r),t))if(e)t=e(w,S,a);else if(N){var i=S.length(),s=S.at(i-1);s>p<<2?t=!1:S.truncate(s)}return!N&&!e&&r>0&&S.truncate(w-r),t},g.start=function(e,t){if(null===e&&(e=A.slice(0)),"undefined"==typeof e&&(e="0000000000000000"),"string"==typeof e&&16===e.length)e=u.util.createBuffer(e);else if(u.util.isArray(e)&&16===e.length)for(var r=e,e=u.util.createBuffer(),a=0;a<16;++a)e.putByte(r[a]);if(!u.util.isArray(e)){var r=e;e=new Array(4),e[0]=r.getInt32(),e[1]=r.getInt32(),e[2]=r.getInt32(),e[3]=r.getInt32()}if(E=u.util.createBuffer(),S=t||u.util.createBuffer(),A=e.slice(0),I=new Array(p),T=new Array(p),b=!1,g.output=S,["CFB","OFB","CTR"].indexOf(n)!==-1){for(var a=0;a<p;++a)I[a]=A[a];A=null}},null!==t&&g.start(t,r),g};u.aes=u.aes||{},u.aes.startEncrypting=function(e,t,r,a){return h(e,t,r,!1,a)},u.aes.createEncryptionCipher=function(e,t){return h(e,null,null,!1,t)},u.aes.startDecrypting=function(e,t,r,a){return h(e,t,r,!0,a)},u.aes.createDecryptionCipher=function(e,t){return h(e,null,null,!0,t)},u.aes._expandKey=function(e,t){return c||l(),f(e,t)},u.aes._updateBlock=d,e.exports=u.aes},function(e,t,r){function a(e){for(var t,r=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],a=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],n=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],i=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],s=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],o=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],u=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],c=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],p=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],l=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],f=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],d=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],h=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],y=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],g=e.length()>8?3:1,C=[],v=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],m=0,E=0;E<g;E++){var S=e.getInt32(),I=e.getInt32();t=252645135&(S>>>4^I),I^=t,S^=t<<4,t=65535&(I>>>-16^S),S^=t,I^=t<<-16,t=858993459&(S>>>2^I),I^=t,S^=t<<2,t=65535&(I>>>-16^S),S^=t,I^=t<<-16,t=1431655765&(S>>>1^I),I^=t,S^=t<<1,t=16711935&(I>>>8^S),S^=t,I^=t<<8,t=1431655765&(S>>>1^I),I^=t,S^=t<<1,t=S<<8|I>>>20&240,S=I<<24|I<<8&16711680|I>>>8&65280|I>>>24&240,I=t;for(var T=0;T<v.length;T++){v[T]?(S=S<<2|S>>>26,I=I<<2|I>>>26):(S=S<<1|S>>>27,I=I<<1|I>>>27),S&=-15,I&=-15;var A=r[S>>>28]|a[S>>>24&15]|n[S>>>20&15]|i[S>>>16&15]|s[S>>>12&15]|o[S>>>8&15]|u[S>>>4&15],b=c[I>>>28]|p[I>>>24&15]|l[I>>>20&15]|f[I>>>16&15]|d[I>>>12&15]|h[I>>>8&15]|y[I>>>4&15];t=65535&(b>>>16^A),C[m++]=A^t,C[m++]=b^t<<16}}return C}var n=r(1),i=r(17),s=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],o=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],u=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],c=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],p=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],l=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],f=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],d=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696],h=function(e,t,r){function h(e,t,r){var a,n,i=e[0],h=e[1];n=3===S?r?[0,32,2]:[30,-2,-2]:r?[0,32,2,62,30,-2,64,96,2]:[94,62,-2,32,64,2,30,-2,-2],a=252645135&(i>>>4^h),h^=a,i^=a<<4,a=65535&(i>>>16^h),h^=a,i^=a<<16,a=858993459&(h>>>2^i),i^=a,h^=a<<2,a=16711935&(h>>>8^i),i^=a,h^=a<<8,a=1431655765&(i>>>1^h),h^=a,i^=a<<1,i=i<<1|i>>>31,h=h<<1|h>>>31;for(var g=0;g<S;g+=3){for(var C=n[g+1],v=n[g+2],m=n[g];m!=C;m+=v){var E=h^y[m],I=(h>>>4|h<<28)^y[m+1];a=i,i=h,h=a^(o[E>>>24&63]|c[E>>>16&63]|l[E>>>8&63]|d[63&E]|s[I>>>24&63]|u[I>>>16&63]|p[I>>>8&63]|f[63&I])}a=i,i=h,h=a}i=i>>>1|i<<31,h=h>>>1|h<<31,a=1431655765&(i>>>1^h),h^=a,i^=a<<1,a=16711935&(h>>>8^i),i^=a,h^=a<<8,a=858993459&(h>>>2^i),i^=a,h^=a<<2,a=65535&(i>>>16^h),h^=a,i^=a<<16,a=252645135&(i>>>4^h),h^=a,i^=a<<4,t[0]=i,t[1]=h}"string"!=typeof e||8!==e.length&&24!==e.length||(e=n.util.createBuffer(e));var y=a(e),r=r?r.toLowerCase():"cbc",g=null,C=[],v=!1,m=null,E=null,S=32===y.length?3:9,I=null;return I={start:function(e,t){if(e?("string"==typeof e&&8===e.length&&(e=n.util.createBuffer(e)),C[0]=e.getInt32(),C[1]=e.getInt32(),g=i.getModeFunction(r,2,C)):g=i.getModeFunction("ecb",2,null),null==g)throw"unsupported mode:"+r;v=!1,m=n.util.createBuffer(),E=t||n.util.createBuffer(),I.output=E},update:function(e){v||m.putBuffer(e),g(h,m,E,!t)},finish:function(e){var a=!0;if(t&&"ofb8"!==r)if(e)a=e(8,m,!t);else{var n=8===m.length()?8:8-m.length();m.fillWithByte(n,n)}if("ofb8"===r&&(a=!1),a&&(v=!0,g(h,m,E,!t)),!t&&(a=0===m.length()))if(e)a=e(8,E,!t);else{var i=E.length(),s=E.at(i-1);s>i?a=!1:E.truncate(s)}return a}}};n.des=n.des||{},n.des.startEncrypting=function(e,t,r,a){var n=h(e,!0,a);return n.start(t,r),n},n.des.createEncryptionCipher=function(e,t){return h(e,!0,t)},n.des.startDecrypting=function(e,t,r,a){var n=h(e,!1,a);return n.start(t,r),n},n.des.createDecryptionCipher=function(e,t){return h(e,!1,t)},e.exports=n.des},function(e,t,r){var a=r(1),n=function(){};n.prototype.cbc=function(e,t){for(var r=[],a=0;a<e;++a)r[a]=t[a];return function(t,a,n,i){for(var s=[],o=[];a.length()>=4*e;){for(var u=0;u<e;++u)s[u]=a.getInt32();if(!i)for(var u=0;u<e;++u)s[u]=r[u]^s[u];if(t(s,o,!i),i){for(var u=0;u<e;++u)n.putInt32(r[u]^o[u]);r=s.slice(0)}else for(var u=0;u<e;++u)n.putInt32(o[u]),r[u]=o[u]}}},n.prototype.ofb=function(e,t,r){var n=t,i=[],s=[];return function(t,o,u,c){for(var p;o.length()>=r/8;){if(n.length>0)for(p=0;p<e;++p)i[p]=n.shift();for(t(i,s,!0),_tempBlock=a.util.createBuffer(),p=0;p<2*e;++p)p<e?_tempBlock.putInt32(i[p]):_tempBlock.putInt32(s[p%e]);for(p=0;p<r/8;++p)_tempBlock.getByte();for(p=0;p<e;++p)i[p]=_tempBlock.getInt32();for(_tempBlock=a.util.createBuffer(),p=0;p<e;++p)_tempBlock.putInt32(s[p]);for(_tempBlock=_tempBlock.getBytes(),p=0;p<r/8;++p)u.putByte(o.getByte()^_tempBlock.charCodeAt(p))}}},n.prototype.getModeFunction=function(e,t,r){if(arguments.length<3)throw"bad input! need more parameter";if(e=e.toLowerCase(),"cbc"===e)return this.cbc(t,r);if(e.indexOf("ofb")!=-1){var a=0;return a=parseInt(e.substr(3)),a=isNaN(a)?8:a,this.ofb(t,r,a)}return null},e.exports=new n},function(e,t,r){function a(e){return s[3][e>>>24&255]^s[2][e>>>16&255]^s[1][e>>>8&255]^s[0][255&e]}function n(e,t){var r=e[0],n=e[1],i=[];return i[0]=n[0]^t[0],i[1]=n[1]^t[1],i[1]^=i[0],i[1]=a(i[1]),i[0]+=i[1],i[0]=a(i[0]),i[1]+=i[0],i[1]=a(i[1]),i[0]+=i[1],r[0]^=i[0],r[1]^=i[1],[n,r]}var i=r(1);i.seed=i.seed||{};var s=[[696885672,92635524,382128852,331600848,340021332,487395612,747413676,621093156,491606364,54739776,403181592,504238620,289493328,1020063996,181060296,591618912,671621160,71581764,536879136,495817116,549511392,583197408,147374280,386339604,629514660,261063564,50529024,994800504,999011256,318968592,314757840,785310444,809529456,210534540,1057960764,680042664,839004720,500027868,919007988,876900468,751624428,361075092,185271048,390550356,474763356,457921368,1032696252,16843008,604250148,470552604,860058480,411603096,268439568,214745292,851636976,432656856,738992172,667411428,843215472,58950528,462132120,297914832,109478532,164217288,541089888,272650320,595829664,734782440,218956044,914797236,512660124,256852812,931640244,441078360,113689284,944271480,646357668,302125584,797942700,365285844,557932896,63161280,881111220,21053760,306336336,1028485500,227377548,134742024,521081628,428446104,0,420024600,67371012,323179344,935850996,566354400,1036907004,910586484,789521196,654779172,813740208,193692552,235799052,730571688,578986656,776888940,327390096,223166796,692674920,1011642492,151585032,168428040,1066382268,802153452,868479984,96846276,126321540,335810580,1053750012,608460900,516870876,772678188,189481800,436867608,101057028,553722144,726360936,642146916,33686016,902164980,310547088,176849544,202113036,864269232,1045328508,281071824,977957496,122110788,377918100,633725412,637936164,8421504,764256684,533713884,562143648,805318704,923218740,781099692,906375732,352653588,570565152,940060728,885321972,663200676,88424772,206323788,25264512,701096424,75792516,394761108,889532724,197903304,248431308,1007431740,826372464,285282576,130532292,160006536,893743476,1003222008,449499864,952692984,344232084,424235352,42107520,80003268,1070593020,155795784,956903736,658989924,12632256,265274316,398971860,948482232,252642060,244220556,37896768,587408160,293704080,743202924,466342872,612671652,872689716,834793968,138952776,46318272,793731948,1024274748,755835180,4210752,1049539260,1041117756,1015853244,29475264,713728680,982168248,240009804,356864340,990589752,483184860,675831912,1062171516,478974108,415813848,172638792,373707348,927429492,545300640,768467436,105267780,897954228,722150184,625303908,986379e3,600040416,965325240,830583216,529503132,508449372,969535992,650568420,847426224,822161712,717939432,760045932,525292380,616882404,817950960,231588300,143163528,369496596,973746744,407392344,348442836,574775904,688464168,117900036,855847728,684253416,453710616,84214020,961114488,276861072,709517928,705307176,445289112],[943196208,3894986976,741149985,2753988258,3423588291,3693006546,2956166067,3090712752,2888798115,1612726368,1410680145,3288844227,1141130304,1815039843,1747667811,1478183763,3221472195,1612857954,808649523,3023406513,673777953,2686484640,3760374498,2754054051,3490956243,2417066385,269549841,67503618,471600144,3158084784,875955762,1208699715,3962556387,2282260608,1814842464,2821228704,337053459,3288646848,336987666,4097098992,3221406402,1141196097,3760308705,3558262482,1010765619,1010634033,2349764226,2551744656,673712160,1276005954,4097230578,1010699826,2753922465,4164536817,202181889,3693072339,3625502928,673909539,1680229986,2017086066,606537507,741281571,4029792753,1882342002,1073889858,3558130896,1073824065,3221274816,1882407795,1680295779,2888600736,2282457987,4097296371,2888666529,2147516544,471797523,3356150466,741084192,2821360290,875824176,3490890450,134941443,3962490594,3895052769,1545424209,2484372624,404228112,4164471024,1410811731,2888732322,134744064,3288712641,269681427,3423456705,2215020162,3090778545,4232040435,2084392305,3221340609,808517937,4097164785,2282392194,1747602018,2956034481,3490824657,538968096,3558328275,131586,539099682,67372032,1747470432,1882276209,67569411,3625700307,2619182481,2551810449,1612792161,3158216370,3827746530,1478052177,3692940753,1343308113,2417000592,3692874960,2551876242,2686682019,2821426083,3490758864,2147582337,202313475,1141327683,404359698,3760440291,3962359008,2349698433,3158282163,2484504210,2017151859,1545358416,2686616226,2686550433,1612923747,539165475,1275940161,3356018880,2619248274,2619116688,943327794,202116096,741215778,3090844338,1814974050,2619314067,1478117970,4029858546,2417132178,4029924339,1208568129,2016954480,3423390912,336921873,4164668403,1882210416,1949648241,2084523891,875889969,269484048,197379,1680098400,1814908257,3288778434,1949582448,3558196689,3023340720,3895118562,134809857,1949714034,404293905,4231974642,1073758272,269615634,3760242912,3158150577,67437825,4164602610,65793,4029726960,673843746,1545490002,2821294497,1410745938,1073955651,2214954369,336856080,2282326401,2551942035,2955968688,3827680737,1208502336,2017020273,2484570003,4231843056,471731730,2147648130,539033889,2349632640,404425491,1545555795,1949779827,1410614352,2956100274,471665937,606405921,1276071747,0,1141261890,3962424801,1477986384,1343373906,3895184355,2084458098,3625634514,3356084673,4231908849,808452144,2484438417,1680164193,1010568240,3023472306,3827614944,3090910131,2084326512,202247682,1343242320,943262001,606471714,808583730,2214888576,1747536225,2417197971,876021555,3827812323,606340128,2753856672,3356216259,1343439699,134875650,2215085955,3625568721,1275874368,2147713923,2349830019,3423522498,943393587,1208633922,3023538099],[2712152457,2172913029,3537114822,3553629123,1347687492,287055117,2695638156,556016901,1364991309,1128268611,270014472,303832590,1364201793,4043062476,3267889866,1667244867,539502600,1078199364,538976256,2442927501,3772784832,3806339778,3234334920,320083719,2711889285,2206994319,50332419,1937259339,3015195531,319820547,3536851650,3807129294,1886400576,2156661900,859586319,2695374984,842019330,3520863693,4076091078,1886663748,3773574348,2442401157,50858763,1398019911,1348213836,1398283083,2981903757,16777473,539239428,270277644,1936732995,2425886856,269488128,3234598092,4075827906,3520600521,539765772,3823380423,1919955522,2206204803,2476219275,3520074177,2189690502,3251112393,1616912448,1347424320,2745181059,3823643595,17566989,2998154886,2459704974,1129058127,3014932359,1381505610,3267626694,1886926920,2728666758,303043074,2745970575,3520337349,1633689921,3284140995,2964599940,1094713665,1380979266,1903967565,2173439373,526344,320610063,2442664329,0,286791945,263172,1397756739,4092868551,3789562305,4059839949,1920218694,590098191,589571847,2964336768,2206731147,34344462,2745707403,2728403586,1651256910,2475692931,1095503181,1634216265,1887190092,17303817,34081290,3015458703,3823906767,4092605379,3250849221,2206467975,269751300,4076617422,1617175620,3537641166,573320718,1128794955,303569418,33818118,555753729,1667771211,1650730566,33554946,4059313605,2458915458,2189953674,789516,3014669187,1920745038,3503296704,1920481866,1128531783,2459178630,3789825477,572794374,2155872384,2712415629,3554418639,2711626113,808464384,859059975,2729193102,842282502,286528773,572531202,808990728,4042536132,2745444231,1094976837,1078725708,2172649857,3790088649,2156135556,2475956103,825505029,3284667339,3268153038,809253900,1903178049,286265601,3284404167,2173176201,1903441221,4093131723,3537377994,4042799304,2425623684,1364728137,2189427330,3234071748,4093394895,1095240009,825768201,1667508039,3233808576,3284930511,3553892295,2964863112,51121935,2190216846,1111491138,589308675,2442137985,1617701964,3554155467,2695111812,808727556,4059050433,1078462536,3267363522,1668034383,826031373,556543245,1077936192,2998681230,842808846,2965126284,3250586049,2728929930,2998418058,1112280654,1364464965,859323147,3504086220,1617438792,1937522511,2426150028,3503823048,1112017482,1381242438,1936996167,2694848640,3790351821,1111754310,2981377413,589835019,1633953093,4076354250,3823117251,2981640585,2981114241,2476482447,1381768782,4059576777,3806602950,2997891714,825241857,3806866122,1634479437,1398546255,3773048004,4042272960,3251375565,2156398728,303306246,842545674,1347950664,3503559876,1650467394,556280073,50595591,858796803,3773311176,320346891,17040645,1903704393,2425360512,1650993738,573057546,2459441802],[137377848,3370182696,220277805,2258805798,3485715471,3469925406,2209591347,2293282872,2409868335,1080057888,1162957845,3351495687,1145062404,1331915823,1264805931,1263753243,3284385795,1113743394,53686323,2243015733,153167913,2158010400,3269648418,2275648551,3285438483,2173800465,17895441,100795398,202382364,2360392764,103953462,1262700555,3487820847,2290124808,1281387564,2292230184,118690839,3300967428,101848086,3304125492,3267543042,1161905157,3252805665,3335705622,255015999,221330493,2390920206,2291177496,136325160,1312967694,3337810998,238173246,2241963045,3388078137,218172429,3486768159,3369130008,186853419,1180853286,1249015866,119743527,253963311,3253858353,1114796082,1111638018,3302020116,1094795265,3233857536,1131638835,1197696039,2359340076,2340653067,3354653751,2376182829,2155905024,252910623,3401762826,203435052,2325915690,70267956,3268595730,184748043,3470978094,3387025449,1297177629,2224067604,135272472,3371235384,1196643351,2393025582,134219784,3317810181,51580947,3452029965,2256700422,2310125625,3488873535,1299283005,3250700289,20000817,3320968245,2323810314,1247963178,2175905841,3251752977,2105376,3352548375,33685506,35790882,67109892,1214277672,1097953329,117638151,3419658267,2375130141,2308020249,1096900641,2394078270,3336758310,1230067737,3453082653,1095847953,2156957712,3436239900,2324863002,2208538659,2342758443,3234910224,2172747777,251857935,1195590663,168957978,3286491171,3437292588,2374077453,2410921023,2257753110,1265858619,1280334876,2191695906,2174853153,1130586147,52633635,1296124941,3368077320,2391972894,2358287388,171063354,201329676,237120558,2326968378,1315073070,2408815647,1246910490,3270701106,2190643218,3287543859,1229015049,1215330360,3435187212,85005333,3421763643,1081110576,1165063221,1332968511,87110709,1052688,50528259,1147167780,1298230317,3334652934,1148220468,3318862869,2226172980,3403868202,151062537,1181905974,152115225,3472030782,1077952512,34738194,3235962912,2377235517,83952645,3404920890,16842753,3237015600,170010666,1314020382,2309072937,1179800598,1128480771,2239857669,68162580,2306967561,2341705755,2159063088,3319915557,1212172296,1232173113,2274595863,3438345276,236067870,2189590530,18948129,2357234700,185800731,1330863135,1198748727,1146115092,2192748594,219225117,86058021,1329810447,0,1178747910,3454135341,1213224984,1112690706,3420710955,1316125758,3402815514,3384920073,3455188029,3158064,2240910357,1164010533,204487740,2259858486,3303072804,2343811131,1282440252,235015182,1079005200,154220601,102900774,36843570,2223014916,1231120425,2207485971,120796215,3353601063,69215268,2225120292,3418605579,1129533459,167905290,2273543175,3385972761,1279282188,2206433283,2407762959,3468872718,187906107,1245857802,2276701239]],o=[2654435769,1013904243,2027808486,4055616972,3816266649,3337566003,2380164711,465362127,930724254,1861448508,3722897016,3150826737,2006686179,4013372358,3731777421,3168587547],u=function(e,t,r){
for(var a=0,i=e.slice(a,a+2),s=e.slice(a+2,a+4),o=[i,s],u=0;u<16;u++)o=n(o,t[u]);o.reverse(),r.splice(a,4,o[0][0],o[0][1],o[1][0],o[1][1])},c=function(e,t,r,a){u(t,e,r)},p=function(e,t,r,n,s){function u(){var e;if(e=m._roundKeys,n){e=m._invRoundKeys;for(var t=0;t<4;++t)d[t]=l.getInt32()}else for(var t=0;t<4;++t)d[t]=C[t]^l.getInt32();if(c(e,d,h,n),n){for(var t=0;t<4;++t)f.putInt32(C[t]^h[t]);C=d.slice(0)}else{for(var t=0;t<4;++t)f.putInt32(h[t]);C=h}}var p,l,f,d,h,y,g,C,v="CBC"===s,m=null,E=16;if("string"!=typeof e||16!=e.length)throw"bad key";return m={_key:e,output:null},g=u,m.update=function(e){for(y||l.putBuffer(e);l.length()>=E||l.length()>0&&y;)g()},m.finish=function(e){var t=!0,r=l.length()%E;if(!n)if(e)t=e(E,l,n);else if(v){var a=l.length()===E?E:E-l.length();l.fillWithByte(a,a)}if(t&&(y=!0,m.update()),n&&(v&&(t=0===r),t))if(e)t=e(E,f,n);else if(v){var i=f.length(),s=f.at(i-1);s>16?t=!1:f.truncate(s)}return!v&&!e&&r>0&&f.truncate(E-r),t},m.start=function(e,t){if(p=e,"string"==typeof e&&16===e.length)e=i.util.createBuffer(e);else if(i.util.isArray(e)&&16===e.length){var r=e;e=i.util.createBuffer();for(var n=0;n<16;++n)e.putByte(r[n])}if(l=i.util.createBuffer(),f=t||i.util.createBuffer(),C=[],C.splice(0,4,e.getInt32(),e.getInt32(),e.getInt32(),e.getInt32()),d=new Array(4),h=new Array(4),y=!1,m.output=f,["CFB","OFB","CTR"].indexOf(s)!==-1){for(n=0;n<4;++n)d[n]=C[n];C=null}var u=i.util.createBuffer(this._key),c=u.getInt32(),g=u.getInt32(),v=u.getInt32(),E=u.getInt32(),S=[];for(n=0;n<16;n++)if(S[n]=[],S[n][0]=a(c+v-o[n]),S[n][1]=a(g-E+o[n]),n%2==0){var I=c;c=c>>>8|g<<24,g=g>>>8|I<<24}else{var T=v;v=v<<8|E>>>24,E=E<<8|T>>>24}this._roundKeys=S,this._invRoundKeys=S.slice().reverse()},null!==t&&m.start(t,r),m};i.seed.createEncryptionCipher=function(e,t){return p(e,null,null,!1,t)},i.seed.createDecryptionCipher=function(e,t){return p(e,null,null,!0,t)},e.exports=i.seed},function(e,t,r){function a(e,t){for(var r=[],a=0;a<e.length;++a)r[a]=e[a]^t[a];return r=i(1,r),r=s(r)}function n(e,t){for(var r=[],a=0;a<e.length;++a)r[a]=e[a]^t[a];return r=i(2,r),r=s(r)}function i(e,t){var r=[];X=u.util.createBuffer();for(var a=0;a<t.length;++a)X.putInt32(t[a]);if(1==e)r[0]=d[X.getByte()],r[0]<<=8,r[0]|=h[X.getByte()],r[0]<<=8,r[0]|=y[X.getByte()],r[0]<<=8,r[0]|=g[X.getByte()],r[1]=d[X.getByte()],r[1]<<=8,r[1]|=h[X.getByte()],r[1]<<=8,r[1]|=y[X.getByte()],r[1]<<=8,r[1]|=g[X.getByte()],r[2]=d[X.getByte()],r[2]<<=8,r[2]|=h[X.getByte()],r[2]<<=8,r[2]|=y[X.getByte()],r[2]<<=8,r[2]|=g[X.getByte()],r[3]=d[X.getByte()],r[3]<<=8,r[3]|=h[X.getByte()],r[3]<<=8,r[3]|=y[X.getByte()],r[3]<<=8,r[3]|=g[X.getByte()];else{if(2!=e)throw"internal error";r[0]=y[X.getByte()],r[0]<<=8,r[0]|=g[X.getByte()],r[0]<<=8,r[0]|=d[X.getByte()],r[0]<<=8,r[0]|=h[X.getByte()],r[1]=y[X.getByte()],r[1]<<=8,r[1]|=g[X.getByte()],r[1]<<=8,r[1]|=d[X.getByte()],r[1]<<=8,r[1]|=h[X.getByte()],r[2]=y[X.getByte()],r[2]<<=8,r[2]|=g[X.getByte()],r[2]<<=8,r[2]|=d[X.getByte()],r[2]<<=8,r[2]|=h[X.getByte()],r[3]=y[X.getByte()],r[3]<<=8,r[3]|=g[X.getByte()],r[3]<<=8,r[3]|=d[X.getByte()],r[3]<<=8,r[3]|=h[X.getByte()]}return r}function s(e){var t=[];if(e.length<16){var r=u.util.createBuffer();for(e.map(function(e){r.putInt32(e)}),e=[];r.length()>0;)e.push(r.getByte())}return t[0]=e[3]^e[4]^e[6]^e[8]^e[9]^e[13]^e[14],t[0]<<=8,t[0]|=e[2]^e[5]^e[7]^e[8]^e[9]^e[12]^e[15],t[0]<<=8,t[0]|=e[1]^e[4]^e[6]^e[10]^e[11]^e[12]^e[15],t[0]<<=8,t[0]|=e[0]^e[5]^e[7]^e[10]^e[11]^e[13]^e[14],t[1]=e[0]^e[2]^e[5]^e[8]^e[11]^e[14]^e[15],t[1]<<=8,t[1]|=e[1]^e[3]^e[4]^e[9]^e[10]^e[14]^e[15],t[1]<<=8,t[1]|=e[0]^e[2]^e[7]^e[9]^e[10]^e[12]^e[13],t[1]<<=8,t[1]|=e[1]^e[3]^e[6]^e[8]^e[11]^e[12]^e[13],t[2]=e[0]^e[1]^e[4]^e[7]^e[10]^e[13]^e[15],t[2]<<=8,t[2]|=e[0]^e[1]^e[5]^e[6]^e[11]^e[12]^e[14],t[2]<<=8,t[2]|=e[2]^e[3]^e[5]^e[6]^e[8]^e[13]^e[15],t[2]<<=8,t[2]|=e[2]^e[3]^e[4]^e[7]^e[9]^e[12]^e[14],t[3]=e[1]^e[2]^e[6]^e[7]^e[9]^e[11]^e[12],t[3]<<=8,t[3]|=e[0]^e[3]^e[6]^e[7]^e[8]^e[10]^e[13],t[3]<<=8,t[3]|=e[0]^e[3]^e[4]^e[5]^e[9]^e[11]^e[14],t[3]<<=8,t[3]|=e[1]^e[2]^e[4]^e[5]^e[8]^e[10]^e[15],t}function o(e,t,r){var a=[],n=4-parseInt(r/32),i=r%32,s=32-i;return a[0]=t[n%4]>>>i^t[(n+3)%4]<<s^e[0],a[1]=t[(n+1)%4]>>>i^t[n%4]<<s^e[1],a[2]=t[(n+2)%4]>>>i^t[(n+1)%4]<<s^e[2],a[3]=t[(n+3)%4]>>>i^t[(n+2)%4]<<s^e[3],a}var u=r(1);u.aria=u.aria||{};var c=4,p=[1367130551,656542356,4262702056,4204424928],l=[1840335564,2653014048,4280857045,4015907504],f=[3683792669,556198256,52729717,82364686],d=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22],h=[226,78,84,252,148,194,74,204,98,13,106,70,60,77,139,209,94,250,100,203,180,151,190,43,188,119,46,3,211,25,89,193,29,6,65,107,85,240,153,105,234,156,24,174,99,223,231,187,0,115,102,251,150,76,133,228,58,9,69,170,15,238,16,235,45,127,244,41,172,207,173,145,141,120,200,149,249,47,206,205,8,122,136,56,92,131,42,40,71,219,184,199,147,164,18,83,255,135,14,49,54,33,88,72,1,142,55,116,50,202,233,177,183,171,12,215,196,86,66,38,7,152,96,217,182,185,17,64,236,32,140,189,160,201,132,4,73,35,241,79,80,31,19,220,216,192,158,87,227,195,123,101,59,2,143,62,232,37,146,229,21,221,253,23,169,191,212,154,126,197,57,103,254,118,157,67,167,225,208,245,104,242,27,52,112,5,163,138,213,121,134,168,48,198,81,75,30,166,39,246,53,210,110,36,22,130,95,218,230,117,162,239,44,178,28,159,93,111,128,10,114,68,155,108,144,11,91,51,125,90,82,243,97,161,247,176,214,63,124,109,237,20,224,165,61,34,179,248,137,222,113,26,175,186,181,129],y=[82,9,106,213,48,54,165,56,191,64,163,158,129,243,215,251,124,227,57,130,155,47,255,135,52,142,67,68,196,222,233,203,84,123,148,50,166,194,35,61,238,76,149,11,66,250,195,78,8,46,161,102,40,217,36,178,118,91,162,73,109,139,209,37,114,248,246,100,134,104,152,22,212,164,92,204,93,101,182,146,108,112,72,80,253,237,185,218,94,21,70,87,167,141,157,132,144,216,171,0,140,188,211,10,247,228,88,5,184,179,69,6,208,44,30,143,202,63,15,2,193,175,189,3,1,19,138,107,58,145,17,65,79,103,220,234,151,242,207,206,240,180,230,115,150,172,116,34,231,173,53,133,226,249,55,232,28,117,223,110,71,241,26,113,29,41,197,137,111,183,98,14,170,24,190,27,252,86,62,75,198,210,121,32,154,219,192,254,120,205,90,244,31,221,168,51,136,7,199,49,177,18,16,89,39,128,236,95,96,81,127,169,25,181,74,13,45,229,122,159,147,201,156,239,160,224,59,77,174,42,245,176,200,235,187,60,131,83,153,97,23,43,4,126,186,119,214,38,225,105,20,99,85,33,12,125],g=[48,104,153,27,135,185,33,120,80,57,219,225,114,9,98,60,62,126,94,142,241,160,204,163,42,29,251,182,214,32,196,141,129,101,245,137,203,157,119,198,87,67,86,23,212,64,26,77,192,99,108,227,183,200,100,106,83,170,56,152,12,244,155,237,127,34,118,175,221,58,11,88,103,136,6,195,53,13,1,139,140,194,230,95,2,36,117,147,102,30,229,226,84,216,16,206,122,232,8,44,18,151,50,171,180,39,10,35,223,239,202,217,184,250,220,49,107,209,173,25,73,189,81,150,238,228,168,65,218,255,205,85,134,54,190,97,82,248,187,14,130,72,105,154,224,71,158,92,4,75,52,21,121,38,167,222,41,174,146,215,132,233,210,186,93,243,197,176,191,164,59,113,68,70,43,252,235,111,213,246,20,254,124,112,90,125,253,47,24,131,22,165,145,31,5,149,116,169,193,91,74,133,109,19,7,79,78,69,178,15,201,28,166,188,236,115,144,123,207,89,143,161,249,45,242,177,0,148,55,159,208,46,156,110,40,63,128,240,61,211,37,138,181,231,66,179,199,234,247,76,17,51,3,162,172,96],C=function(e,t,r,s){var o=[],u=[];o[0]=e;for(var c=1;c<s;++c)c%2==1?o[c]=a(o[c-1],t[c]):o[c]=n(o[c-1],t[c]);for(var c=0;c<o[s-1].length;++c)u[c]=o[s-1][c]^t[s][c];u=i(2,u);for(var c=0;c<u.length;++c)r[c]=u[c]^t[s+1][c]},v=function(e,t,r,i,d){function h(){var e,t,r,c,p,l,f,d=[0,0,0,0];for(e=F._key.slice(0,4),t=F._key.slice(4),t=t.concat(d).slice(0,4),r=e,c=a(r,R),f=0;f<c.length;++f)c[f]=c[f]^t[f];for(p=n(c,w),f=0;f<c.length;++f)p[f]=p[f]^r[f];for(l=a(p,U),f=0;f<c.length;++f)l[f]=l[f]^c[f];var h;h=u.util.createBuffer(),r.map(function(e){h.putInt32(e)}),u.consoleLog,h=u.util.createBuffer(),c.map(function(e){h.putInt32(e)}),u.consoleLog,h=u.util.createBuffer(),p.map(function(e){h.putInt32(e)}),u.consoleLog,h=u.util.createBuffer(),l.map(function(e){h.putInt32(e)}),u.consoleLog,F.W0=r,F.W1=c,F.W2=p,F.W3=l;var y=[];for(y[1]=o(r,c,19),y[2]=o(c,p,19),y[3]=o(p,l,19),y[4]=o(l,r,19),y[5]=o(r,c,31),y[6]=o(c,p,31),y[7]=o(p,l,31),y[8]=o(l,r,31),y[9]=o(r,c,67),y[10]=o(c,p,67),y[11]=o(p,l,67),y[12]=o(l,r,67),y[13]=o(r,c,97),y[14]=o(c,p,97),y[15]=o(p,l,97),y[16]=o(l,r,97),y[17]=o(r,c,109),f=1;f<y.length;++f){var h=u.util.createBuffer();y[f].map(function(e){h.putInt32(e)}),u.consoleLog}if(F._roundKeys=y,i){var g=[];for(f=1;f<N+2;++f)g[f]=y[N+2-f],1!=f&&f!=N+1&&(g[f]=s(g[f]));for(f=1;f<g.length;++f){var h=u.util.createBuffer();g[f].map(function(e){h.putInt32(e)}),u.consoleLog}F._roundKeys=g}}function y(){var e;e=F._roundKeys;for(var t=0;t<c;++t)E[t]=v.getInt32();P(e,E,S,i);for(var t=0;t<c;++t)m.putInt32(S[t])}function g(){var e;if(e=F._roundKeys,i)for(var t=0;t<4;++t)E[t]=v.getInt32();else for(var t=0;t<4;++t)E[t]=A[t]^v.getInt32();if(P(e,E,S,i),i){for(var t=0;t<4;++t)m.putInt32(A[t]^S[t]);A=E.slice(0)}else{for(var t=0;t<4;++t)m.putInt32(S[t]);A=S}}d=(d||"CBC").toUpperCase();var v,m,E,S,I,T,A,b="CBC"===d,F=null,B=16,N=0;F={_key:e,output:null};var R,w,U;if(16==e.length)N=12,R=p,w=l,U=f;else if(24==e.length)N=14,R=l,w=f,U=p;else{if(32!=e.length)throw"bad key length";N=16,R=f,w=p,U=l}if("CBC"===d)T=g;else if("CFB"===d)T=cfbOp;else if("OFB"===d)T=ofbOp;else if("CTR"===d)T=ctrOp;else{if("ECB"!==d)throw{message:'Unsupported block cipher mode of operation: "'+d+'"'};T=y}for(F._key=[],e=u.util.createBuffer(e);e.length()>0;)F._key.push(e.getInt32());h();var P=function(e,t,r,a){C(t,e,r,N)};return F.update=function(e){for(I||v.putBuffer(e);v.length()>=B||v.length()>0&&I;)T()},F.finish=function(e){var t=!0,r=v.length()%B;if(!i)if(e)t=e(B,v,i);else if(b){var a=v.length()===B?B:B-v.length();v.fillWithByte(a,a)}if(t&&(I=!0,F.update()),i&&(b&&(t=0===r),t))if(e)t=e(B,m,i);else if(b){var n=m.length(),s=m.at(n-1);s>16?t=!1:m.truncate(s)}return!b&&!e&&r>0&&m.truncate(B-r),t},F.start=function(e,t){if("undefined"==typeof e&&(e="0000000000000000"),null===e&&(e=A.slice(0)),"string"==typeof e&&16===e.length)e=u.util.createBuffer(e);else if(u.util.isArray(e)&&16===e.length)for(var r=e,e=u.util.createBuffer(),a=0;a<16;++a)e.putByte(r[a]);if(!u.util.isArray(e)){var r=e;e=new Array(4),e[0]=r.getInt32(),e[1]=r.getInt32(),e[2]=r.getInt32(),e[3]=r.getInt32()}if(v=u.util.createBuffer(),m=t||u.util.createBuffer(),A=e.slice(0),E=new Array(c),S=new Array(c),I=!1,F.output=m,["CFB","OFB","CTR"].indexOf(d)!==-1){for(var a=0;a<c;++a)E[a]=A[a];A=null}},null!==t&&F.start(t,r),F};u.aria.createEncryptionCipher=function(e,t){return v(e,null,null,!1,t)},u.aria.createDecryptionCipher=function(e,t){return v(e,null,null,!0,t)},e.exports=u.aria},function(e,t,r){var a=r(1),n=a.asn1=a.asn1||{};n.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192},n.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30},n.create=function(e,t,r,n){if(a.util.isArray(n)){for(var i=[],s=0;s<n.length;++s)void 0!==n[s]&&i.push(n[s]);n=i}return{tagClass:e,type:t,constructed:r,composed:r||a.util.isArray(n),value:n}};var i=function(e){var t=e.getByte();if(128!==t){var r,a=128&t;return r=a?e.getInt((127&t)<<3):t}};n.fromDer=function(e,t){if(void 0===t&&(t=!0),"string"==typeof e&&(e=a.util.createBuffer(e)),e.length()<2)throw{message:"Too few bytes to parse DER.",bytes:e.length()};var r=e.getByte(),s=192&r,o=31&r,u=i(e);if(e.length()<u){if(t)throw{message:"Too few bytes to read ASN.1 value.",detail:e.length()+" < "+u};u=e.length()}var c,p=32===(32&r),l=p;if(!l&&s===n.Class.UNIVERSAL&&o===n.Type.BITSTRING&&u>1){var f=e.read,d=e.getByte(),h=!1;if(0===d&&h){r=e.getByte();var y=192&r;if(y===n.Class.UNIVERSAL||y===n.Class.CONTEXT_SPECIFIC)try{var g=i(e);l=g===u-(e.read-f),l&&(++f,--u)}catch(e){}}e.read=f}if(l)if(c=[],void 0===u)for(;;){if(e.bytes(2)===String.fromCharCode(0,0)){e.getBytes(2);break}c.push(n.fromDer(e,t))}else for(var C=e.length();u>0;)c.push(n.fromDer(e,t)),u-=C-e.length(),C=e.length();else{if(void 0===u){if(t)throw{message:"Non-constructed ASN.1 object of indefinite length."};u=e.length()}if(o===n.Type.BMPSTRING){c="";for(var v=0;v<u;v+=2)c+=String.fromCharCode(e.getInt16())}else c=e.getBytes(u)}return n.create(s,o,p,c)},n.toDer=function(e){var t=a.util.createBuffer(),r=e.tagClass|e.type,i=a.util.createBuffer();if(e.composed){e.constructed?r|=32:i.putByte(0);for(var s=0;s<e.value.length;++s)void 0!==e.value[s]&&i.putBuffer(n.toDer(e.value[s]))}else if(e.type===n.Type.BMPSTRING)for(var s=0;s<e.value.length;++s)i.putInt16(e.value.charCodeAt(s));else i.putBytes(e.value);if(t.putByte(r),i.length()<=127)t.putByte(127&i.length());else{var o=i.length(),u="";do u+=String.fromCharCode(255&o),o>>>=8;while(o>0);t.putByte(128|u.length);for(var s=u.length-1;s>=0;--s)t.putByte(u.charCodeAt(s))}return t.putBuffer(i),t},n.oidToDer=function(e){var t=e.split("."),r=a.util.createBuffer();r.putByte(40*parseInt(t[0],10)+parseInt(t[1],10));for(var n,i,s,o,u=2;u<t.length;++u){n=!0,i=[],s=parseInt(t[u],10);do o=127&s,s>>>=7,n||(o|=128),i.push(o),n=!1;while(s>0);for(var c=i.length-1;c>=0;--c)r.putByte(i[c])}return r},n.derToOid=function(e){var t;"string"==typeof e&&(e=a.util.createBuffer(e));var r=e.getByte();t=Math.floor(r/40)+"."+r%40;for(var n=0;e.length()>0;)r=e.getByte(),n<<=7,128&r?n+=127&r:(t+="."+(n+r),n=0);return t},n.utcTimeToDate=function(e){var t=new Date,r=parseInt(e.substr(0,2),10);r=r>=50?1900+r:2e3+r;var a=parseInt(e.substr(2,2),10)-1,n=parseInt(e.substr(4,2),10),i=parseInt(e.substr(6,2),10),s=parseInt(e.substr(8,2),10),o=0;if(e.length>11){var u=e.charAt(10),c=10;"+"!==u&&"-"!==u&&(o=parseInt(e.substr(10,2),10),c+=2)}if(t.setUTCFullYear(r,a,n),t.setUTCHours(i,s,o,0),c&&(u=e.charAt(c),"+"===u||"-"===u)){var p=parseInt(e.substr(c+1,2),10),l=parseInt(e.substr(c+4,2),10),f=60*p+l;f*=6e4,"+"===u?t.setTime(+t-f):t.setTime(+t+f)}return t},n.generalizedTimeToDate=function(e){var t=new Date,r=parseInt(e.substr(0,4),10),a=parseInt(e.substr(4,2),10)-1,n=parseInt(e.substr(6,2),10),i=parseInt(e.substr(8,2),10),s=parseInt(e.substr(10,2),10),o=parseInt(e.substr(12,2),10),u=0,c=0,p=!1;"Z"===e.charAt(e.length-1)&&(p=!0);var l=e.length-5,f=e.charAt(l);if("+"===f||"-"===f){var d=parseInt(e.substr(l+1,2),10),h=parseInt(e.substr(l+4,2),10);c=60*d+h,c*=6e4,"+"===f&&(c*=-1),p=!0}return"."===e.charAt(14)&&(u=1e3*parseFloat(e.substr(14),10)),p?(t.setUTCFullYear(r,a,n),t.setUTCHours(i,s,o,u),t.setTime(+t+c)):(t.setFullYear(r,a,n),t.setHours(i,s,o,u)),t},n.dateToUtcTime=function(e){var t="",r=[];r.push((""+e.getUTCFullYear()).substr(2)),r.push(""+(e.getUTCMonth()+1)),r.push(""+e.getUTCDate()),r.push(""+e.getUTCHours()),r.push(""+e.getUTCMinutes()),r.push(""+e.getUTCSeconds());for(var a=0;a<r.length;++a)r[a].length<2&&(t+="0"),t+=r[a];return t+="Z"},n.integerToDer=function(e){var t=a.util.createBuffer();if(e>=-128&&e<128)return t.putSignedInt(e,8);if(e>=-32768&&e<32768)return t.putSignedInt(e,16);if(e>=-8388608&&e<8388608)return t.putSignedInt(e,24);if(e>=-2147483648&&e<2147483648)return t.putSignedInt(e,32);throw{message:"Integer too large; max is 32-bits.",integer:e}},n.derToInteger=function(e){"string"==typeof e&&(e=a.util.createBuffer(e));var t=8*e.length();if(t>32)throw{message:"Integer too large; max is 32-bits."};return e.getSignedInt(t)},n.validate=function(e,t,r,i){var s=!1;if(e.tagClass!==t.tagClass&&"undefined"!=typeof t.tagClass||e.type!==t.type&&"undefined"!=typeof t.type)i&&(e.tagClass!==t.tagClass&&i.push("["+t.name+'] Expected tag class "'+t.tagClass+'", got "'+e.tagClass+'"'),e.type!==t.type&&i.push("["+t.name+'] Expected type "'+t.type+'", got "'+e.type+'"'));else if(e.constructed===t.constructed||"undefined"==typeof t.constructed){if(s=!0,t.value&&a.util.isArray(t.value))for(var o=0,u=0;s&&u<t.value.length;++u)s=t.value[u].optional||!1,e.value[o]&&(s=n.validate(e.value[o],t.value[u],r,i),s?++o:t.value[u].optional&&(s=!0)),!s&&i&&i.push("["+t.name+'] Tag class "'+t.tagClass+'", type "'+t.type+'" expected value length "'+t.value.length+'", got "'+e.value.length+'"');s&&r&&(t.capture&&(r[t.capture]=e.value),t.captureAsn1&&(r[t.captureAsn1]=e))}else i&&i.push("["+t.name+'] Expected constructed "'+t.constructed+'", got "'+e.constructed+'"');return s};var s=/[^\\u0000-\\u00ff]/;n.prettyPrint=function(e,t,r){var i="";t=t||0,r=r||2,t>0&&(i+="\n");for(var o="",u=0;u<t*r;++u)o+=" ";switch(i+=o+"Tag: ",e.tagClass){case n.Class.UNIVERSAL:i+="Universal:";break;case n.Class.APPLICATION:i+="Application:";break;case n.Class.CONTEXT_SPECIFIC:i+="Context-Specific:";break;case n.Class.PRIVATE:i+="Private:"}if(e.tagClass===n.Class.UNIVERSAL)switch(i+=e.type,e.type){case n.Type.NONE:i+=" (None)";break;case n.Type.BOOLEAN:i+=" (Boolean)";break;case n.Type.BITSTRING:i+=" (Bit string)";break;case n.Type.INTEGER:i+=" (Integer)";break;case n.Type.OCTETSTRING:i+=" (Octet string)";break;case n.Type.NULL:i+=" (Null)";break;case n.Type.OID:i+=" (Object Identifier)";break;case n.Type.ODESC:i+=" (Object Descriptor)";break;case n.Type.EXTERNAL:i+=" (External or Instance of)";break;case n.Type.REAL:i+=" (Real)";break;case n.Type.ENUMERATED:i+=" (Enumerated)";break;case n.Type.EMBEDDED:i+=" (Embedded PDV)";break;case n.Type.UTF8:i+=" (UTF8)";break;case n.Type.ROID:i+=" (Relative Object Identifier)";break;case n.Type.SEQUENCE:i+=" (Sequence)";break;case n.Type.SET:i+=" (Set)";break;case n.Type.PRINTABLESTRING:i+=" (Printable String)";break;case n.Type.IA5String:i+=" (IA5String (ASCII))";break;case n.Type.UTCTIME:i+=" (UTC time)";break;case n.Type.GENERALIZEDTIME:i+=" (Generalized time)";break;case n.Type.BMPSTRING:i+=" (BMP String)"}else i+=e.type;if(i+="\n",i+=o+"Constructed: "+e.constructed+"\n",e.composed){for(var c=0,p="",u=0;u<e.value.length;++u)void 0!==e.value[u]&&(c+=1,p+=n.prettyPrint(e.value[u],t+1,r),u+1<e.value.length&&(p+=","));i+=o+"Sub values: "+c+p}else{if(i+=o+"Value: ",e.type===n.Type.OID){var l=n.derToOid(e.value);i+=l,a.pki&&a.pki.oids&&l in a.pki.oids&&(i+=" ("+a.pki.oids[l]+")")}if(e.type===n.Type.INTEGER)try{i+=n.derToInteger(e.value)}catch(t){i+="0x"+a.util.bytesToHex(e.value)}else i+=s.test(e.value)?"0x"+a.util.createBuffer(e.value,"utf8").toHex():0===e.value.length?"[null]":e.value}return i},n.generateBitString=function(e,t){function r(e){return(128&e)>>7|(64&e)>>5|(32&e)>>3|(16&e)>>1|(8&e)<<1|(4&e)<<3|(2&e)<<5|(1&e)<<7}var a=ytcrypto.jsbn.BigInteger.ZERO;a=a.setBit(t);var n=[],i=a.toByteArrayUnsigned();i.forEach(function(e){n.unshift(r(e))});var s=a.bitLength()%8;return 0!=s&&(s=8-s),n.unshift(s),n=n.map(function(e){return String.fromCharCode(e)}),n=n.join("")},e.exports=n},function(e,t,r){function a(e,t,r){this.data=[],null!=e&&("number"==typeof e?this.fromNumber(e,t,r):null==t&&"string"!=typeof e?this.fromString(e,256):this.fromString(e,t))}function n(){return new a(null)}function i(e,t,r,a,n,i){for(;--i>=0;){var s=t*this.data[e++]+r.data[a]+n;n=Math.floor(s/67108864),r.data[a++]=67108863&s}return n}function s(e,t,r,a,n,i){for(var s=32767&t,o=t>>15;--i>=0;){var u=32767&this.data[e],c=this.data[e++]>>15,p=o*u+c*s;u=s*u+((32767&p)<<15)+r.data[a]+(1073741823&n),n=(u>>>30)+(p>>>15)+o*c+(n>>>30),r.data[a++]=1073741823&u}return n}function o(e,t,r,a,n,i){for(var s=16383&t,o=t>>14;--i>=0;){var u=16383&this.data[e],c=this.data[e++]>>14,p=o*u+c*s;u=s*u+((16383&p)<<14)+r.data[a]+n,n=(u>>28)+(p>>14)+o*c,r.data[a++]=268435455&u}return n}function u(e){return ct.charAt(e)}function c(e,t){var r=pt[e.charCodeAt(t)];return null==r?-1:r}function p(e){for(var t=this.t-1;t>=0;--t)e.data[t]=this.data[t];e.t=this.t,e.s=this.s}function l(e){this.t=1,this.s=e<0?-1:0,e>0?this.data[0]=e:e<-1?this.data[0]=e+this.DV:this.t=0}function f(e){var t=n();return t.fromInt(e),t}function d(e,t){var r;if(16==t)r=4;else if(8==t)r=3;else if(256==t)r=8;else if(2==t)r=1;else if(32==t)r=5;else{if(4!=t)return void this.fromRadix(e,t);r=2}this.t=0,this.s=0;for(var n=e.length,i=!1,s=0;--n>=0;){var o;if(o=8==r?e.charCodeAt?e.charCodeAt(n):e[n]:c(e,n),o>=256)throw"input data is not binary";o<0?e.charAt?"-"==e.charAt(n)&&(i=!0):"-"==e[n]&&(i=!0):(i=!1,0==s?this.data[this.t++]=o:s+r>this.DB?(this.data[this.t-1]|=(o&(1<<this.DB-s)-1)<<s,this.data[this.t++]=o>>this.DB-s):this.data[this.t-1]|=o<<s,s+=r,s>=this.DB&&(s-=this.DB))}8==r&&0!=(128&e[0])&&(this.s=-1,s>0&&(this.data[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),i&&a.ZERO.subTo(this,this)}function h(){for(var e=this.s&this.DM;this.t>0&&this.data[this.t-1]==e;)--this.t}function y(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(16==e)t=4;else if(8==e)t=3;else if(2==e)t=1;else if(32==e)t=5;else{if(4!=e)return this.toRadix(e);t=2}var r,a=(1<<t)-1,n=!1,i="",s=this.t,o=this.DB-s*this.DB%t;if(s-- >0)for(o<this.DB&&(r=this.data[s]>>o)>0&&(n=!0,i=u(r));s>=0;)o<t?(r=(this.data[s]&(1<<o)-1)<<t-o,r|=this.data[--s]>>(o+=this.DB-t)):(r=this.data[s]>>(o-=t)&a,o<=0&&(o+=this.DB,--s)),r>0&&(n=!0),n&&(i+=u(r));return n?i:"0"}function g(){var e=n();return a.ZERO.subTo(this,e),e}function C(){return this.s<0?this.negate():this}function v(e){var t=this.s-e.s;if(0!=t)return t;var r=this.t;if(t=r-e.t,0!=t)return this.s<0?-t:t;for(;--r>=0;)if(0!=(t=this.data[r]-e.data[r]))return t;return 0}function m(e){var t,r=1;return 0!=(t=e>>>16)&&(e=t,r+=16),0!=(t=e>>8)&&(e=t,r+=8),0!=(t=e>>4)&&(e=t,r+=4),0!=(t=e>>2)&&(e=t,r+=2),0!=(t=e>>1)&&(e=t,r+=1),r}function E(){return this.t<=0?0:this.DB*(this.t-1)+m(this.data[this.t-1]^this.s&this.DM)}function S(e,t){var r;for(r=this.t-1;r>=0;--r)t.data[r+e]=this.data[r];for(r=e-1;r>=0;--r)t.data[r]=0;t.t=this.t+e,t.s=this.s}function I(e,t){for(var r=e;r<this.t;++r)t.data[r-e]=this.data[r];t.t=Math.max(this.t-e,0),t.s=this.s}function T(e,t){var r,a=e%this.DB,n=this.DB-a,i=(1<<n)-1,s=Math.floor(e/this.DB),o=this.s<<a&this.DM;for(r=this.t-1;r>=0;--r)t.data[r+s+1]=this.data[r]>>n|o,o=(this.data[r]&i)<<a;for(r=s-1;r>=0;--r)t.data[r]=0;t.data[s]=o,t.t=this.t+s+1,t.s=this.s,t.clamp()}function A(e,t){t.s=this.s;var r=Math.floor(e/this.DB);if(r>=this.t)return void(t.t=0);var a=e%this.DB,n=this.DB-a,i=(1<<a)-1;t.data[0]=this.data[r]>>a;for(var s=r+1;s<this.t;++s)t.data[s-r-1]|=(this.data[s]&i)<<n,t.data[s-r]=this.data[s]>>a;a>0&&(t.data[this.t-r-1]|=(this.s&i)<<n),t.t=this.t-r,t.clamp()}function b(e,t){for(var r=0,a=0,n=Math.min(e.t,this.t);r<n;)a+=this.data[r]-e.data[r],t.data[r++]=a&this.DM,a>>=this.DB;if(e.t<this.t){for(a-=e.s;r<this.t;)a+=this.data[r],t.data[r++]=a&this.DM,a>>=this.DB;a+=this.s}else{for(a+=this.s;r<e.t;)a-=e.data[r],t.data[r++]=a&this.DM,a>>=this.DB;a-=e.s}t.s=a<0?-1:0,a<-1?t.data[r++]=this.DV+a:a>0&&(t.data[r++]=a),t.t=r,t.clamp()}function F(e,t){var r=this.abs(),n=e.abs(),i=r.t;for(t.t=i+n.t;--i>=0;)t.data[i]=0;for(i=0;i<n.t;++i)t.data[i+r.t]=r.am(0,n.data[i],t,i,0,r.t);t.s=0,t.clamp(),this.s!=e.s&&a.ZERO.subTo(t,t)}function B(e){for(var t=this.abs(),r=e.t=2*t.t;--r>=0;)e.data[r]=0;for(r=0;r<t.t-1;++r){var a=t.am(r,t.data[r],e,2*r,0,1);(e.data[r+t.t]+=t.am(r+1,2*t.data[r],e,2*r+1,a,t.t-r-1))>=t.DV&&(e.data[r+t.t]-=t.DV,e.data[r+t.t+1]=1)}e.t>0&&(e.data[e.t-1]+=t.am(r,t.data[r],e,2*r,0,1)),e.s=0,e.clamp()}function N(e,t,r){var i=e.abs();if(!(i.t<=0)){var s=this.abs();if(s.t<i.t)return null!=t&&t.fromInt(0),void(null!=r&&this.copyTo(r));null==r&&(r=n());var o=n(),u=this.s,c=e.s,p=this.DB-m(i.data[i.t-1]);p>0?(i.lShiftTo(p,o),s.lShiftTo(p,r)):(i.copyTo(o),s.copyTo(r));var l=o.t,f=o.data[l-1];if(0!=f){var d=f*(1<<this.F1)+(l>1?o.data[l-2]>>this.F2:0),h=this.FV/d,y=(1<<this.F1)/d,g=1<<this.F2,C=r.t,v=C-l,E=null==t?n():t;for(o.dlShiftTo(v,E),r.compareTo(E)>=0&&(r.data[r.t++]=1,r.subTo(E,r)),a.ONE.dlShiftTo(l,E),E.subTo(o,o);o.t<l;)o.data[o.t++]=0;for(;--v>=0;){var S=r.data[--C]==f?this.DM:Math.floor(r.data[C]*h+(r.data[C-1]+g)*y);if((r.data[C]+=o.am(0,S,r,v,0,l))<S)for(o.dlShiftTo(v,E),r.subTo(E,r);r.data[C]<--S;)r.subTo(E,r)}null!=t&&(r.drShiftTo(l,t),u!=c&&a.ZERO.subTo(t,t)),r.t=l,r.clamp(),p>0&&r.rShiftTo(p,r),u<0&&a.ZERO.subTo(r,r)}}}function R(e){var t=n();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(a.ZERO)>0&&e.subTo(t,t),t}function w(e){this.m=e}function U(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e}function P(e){return e}function L(e){e.divRemTo(this.m,null,e)}function D(e,t,r){e.multiplyTo(t,r),this.reduce(r)}function k(e,t){e.squareTo(t),this.reduce(t)}function O(){if(this.t<1)return 0;var e=this.data[0];if(0==(1&e))return 0;var t=3&e;return t=t*(2-(15&e)*t)&15,t=t*(2-(255&e)*t)&255,t=t*(2-((65535&e)*t&65535))&65535,t=t*(2-e*t%this.DV)%this.DV,t>0?this.DV-t:-t}function K(e){this.m=e,this.mp=e.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function V(e){var t=n();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(a.ZERO)>0&&this.m.subTo(t,t),t}function x(e){var t=n();return e.copyTo(t),this.reduce(t),t}function _(e){for(;e.t<=this.mt2;)e.data[e.t++]=0;for(var t=0;t<this.m.t;++t){var r=32767&e.data[t],a=r*this.mpl+((r*this.mph+(e.data[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(r=t+this.m.t,e.data[r]+=this.m.am(0,a,e,t,0,this.m.t);e.data[r]>=e.DV;)e.data[r]-=e.DV,e.data[++r]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)}function j(e,t){e.squareTo(t),this.reduce(t)}function G(e,t,r){e.multiplyTo(t,r),this.reduce(r)}function M(){return 0==(this.t>0?1&this.data[0]:this.s)}function q(e,t){if(e>4294967295||e<1)return a.ONE;var r=n(),i=n(),s=t.convert(this),o=m(e)-1;for(s.copyTo(r);--o>=0;)if(t.sqrTo(r,i),(e&1<<o)>0)t.mulTo(i,s,r);else{var u=r;r=i,i=u}return t.revert(r)}function Q(e,t){var r;return r=e<256||t.isEven()?new w(t):new K(t),this.exp(e,r)}function H(){var e=n();return this.copyTo(e),e}function X(){if(this.s<0){if(1==this.t)return this.data[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this.data[0];if(0==this.t)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function W(){return 0==this.t?this.s:this.data[0]<<24>>24}function z(){return 0==this.t?this.s:this.data[0]<<16>>16}function Y(e){return Math.floor(Math.LN2*this.DB/Math.log(e))}function Z(){return this.s<0?-1:this.t<=0||1==this.t&&this.data[0]<=0?0:1}function J(e){if(null==e&&(e=10),0==this.signum()||e<2||e>36)return"0";var t=this.chunkSize(e),r=Math.pow(e,t),a=f(r),i=n(),s=n(),o="";for(this.divRemTo(a,i,s);i.signum()>0;)o=(r+s.intValue()).toString(e).substr(1)+o,i.divRemTo(a,i,s);return s.intValue().toString(e)+o}function $(e,t){this.fromInt(0),null==t&&(t=10);for(var r=this.chunkSize(t),n=Math.pow(t,r),i=!1,s=0,o=0,u=0;u<e.length;++u){var p=c(e,u);p<0?"-"==e.charAt(u)&&0==this.signum()&&(i=!0):(o=t*o+p,++s>=r&&(this.dMultiply(n),this.dAddOffset(o,0),s=0,o=0))}s>0&&(this.dMultiply(Math.pow(t,s)),this.dAddOffset(o,0)),i&&a.ZERO.subTo(this,this)}function ee(e,t,r){if("number"==typeof t)if(e<2)this.fromInt(1);else for(this.fromNumber(e,r),this.testBit(e-1)||this.bitwiseTo(a.ONE.shiftLeft(e-1),ue,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(a.ONE.shiftLeft(e-1),this);else{var n=new Array,i=7&e;n.length=(e>>3)+1,t.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}}function te(){var e=this.t,t=new Array;t[0]=this.s;var r,a=this.DB-e*this.DB%8,n=0;if(e-- >0)for(a<this.DB&&(r=this.data[e]>>a)!=(this.s&this.DM)>>a&&(t[n++]=r|this.s<<this.DB-a);e>=0;)a<8?(r=(this.data[e]&(1<<a)-1)<<8-a,r|=this.data[--e]>>(a+=this.DB-8)):(r=this.data[e]>>(a-=8)&255,a<=0&&(a+=this.DB,--e)),0!=(128&r)&&(r|=-256),0==n&&(128&this.s)!=(128&r)&&++n,(n>0||r!=this.s)&&(t[n++]=r);return t}function re(e){return 0==this.compareTo(e)}function ae(e){return this.compareTo(e)<0?this:e}function ne(e){return this.compareTo(e)>0?this:e}function ie(e,t,r){var a,n,i=Math.min(e.t,this.t);for(a=0;a<i;++a)r.data[a]=t(this.data[a],e.data[a]);if(e.t<this.t){for(n=e.s&this.DM,a=i;a<this.t;++a)r.data[a]=t(this.data[a],n);r.t=this.t}else{for(n=this.s&this.DM,a=i;a<e.t;++a)r.data[a]=t(n,e.data[a]);r.t=e.t}r.s=t(this.s,e.s),r.clamp()}function se(e,t){return e&t}function oe(e){var t=n();return this.bitwiseTo(e,se,t),t}function ue(e,t){return e|t}function ce(e){var t=n();return this.bitwiseTo(e,ue,t),t}function pe(e,t){return e^t}function le(e){var t=n();return this.bitwiseTo(e,pe,t),t}function fe(e,t){return e&~t}function de(e){var t=n();return this.bitwiseTo(e,fe,t),t}function he(){for(var e=n(),t=0;t<this.t;++t)e.data[t]=this.DM&~this.data[t];return e.t=this.t,e.s=~this.s,e}function ye(e){var t=n();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t}function ge(e){var t=n();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t}function Ce(e){if(0==e)return-1;var t=0;return 0==(65535&e)&&(e>>=16,t+=16),0==(255&e)&&(e>>=8,t+=8),0==(15&e)&&(e>>=4,t+=4),0==(3&e)&&(e>>=2,t+=2),0==(1&e)&&++t,t}function ve(){for(var e=0;e<this.t;++e)if(0!=this.data[e])return e*this.DB+Ce(this.data[e]);return this.s<0?this.t*this.DB:-1}function me(e){for(var t=0;0!=e;)e&=e-1,++t;return t}function Ee(){for(var e=0,t=this.s&this.DM,r=0;r<this.t;++r)e+=me(this.data[r]^t);return e}function Se(e){var t=Math.floor(e/this.DB);return t>=this.t?0!=this.s:0!=(this.data[t]&1<<e%this.DB)}function Ie(e,t){var r=a.ONE.shiftLeft(e);return this.bitwiseTo(r,t,r),r}function Te(e){return this.changeBit(e,ue)}function Ae(e){return this.changeBit(e,fe)}function be(e){return this.changeBit(e,pe)}function Fe(e,t){for(var r=0,a=0,n=Math.min(e.t,this.t);r<n;)a+=this.data[r]+e.data[r],t.data[r++]=a&this.DM,a>>=this.DB;if(e.t<this.t){for(a+=e.s;r<this.t;)a+=this.data[r],t.data[r++]=a&this.DM,a>>=this.DB;a+=this.s}else{for(a+=this.s;r<e.t;)a+=e.data[r],t.data[r++]=a&this.DM,a>>=this.DB;a+=e.s}t.s=a<0?-1:0,a>0?t.data[r++]=a:a<-1&&(t.data[r++]=this.DV+a),t.t=r,t.clamp()}function Be(e){var t=n();return this.addTo(e,t),t}function Ne(e){var t=n();return this.subTo(e,t),t}function Re(e){var t=n();return this.multiplyTo(e,t),t}function we(){var e=n();return this.squareTo(e),e}function Ue(e){var t=n();return this.divRemTo(e,t,null),t}function Pe(e){var t=n();return this.divRemTo(e,null,t),t}function Le(e){var t=n(),r=n();return this.divRemTo(e,t,r),new Array(t,r)}function De(e){this.data[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()}function ke(e,t){if(0!=e){for(;this.t<=t;)this.data[this.t++]=0;for(this.data[t]+=e;this.data[t]>=this.DV;)this.data[t]-=this.DV,++t>=this.t&&(this.data[this.t++]=0),++this.data[t]}}function Oe(){}function Ke(e){return e}function Ve(e,t,r){e.multiplyTo(t,r)}function xe(e,t){e.squareTo(t)}function _e(e){return this.exp(e,new Oe)}function je(e,t,r){var a=Math.min(this.t+e.t,t);for(r.s=0,r.t=a;a>0;)r.data[--a]=0;var n;for(n=r.t-this.t;a<n;++a)r.data[a+this.t]=this.am(0,e.data[a],r,a,0,this.t);for(n=Math.min(e.t,t);a<n;++a)this.am(0,e.data[a],r,a,0,t-a);r.clamp()}function Ge(e,t,r){--t;var a=r.t=this.t+e.t-t;for(r.s=0;--a>=0;)r.data[a]=0;for(a=Math.max(t-this.t,0);a<e.t;++a)r.data[this.t+a-t]=this.am(t-a,e.data[a],r,0,0,this.t+a-t);r.clamp(),r.drShiftTo(1,r)}function Me(e){this.r2=n(),this.q3=n(),a.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e;
}function qe(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=n();return e.copyTo(t),this.reduce(t),t}function Qe(e){return e}function He(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)}function Xe(e,t){e.squareTo(t),this.reduce(t)}function We(e,t,r){e.multiplyTo(t,r),this.reduce(r)}function ze(e,t){var r,a,i=e.bitLength(),s=f(1);if(i<=0)return s;r=i<18?1:i<48?3:i<144?4:i<768?5:6,a=i<8?new w(t):t.isEven()?new Me(t):new K(t);var o=new Array,u=3,c=r-1,p=(1<<r)-1;if(o[1]=a.convert(this),r>1){var l=n();for(a.sqrTo(o[1],l);u<=p;)o[u]=n(),a.mulTo(l,o[u-2],o[u]),u+=2}var d,h,y=e.t-1,g=!0,C=n();for(i=m(e.data[y])-1;y>=0;){for(i>=c?d=e.data[y]>>i-c&p:(d=(e.data[y]&(1<<i+1)-1)<<c-i,y>0&&(d|=e.data[y-1]>>this.DB+i-c)),u=r;0==(1&d);)d>>=1,--u;if((i-=u)<0&&(i+=this.DB,--y),g)o[d].copyTo(s),g=!1;else{for(;u>1;)a.sqrTo(s,C),a.sqrTo(C,s),u-=2;u>0?a.sqrTo(s,C):(h=s,s=C,C=h),a.mulTo(C,o[d],s)}for(;y>=0&&0==(e.data[y]&1<<i);)a.sqrTo(s,C),h=s,s=C,C=h,--i<0&&(i=this.DB-1,--y)}return a.revert(s)}function Ye(e){var t=this.s<0?this.negate():this.clone(),r=e.s<0?e.negate():e.clone();if(t.compareTo(r)<0){var a=t;t=r,r=a}var n=t.getLowestSetBit(),i=r.getLowestSetBit();if(i<0)return t;for(n<i&&(i=n),i>0&&(t.rShiftTo(i,t),r.rShiftTo(i,r));t.signum()>0;)(n=t.getLowestSetBit())>0&&t.rShiftTo(n,t),(n=r.getLowestSetBit())>0&&r.rShiftTo(n,r),t.compareTo(r)>=0?(t.subTo(r,t),t.rShiftTo(1,t)):(r.subTo(t,r),r.rShiftTo(1,r));return i>0&&r.lShiftTo(i,r),r}function Ze(e){if(e<=0)return 0;var t=this.DV%e,r=this.s<0?e-1:0;if(this.t>0)if(0==t)r=this.data[0]%e;else for(var a=this.t-1;a>=0;--a)r=(t*r+this.data[a])%e;return r}function Je(e){var t=e.isEven();if(this.isEven()&&t||0==e.signum())return a.ZERO;for(var r=e.clone(),n=this.clone(),i=f(1),s=f(0),o=f(0),u=f(1);0!=r.signum();){for(;r.isEven();)r.rShiftTo(1,r),t?(i.isEven()&&s.isEven()||(i.addTo(this,i),s.subTo(e,s)),i.rShiftTo(1,i)):s.isEven()||s.subTo(e,s),s.rShiftTo(1,s);for(;n.isEven();)n.rShiftTo(1,n),t?(o.isEven()&&u.isEven()||(o.addTo(this,o),u.subTo(e,u)),o.rShiftTo(1,o)):u.isEven()||u.subTo(e,u),u.rShiftTo(1,u);r.compareTo(n)>=0?(r.subTo(n,r),t&&i.subTo(o,i),s.subTo(u,s)):(n.subTo(r,n),t&&o.subTo(i,o),u.subTo(s,u))}return 0!=n.compareTo(a.ONE)?a.ZERO:u.compareTo(e)>=0?u.subtract(e):u.signum()<0?(u.addTo(e,u),u.signum()<0?u.add(e):u):u}function $e(e){var t,r=this.abs();if(1==r.t&&r.data[0]<=lt[lt.length-1]){for(t=0;t<lt.length;++t)if(r.data[0]==lt[t])return!0;return!1}if(r.isEven())return!1;for(t=1;t<lt.length;){for(var a=lt[t],n=t+1;n<lt.length&&a<ft;)a*=lt[n++];for(a=r.modInt(a);t<n;)if(a%lt[t++]==0)return!1}return r.millerRabin(e)}function et(e){var t=this.subtract(a.ONE),r=t.getLowestSetBit();if(r<=0)return!1;for(var n,i=t.shiftRight(r),s=tt(),o=0;o<e;++o){do n=new a(this.bitLength(),s);while(n.compareTo(a.ONE)<=0||n.compareTo(t)>=0);var u=n.modPow(i,this);if(0!=u.compareTo(a.ONE)&&0!=u.compareTo(t)){for(var c=1;c++<r&&0!=u.compareTo(t);)if(u=u.modPowInt(2,this),0==u.compareTo(a.ONE))return!1;if(0!=u.compareTo(t))return!1}}return!0}function tt(){return{nextBytes:function(e){for(var t=0;t<e.length;++t)e[t]=Math.floor(255*at.base.srnd())}}}var rt,at=r(1),nt=0xdeadbeefcafe,it=15715070==(16777215&nt);"undefined"==typeof navigator?(a.prototype.am=o,rt=28):it&&"Microsoft Internet Explorer"==navigator.appName?(a.prototype.am=s,rt=30):it&&"Netscape"!=navigator.appName?(a.prototype.am=i,rt=26):(a.prototype.am=o,rt=28),a.prototype.DB=rt,a.prototype.DM=(1<<rt)-1,a.prototype.DV=1<<rt;var st=52;a.prototype.FV=Math.pow(2,st),a.prototype.F1=st-rt,a.prototype.F2=2*rt-st;var ot,ut,ct="0123456789abcdefghijklmnopqrstuvwxyz",pt=new Array;for(ot="0".charCodeAt(0),ut=0;ut<=9;++ut)pt[ot++]=ut;for(ot="a".charCodeAt(0),ut=10;ut<36;++ut)pt[ot++]=ut;for(ot="A".charCodeAt(0),ut=10;ut<36;++ut)pt[ot++]=ut;w.prototype.convert=U,w.prototype.revert=P,w.prototype.reduce=L,w.prototype.mulTo=D,w.prototype.sqrTo=k,K.prototype.convert=V,K.prototype.revert=x,K.prototype.reduce=_,K.prototype.mulTo=G,K.prototype.sqrTo=j,a.prototype.copyTo=p,a.prototype.fromInt=l,a.prototype.fromString=d,a.prototype.clamp=h,a.prototype.dlShiftTo=S,a.prototype.drShiftTo=I,a.prototype.lShiftTo=T,a.prototype.rShiftTo=A,a.prototype.subTo=b,a.prototype.multiplyTo=F,a.prototype.squareTo=B,a.prototype.divRemTo=N,a.prototype.invDigit=O,a.prototype.isEven=M,a.prototype.exp=q,a.prototype.toString=y,a.prototype.negate=g,a.prototype.abs=C,a.prototype.compareTo=v,a.prototype.bitLength=E,a.prototype.mod=R,a.prototype.modPowInt=Q,a.ZERO=f(0),a.ONE=f(1),Oe.prototype.convert=Ke,Oe.prototype.revert=Ke,Oe.prototype.mulTo=Ve,Oe.prototype.sqrTo=xe,Me.prototype.convert=qe,Me.prototype.revert=Qe,Me.prototype.reduce=He,Me.prototype.mulTo=We,Me.prototype.sqrTo=Xe;var lt=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],ft=(1<<26)/lt[lt.length-1];a.prototype.chunkSize=Y,a.prototype.toRadix=J,a.prototype.fromRadix=$,a.prototype.fromNumber=ee,a.prototype.bitwiseTo=ie,a.prototype.changeBit=Ie,a.prototype.addTo=Fe,a.prototype.dMultiply=De,a.prototype.dAddOffset=ke,a.prototype.multiplyLowerTo=je,a.prototype.multiplyUpperTo=Ge,a.prototype.modInt=Ze,a.prototype.millerRabin=et,a.prototype.clone=H,a.prototype.intValue=X,a.prototype.byteValue=W,a.prototype.shortValue=z,a.prototype.signum=Z,a.prototype.toByteArray=te,a.prototype.equals=re,a.prototype.min=ae,a.prototype.max=ne,a.prototype.and=oe,a.prototype.or=ce,a.prototype.xor=le,a.prototype.andNot=de,a.prototype.not=he,a.prototype.shiftLeft=ye,a.prototype.shiftRight=ge,a.prototype.getLowestSetBit=ve,a.prototype.bitCount=Ee,a.prototype.testBit=Se,a.prototype.setBit=Te,a.prototype.clearBit=Ae,a.prototype.flipBit=be,a.prototype.add=Be,a.prototype.subtract=Ne,a.prototype.multiply=Re,a.prototype.divide=Ue,a.prototype.remainder=Pe,a.prototype.divideAndRemainder=Le,a.prototype.modPow=ze,a.prototype.modInverse=Je,a.prototype.pow=_e,a.prototype.gcd=Ye,a.prototype.isProbablePrime=$e,a.prototype.square=we,a.fromByteArrayUnsigned=function(e){return e.length?new a(128&e[0]?[0].concat(e):e):new a.valueOf(0)},a.fromByteArraySigned=function(e){return 128&e[0]?(e[0]&=127,a.fromByteArrayUnsigned(e).negate()):a.fromByteArrayUnsigned(e)},a.prototype.toByteArrayUnsigned=function(){var e=this.abs().toByteArray();if(!e.length)return e;0===e[0]&&(e=e.slice(1));for(var t=0;t<e.length;++t)e[t]=e[t]<0?e[t]+256:e[t];return e},a.prototype.toByteArraySigned=function(){var e=this.toByteArrayUnsigned(),t=this.s<0;return 128&e[0]?e.unshift(t?128:0):t&&(e[0]|=128),e},a.prototype.toBinary=function(e){var t,r=[];for(t=this.toByteArrayUnsigned();8*(r.length+t.length)<e;)r=[String.fromCharCode(0)].concat(r);return t.map(function(e,t){r.push(String.fromCharCode(e))}),r.join("")},a.prototype.print=function(e){for(var t=0;t<this.t;++t);},at.jsbn=at.jsbn||{},at.jsbn.BigInteger=a,at.jsbn.Barrett=Me,e.exports=at.jsbn},function(e,t,r){var a=r(1);a.pki=a.pki||{};var n=a.pki.oids=a.oids=a.oids||{};n["1.2.840.113549.1.1.1"]="rsaEncryption",n.rsaEncryption="1.2.840.113549.1.1.1",n["1.2.840.113549.1.1.4"]="md5WithRSAEncryption",n.md5WithRSAEncryption="1.2.840.113549.1.1.4",n["1.2.840.113549.1.1.5"]="sha1WithRSAEncryption",n.sha1WithRSAEncryption="1.2.840.113549.1.1.5",n["1.2.840.113549.1.1.7"]="RSAES-OAEP",n["RSAES-OAEP"]="1.2.840.113549.1.1.7",n["1.2.840.113549.1.1.8"]="mgf1",n.mgf1="1.2.840.113549.1.1.8",n["1.2.840.113549.1.1.9"]="pSpecified",n.pSpecified="1.2.840.113549.1.1.9",n["1.2.840.113549.1.1.10"]="RSASSA-PSS",n["RSASSA-PSS"]="1.2.840.113549.1.1.10",n["1.2.840.113549.1.1.11"]="sha256WithRSAEncryption",n.sha256WithRSAEncryption="1.2.840.113549.1.1.11",n["1.2.840.113549.1.1.12"]="sha384WithRSAEncryption",n.sha384WithRSAEncryption="1.2.840.113549.1.1.12",n["1.2.840.113549.1.1.13"]="sha512WithRSAEncryption",n.sha512WithRSAEncryption="1.2.840.113549.1.1.13",n["1.3.14.3.2.7"]="desCBC",n.desCBC="1.3.14.3.2.7",n["1.3.14.3.2.26"]="sha1",n.sha1="1.3.14.3.2.26",n["2.16.840.1.101.3.4.2.1"]="sha256",n.sha256="2.16.840.1.101.3.4.2.1",n["2.16.840.1.101.3.4.2.2"]="sha384",n.sha384="2.16.840.1.101.3.4.2.2",n["2.16.840.1.101.3.4.2.3"]="sha512",n.sha512="2.16.840.1.101.3.4.2.3",n["1.2.840.113549.2.5"]="md5",n.md5="1.2.840.113549.2.5",n.kcdsa="1.2.410.200004.1.21",n["1.2.410.200004.1.21"]="kcdsa",n.ecdsa="1.2.840.10045.2.1",n["1.2.840.10045.2.1"]="ecdsa",n.secp256r1="1.2.840.10045.3.1.7",n["1.2.840.10045.3.1.7"]="secp256r1",e.exports=n},function(e,t,r){function a(e,t,r){r||(r=n.md.sha1.create());for(var a="",i=Math.ceil(t/r.digestLength),s=0;s<i;++s){var o=String.fromCharCode(s>>24&255,s>>16&255,s>>8&255,255&s);r.start(),r.update(e+o),a+=r.digest().getBytes()}return a.substring(0,t)}var n=r(1),i=n.asn1,s=n.pki,o=n.pkcs1=n.pkcs1||{};o.encode_rsa_oaep=function(e,t,r){var i=void 0,s=void 0,o=void 0,u=void 0;"string"==typeof r?(i=r,s=arguments[3]||void 0,o=arguments[4]||void 0):r&&(i=r.label||void 0,s=r.seed||void 0,o=r.md||void 0,r.mgf1&&r.mgf1.md&&(u=r.mgf1.md)),o?o.start():o=n.md.sha1.create(),u||(u=o);var c=Math.ceil(e.n.bitLength()/8),p=c-2*o.digestLength-2;if(t.length>p)throw{message:"RSAES-OAEP input message length is too long.",length:t.length,maxLength:p};i||(i=""),o.update(i,"raw");for(var l=o.digest(),f="",d=p-t.length,h=0;h<d;h++)f+="\0";var y=l.getBytes()+f+""+t;if(s){if(s.length!==o.digestLength)throw{message:"Invalid RSAES-OAEP seed. The seed length must match the digest length.",seedLength:s.length,digestLength:o.digestLength}}else s=n.random.getBytes(o.digestLength);var g=a(s,c-o.digestLength-1,u),C=n.util.xorBytes(y,g,y.length),v=a(C,o.digestLength,u),m=n.util.xorBytes(s,v,s.length);return"\0"+m+C},o.decode_rsa_oaep=function(e,t,r){var i=void 0,s=void 0,o=void 0;"string"==typeof r?(i=r,s=arguments[3]||void 0):r&&(i=r.label||void 0,s=r.md||void 0,r.mgf1&&r.mgf1.md&&(o=r.mgf1.md));var u=Math.ceil(e.n.bitLength()/8);if(t.length!==u)throw{message:"RSAES-OAEP encoded message length is invalid.",length:t.length,expectedLength:u};if(void 0===s?s=n.md.sha1.create():s.start(),o||(o=s),u<2*s.digestLength+2)throw{message:"RSAES-OAEP key is too short for the hash function."};i||(i=""),s.update(i,"raw");for(var c=s.digest().getBytes(),p=t.charAt(0),l=t.substring(1,s.digestLength+1),f=t.substring(1+s.digestLength),d=a(f,s.digestLength,o),h=n.util.xorBytes(l,d,l.length),y=a(h,u-s.digestLength-1,o),g=n.util.xorBytes(f,y,f.length),C=g.substring(0,s.digestLength),v="\0"!==p,m=0;m<s.digestLength;++m)v|=c.charAt(m)!==C.charAt(m);for(var E=1,S=s.digestLength,I=s.digestLength;I<g.length;I++){var T=g.charCodeAt(I),A=1&T^1,b=E?65534:0;v|=T&b,E&=A,S+=E}if(v||1!==g.charCodeAt(S))throw{message:"Invalid RSAES-OAEP padding."};return g.substring(S+1)},o.createDigestInfo=function(e,t,r){var a;if(arguments.length<2){if(!(e.algorithm in s.oids))throw{message:"Unknown message digest algorithm.",algorithm:e.algorithm};if(a=s.oids[e.algorithm],e.hasOwnProperty("parameter")){if(8!=e.parameter.length)throw"invalid parameter length(must be 8 bytes)";r=i.create(i.Class.UNIVERSAL,i.Type,OCTETSTRING,!1,e.parameter)}t=e.digest().getBytes()}else if(a=e,"undefined"==typeof t)throw{message:"invalid input need digest value"};"undefined"==typeof r&&(r=i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,""));var n=i.oidToDer(a).getBytes(),o=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]),u=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]);u.value.push(i.create(i.Class.UNIVERSAL,i.Type.OID,!1,n)),u.value.push(r);var t=i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,t);return o.value.push(u),o.value.push(t),i.toDer(o).getBytes()},e.exports=o},function(e,t,r){function a(e,t,r){var a=o.util.createBuffer(),n=Math.ceil(t.n.bitLength()/8);if(e.length>n-11)throw{message:"Message is too long for PKCS#1 v1.5 padding.",length:e.length,max:n-11};a.putByte(0),a.putByte(r);var i,s=n-3-e.length;if(0===r||1===r){i=0===r?0:255;for(var u=0;u<s;++u)a.putByte(i)}else for(;s>0;){for(var c=0,p=o.random.getBytes(s),u=0;u<s;++u)i=p.charCodeAt(u),0===i?++c:a.putByte(i);s=c}return a.putByte(0),a.putBytes(e),a}function n(e,t,r,a){var n=Math.ceil(t.n.bitLength()/8),i=o.util.createBuffer(e),s=i.getByte(),u=i.getByte();if(0!==s||r&&0!==u&&1!==u||!r&&2!=u||r&&0===u&&"undefined"==typeof a)throw{message:"Encryption block is invalid."};var c=0;if(0===u){c=n-3-a;for(var p=0;p<c;++p)if(0!==i.getByte())throw{message:"Encryption block is invalid."}}else if(1===u)for(c=0;i.length()>1;){if(255!==i.getByte()){--i.read;break}++c}else if(2===u)for(c=0;i.length()>1;){if(0===i.getByte()){--i.read;break}++c}var l=i.getByte();if(0!==l||c!==n-3-i.length())throw{message:"Encryption block is invalid."};return i.getBytes()}function i(e,t,r){function a(){return p.rsa.stepKeyPairGenerationState(e,10)?r(null,e.keys):void o.util.setImmediate(a)}function n(){c=Math.max(1,c),i(e.pBits,function(t,a){return t?r(t):(e.p=a,void i(e.qBits,s))})}function i(t,r){function a(){var r=t-1,a=new u(t,e.rng);return a.testBit(r)||a.bitwiseTo(u.ONE.shiftLeft(r),y,a),a.dAddOffset(31-a.mod(h).byteValue(),0),a}function n(n){if(!g){--o;var s=n.data;if(s.found){for(var c=0;c<i.length;++c)i[c].terminate();return g=!0,r(null,new u(s.prime,16))}p.bitLength()>t&&(p=a());var d=p.toString(16);n.target.postMessage({e:e.eInt,hex:d,workLoad:l}),p.dAddOffset(f,0)}}for(var i=[],s=0;s<c;++s)i[s]=new Worker(d);for(var o=c,p=a(),s=0;s<c;++s)i[s].addEventListener("message",n);var g=!1}function s(t,a){if(e.q=a,e.p.compareTo(e.q)<0){var o=e.p;e.p=e.q,e.q=o}if(e.p1=e.p.subtract(u.ONE),e.q1=e.q.subtract(u.ONE),e.phi=e.p1.multiply(e.q1),0!==e.phi.gcd(e.e).compareTo(u.ONE))return e.p=e.q=null,void n();if(e.n=e.p.multiply(e.q),e.n.bitLength()!==e.bits)return e.q=null,void i(e.qBits,s);var c=e.e.modInverse(e.phi);e.keys={privateKey:p.rsa.setPrivateKey(e.n,e.e,c,e.p,e.q,c.mod(e.p1),c.mod(e.q1),e.q.modInverse(e.p)),publicKey:p.rsa.setPublicKey(e.n,e.e)},r(null,e.keys)}if("function"==typeof t&&(r=t,t={}),"undefined"==typeof Worker)return a();var c=t.workers||2,l=t.workLoad||100,f=30*l/8,d=t.workerScript||"yt/prime.worker.js",h=new u(null);h.fromInt(30);var y=function(e,t){return e|t};return c===-1?o.util.estimateCores(function(e,t){e&&(t=2),c=t-1,n()}):void n()}function s(e){return e<=100?27:e<=150?18:e<=200?15:e<=250?12:e<=300?9:e<=350?8:e<=400?7:e<=500?6:e<=600?5:e<=800?4:e<=1250?3:2}var o=r(1);if("undefined"==typeof u)var u=o.jsbn.BigInteger;var c=o.asn1;o.pki=o.pki||{},o.pki.rsa=o.rsa=o.rsa||{};var p=o.pki,l=[6,4,2,4,2,4,6,2],f=function(e){var t;if(!(e.algorithm in p.oids))throw{message:"Unknown message digest algorithm.",algorithm:e.algorithm};t=p.oids[e.algorithm];var r=c.oidToDer(t).getBytes(),a=c.create(c.Class.UNIVERSAL,c.Type.SEQUENCE,!0,[]),n=c.create(c.Class.UNIVERSAL,c.Type.SEQUENCE,!0,[]);if(n.value.push(c.create(c.Class.UNIVERSAL,c.Type.OID,!1,r)),e.hasOwnProperty("parameter")){if(8!=e.parameter.length)throw"invalid parameter length(must be 8 bytes)";n.value.push(c.create(c.Class.UNIVERSAL,c.Type.OCTETSTRING,!1,e.parameter))}else n.value.push(c.create(c.Class.UNIVERSAL,c.Type.NULL,!1,""));var i=c.create(c.Class.UNIVERSAL,c.Type.OCTETSTRING,!1,e.digest().getBytes());return a.value.push(n),a.value.push(i),c.toDer(a).getBytes()},d=function(e,t,r){var a;if(r)a=e.modPow(t.e,t.n);else if(t.p&&t.q){t.dP||(t.dP=t.d.mod(t.p.subtract(u.ONE))),t.dQ||(t.dQ=t.d.mod(t.q.subtract(u.ONE))),t.qInv||(t.qInv=t.q.modInverse(t.p));for(var n=e.mod(t.p).modPow(t.dP,t.p),i=e.mod(t.q).modPow(t.dQ,t.q);n.compareTo(i)<0;)n=n.add(t.p);a=n.subtract(i).multiply(t.qInv).mod(t.p).multiply(t.q).add(i)}else a=e.modPow(t.d,t.n);return a};p.rsa.encrypt=function(e,t,r){var n,i=r,s=Math.ceil(t.n.bitLength()/8);r!==!1&&r!==!0?(i=2===r,n=a(e,t,r)):(n=o.util.createBuffer(),n.putBytes(e));for(var c=new u(n.toHex(),16),p=d(c,t,i),l=p.toString(16),f=o.util.createBuffer(),h=s-Math.ceil(l.length/2);h>0;)f.putByte(0),--h;return f.putBytes(o.util.hexToBytes(l)),f.getBytes()},p.rsa.decrypt=function(e,t,r,a){var i=Math.ceil(t.n.bitLength()/8);if(e.length!==i)throw{message:"Encrypted message length is invalid.",length:e.length,expected:i};var s=new u(o.util.createBuffer(e).toHex(),16);if(s.compareTo(t.n)>=0)throw{message:"Encrypted message is invalid."};for(var c=d(s,t,r),p=c.toString(16),l=o.util.createBuffer(),f=i-Math.ceil(p.length/2);f>0;)l.putByte(0),--f;return l.putBytes(o.util.hexToBytes(p)),a!==!1?n(l.getBytes(),t,r):l.getBytes()},p.rsa.createKeyPairGenerationState=function(e,t){"string"==typeof e&&(e=parseInt(e,10)),e=e||2048;var r={nextBytes:function(e){for(var t=o.random.getBytes(e.length),r=0;r<e.length;++r)e[r]=t.charCodeAt(r)}},a={state:0,bits:e,rng:r,eInt:t||65537,e:new u(null),p:null,q:null,qBits:e>>1,pBits:e-(e>>1),pqState:0,num:null,keys:null};return a.e.fromInt(a.eInt),a},p.rsa.stepKeyPairGenerationState=function(e,t){var r=new u(null);r.fromInt(30);for(var a,n=0,i=function(e,t){return e|t},o=+new Date,c=0;null===e.keys&&(t<=0||c<t);){if(0===e.state){var f=null===e.p?e.pBits:e.qBits,d=f-1;0===e.pqState?(e.num=new u(f,e.rng),e.num.testBit(d)||e.num.bitwiseTo(u.ONE.shiftLeft(d),i,e.num),e.num.dAddOffset(31-e.num.mod(r).byteValue(),0),n=0,++e.pqState):1===e.pqState?e.num.bitLength()>f?e.pqState=0:e.num.isProbablePrime(s(e.num.bitLength()))?++e.pqState:e.num.dAddOffset(l[n++%8],0):2===e.pqState?e.pqState=0===e.num.subtract(u.ONE).gcd(e.e).compareTo(u.ONE)?3:0:3===e.pqState&&(e.pqState=0,null===e.p?e.p=e.num:e.q=e.num,null!==e.p&&null!==e.q&&++e.state,e.num=null)}else if(1===e.state)e.p.compareTo(e.q)<0&&(e.num=e.p,e.p=e.q,e.q=e.num),++e.state;else if(2===e.state)e.p1=e.p.subtract(u.ONE),e.q1=e.q.subtract(u.ONE),e.phi=e.p1.multiply(e.q1),++e.state;else if(3===e.state)0===e.phi.gcd(e.e).compareTo(u.ONE)?++e.state:(e.p=null,e.q=null,e.state=0);else if(4===e.state)e.n=e.p.multiply(e.q),e.n.bitLength()===e.bits?++e.state:(e.q=null,e.state=0);else if(5===e.state){var h=e.e.modInverse(e.phi);e.keys={privateKey:p.rsa.setPrivateKey(e.n,e.e,h,e.p,e.q,h.mod(e.p1),h.mod(e.q1),e.q.modInverse(e.p)),publicKey:p.rsa.setPublicKey(e.n,e.e)}}a=+new Date,c+=a-o,o=a}return null!==e.keys},p.rsa.generateKeyPair=function(e,t,r,a){1===arguments.length?"object"==typeof e?(r=e,e=void 0):"function"==typeof e&&(a=e,e=void 0):2===arguments.length?("number"==typeof e?"function"==typeof t?a=t:r=t:(r=e,a=t,e=void 0),t=void 0):3===arguments.length&&("number"==typeof t?"function"==typeof r&&(a=r,r=void 0):(a=r,r=t,t=void 0)),r=r||{},void 0===e&&(e=r.bits||2048),void 0===t&&(t=r.e||65537);var n=p.rsa.createKeyPairGenerationState(e,t);return a?void i(n,r,a):(p.rsa.stepKeyPairGenerationState(n,0),n.keys)},p.setRsaPublicKey=p.rsa.setPublicKey=function(e,t,r){var i={oid:p.oids.rsaEncryption,n:e,e:t,params:r};return i.encrypt=function(e,t,r){if("string"==typeof t?t=t.toUpperCase():void 0===t&&(t="RSAES-PKCS1-V1_5"),"RSAES-PKCS1-V1_5"===t)t={encode:function(e,t,r){return a(e,t,2).getBytes()}};else if("RSA-OAEP"===t||"RSAES-OAEP"===t)t={encode:function(e,t){return o.pkcs1.encode_rsa_oaep(t,e,r)}};else{if(["RAW","NONE","NULL",null].indexOf(t)===-1)throw{message:'Unsupported encryption scheme: "'+t+'".'};t={encode:function(e){return e}}}var n=t.encode(e,i,!0);return p.rsa.encrypt(n,i,!0)},i.verify=function(e,t,r){"string"==typeof r?r=r.toUpperCase():void 0===r&&(r="RSASSA-PKCS1-V1_5"),"RSASSA-PKCS1-V1_5"===r?r={verify:function(e,t){t=n(t,i,!0);var r=c.fromDer(t);return e===r.value[1].value}}:"NONE"!==r&&"NULL"!==r&&null!==r||(r={verify:function(e,t){return t=n(t,i,!0),e===t}});var a=p.rsa.decrypt(t,i,!0,!1);return o.consoleLog,r.verify(e,a,i.n.bitLength())},i},p.kcdsa={},p.setKcdsaPublicKey=p.kcdsa.setPublicKey=function(e,t,r,a){var n={oid:p.oids.kcdsa,y:e,params:{P:t,Q:r,G:a}};return n.verify=function(e,t){throw"not supported"},n},p.setRsaPrivateKey=p.rsa.setPrivateKey=function(e,t,r,a,i,s,u,c){var l={oid:p.oids.rsaEncryption,n:e,e:t,d:r,p:a,q:i,dP:s,dQ:u,qInv:c};return l.decrypt=function(e,t,r){"string"==typeof t?t=t.toUpperCase():void 0===t&&(t="RSAES-PKCS1-V1_5");var a=p.rsa.decrypt(e,l,!1,!1);if("RSAES-PKCS1-V1_5"===t)t={decode:n};else if("RSA-OAEP"===t||"RSAES-OAEP"===t)t={decode:function(e,t){return o.pkcs1.decode_rsa_oaep(t,e,r)}};else{if(["RAW","NONE","NULL",null].indexOf(t)===-1)throw{message:'Unsupported encryption scheme: "'+t+'".'};t={decode:function(e){return e}}}return t.decode(a,l,!1)},l.sign=function(e,t){var r=!1;"string"==typeof t&&(t=t.toUpperCase()),void 0===t||"RSASSA-PKCS1-V1_5"===t?(t={encode:f},r=1):"NONE"!==t&&"NULL"!==t&&null!==t||(t={encode:function(){return e}},r=1);var a=t.encode(e,l.n.bitLength());return o.consoleLog,p.rsa.encrypt(a,l,r)},l},p.wrapRsaPrivateKey=function(e){return c.create(c.Class.UNIVERSAL,c.Type.SEQUENCE,!0,[c.create(c.Class.UNIVERSAL,c.Type.INTEGER,!1,c.integerToDer(0).getBytes()),c.create(c.Class.UNIVERSAL,c.Type.SEQUENCE,!0,[c.create(c.Class.UNIVERSAL,c.Type.OID,!1,c.oidToDer(p.oids.rsaEncryption).getBytes()),c.create(c.Class.UNIVERSAL,c.Type.NULL,!1,"")]),c.create(c.Class.UNIVERSAL,c.Type.OCTETSTRING,!1,c.toDer(e).getBytes())])},e.exports=o.rsa},function(e,t,r){var a=r(1);a.mgf=a.mgf||{};var n=a.mgf.mgf1=a.mgf1=a.mgf1||{};n.create=function(e){var t={generate:function(t,r){for(var n=new a.util.ByteBuffer,i=Math.ceil(r/e.digestLength),s=0;s<i;s++){var o=new a.util.ByteBuffer;o.putInt32(s),e.start(),e.update(t+o.getBytes()),n.putBuffer(e.digest())}return n.truncate(n.length()-r),n.getBytes()}};return t},e.exports=a.mgf1},function(e,t,r){var a=r(1);a.mgf=a.mgf||{},a.mgf.mgf1=a.mgf1,e.exports=a.mgf},function(e,t,r){var a=r(1),n=a.pss=a.pss||{};n.create=function(e,t,r){var n=e.digestLength,i={};return i.verify=function(i,s,o){var u,c=o-1,p=Math.ceil(c/8);if(s=s.substr(-p),p<n+r+2)throw{message:"Inconsistent parameters to PSS signature verification."};if(188!==s.charCodeAt(p-1))throw{message:"Encoded message does not end in 0xBC."};var l=p-n-1,f=s.substr(0,l),d=s.substr(l,n),h=65280>>8*p-c&255;if(0!==(f.charCodeAt(0)&h))throw{message:"Bits beyond keysize not zero as expected."};var y=t.generate(d,l),g="";for(u=0;u<l;u++)g+=String.fromCharCode(f.charCodeAt(u)^y.charCodeAt(u));g=String.fromCharCode(g.charCodeAt(0)&~h)+g.substr(1);var C=p-n-r-2;for(u=0;u<C;u++)if(0!==g.charCodeAt(u))throw{message:"Leftmost octets not zero as expected"};if(1!==g.charCodeAt(C))throw{message:"Inconsistent PSS signature, 0x01 marker not found"};var v=g.substring(g.length-r,g.length),m=new a.util.ByteBuffer;m.fillWithByte(0,8),m.putBytes(i),m.putBytes(v),e.start(),e.update(m.getBytes());var E=e.digest().getBytes();return d===E},i.encode=function(i,s){var o,u=s-1,c=Math.ceil(u/8),p=i.digest().getBytes();if(c<n+r+2)throw{message:"Message is too long to encrypt"};var l=a.random.getBytes(r),f=new a.util.ByteBuffer;f.fillWithByte(0,8),f.putBytes(p),f.putBytes(l),e.start(),e.update(f.getBytes());var d=e.digest().getBytes(),h=new a.util.ByteBuffer;h.fillWithByte(0,c-r-n-2),h.putByte(1),h.putBytes(l);var y=h.getBytes(),g=c-n-1,C=t.generate(d,g),v="";for(o=0;o<g;o++)v+=String.fromCharCode(y.charCodeAt(o)^C.charCodeAt(o));var m=65280>>8*c-u&255;return v=String.fromCharCode(v.charCodeAt(0)&~m)+v.substr(1),v+d+String.fromCharCode(188)},i},e.exports=a.pss},function(e,t,r){function a(e,t){this.x=t,this.q=e}function n(e){return e==this||this.q.equals(e.q)&&this.x.equals(e.x)}function i(){return this.x}function s(){return new a(this.q,this.x.negate().mod(this.q))}function o(e){return new a(this.q,this.x.add(e.toBigInteger()).mod(this.q))}function u(e){return new a(this.q,this.x.subtract(e.toBigInteger()).mod(this.q))}function c(e){return new a(this.q,this.x.multiply(e.toBigInteger()).mod(this.q))}function p(){return new a(this.q,this.x.square().mod(this.q))}function l(e){return new a(this.q,this.x.multiply(e.toBigInteger().modInverse(this.q)).mod(this.q))}function f(e,t,r,a){this.curve=e,this.x=t,this.y=r,null==a?this.z=L.ONE:this.z=a,this.zinv=null}function d(){null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q));var e=this.x.toBigInteger().multiply(this.zinv);return this.curve.reduce(e),this.curve.fromBigInteger(e)}function h(){null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q));var e=this.y.toBigInteger().multiply(this.zinv);return this.curve.reduce(e),this.curve.fromBigInteger(e)}function y(e){if(e==this)return!0;if(this.isInfinity())return e.isInfinity();if(e.isInfinity())return this.isInfinity();var t,r;return t=e.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(e.z)).mod(this.curve.q),!!t.equals(L.ZERO)&&(r=e.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(e.z)).mod(this.curve.q),r.equals(L.ZERO))}function g(){return null==this.x&&null==this.y||this.z.equals(L.ZERO)&&!this.y.toBigInteger().equals(L.ZERO)}function C(){return new f(this.curve,this.x,this.y.negate(),this.z)}function v(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var t=e.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(e.z)).mod(this.curve.q),r=e.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(e.z)).mod(this.curve.q);if(L.ZERO.equals(r))return L.ZERO.equals(t)?this.twice():this.curve.getInfinity();var a=new L("3"),n=this.x.toBigInteger(),i=this.y.toBigInteger(),s=(e.x.toBigInteger(),e.y.toBigInteger(),r.square()),o=s.multiply(r),u=n.multiply(s),c=t.square().multiply(this.z),p=c.subtract(u.shiftLeft(1)).multiply(e.z).subtract(o).multiply(r).mod(this.curve.q),l=u.multiply(a).multiply(t).subtract(i.multiply(o)).subtract(c.multiply(t)).multiply(e.z).add(t.multiply(o)).mod(this.curve.q),d=o.multiply(this.z).multiply(e.z).mod(this.curve.q);return new f(this.curve,this.curve.fromBigInteger(p),this.curve.fromBigInteger(l),d)}function m(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var e=new L("3"),t=this.x.toBigInteger(),r=this.y.toBigInteger(),a=r.multiply(this.z),n=a.multiply(r).mod(this.curve.q),i=this.curve.a.toBigInteger(),s=t.square().multiply(e);L.ZERO.equals(i)||(s=s.add(this.z.square().multiply(i))),s=s.mod(this.curve.q);var o=s.square().subtract(t.shiftLeft(3).multiply(n)).shiftLeft(1).multiply(a).mod(this.curve.q),u=s.multiply(e).multiply(t).subtract(n.shiftLeft(1)).shiftLeft(2).multiply(n).subtract(s.square().multiply(s)).mod(this.curve.q),c=a.square().multiply(a).shiftLeft(3).mod(this.curve.q);return new f(this.curve,this.curve.fromBigInteger(o),this.curve.fromBigInteger(u),c)}function E(e){if(this.isInfinity())return this;if(0==e.signum())return this.curve.getInfinity();var t,r=e,a=r.multiply(new L("3")),n=this.negate(),i=this;for(t=a.bitLength()-2;t>0;--t){i=i.twice();var s=a.testBit(t),o=r.testBit(t);s!=o&&(i=i.add(s?this:n))}return i}function S(e,t,r){var a;a=e.bitLength()>r.bitLength()?e.bitLength()-1:r.bitLength()-1;for(var n=this.curve.getInfinity(),i=this.add(t);a>=0;)n=n.twice(),e.testBit(a)?n=r.testBit(a)?n.add(i):n.add(this):r.testBit(a)&&(n=n.add(t)),--a;return n}function I(e,t,r){this.q=e,this.a=this.fromBigInteger(t),this.b=this.fromBigInteger(r),this.infinity=new f(this,null,null),this.reducer=new D(this.q)}function T(){return this.q}function A(){return this.a}function b(){return this.b}function F(e){return e==this||this.q.equals(e.q)&&this.a.equals(e.a)&&this.b.equals(e.b)}function B(){return this.infinity}function N(e){return new a(this.q,e)}function R(e){this.reducer.reduce(e)}function w(e){switch(parseInt(e.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:return null;case 4:case 6:case 7:var t=(e.length-2)/2,r=e.substr(2,t),a=e.substr(t+2,t);return new f(this,this.fromBigInteger(new L(r,16)),this.fromBigInteger(new L(a,16)));default:return null}}function U(e){if(e.isInfinity())return"00";var t=e.getX().toBigInteger().toString(16),r=e.getY().toBigInteger().toString(16),a=this.getQ().toString(16).length;for(a%2!=0&&a++;t.length<a;)t="0"+t;for(;r.length<a;)r="0"+r;return"04"+t+r}var P=r(1),L=P.jsbn.BigInteger,D=P.jsbn.Barrett;P.ec={},a.prototype.equals=n,a.prototype.toBigInteger=i,a.prototype.negate=s,a.prototype.add=o,a.prototype.subtract=u,a.prototype.multiply=c,a.prototype.square=p,a.prototype.divide=l,f.decodeFrom=function(e,t){var r=t[0],a=t.length-1;if(4!=r)throw"not supported ECPoint encoding:"+r;var n=t.slice(1,1+a/2),i=t.slice(1+a/2,1+a);n.unshift(0),i.unshift(0);var s=new L(n),o=new L(i);return new f(e,e.fromBigInteger(s),e.fromBigInteger(o))},f.prototype.getX=d,f.prototype.getY=h,f.prototype.equals=y,f.prototype.isInfinity=g,f.prototype.negate=C,f.prototype.add=v,f.prototype.twice=m,f.prototype.multiply=E,f.prototype.multiplyTwo=S,P.ec.ECPointFp=f,I.prototype.getQ=T,I.prototype.getA=A,I.prototype.getB=b,I.prototype.equals=F,I.prototype.getInfinity=B,I.prototype.fromBigInteger=N,I.prototype.reduce=R,I.prototype.decodePointHex=w,I.prototype.encodePointHex=U,P.ec.ECCurveFp=I,e.exports=P.ec},function(e,t,r){function a(e){this.privateKey=e.privateKey,this.publicKey=e.publicKey}var n=r(1),i=n.ec.ECPointFp;a.prototype.computeSharedData=function(e){var t=n.ECParameterDB.getByName("P-256"),r=e.raw.Q.toByteArrayUnsigned();if(!t.h.equals(n.jsbn.BigInteger.ONE))throw"need more calculation(h inverse) but not implemented";r=i.decodeFrom(t.curve,r);var a=r.multiply(this.privateKey.raw.d),s=n.crypto.util.arrayToString(a.getX().toBigInteger().toByteArrayUnsigned());return s},n.ecdh=a,e.exports=n.ecdh},function(e,t,r){var a=r(1),n=a.jsbn.BigInteger,i=a.ec.ECCurveFp;a.ECParameterDB=new function(){function e(e){return new n(e,16)}var t={},r={};this.getByName=function(e){var a=e;if("undefined"!=typeof r[a]&&(a=r[e]),"undefined"!=typeof t[a])return t[a];throw"unregistered EC curve name: "+a},this.regist=function(a,n,s,o,u,c,p,l,f,d,h,y){t[a]={};var g=e(s),C=e(o),v=e(u),m=e(c),E=e(p),S=new i(g,C,v),I=S.decodePointHex("04"+l+f);t[a].name=a,t[a].keylen=n,t[a].curve=S,t[a].G=I,t[a].n=m,t[a].h=E,t[a].oid=h,t[a].info=y;for(var T=0;T<d.length;T++)r[d[T]]=a}},a.ECParameterDB.regist("secp128r1",128,"FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFC","E87579C11079F43DD824993C2CEE5ED3","FFFFFFFE0000000075A30D1B9038A115","1","161FF7528B899B2D0C28607CA52C5B86","CF5AC8395BAFEB13C02DA292DDED7A83",[],"","secp128r1 : SECG curve over a 128 bit prime field"),a.ECParameterDB.regist("secp160k1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFAC73","0","7","0100000000000000000001B8FA16DFAB9ACA16B6B3","1","3B4C382CE37AA192A4019E763036F4F5DD4D7EBB","938CF935318FDCED6BC28286531733C3F03C4FEE",[],"","secp160k1 : SECG curve over a 160 bit prime field"),a.ECParameterDB.regist("secp160r1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFC","1C97BEFC54BD7A8B65ACF89F81D4D4ADC565FA45","0100000000000000000001F4C8F927AED3CA752257","1","4A96B5688EF573284664698968C38BB913CBFC82","23A628553168947D59DCC912042351377AC5FB32",[],"","secp160r1 : SECG curve over a 160 bit prime field"),a.ECParameterDB.regist("secp192k1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFEE37","0","3","FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8D","1","DB4FF10EC057E9AE26B07D0280B7F4341DA5D1B1EAE06C7D","9B2F2F6D9C5628A7844163D015BE86344082AA88D95E2F9D",[]),a.ECParameterDB.regist("secp192r1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC","64210519E59C80E70FA7E9AB72243049FEB8DEECC146B9B1","FFFFFFFFFFFFFFFFFFFFFFFF99DEF836146BC9B1B4D22831","1","188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF1012","07192B95FFC8DA78631011ED6B24CDD573F977A11E794811",[]),a.ECParameterDB.regist("secp224r1",224,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE","B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4","FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D","1","B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21","BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34",[]),
a.ECParameterDB.regist("secp256k1",256,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F","0","7","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141","1","79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798","483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8",[]),a.ECParameterDB.regist("secp256r1",256,"FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC","5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B","FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551","1","6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296","4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5",["NIST P-256","P-256","prime256v1"]),a.ECParameterDB.regist("secp384r1",384,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFC","B3312FA7E23EE7E4988E056BE3F82D19181D9C6EFE8141120314088F5013875AC656398D8A2ED19D2A85C8EDD3EC2AEF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC7634D81F4372DDF581A0DB248B0A77AECEC196ACCC52973","1","AA87CA22BE8B05378EB1C71EF320AD746E1D3B628BA79B9859F741E082542A385502F25DBF55296C3A545E3872760AB7","3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f",["NIST P-384","P-384"]),a.ECParameterDB.regist("secp521r1",521,"1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC","051953EB9618E1C9A1F929A21A0B68540EEA2DA725B99B315F3B8B489918EF109E156193951EC7E937B1652C0BD3BB1BF073573DF883D2C34F1EF451FD46B503F00","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA51868783BF2F966B7FCC0148F709A5D03BB5C9B8899C47AEBB6FB71E91386409","1","C6858E06B70404E9CD9E3ECB662395B4429C648139053FB521F828AF606B4D3DBAA14B5E77EFE75928FE1DC127A2FFA8DE3348B3C1856A429BF97E7E31C2E5BD66","011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650",["NIST P-521","P-521"]),e.exports=a.ECParameterDB},function(e,t,r){function a(){this.i=0,this.j=0,this.S=new Array}function n(e){var t,r,a;for(t=0;t<256;++t)this.S[t]=t;for(r=0,t=0;t<256;++t)r=r+this.S[t]+e[t%e.length]&255,a=this.S[t],this.S[t]=this.S[r],this.S[r]=a;this.i=0,this.j=0}function i(){var e;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,e=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=e,this.S[e+this.S[this.i]&255]}function s(){return new a}function o(e){m[E++]^=255&e,m[E++]^=e>>8&255,m[E++]^=e>>16&255,m[E++]^=e>>24&255,E>=S&&(E-=S)}function u(){o((new Date).getTime())}function c(){if(null==v){for(u(),v=s(),v.init(m),E=0;E<m.length;++E)m[E]=0;E=0}return v.next()}function p(e){var t;for(t=0;t<e.length;++t)e[t]=c()}function l(){}function f(e){return B.forEach(function(t){if(t.curveName==F.getName(e))return t}),B.push(new F({curve:e})),B[B.length-1]}function d(){}var h=r(1),y=h.jsbn.BigInteger,g=h.ec.ECPointFp,C=h.pki;a.prototype.init=n,a.prototype.next=i;var v,m,E,S=256;if(null==m){m=new Array,E=0;var I;if("undefined"!=typeof window&&(void 0!==window.crypto||void 0!==window.msCrypto)){var T=window.crypto||window.msCrypto;if(T.getRandomValues){var A=new Uint8Array(32);for(T.getRandomValues(A),I=0;I<32;++I)m[E++]=A[I]}else if("Netscape"==navigator.appName&&navigator.appVersion<"5"){var b=window.crypto.random(32);for(I=0;I<b.length;++I)m[E++]=255&b.charCodeAt(I)}}for(;E<S;)I=Math.floor(65536*Math.random()),m[E++]=I>>>8,m[E++]=255&I;E=0,u()}l.prototype.nextBytes=p;var F=function(e){var t="secp256r1",r=new l;this.type="EC",this.isPrivate=!1,this.isPublic=!1,this.getBigRandom=function(e){var t;return t=new y(e.bitLength(),r).mod(e.subtract(y.ONE)).add(y.ONE),t.bitLength()!=e.bitLength()&&(t=t.setBit(e.bitLength()-1)),t},this.checkBigRandom=function(e,t){var r=t;if(r.bitLength()!=e.bitLength())throw new h.error("mismatch number bits (need "+e.bitLength()+" bits)");r.mod(e.subtract(y.ONE)).add(y.ONE)},this.setNamedCurve=function(e){this.ecparams=h.ECParameterDB.getByName(e),this.prvKeyHex=null,this.pubKeyHex=null,this.curveName=e},this.setPrivateKeyHex=function(e){this.isPrivate=!0,this.prvKeyHex=e},this.setPublicKeyHex=function(e){this.isPublic=!0,this.pubKeyHex=e},this.getPublicKeyXYHex=function(){var e=this.pubKeyHex;if("04"!==e.substr(0,2))throw"this method supports uncompressed format(04) only";var t=this.ecparams.keylen/4;if(e.length!==2+2*t)throw"malformed public key hex length";var r={};return r.x=e.substr(2,t),r.y=e.substr(2+t),r},this.getShortNISTPCurveName=function(){var e=this.curveName;return"secp256r1"===e||"NIST P-256"===e||"P-256"===e||"prime256v1"===e?"P-256":"secp384r1"===e||"NIST P-384"===e||"P-384"===e?"P-384":null},this.generateKeyPairHex=function(e){var t,r=this.ecparams.n;"undefined"==typeof e?(t=this.getBigRandom(r),this.checkBigRandom(r,t)):(this.checkBigRandom(r,e),t=e);var a=this.ecparams.G.multiply(t),n=a.getX().toBigInteger(),i=a.getY().toBigInteger(),s=this.ecparams.keylen/4,o=("0000000000"+t.toString(16)).slice(-s),u=("0000000000"+n.toString(16)).slice(-s),c=("0000000000"+i.toString(16)).slice(-s),p="04"+u+c;return this.setPrivateKeyHex(o),this.setPublicKeyHex(p),{ecprvhex:o,ecpubhex:p}},this.signWithMessageHash=function(e){return this.signHex(e,this.prvKeyHex)},this.signHex=function(e,t){var r=new y(t,16),a=this.ecparams.n,n=new y(e,16);do var i=this.getBigRandom(a),s=this.ecparams.G,o=s.multiply(i),u=o.getX().toBigInteger().mod(a);while(u.compareTo(y.ZERO)<=0);var c=i.modInverse(a).multiply(n.add(r.multiply(u))).mod(a);return h.ECDSA.biRSSigToASN1Sig(u,c)},this.sign=function(e,t,r){var a=t,n=this.ecparams.n,i=y.fromByteArrayUnsigned(e);do{var s=this.getBigRandom(n);r.hasOwnProperty("k")&&(s=new y(h.util.bytesToHex(r.k),16));var o=this.ecparams.G,u=o.multiply(s),c=u.getX().toBigInteger().mod(n)}while(c.compareTo(y.ZERO)<=0);var p=s.modInverse(n).multiply(i.add(a.multiply(c))).mod(n);return this.serializeSig(c,p)},this.verifyWithMessageHash=function(e,t){return this.verifyHex(e,t,this.pubKeyHex)},this.verifyHex=function(e,t,r){var a,n,i=h.ECDSA.parseSigHex(t);a=i.r,n=i.s;var s;s=g.decodeFromHex(this.ecparams.curve,r);var o=new y(e,16);return this.verifyRaw(o,a,n,s)},this.verify=function(e,t,r){var a,n;if(h.util.isArray(t)||h.util.isArrayBuffer){var i=this.parseSig(t);a=i.r,n=i.s}else{if("object"!=typeof t||!t.r||!t.s)throw"Invalid value for signature";a=t.r,n=t.s}var s;if(r instanceof g)s=r;else{if(!h.util.isArray(r)&&!h.util.isArrayBuffer(r))throw"Invalid format for pubkey value, must be byte array or ECPointFp";s=g.decodeFrom(this.ecparams.curve,r)}var o=y.fromByteArrayUnsigned(e);return this.verifyRaw(o,a,n,s)},this.verifyRaw=function(e,t,r,a){var n=this.ecparams.n,i=this.ecparams.G;if(t.compareTo(y.ONE)<0||t.compareTo(n)>=0)return!1;if(r.compareTo(y.ONE)<0||r.compareTo(n)>=0)return!1;var s=r.modInverse(n),o=e.multiply(s).mod(n),u=t.multiply(s).mod(n),c=i.multiply(o).add(a.multiply(u)),p=c.getX().toBigInteger().mod(n);return p.equals(t)},this.serializeSig=function(e,t){var r=e.toByteArraySigned(),a=t.toByteArraySigned(),n=[];return n.push(2),n.push(r.length),n=n.concat(r),n.push(2),n.push(a.length),n=n.concat(a),n.unshift(n.length),n.unshift(48),n},this.parseSig=function(e){var t;if(48!=e[0])throw new Error("Signature not a valid DERSequence");if(t=2,2!=e[t])throw new Error("First element in signature must be a DERInteger");var r=e.slice(t+2,t+2+e[t+1]);if(t+=2+e[t+1],2!=e[t])throw new Error("Second element in signature must be a DERInteger");var a=e.slice(t+2,t+2+e[t+1]);t+=2+e[t+1];var n=y.fromByteArrayUnsigned(r),i=y.fromByteArrayUnsigned(a);return{r:n,s:i}},this.parseSigCompact=function(e){if(65!==e.length)throw"Signature has the wrong length";var t=e[0]-27;if(t<0||t>7)throw"Invalid signature type";var r=this.ecparams.n,a=y.fromByteArrayUnsigned(e.slice(1,33)).mod(r),n=y.fromByteArrayUnsigned(e.slice(33,65)).mod(r);return{r:a,s:n,i:t}},this.readPKCS5PrvKeyHex=function(e){var t=ASN1HEX,r=h.ECDSA.getName,a=t.getVbyList;if(t.isASN1HEX(e)===!1)throw"not ASN.1 hex string";var n,i,s;try{n=a(e,0,[2,0],"06"),i=a(e,0,[1],"04");try{s=a(e,0,[3,0],"03").substr(2)}catch(e){}}catch(e){throw"malformed PKCS#1/5 plain ECC private key"}if(this.curveName=r(n),void 0===this.curveName)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(s),this.setPrivateKeyHex(i),this.isPublic=!1},this.readPKCS8PrvKeyHex=function(e){var t=ASN1HEX,r=h.ECDSA.getName,a=t.getVbyList;if(t.isASN1HEX(e)===!1)throw"not ASN.1 hex string";var n,i,s,o;try{n=a(e,0,[1,0],"06"),i=a(e,0,[1,1],"06"),s=a(e,0,[2,0,1],"04");try{o=a(e,0,[2,0,2,0],"03").substr(2)}catch(e){}}catch(e){throw"malformed PKCS#8 plain ECC private key"}if(this.curveName=r(i),void 0===this.curveName)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(o),this.setPrivateKeyHex(s),this.isPublic=!1},this.readPKCS8PubKeyHex=function(e){var t=ASN1HEX,r=h.ECDSA.getName,a=t.getVbyList;if(t.isASN1HEX(e)===!1)throw"not ASN.1 hex string";var n,i,s;try{n=a(e,0,[0,0],"06"),i=a(e,0,[0,1],"06"),s=a(e,0,[1],"03").substr(2)}catch(e){throw"malformed PKCS#8 ECC public key"}if(this.curveName=r(i),null===this.curveName)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(s)},this.readCertPubKeyHex=function(e,t){5!==t&&(t=6);var r=ASN1HEX,a=F.getName,n=r.getVbyList;if(r.isASN1HEX(e)===!1)throw"not ASN.1 hex string";var i,s;try{i=n(e,0,[0,t,0,1],"06"),s=n(e,0,[0,t,1],"03").substr(2)}catch(e){throw"malformed X.509 certificate ECC public key"}if(this.curveName=a(i),null===this.curveName)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(s)},void 0!==e&&void 0!==e.curve&&(this.curveName=e.curve),void 0===this.curveName&&(this.curveName=t),this.setNamedCurve(this.curveName),void 0!==e&&(void 0!==e.prv&&this.setPrivateKeyHex(e.prv),void 0!==e.pub&&this.setPublicKeyHex(e.pub))};F.parseSigHex=function(e){var t=h.ECDSA.parseSigHexInHexRS(e),r=new y(t.r,16),a=new y(t.s,16);return{r:r,s:a}},F.parseSigHexInHexRS=function(e){var t=ASN1HEX,r=t.getChildIdx,a=t.getV;if("30"!=e.substr(0,2))throw"signature is not a ASN.1 sequence";var n=r(e,0);if(2!=n.length)throw"number of signature ASN.1 sequence elements seem wrong";var i=n[0],s=n[1];if("02"!=e.substr(i,2))throw"1st item of sequene of signature is not ASN.1 integer";if("02"!=e.substr(s,2))throw"2nd item of sequene of signature is not ASN.1 integer";var o=a(e,i),u=a(e,s);return{r:o,s:u}},F.asn1SigToConcatSig=function(e){var t=h.ECDSA.parseSigHexInHexRS(e),r=t.r,a=t.s;if("00"==r.substr(0,2)&&r.length/2*8%128==8&&(r=r.substr(2)),"00"==a.substr(0,2)&&a.length/2*8%128==8&&(a=a.substr(2)),r.length/2*8%128!=0)throw"unknown ECDSA sig r length error";if(a.length/2*8%128!=0)throw"unknown ECDSA sig s length error";return r+a},F.concatSigToASN1Sig=function(e){if(e.length/2*8%128!=0)throw"unknown ECDSA concatinated r-s sig  length error";var t=e.substr(0,e.length/2),r=e.substr(e.length/2);return h.ECDSA.hexRSSigToASN1Sig(t,r)},F.hexRSSigToASN1Sig=function(e,t){var r=new y(e,16),a=new y(t,16);return h.ECDSA.biRSSigToASN1Sig(r,a)},F.biRSSigToASN1Sig=function(e,t){var r=KJUR.asn1,a=new r.DERInteger({bigint:e}),n=new r.DERInteger({bigint:t}),i=new r.DERSequence({array:[a,n]});return i.getEncodedHex()},F.getName=function(e){return"2a8648ce3d030107"===e?"secp256r1":"2b8104000a"===e?"secp256k1":"2b81040022"===e?"secp384r1":"|secp256r1|NIST P-256|P-256|prime256v1|".indexOf(e)!==-1?"secp256r1":"|secp256k1|".indexOf(e)!==-1?"secp256k1":"|secp384r1|NIST P-384|P-384|".indexOf(e)!==-1?"secp384r1":null};var B=[];h.ecdsa=new d,d.prototype.generateKeyPair=function(e,t){var r,a;return r=f(e),"undefined"==typeof t&&(t={}),a=r.generateKeyPairHex(t.privateKey),{privateKey:C.setECPrivateKey(e,new y(a.ecprvhex,16),new y(a.ecpubhex,16)),publicKey:C.setECPublicKey(e,new y(a.ecpubhex,16))}},d.prototype.sign=function(e,t,r,a){var n,i,s=a||{};if(n=f(e.namedCurve),!n)throw"not supported curve";t=h.crypto.util.stringToArray(t),i=n.sign(t,e.d,s),i=h.crypto.util.arrayToString(i),r(i)},d.prototype.verify=function(e,t,r,a){var n,i,s=a||{};if(n=f(r.namedCurve),!n)throw"not supported curve";return e=h.crypto.util.stringToArray(e),t=h.crypto.util.stringToArray(t),r=r.Q.toByteArrayUnsigned(),i=n.verify(e,t,r,s)},e.exports=h.ecdsa},function(e,t,r){function a(e,t,r){var a,n,i=0,s=8*r.digestLength,o=t/s,u=t%s,p=0;for(r.start(),e=c.util.hexToBytes(e.toRadix(16));0==e.charCodeAt(p);)++p;for(n=l.ZERO,i=0;i<=o;++i)r.update(e,p,e.length-p),r.update(String.fromCharCode(i)),a=r.digest(),a=a.getBytes(),V_i=new l(a,256),V_i.signum()<0&&(V_i=V_i.negate()),i==o&&(mod=l.ZERO.setBit(u),V_i=V_i.mod(mod)),0!=i&&(mod=l.ZERO.setBit(i*s),V_i=V_i.mod(mod)),n=n.add(V_i);return n}function n(e,t,r){for(var n;;)if(n=c.random.getBytes(e/8),n=new l(n,256),n.setBit(e),!(n.bitLength()<t.bitLength()))break;return KSEED=a(new l(c.random.getBytes(e/8),256),e,r),{KKEY:n,KSEED:KSEED}}function i(e,t){var r,i,s,o=e.bitLength(),u={};switch(o){case 224:r=c.md.sha224.create();break;case 256:r=c.md.sha256.create();break;default:throw"not supported parameter Q length:"+o}if(t.hasOwnProperty("KKEY")&&t.hasOwnProperty("KSEED"))u.KKEY=t.KKEY,u.KSEED=t.KSEED,i=new l(u.KKEY,256),s=new l(u.KSEED,256);else{var p=n(o,e,r);i=p.KKEY,s=p.KSEED}var f,d,h=i.add(s),y=l.ZERO.setBit(o);return c.consoleLog,c.consoleLog,h=h.mod(y),c.consoleLog,f=a(h,o,r),c.consoleLog,f=f.mod(e),c.consoleLog,d=a(f.add(s.mod(y)),o,r),i=i.add(d.mod(y)),f}function s(e,t){return t=parseInt(t/8),e.substring(e.length-t)}function o(e,t){var r=e.modInverse(t.Q);return t.G.modPow(r,t.P)}function u(){this.KKEY=null,this.KSEED=null}var c=r(1),p=c.asn1,l=c.jsbn.BigInteger;u.prototype.encodeRS=function(e,t){var r,a=[],n=[];return a=String.fromCharCode(0)+e.R.toBinary(t),n=e.S.toBinary(),n.charCodeAt(0)>128&&(n=String.fromCharCode(0)+n),r=p.create(p.Class.UNIVERSAL,p.Type.SEQUENCE,!0,[p.create(p.Class.UNIVERSAL,p.Type.BITSTRING,!1,a),p.create(p.Class.UNIVERSAL,p.Type.INTEGER,!1,n)]),r=p.toDer(r),r.getBytes()},u.prototype.decodeRS=function(e){var t={};return e=c.asn1.fromDer(e),t.R=new l(e.value[0].value.substring(1),256),t.S=new l(e.value[1].value,256),t},u.prototype.sign=function(e,t,r,a){var n,u,p,f,d,h,y,g=0,C=a.digest;y=8*C.blockLength,n=e.params.P,u=e.params.Q,p=e.params.G,g=u.bitLength();var v=i(u,a),m=p.modPow(v,n);d=m.toBinary(),h=0,C.start(),C.update(d,h,d.length-h),f=C.digest().getBytes(),c.consoleLog,f=s(f,g),c.consoleLog,Y=o(e.X,e.params),c.consoleLog,d=c.util.hexToBytes(Y.toRadix(16)),h=d.length-y/8,d=d.substr(h),c.consoleLog,C.start(),C.update(d,0,d.length),C.update(t,0,t.length),H=C.digest().getBytes(),c.consoleLog,H=s(H,g),c.consoleLog,f=new l(f,256),f.signum()<0&&(f=f.negate()),H=new l(H,256),H.signum()<0&&(H=H.negate());var I=f.xor(H);E=I.mod(u),c.consoleLog,S=v.subtract(E).multiply(e.X).mod(u),c.consoleLog,RS={R:f,S:S},r(RS)},u.prototype.verify=function(e,t,r,a,n){var i,o,u,p,f,d,h,y,g,C,v=a.digest;if(i=e.params.P,o=e.params.Q,u=e.params.G,f=8*v.blockLength,p=o.bitLength(),f>p){if(p/8!=parseInt((r.R.bitLength()+7)/8))return void n(!1)}else if(f/8!=parseInt((r.R.bitLength()+7)/8))return void n(!1);return l.ZERO.max(r.S)!=r.S||r.S.max(o)!=o?void n(!1):(d=Y.toRadix(16),d=c.util.hexToBytes(d),d=d.substr(d.length-parseInt(f/8)),c.consoleLog,v.start(),v.update(d),v.update(t),y=v.digest().getBytes(),y=s(y,p),y=new l(y,256),c.consoleLog,g=r.R.xor(y).mod(o),c.consoleLog,C=Y.modPow(r.S,i),C=C.multiply(u.modPow(g,i)),C=C.mod(i),c.consoleLog,d=C.toRadix(16),d=c.util.hexToBytes(d),v.start(),v.update(d),d=v.digest().getBytes(),c.consoleLog,d=s(d,p),c.consoleLog,h=new l(d,256),0!=r.R.compareTo(h)?void n(!1):void n(!0))},c.kcdsa=new u,e.exports=c.kcdsa},function(e,t,r){function a(e){var t=e.toString(16);return t[0]>="8"&&(t="00"+t),o.util.hexToBytes(t)}function n(e,t){var r=o.util.createBuffer(e.publicKeyModulus).toHex(),a=o.util.createBuffer(e.publicKeyExponent).toHex();return u.setRsaPublicKey(new p(r,16),new p(a,16),t)}function i(e,t){var r=o.util.createBuffer(e.y).toHex(),a=[];if(!c.validate(t,d,e,a))throw{message:"Cannot read public key parameter. ASN.1 object does not contain an KCDSAPublicKey Parameter.",errors:a};var n=o.util.createBuffer(e.P).toHex(),i=o.util.createBuffer(e.Q).toHex(),s=o.util.createBuffer(e.G).toHex();return u.setKcdsaPublicKey(new p(r,16),new p(n,16),new p(i,16),new p(s,16))}function s(e,t){var r=o.util.createBuffer(e.q).toHex();if(t.type==c.Type.OID){var a=c.derToOid(t.value);return a=u.oids[a],u.setECPublicKey(a,new p(r,16))}throw{message:"not implemented choice, only support oid type"}}var o=r(1),u=o.pki,c=o.asn1,p=o.jsbn.BigInteger,l={name:"RSAPublicKey",tagClass:c.Class.UNIVERSAL,type:c.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:c.Class.UNIVERSAL,type:c.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:c.Class.UNIVERSAL,type:c.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},f={name:"KCDSAPublicKey",tagClass:c.Class.UNIVERSAL,type:c.Type.INTEGER,constructed:!1,capture:"y"},d={name:"KCDSAParameter",tagClass:c.Class.UNIVERSAL,type:c.Type.SEQUENCE,constructed:!0,value:[{name:"KCDSAParameter.P",tagClass:c.Class.UNIVERSAL,type:c.Type.INTEGER,constructed:!1,capture:"P"},{name:"KCDSAParameter.Q",tagClass:c.Class.UNIVERSAL,type:c.Type.INTEGER,constructed:!1,capture:"Q"},{name:"KCDSAParameter.G",tagClass:c.Class.UNIVERSAL,type:c.Type.INTEGER,constructed:!1,capture:"G"}]},h={name:"ECDSAPublicKey",tagClass:c.Class.UNIVERSAL,type:c.Type.OCTETSTRING,construncted:!0,capture:"q"},y={name:"SubjectPublicKeyInfo",tagClass:c.Class.UNIVERSAL,type:c.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:c.Class.UNIVERSAL,type:c.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:c.Class.UNIVERSAL,type:c.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:c.Class.UNIVERSAL,type:c.Type.BITSTRING,constructed:!1,capture:"publicKey"}]};u.publicKeyValidator=y,u.publicKeyFromAsn1=function(e,t,r){var a,o,p,d={},g=[];if(t)t==u.oids.rsaEncryption&&(o=l);else{if(!c.validate(e,y,d,g))throw{message:"can not read public key.",errors:g};var t=c.derToOid(d.publicKeyOid);switch(t){case u.oids.rsaEncryption:o=l;break;case u.oids.kcdsa:o=f;break;case u.oids.ecdsa:o=h;break;default:throw{message:"Cannot read public key. Unknown OID.",oid:t}}e.value[0].value.length>1&&(a=e.value[0].value[1]),p=d.publicKey.substring(1)}if(o==h)d.q=p;else{var C=p?c.fromDer(p):e;if(g=[],!c.validate(C,o,d,g))throw{message:"Cannot read public key. ASN.1 object does not contain an ECPublicKey.",errors:g}}switch(o){default:case l:return n(d,a);case f:return i(d,a);case h:return s(d,a)}},u.setECPublicKey=function(e,t){var r={};return r.oid=u.oids.ecdsa,r.type="public",r.namedCurve=e,t instanceof p?r.Q=t:r.Q=new p(o.util.bytesToHex(t),16),r},u.setKCDSAPublicKey=function(e,t,r,a,n,i){function s(){this.oid=o.pki.oids.kcdsa,this.type="public",this.params={}}var u=new s;if("undefined"==typeof e||"undefined"==typeof t||"undefined"==typeof r||"undefined"==typeof a)throw"need mandatory parameters (Y, P, Q, G)";return e instanceof p?u.Y=e:u.Y=new p(e,256),t instanceof p?u.params.P=t:u.params.P=new p(t,256),r instanceof p?u.params.Q=r:u.params.Q=new p(r,256),a instanceof p?u.params.G=a:u.params.G=new p(a,256),n&&(n instanceof p?u.params.J=n:u.params.J=new p(n,256)),i&&(u.params.validation=i),u},u.publicKeyToAsn1=u.publicKeyToSubjectPublicKeyInfo=function(e){var t,r,n;switch(e.oid){case u.oids.rsaEncryption:n=c.create(c.Class.UNIVERSAL,c.Type.NULL,!1,""),r=c.create(c.Class.UNIVERSAL,c.Type.BITSTRING,!1,String.fromCharCode(0)+c.toDer(u.publicKeyToRSAPublicKey(e)).bytes());break;case u.oids.kcdsa:n=c.create(c.Class.UNIVERSAL,c.Type.SEQUENCE,!0,[]),n.value.push(c.create(c.Class.UNIVERSAL,c.Type.INTEGER,!1,a(e.params.P))),n.value.push(c.create(c.Class.UNIVERSAL,c.Type.INTEGER,!1,a(e.params.Q))),n.value.push(c.create(c.Class.UNIVERSAL,c.Type.INTEGER,!1,a(e.params.G))),r=c.create(c.Class.UNIVERSAL,c.Type.BITSTRING,!1,String.fromCharCode(0)+c.toDer(u.publicKeyToKCDSAPublicKey(e)).bytes());break;case u.oids.ecdsa:n=c.create(c.Class.UNIVERSAL,c.Type.OID,!1,c.oidToDer(o.pki.oids.secp256r1).getBytes()),r=c.create(c.Class.UNIVERSAL,c.Type.BITSTRING,!1,String.fromCharCode(0)+u.publicKeyToECPublicKey(e));break;default:throw"unknown public key oid:"+e.oid}return t=c.create(c.Class.UNIVERSAL,c.Type.SEQUENCE,!0,[c.create(c.Class.UNIVERSAL,c.Type.SEQUENCE,!0,[c.create(c.Class.UNIVERSAL,c.Type.OID,!1,c.oidToDer(e.oid).getBytes()),n])]),t.value.push(r),t},u.publicKeyFromRSAPublicKeyAsn1=function(e){var t=n(e);c.create(c.Class.UNIVERSAL,c.Type.SEQUENCE,!0,[c.create(c.Class.UNIVERSAL,c.Type.INTEGER,!1,a(t.n)),c.create(c.Class.UNIVERSAL,c.Type.INTEGER,!1,a(t.e))])},u.publicKeyToRSAPublicKey=function(e){return c.create(c.Class.UNIVERSAL,c.Type.SEQUENCE,!0,[c.create(c.Class.UNIVERSAL,c.Type.INTEGER,!1,a(e.n)),c.create(c.Class.UNIVERSAL,c.Type.INTEGER,!1,a(e.e))])},u.publicKeyToKCDSAPublicKey=function(e){return c.create(c.Class.UNIVERSAL,c.Type.INTEGER,!1,a(e.y))},u.publicKeyToECPublicKey=function(e){return a(e.Q)},e.exports=u},function(e,t,r){function a(e){var t=e.toString(16);return t[0]>="8"&&(t="00"+t),o.util.hexToBytes(t)}function n(e,t){var r={},a=[];if(!c.validate(e,f,r,a))throw{message:"Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.",errors:a};var n,i,s,l,d,h,y,g;return n=o.util.createBuffer(r.privateKeyModulus).toHex(),i=o.util.createBuffer(r.privateKeyPublicExponent).toHex(),s=o.util.createBuffer(r.privateKeyPrivateExponent).toHex(),l=o.util.createBuffer(r.privateKeyPrime1).toHex(),d=o.util.createBuffer(r.privateKeyPrime2).toHex(),h=o.util.createBuffer(r.privateKeyExponent1).toHex(),y=o.util.createBuffer(r.privateKeyExponent2).toHex(),g=o.util.createBuffer(r.privateKeyCoefficient).toHex(),u.setRsaPrivateKey(new p(n,16),new p(i,16),new p(s,16),new p(l,16),new p(d,16),new p(h,16),new p(y,16),new p(g,16))}function i(e){if(1!=c.derToInteger(e.privateKeyVersion))throw"unknown ecprivatekey version";var t=c.derToOid(e.namedCurve);switch(t=u.oids[t]){case"secp256r1":t="P-256";break;default:throw"not implemented curve name:"+t}return u.setECPrivateKey(t,e.privateKey)}function s(e,t){var r,a,n,i,s,o;return r=new p(e.value,256),a=new p(t[0].value,256),n=new p(t[1].value,256),i=new p(t[2].value,256),t.length>3,u.setKCDSAPrivateKey(r,a,n,i,s,o)}var o=r(1),u=o.pki,c=o.asn1,p=o.jsbn.BigInteger,l={name:"PrivateKeyInfo",tagClass:c.Class.UNIVERSAL,type:c.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:c.Class.UNIVERSAL,type:c.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:c.Class.UNIVERSAL,type:c.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:c.Class.UNIVERSAL,type:c.Type.OID,constructed:!1,capture:"privateKeyOid"},{name:"AlgorithmIdentifier.parameter",tagClass:c.Class.UNIVERSAL,type:c.Type.ANY,constructed:!1,capture:"keyParameter",optional:!0}]},{name:"PrivateKeyInfo",tagClass:c.Class.UNIVERSAL,type:c.Type.OCTETSTRING,constructed:!1,capture:"privateKey"},{name:"PrivateKeyInfo.attributes",tagClass:c.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,captureAsn1:"attributes",optional:!0}]},f={name:"RSAPrivateKey",tagClass:c.Class.UNIVERSAL,type:c.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:c.Class.UNIVERSAL,type:c.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:c.Class.UNIVERSAL,type:c.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:c.Class.UNIVERSAL,type:c.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:c.Class.UNIVERSAL,type:c.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:c.Class.UNIVERSAL,type:c.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:c.Class.UNIVERSAL,type:c.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:c.Class.UNIVERSAL,type:c.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:c.Class.UNIVERSAL,type:c.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:c.Class.UNIVERSAL,type:c.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},d={name:"ECPrivateKey",tagClass:c.Class.UNIVERSAL,type:c.Type.SEQUENCE,constructed:!0,value:[{name:"ECPrivateKey.version",tagClass:c.Class.UNIVERSAL,type:c.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"ECPrivateKey.privateKey",tagClass:c.Class.UNIVERSAL,type:c.Type.OCTETSTRING,constructed:!1,capture:"privateKey"},{name:"ECPrivateKey.parameters",tagClass:c.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"ECPrivateKey.namedCurve",tagClass:c.Class.UNIVERSAL,type:c.Type.OID,capture:"namedCurve"}]},{name:"ECPrivateKey.publicKey",tagClass:c.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"ECPrivateKey.publicKey",tagClass:c.Class.UNIVERSAL,type:c.Type.BITSTRING,capture:"publicKey"}]}]};u.privateKeyToAsn1=function(e){switch(e.oid){case o.pki.oids.rsaEncryption:return u.privateKeyToRSAPrivateKey(e);case o.pki.oids.ecdsa:return u.privateKeyToECPrivateKey(e);default:throw"not implemented oid:"+e.oid}},u.privateKeyToRSAPrivateKey=function(e){return c.create(c.Class.UNIVERSAL,c.Type.SEQUENCE,!0,[c.create(c.Class.UNIVERSAL,c.Type.INTEGER,!1,c.integerToDer(0).getBytes()),c.create(c.Class.UNIVERSAL,c.Type.INTEGER,!1,a(e.n)),c.create(c.Class.UNIVERSAL,c.Type.INTEGER,!1,a(e.e)),c.create(c.Class.UNIVERSAL,c.Type.INTEGER,!1,a(e.d)),c.create(c.Class.UNIVERSAL,c.Type.INTEGER,!1,a(e.p)),c.create(c.Class.UNIVERSAL,c.Type.INTEGER,!1,a(e.q)),c.create(c.Class.UNIVERSAL,c.Type.INTEGER,!1,a(e.dP)),c.create(c.Class.UNIVERSAL,c.Type.INTEGER,!1,a(e.dQ)),c.create(c.Class.UNIVERSAL,c.Type.INTEGER,!1,a(e.qInv))])},u.privateKeyToECPrivateKey=function(e){var t,r,n,i;switch(e.namedCurve){default:case"P-256":n="secp256r1"}return n=u.oids[n],r=c.create(c.Class.UNIVERSAL,c.Type.OID,!1,c.oidToDer(n).getBytes()),e.hasOwnProperty("Q")&&(t=c.create(c.Class.UNIVERSAL,c.Type.BITSTRING,!1,String.fromCharCode(0)+a(e.Q))),i=c.create(c.Class.UNIVERSAL,c.Type.SEQUENCE,!0,[c.create(c.Class.UNIVERSAL,c.Type.INTEGER,!1,c.integerToDer(1)),c.create(c.Class.UNIVERSAL,c.Type.OCTETSTRING,!1,a(e.d)),c.create(c.Class.CONTEXT_SPECIFIC,0,!0,[r]),t?c.create(c.Class.CONTEXT_SPECIFIC,1,!0,[t]):void 0])},u.setECPrivateKey=function(e,t,r){var a={};return a.oid=o.pki.oids.ecdsa,a.type="private",a.namedCurve=e,t instanceof p?a.d=t:a.d=new p(o.util.bytesToHex(t),16),r instanceof p?a.Q=r:a.Q=new p(o.util.bytesToHex(r),16),a},u.setKCDSAPrivateKey=function(e,t,r,a,n,i){var s={};if("undefined"==typeof e||"undefined"==typeof t||"undefined"==typeof r||"undefined"==typeof a)throw"need mandatory parameters (X, P, Q, G)";return s.oid=o.pki.oids.kcdsa,s.type="private",s.params={},e instanceof p?s.X=e:s.X=new p(e,256),t instanceof p?s.params.P=t:s.params.P=new p(t,256),r instanceof p?s.params.Q=r:s.params.Q=new p(r,256),a instanceof p?s.params.G=a:s.params.G=new p(a,256),n&&(n instanceof p?s.params.J=n:s.params.J=new p(n,256)),i&&(s.params.validation=i),s},u.privateKeyFromAsn1=function(e,t,r){var a={},u=[];return t==o.oids.kcdsa?s(e,r):(c.validate(e,l,a,u)&&(e=c.fromDer(o.util.createBuffer(a.privateKey)),"undefined"==typeof t&&a.privateKeyOid&&(t=c.derToOid(a.privateKeyOid)),a.keyParameter&&!r&&(r=a.keyParameter)),u=[],a=[],c.validate(e,d,a,u)?i(a):n(e,t))},e.exports=u},function(e,t,r){var a=r(1),n=(r(36),r(37)),i=r(38),s=a.getSettings(),o=s.subtle,u=function(e,t,r){return e.then?e.then(t,r):(e.onerror=r,e.oncomplete=function(){1==arguments.length&&arguments[0]instanceof Event&&(arguments[0]=arguments[0].target.result),t.apply(this,arguments)},e)};a.Promise=u,a.crypto.key=function(e,t,r){function o(e,t,r,s){var o,u=0;if(a.consoleLog,a.consoleLog,t.hasOwnProperty("saltLength")?u=t.saltLength:(u=32,"RSA-PSS"===t.name&&(t.saltLength=u)),a.consoleLog,t.hash.hasOwnProperty("parameter")&&(o=t.hash.parameter),a.useWebCrypto&&e.webcrypto){if("undefined"!=typeof o)return void s(new a.error("webcrypto object does not support sign with parameter"));n.sign(e.raw,t,r,function(e){return e instanceof a.error?void s(e):void s(e)})}else i.sign(e.raw,t,r,function(e){return e instanceof a.error?void s(e):void s(e)})}function u(e,t,r,i,s){var o,u=0;if(a.consoleLog,o=a.md.algorithms[t.hash.name.replace("-","").toLowerCase()],t.hasOwnProperty("saltLength")?u=t.saltLength:(u=32,"RSA-PSS"===t.name&&(t.saltLength=u)),a.consoleLog,a.useWebCrypto&&e.webcrypto)return void n.verify(e.raw,t,r,i,s);var c,p=o.create();if(a.consoleLog,a.consoleLog,t.inputTypeDigestInfo){var l=a.asn1.fromDer(i);c=l.value[1].value}else p=a.md.algorithms[t.hash.name.replace("-","").toLowerCase()].create(),p.update(i),c=p.digest().getBytes();a.consoleLog;try{var f;"RSA-PSS"===t.name&&(f=a.pss.create(p,a.mgf.mgf1.create(o.create()),u));var d=e.raw.verify(c,r,f)}catch(e){return a.consoleLog,void s(new a.error(e.message?e.message:e))}s(d)}function c(e,t,r,n,i){var s,o,u=!1;"RAW"!==t.hash?(s=a.md.algorithms[t.hash.name.replace("-","").toLowerCase()],s=s.create(),s.update(n),o=s.digest().getBytes()):o=n,u=a.ecdsa.verify(o,r,e.raw),i(u)}function p(e,t,r,n,i){var s,o={};if("RAW"===t.hash)throw"not supported hash algorithm raw";s=a.md.algorithms[t.hash.name.replace("-","").toLowerCase()],o.digest=s.create(),r=a.kcdsa.decodeRS(r),a.kcdsa.verify(e.raw,n,r,o,function(e){i(e)})}if("undefined"!=typeof e){var l,f=0;if(this.raw=e,this.type=t,this.webcrypto=!("undefined"==typeof r||!r),this.webcrypto)"undefined"==typeof t&&"type"in e&&(this.type=e.type);else switch(e.oid){case a.pki.oids.rsaEncryption:if(l="RSA",!e.hasOwnProperty("n")||!e.hasOwnProperty("e"))throw new a.error("bad rsa publickey");e.hasOwnProperty("p")&&e.hasOwnProperty("q")?this.type="private":this.type="public",f=e.n.bitLength();break;case a.pki.oids.kcdsa:l="KCDSA",f=e.params.P.bitLength(),e.hasOwnProperty("y")?this.type="public":this.type="private";break;case a.pki.oids.ecdsa:l="ECDSA",this.namedCurve=e.namedCurve,e.hasOwnProperty("type")&&(this.type=e.type);break;default:throw new a.error("not supported key")}this.getKeyAlgorithm=function(){return l},this.getKeySize=function(){return f},this.encrypt=function(e,t,r){var s,o;if("undefined"!=typeof t&&"RSA-OAEP"===t.name&&(s="RSA-OAEP","label"in t))throw new a.error("not supported OAEP label");return a.useWebCrypto&&this.webcrypto?void(this.raw.extractable?n.exportKeyInfo.call(this,function(t){return t=a.pki.publicKeyFromAsn1(a.asn1.fromDer(t)),i.encrypt(t,e,s,o,r)}):n.encrypt.apply(this,arguments)):i.encrypt(this.raw,e,s,o,r)},this.decrypt=function(e,t,r){var n,i,s;if("undefined"!=typeof t&&"RSA-OAEP"===t.name&&(i="RSA-OAEP","label"in t))throw new a.error("not supported OAEP label");if(a.useWebCrypto&&this.webcrypto){if(this.raw.extractable)return void this.exportKeyInfo(function(t){t=a.pki.privateKeyFromAsn1(a.asn1.fromDer(t)),n=t.decrypt(e,i,s),r(n)});throw new yt.error("need extractable webcrypto key.")}try{n=this.raw.decrypt(e,i,s)}catch(e){if(r)return void r(new a.error(e))}return"undefined"==typeof r?n:void r(n)},this.sign=function(e,t,r,n){if("private"!==this.type)return void r(new a.error("publicKey can not sign a data"));if(e.name.indexOf("RSA")!=-1)return void o(this,e,t,r);if("ECDSA"==e.name)return void i.signECDSA(this.raw,e,t,r,n);
if("KCDSA"==e.name)return void i.signKCDSA(this.raw,e,t,r,n);throw"unknown algorithm:"+e.name},this.verify=function(e,t,r,n){return"public"!==this.type?void n(new a.error("privateKey can not verify a signature")):void(e.name.indexOf("RSA")!=-1?u(this,e,t,r,n):"ECDSA"==e.name?c(this,e,t,r,n):"KCDSA"==e.name&&p(this,e,t,r,n))},this.exportKeyInfo=function(e,t){function r(r,n){var i,s;if(n.hasOwnProperty("namedCurve")&&(i=a.asn1.oidToDer(a.pki.oids.secp256r1).getBytes()),"public"==r){if(s=a.pki.publicKeyToAsn1(n),t.rawPublicKey){var o;return a.consoleLog,o=s.value[1].value.substring(1),void e(o,i)}}else"private"==r&&(s=a.pki.privateKeyToAsn1(n));e(a.asn1.toDer(s).getBytes(),i)}var i=this;if(t=t||{},a.useWebCrypto===!1||this.webcrypto===!1)return void r(this.type,this.raw);var o="";o="public"==this.type?s.exportWebCryptoPublicKeyMethod:s.exportWebCryptoPrivateKeyMethod,n.exportKey(this.raw,o,function(t){return t instanceof a.error?void e(t):void r(i.type,t)})}}},a.crypto.key.fromBytes=function(e,t,r,s){var u,c,p="public",l=!0;"undefined"==typeof r&&(r={}),l=r.autoImport,c=a.asn1.fromDer(e);try{u=a.pki.privateKeyFromAsn1(c,s),p="private"}catch(e){try{u=r.RSAPublicKey?a.pki.publicKeyFromAsn1(c,a.oids.rsaEncryption,null):a.pki.publicKeyFromAsn1(c),p="public"}catch(e){return a.consoleLog,void t(new a.error("알수 없는 키 입니다:"+JSON.stringify(e)))}}switch("undefined"==typeof s&&(s=u.oid),s){case a.pki.oids.kcdsa:break;case a.pki.oids.ecdsa:break;case a.pki.oids.rsaEncryption:default:if(a.useWebCrypto&&l&&o)return void n.keyFromAsn1(u,p,r,t)}i.keyFromAsn1(s,u,p,r,t)},a.crypto.key.fromString=function(e,t){return a.crypto.key.fromBytes(a.util.hexToBytes(e),t)},a.crypto.generateKey=function(e,t,r,i){var s,u;if(a.crypto.handlers.generateKey)return void a.crypto.handlers.generateKey(e,t,r,i);if(a.useWebCrypto&&o&&e.webcrypto&&"ECDSA"!=e.name)return void n.generateKey(e,t,r,i);var c;if(e.name.indexOf("RSA")!=-1)c=a.rsa.generateKeyPair(e.modulusLength,"undefined"!=typeof e.publicExponent?e.publicExponent:65537);else{if("ECDSA"!=e.name)throw"unsupported algorithm name:"+e.name;c=a.ecdsa.generateKeyPair(e.namedCurve,e.options)}a.consoleLog,s=new a.crypto.key(c.publicKey,"public"),u=new a.crypto.key(c.privateKey,"private"),i({publicKey:s,privateKey:u})},e.exports=a.crypto.key},function(e,t,r){function a(e){return e=s.crypto.util.decode64url(e),new s.jsbn.BigInteger(e,256)}function n(e){var t;return t=e.toString(16),s.crypto.util.encode64url(s.util.hexToBytes(t))}function i(){}var s=r(1);i.prototype.encode=function(e,t){var r={};return r.kty="RSA",r.alg="RS256","RSA-PSS"==e&&(r.alg="PS256"),r.n=n(t.n),r.e=n(t.e),t.hasOwnProperty("d")&&(r.d=n(t.d),r.p=n(t.p),r.q=n(t.q),r.dp=n(t.dP),r.dq=n(t.dQ),r.qi=n(t.qInv)),r},i.prototype.decode=function(e){return e.hasOwnProperty("d")===!1?s.pki.setRsaPublicKey(a(e.n),a(e.e)):s.pki.setRsaPrivateKey(a(e.n),a(e.e),a(e.d),a(e.p),a(e.q),a(e.dp),a(e.dq),a(e.qi))},e.exports=new i},function(e,t,r){function a(e,t,r,a){plain=s.crypto.util.stringToArrayBuffer(r),s.consoleLog,l(p.sign(t,e,plain.buffer),function(e){s.consoleLog,a(s.crypto.util.arrayBufferToString(e))},function(e){s.consoleLog,a(new s.error(e))})}function n(e,t,r,a,n){a=s.crypto.util.hexToArrayBuffer(s.util.bytesToHex(a)),r=s.crypto.util.hexToArrayBuffer(s.util.bytesToHex(r)),l(p.verify(t,e,r,a),function(e){s.consoleLog,n(e)},function(e){s.consoleLog,n(new s.error(e))})}function i(e,t,r){function a(e){s.consoleLog,r(new s.error(e))}function n(e){var a=e,n=null;if(c.wrapWebCryptoArrayBuffer){if(a=s.crypto.util.arrayBufferToString(e),"jwk"==t)try{n=JSON.parse(a)}catch(e){s.consoleLog}}else"jwk"==t&&(n=a);null!=n&&(a=o.decode(n)),r(a)}try{l(p.exportKey(t,e),n,a)}catch(e){a(e)}}var s=r(1),o=r(36),u={},c=s.getSettings(),p=c.subtle,l=function(e,t,r){return e.then?e.then(t,r):(e.onerror=r,e.oncomplete=function(){1==arguments.length&&arguments[0]instanceof Event&&(arguments[0]=arguments[0].target.result),t.apply(this,arguments)},e)};u.sign=a,u.verify=n,u.encrypt=function(e,t,r){e=s.crypto.util.stringToArrayBuffer(e),l(p.encrypt(t,this.raw,e),function(e){s.consoleLog,r(s.crypto.util.arrayBufferToString(e))},function(e){s.consoleLog,r(new s.error(e))})},u.generateKey=function(e,t,r,a){try{l(p.generateKey(e,t,r),function(e){publicKey=new s.crypto.key(e.publicKey,"public",!0),privateKey=new s.crypto.key(e.privateKey,"private",!0),s.consoleLog,a({publicKey:publicKey,privateKey:privateKey})},function(t){e===t&&(s.consoleLog,t="Unsupported Algorithm or Keysize(maybe)"),a(new s.error(t))})}catch(e){s.consoleLog,s.consoleLog,a(new s.error(e))}},u.exportKey=i,u.keyFromAsn1=function(e,t,r,a){function n(e,r,a){var n;switch(c.importWebCryptoPrivateKeyMethod){case"pkcs8":n=s.crypto.util.stringToArrayBuffer(r),keyFormat="pkcs8";break;case"jwk":var i=o.encode(e,_key);keyFormat="jwk",c.wrapWebCryptoArrayBuffer?(i=JSON.stringify(i),n=s.crypto.util.stringToArrayBuffer(i)):n=i;break;default:return void a(new s.error("not supported importKey method:"+c.importWebCryptoPrivateKeyMethod))}l(p.importKey(keyFormat,n,algs,extractable,keyUsage),function(e){a(new s.crypto.key(e,t,!0))},function(e){s.consoleLog,a(new s.error(e))})}if("private"==t)_key=e,asn=s.pki.privateKeyToAsn1(e),keyFormat="pkcs8",extractable=!1,forSigning?keyUsage.push("sign"):keyUsage.push("decrypt");else try{asn=s.pki.publicKeyToAsn1(e),_key=s.pki.publicKeyFromAsn1(asn),keyFormat="spki",forSigning?keyUsage.push("verify"):keyUsage.push("encrypt")}catch(e){return void a(new s.error("알수 없는 키 입니다:"+e))}_bytes=s.asn1.toDer(asn).getBytes(),n(algorithm,_bytes,a)},e.exports=u},function(e,t,r){function a(e,t,r,a){var n=r.algorithm,i={hash:{name:"SHA-256"}},o=!0;switch("undefined"==typeof n&&(n="RSASSA-PKCS1-v1_5"),n){case"RSA-PSS":i.name="RSA-PSS",i.saltLength=r.saltLength||32,o=!0;break;case"RSASSA-PKCS1-v1_5":i.name="RSASSA-PKCS1-v1_5",o=!0;break;case"RSAES-PKCS1-v1_5":i.name="RSAES-PKCS1-v1_5",o=!1;break;case"RSAES-OAEP":i.name="RSAES_OAEP",o=!1;break;default:return void a(new s.error("not supported algorithm for cms signing:"+n))}a(new s.crypto.key(e,t))}function n(e,t,r,a){r(new s.crypto.key(e,t))}function i(e,t,r){r(new s.crypto.key(e,t))}var s=r(1),o={};o.encrypt=function(e,t,r,a,n){return cipher=e.encrypt(t,r,a),"undefined"==typeof n?cipher:void n(cipher)},o.signECDSA=function(e,t,r,a,n){var i,o;"RAW"!==t.hash?(i=s.md.algorithms[t.hash.name.replace("-","").toLowerCase()],i=i.create(),i.update(r),o=i.digest().getBytes()):o=r,s.ecdsa.sign(e,o,a,n)},o.signKCDSA=function(e,t,r,a,n){var i,o={};if("RAW"===t.hash)throw"not supported hash";i=s.md.algorithms[t.hash.name.replace("-","").toLowerCase()],o.digest=i.create(),s.kcdsa.sign(e,r,function(e){e=s.kcdsa.encodeRS(e,self.raw.params.Q.bitLength()/8),a(e)},o)},o.sign=function(e,t,r,a){var n,i,o,u;t.inputTypeDigestInfo?(i=r,u=null):"RAW"!==t.hash?(n=s.md.algorithms[t.hash.name.replace("-","").toLowerCase()],i=n.create(),i.update(r),s.consoleLog,"undefined"!=typeof t.hash.parameter&&(i.parameter=t.hash.parameter),"RSA-PSS"===t.name&&(u=s.pss.create(i,s.mgf.mgf1.create(n.create()),t.saltLength))):i={algorithm:"RAW",digest:function(){return new ByteBuffer(r)}},o=e.sign(i,u),s.consoleLog,a(o)},o.keyFromAsn1=function(e,t,r,o,u){switch(e){case s.pki.oids.rsaEncryption:return a(t,r,o,u);case s.pki.oids.kcdsa:return n(t,r,u);case s.pki.oids.ecdsa:return i(t,r,u)}},e.exports=o},function(e,t,r){var a=r(1),n=a.hmac=a.hmac||{};n.create=function(){var e=null,t=null,r=null,n=null,i={};return i.start=function(i,s){if(null!==i)if("string"==typeof i){if(i=i.toLowerCase(),!(i in a.md.algorithms))throw'Unknown hash algorithm "'+i+'"';t=a.md.algorithms[i].create()}else t=i;if(null===s)s=e;else{if("string"==typeof s)s=a.util.createBuffer(s);else if(a.util.isArray(s)){var o=s;s=a.util.createBuffer();for(var u=0;u<o.length;++u)s.putByte(o[u])}var c=s.length();c>t.blockLength&&(t.start(),t.update(s.bytes()),s=t.digest()),r=a.util.createBuffer(),n=a.util.createBuffer(),c=s.length();for(var u=0;u<c;++u){var o=s.at(u);r.putByte(54^o),n.putByte(92^o)}if(c<t.blockLength)for(var o=t.blockLength-c,u=0;u<o;++u)r.putByte(54),n.putByte(92);e=s,r=r.bytes(),n=n.bytes()}t.start(),t.update(r)},i.update=function(e){t.update(e)},i.getMac=function(){var e=t.digest().bytes();return t.start(),t.update(n),t.update(e),t.digest()},i.digest=i.getMac,i},e.exports=n},function(e,t,r){var a={};e.exports=a,a.getVersion=function(){return"2.8.8"},a.getLicense=function(){return"JSRose - Public Key Infrastructure & Cryptography ToolKit\nCopyright All rights reserved by YettieSoft(c).\n\nVersion - 2.8.8\nDate - 2022.5.25\n\nContributors\n - lovian@yettiesoft.com\n".split("\n")},r(41),r(42),r(43),r(44),r(45),r(47),r(48),r(49),r(56),r(57),r(61),r(62),r(63),r(64),r(65)},function(e,t,r){function a(e){this.value=e}var n=r(1),i=r(40);i.consoleLog=!1,i.console={},i.console.log=function(e){0!=i.consoleLog&&("undefined"==typeof window.console?document.title=e:window.console.log(e))},i.error=function(e,t){void 0===t&&(t=e,e=void 0),this.code=e,this.reason=[t],this.getReason=function(){return this.reason},this.pushReason=function(e){this.reason.push(e)},this.getReasonString=function(e){var t=[];return e&&(e=","),this.reason.map(function(e){t.push(JSON.stringify(e))}),t.join(e)}},n&&(n.error=i.error),i.common={},i.common.addEvent=function(e,t,r){var a,n;if(a=t.toLowerCase(),n=a.indexOf("on"),window.addEventListener)0==n&&(a=a.substring(2)),e.addEventListener(a,r,!1),e[a]||(e[a]=r);else{if(!window.attachEvent)throw"unknown add event method";0!=n&&(a="on"+a),e.attachEvent(a,r)}},a.prototype.toArrayBuffer=function(){},a.prototype.toHex=function(){},a.prototype.toBase64=function(){},a.prototype.toBase64URL=function(){},a.fromString=function(){return new a},a.fromBytes=function(e){return new a(e)},a.TYPE={HEXA:1,B64:2,B64URL:3},a.b2s=function(e,t){},a.s2b=function(e,t){},i.bytes=a,e.exports=i.error},function(e,t,r){var a=r(40),n=a._asn1=a._asn1||{},i=n;n.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192},n.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30},n.create=function(e,t,r,n){if(a.util.isArray(n)){for(var i=[],s=0;s<n.length;++s)void 0!==n[s]&&i.push(n[s]);n=i}return{tagClass:e,type:t,constructed:r,composed:r||a.util.isArray(n),value:n}};var s=function(e){var t=e.getByte();if(128!==t){var r,a=128&t;return r=a?e.getInt((127&t)<<3):t}};n.fromDer=function(e,t){if(void 0===t&&(t=!0),"string"==typeof e&&(e=a.util.createBuffer(e)),e.length()<2)throw{message:"Too few bytes to parse DER.",bytes:e.length()};var r=e.getByte(),i=192&r,o=31&r,u=s(e);if(e.length()<u){if(t)throw{message:"Too few bytes to read ASN.1 value.",detail:e.length()+" < "+u};u=e.length()}var c,p=32===(32&r),l=p;if(!l&&i===n.Class.UNIVERSAL&&o===n.Type.BITSTRING&&u>1){var f=e.read,d=e.getByte(),h=!1;if(0===d&&h){r=e.getByte();var y=192&r;if(y===n.Class.UNIVERSAL||y===n.Class.CONTEXT_SPECIFIC)try{var g=s(e);l=g===u-(e.read-f),l&&(++f,--u)}catch(e){}}e.read=f}if(l)if(c=[],void 0===u)for(;;){if(e.bytes(2)===String.fromCharCode(0,0)){e.getBytes(2);break}c.push(n.fromDer(e,t))}else for(var C=e.length();u>0;)c.push(n.fromDer(e,t)),u-=C-e.length(),C=e.length();else{if(void 0===u){if(t)throw{message:"Non-constructed ASN.1 object of indefinite length."};u=e.length()}if(o===n.Type.BMPSTRING){c="";for(var v=0;v<u;v+=2)c+=String.fromCharCode(e.getInt16())}else c=e.getBytes(u)}return n.create(i,o,p,c)},n.toDer=function(e){var t=a.util.createBuffer(),r=e.tagClass|e.type,i=a.util.createBuffer();if(e.composed){e.constructed?r|=32:i.putByte(0);for(var s=0;s<e.value.length;++s)void 0!==e.value[s]&&i.putBuffer(n.toDer(e.value[s]))}else if(e.type===n.Type.BMPSTRING)for(var s=0;s<e.value.length;++s)i.putInt16(e.value.charCodeAt(s));else i.putBytes(e.value);if(t.putByte(r),i.length()<=127)t.putByte(127&i.length());else{var o=i.length(),u="";do u+=String.fromCharCode(255&o),o>>>=8;while(o>0);t.putByte(128|u.length);for(var s=u.length-1;s>=0;--s)t.putByte(u.charCodeAt(s))}return t.putBuffer(i),t},n.oidToDer=function(e){var t=e.split("."),r=a.util.createBuffer();r.putByte(40*parseInt(t[0],10)+parseInt(t[1],10));for(var n,i,s,o,u=2;u<t.length;++u){n=!0,i=[],s=parseInt(t[u],10);do o=127&s,s>>>=7,n||(o|=128),i.push(o),n=!1;while(s>0);for(var c=i.length-1;c>=0;--c)r.putByte(i[c])}return r},n.derToOid=function(e){var t;"string"==typeof e&&(e=a.util.createBuffer(e));var r=e.getByte();t=Math.floor(r/40)+"."+r%40;for(var n=0;e.length()>0;)r=e.getByte(),n<<=7,128&r?n+=127&r:(t+="."+(n+r),n=0);return t},n.utcTimeToDate=function(e){var t=new Date,r=parseInt(e.substr(0,2),10);r=r>=50?1900+r:2e3+r;var a=parseInt(e.substr(2,2),10)-1,n=parseInt(e.substr(4,2),10),i=parseInt(e.substr(6,2),10),s=parseInt(e.substr(8,2),10),o=0;if(e.length>11){var u=e.charAt(10),c=10;"+"!==u&&"-"!==u&&(o=parseInt(e.substr(10,2),10),c+=2)}if(t.setUTCFullYear(r,a,n),t.setUTCHours(i,s,o,0),c&&(u=e.charAt(c),"+"===u||"-"===u)){var p=parseInt(e.substr(c+1,2),10),l=parseInt(e.substr(c+4,2),10),f=60*p+l;f*=6e4,"+"===u?t.setTime(+t-f):t.setTime(+t+f)}return t},n.generalizedTimeToDate=function(e){var t=new Date,r=parseInt(e.substr(0,4),10),a=parseInt(e.substr(4,2),10)-1,n=parseInt(e.substr(6,2),10),i=parseInt(e.substr(8,2),10),s=parseInt(e.substr(10,2),10),o=parseInt(e.substr(12,2),10),u=0,c=0,p=!1;"Z"===e.charAt(e.length-1)&&(p=!0);var l=e.length-5,f=e.charAt(l);if("+"===f||"-"===f){var d=parseInt(e.substr(l+1,2),10),h=parseInt(e.substr(l+4,2),10);c=60*d+h,c*=6e4,"+"===f&&(c*=-1),p=!0}return"."===e.charAt(14)&&(u=1e3*parseFloat(e.substr(14),10)),p?(t.setUTCFullYear(r,a,n),t.setUTCHours(i,s,o,u),t.setTime(+t+c)):(t.setFullYear(r,a,n),t.setHours(i,s,o,u)),t},n.dateToUtcTime=function(e){var t="",r=[];r.push((""+e.getUTCFullYear()).substr(2)),r.push(""+(e.getUTCMonth()+1)),r.push(""+e.getUTCDate()),r.push(""+e.getUTCHours()),r.push(""+e.getUTCMinutes()),r.push(""+e.getUTCSeconds());for(var a=0;a<r.length;++a)r[a].length<2&&(t+="0"),t+=r[a];return t+="Z"},n.integerToDer=function(e){var t=a.util.createBuffer();if(e>=-128&&e<128)return t.putSignedInt(e,8);if(e>=-32768&&e<32768)return t.putSignedInt(e,16);if(e>=-8388608&&e<8388608)return t.putSignedInt(e,24);if(e>=-2147483648&&e<2147483648)return t.putSignedInt(e,32);throw{message:"Integer too large; max is 32-bits.",integer:e}},n.derToInteger=function(e){"string"==typeof e&&(e=a.util.createBuffer(e));var t=8*e.length();if(t>32)throw{message:"Integer too large; max is 32-bits."};return e.getSignedInt(t)},n.validate=function(e,t,r,i){var s=!1;if(e.tagClass!==t.tagClass&&"undefined"!=typeof t.tagClass||e.type!==t.type&&"undefined"!=typeof t.type)i&&(e.tagClass!==t.tagClass&&i.push("["+t.name+'] Expected tag class "'+t.tagClass+'", got "'+e.tagClass+'"'),e.type!==t.type&&i.push("["+t.name+'] Expected type "'+t.type+'", got "'+e.type+'"'));else if(e.constructed===t.constructed||"undefined"==typeof t.constructed){if(s=!0,t.value&&a.util.isArray(t.value))for(var o=0,u=0;s&&u<t.value.length;++u)s=t.value[u].optional||!1,e.value[o]&&(s=n.validate(e.value[o],t.value[u],r,i),s?++o:t.value[u].optional&&(s=!0)),!s&&i&&i.push("["+t.name+'] Tag class "'+t.tagClass+'", type "'+t.type+'" expected value length "'+t.value.length+'", got "'+e.value.length+'"');s&&r&&(t.capture&&(r[t.capture]=e.value),t.captureAsn1&&(r[t.captureAsn1]=e))}else i&&i.push("["+t.name+'] Expected constructed "'+t.constructed+'", got "'+e.constructed+'"');return s};var o=/[^\\u0000-\\u00ff]/;n.prettyPrint=function(e,t,r){var i="";t=t||0,r=r||2,t>0&&(i+="\n");for(var s="",u=0;u<t*r;++u)s+=" ";switch(i+=s+"Tag: ",e.tagClass){case n.Class.UNIVERSAL:i+="Universal:";break;case n.Class.APPLICATION:i+="Application:";break;case n.Class.CONTEXT_SPECIFIC:i+="Context-Specific:";break;case n.Class.PRIVATE:i+="Private:"}if(e.tagClass===n.Class.UNIVERSAL)switch(i+=e.type,e.type){case n.Type.NONE:i+=" (None)";break;case n.Type.BOOLEAN:i+=" (Boolean)";break;case n.Type.BITSTRING:i+=" (Bit string)";break;case n.Type.INTEGER:i+=" (Integer)";break;case n.Type.OCTETSTRING:i+=" (Octet string)";break;case n.Type.NULL:i+=" (Null)";break;case n.Type.OID:i+=" (Object Identifier)";break;case n.Type.ODESC:i+=" (Object Descriptor)";break;case n.Type.EXTERNAL:i+=" (External or Instance of)";break;case n.Type.REAL:i+=" (Real)";break;case n.Type.ENUMERATED:i+=" (Enumerated)";break;case n.Type.EMBEDDED:i+=" (Embedded PDV)";break;case n.Type.UTF8:i+=" (UTF8)";break;case n.Type.ROID:i+=" (Relative Object Identifier)";break;case n.Type.SEQUENCE:i+=" (Sequence)";break;case n.Type.SET:i+=" (Set)";break;case n.Type.PRINTABLESTRING:i+=" (Printable String)";break;case n.Type.IA5String:i+=" (IA5String (ASCII))";break;case n.Type.UTCTIME:i+=" (UTC time)";break;case n.Type.GENERALIZEDTIME:i+=" (Generalized time)";break;case n.Type.BMPSTRING:i+=" (BMP String)"}else i+=e.type;if(i+="\n",i+=s+"Constructed: "+e.constructed+"\n",e.composed){for(var c=0,p="",u=0;u<e.value.length;++u)void 0!==e.value[u]&&(c+=1,p+=n.prettyPrint(e.value[u],t+1,r),u+1<e.value.length&&(p+=","));i+=s+"Sub values: "+c+p}else{if(i+=s+"Value: ",e.type===n.Type.OID){var l=n.derToOid(e.value);i+=l,a.pki&&a.pki.oids&&l in a.pki.oids&&(i+=" ("+a.pki.oids[l]+")")}if(e.type===n.Type.INTEGER)try{i+=n.derToInteger(e.value)}catch(t){i+="0x"+a.util.bytesToHex(e.value)}else i+=o.test(e.value)?"0x"+a.util.createBuffer(e.value,"utf8").toHex():0===e.value.length?"[null]":e.value}return i},e.exports=i},function(e,t,r){function a(e){if("object"!=typeof e)throw"yt.asn1: invalid input";this._asn=e}var n=r(40);a.prototype.getAsn1=function(){return this._asn},a.prototype.validate=function(e,t,r){return n._asn1.validate(this._asn,e,t,r)},a.prototype.toBytes=function(){return n._asn1.toDer(this._asn).getBytes()},a.prototype.toHex=function(){return n.util.bytesToHex(this.toBytes())},a.prototype.toBase64=function(){return n.util.encode64(this.toBytes())},a.fromRaw=function(e){return new a(e)},a.fromDer=function(e){var t=n._asn1.fromDer(e);return n.asn1.fromRaw(t)},a.fromBytes=a.fromDer,a.fromString=function(e){var t;return t=n.util.hexToBytes(e),n.asn1.fromDer(t)},n.asn1=a,e.exports=a},function(e,t,r){var a=r(40),n=a.util=a.util||{};n.setImmediate=function(e){setTimeout(e,0)},n.nextTick=n.setImmediate,n.isArray=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},n.isArrayBuffer=function(e){return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer};var i=[];"undefined"!=typeof Int8Array&&i.push(Int8Array),"undefined"!=typeof Uint8Array&&i.push(Uint8Array),"undefined"!=typeof Uint8ClampedArray&&i.push(Uint8ClampedArray),"undefined"!=typeof Int16Array&&i.push(Int16Array),"undefined"!=typeof Uint16Array&&i.push(Uint16Array),"undefined"!=typeof Int32Array&&i.push(Int32Array),"undefined"!=typeof Uint32Array&&i.push(Uint32Array),"undefined"!=typeof Float32Array&&i.push(Float32Array),"undefined"!=typeof Float64Array&&i.push(Float64Array),n.isArrayBufferView=function(e){for(var t=0;t<i.length;++t)if(e instanceof i[t])return!0;return!1},n.ByteBuffer=function(e){if(this.data="",this.read=0,"string"==typeof e)this.data=e;else if(n.isArrayBuffer(e)||n.isArrayBufferView(e)){var t=new Uint8Array(e);try{this.data=String.fromCharCode.apply(null,t)}catch(e){for(var r=0;r<t.length;++r)this.putByte(t[r])}}},n.ByteBuffer.prototype.length=function(){return this.data.length-this.read},n.ByteBuffer.prototype.isEmpty=function(){return this.length()<=0},n.ByteBuffer.prototype.putByte=function(e){return this.data+=String.fromCharCode(e),this},n.ByteBuffer.prototype.fillWithByte=function(e,t){e=String.fromCharCode(e);for(var r=this.data;t>0;)1&t&&(r+=e),t>>>=1,t>0&&(e+=e);return this.data=r,this},n.ByteBuffer.prototype.putBytes=function(e){return this.data+=e,this},n.ByteBuffer.prototype.putString=function(e){return this.data+=n.encodeUtf8(e),this},n.ByteBuffer.prototype.putInt16=function(e){return this.data+=String.fromCharCode(e>>8&255)+String.fromCharCode(255&e),this},n.ByteBuffer.prototype.putInt24=function(e){return this.data+=String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e),this},n.ByteBuffer.prototype.putInt32=function(e){return this.data+=String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e),this},n.ByteBuffer.prototype.putInt16Le=function(e){return this.data+=String.fromCharCode(255&e)+String.fromCharCode(e>>8&255),this},n.ByteBuffer.prototype.putInt24Le=function(e){return this.data+=String.fromCharCode(255&e)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255),this},n.ByteBuffer.prototype.putInt32Le=function(e){return this.data+=String.fromCharCode(255&e)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>24&255),this},n.ByteBuffer.prototype.putInt=function(e,t){do t-=8,this.data+=String.fromCharCode(e>>t&255);while(t>0);return this},n.ByteBuffer.prototype.putSignedInt=function(e,t){return e<0&&(e+=2<<t-1),this.putInt(e,t)},n.ByteBuffer.prototype.putBuffer=function(e){return this.data+=e.getBytes(),this},n.ByteBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)},n.ByteBuffer.prototype.getInt16=function(){var e=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,e},n.ByteBuffer.prototype.getInt24=function(){var e=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,e},n.ByteBuffer.prototype.getInt32=function(){var e=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,e},n.ByteBuffer.prototype.getInt16Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,e},n.ByteBuffer.prototype.getInt24Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,e},n.ByteBuffer.prototype.getInt32Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,e},n.ByteBuffer.prototype.getInt=function(e){var t=0;do t=(t<<8)+this.data.charCodeAt(this.read++),e-=8;while(e>0);return t},n.ByteBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),r=2<<e-2;return t>=r&&(t-=r<<1),t},n.ByteBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):0===e?t="":(t=0===this.read?this.data:this.data.slice(this.read),this.clear()),t},n.ByteBuffer.prototype.bytes=function(e){return"undefined"==typeof e?this.data.slice(this.read):this.data.slice(this.read,this.read+e)},n.ByteBuffer.prototype.at=function(e){return this.data.charCodeAt(this.read+e)},n.ByteBuffer.prototype.setAt=function(e,t){return this.data=this.data.substr(0,this.read+e)+String.fromCharCode(t)+this.data.substr(this.read+e+1),this},n.ByteBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)},n.ByteBuffer.prototype.copy=function(){var e=n.createBuffer(this.data);return e.read=this.read,e},n.ByteBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this},n.ByteBuffer.prototype.clear=function(){return this.data="",this.read=0,this},n.ByteBuffer.prototype.truncate=function(e){var t=Math.max(0,this.length()-e);return this.data=this.data.substr(this.read,t),this.read=0,this},n.ByteBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.length;++t){var r=this.data.charCodeAt(t);r<16&&(e+="0"),e+=r.toString(16)}return e},n.ByteBuffer.prototype.toString=function(){return n.decodeUtf8(this.bytes())},n.createBuffer=function(e,t){return t=t||"raw",void 0!==e&&"utf8"===t&&(e=n.encodeUtf8(e)),new n.ByteBuffer(e)},n.fillString=function(e,t){for(var r="";t>0;)1&t&&(r+=e),t>>>=1,t>0&&(e+=e);return r},n.xorBytes=function(e,t,r){for(var a="",n="",i="",s=0,o=0;r>0;--r,++s)n=e.charCodeAt(s)^t.charCodeAt(s),o>=10&&(a+=i,i="",o=0),i+=String.fromCharCode(n),++o;return a+=i},n.hexToBytes=function(e){var t="",r=0;for(e.length&!0&&(r=1,t+=String.fromCharCode(parseInt(e[0],16)));r<e.length;r+=2)t+=String.fromCharCode(parseInt(e.substr(r,2),16));return t},n.bytesToHex=function(e){return n.createBuffer(e).toHex()},n.int32ToBytes=function(e){return String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e)};var s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",o=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];n.encode64=function(e,t){for(var r,a,n,i="",o="",u=0;u<e.length;)r=e.charCodeAt(u++),a=e.charCodeAt(u++),n=e.charCodeAt(u++),i+=s.charAt(r>>2),i+=s.charAt((3&r)<<4|a>>4),isNaN(a)?i+="==":(i+=s.charAt((15&a)<<2|n>>6),i+=isNaN(n)?"=":s.charAt(63&n)),t&&i.length>t&&(o+=i.substr(0,t)+"\r\n",i=i.substr(t));return o+=i},n.decode64=function(e){e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var t,r,a,n,i="",s=0;s<e.length;)t=o[e.charCodeAt(s++)-43],r=o[e.charCodeAt(s++)-43],a=o[e.charCodeAt(s++)-43],n=o[e.charCodeAt(s++)-43],i+=String.fromCharCode(t<<2|r>>4),64!==a&&(i+=String.fromCharCode((15&r)<<4|a>>2),64!==n&&(i+=String.fromCharCode((3&a)<<6|n)));return i},n.encodeUtf8=function(e){return unescape(encodeURIComponent(e))},n.decodeUtf8=function(e){return decodeURIComponent(escape(e))},n.deflate=function(e,t,r){if(t=n.decode64(e.deflate(n.encode64(t)).rval),r){var a=2,i=t.charCodeAt(1);32&i&&(a=6),t=t.substring(a,t.length-4)}return t},n.inflate=function(e,t,r){var a=e.inflate(n.encode64(t)).rval;return null===a?null:n.decode64(a)};var u=function(e,t,r){if(!e)throw{message:"WebStorage not available."};var a;if(null===r?a=e.removeItem(t):(r=n.encode64(JSON.stringify(r)),a=e.setItem(t,r)),"undefined"!=typeof a&&a.rval!==!0)throw a.error},c=function(e,t){if(!e)throw{message:"WebStorage not available."};var r=e.getItem(t);if(e.init)if(null===r.rval){if(r.error)throw r.error;r=null}else r=r.rval;return null!==r&&(r=JSON.parse(n.decode64(r))),r},p=function(e,t,r,a){var n=c(e,t);null===n&&(n={}),n[r]=a,u(e,t,n)},l=function(e,t,r){var a=c(e,t);return null!==a&&(a=r in a?a[r]:null),a},f=function(e,t,r){var a=c(e,t);if(null!==a&&r in a){delete a[r];var n=!0;for(var i in a){n=!1;break}n&&(a=null),u(e,t,a)}},d=function(e,t){u(e,t,null)},h=function(e,t,r){var a=null;"undefined"==typeof r&&(r=["web","flash"]);var n,i=!1,s=null;for(var o in r){n=r[o];try{if("flash"===n||"both"===n){if(null===t[0])throw{message:"Flash local storage not available."};a=e.apply(this,t),i="flash"===n}"web"!==n&&"both"!==n||(t[0]=localStorage,a=e.apply(this,t),i=!0)}catch(e){s=e}if(i)break}if(!i)throw s;return a};n.setItem=function(e,t,r,a,n){h(p,arguments,n)},n.getItem=function(e,t,r,a){return h(l,arguments,a)},n.removeItem=function(e,t,r,a){h(f,arguments,a)},n.clearItems=function(e,t,r){h(d,arguments,r)},n.parseUrl=function(e){var t=/^(https?):\/\/([^:&^\/]*):?(\d*)(.*)$/g;t.lastIndex=0;var r=t.exec(e),a=null===r?null:{full:e,scheme:r[1],host:r[2],port:r[3],path:r[4]};return a&&(a.fullHost=a.host,a.port?80!==a.port&&"http"===a.scheme?a.fullHost+=":"+a.port:443!==a.port&&"https"===a.scheme&&(a.fullHost+=":"+a.port):"http"===a.scheme?a.port=80:"https"===a.scheme&&(a.port=443),a.full=a.scheme+"://"+a.fullHost),a};var y=null;n.getQueryVariables=function(e){var t,r=function(e){for(var t={},r=e.split("&"),a=0;a<r.length;a++){var n,i,s=r[a].indexOf("=");s>0?(n=r[a].substring(0,s),i=r[a].substring(s+1)):(n=r[a],i=null),n in t||(t[n]=[]),n in Object.prototype||null===i||t[n].push(unescape(i))}return t};return"undefined"==typeof e?(null===y&&(y="undefined"==typeof window?{}:r(window.location.search.substring(1))),t=y):t=r(e),t},n.parseFragment=function(e){var t=e,r="",a=e.indexOf("?");a>0&&(t=e.substring(0,a),r=e.substring(a+1));var i=t.split("/");i.length>0&&""===i[0]&&i.shift();var s=""===r?{}:n.getQueryVariables(r);return{pathString:t,queryString:r,path:i,query:s}},n.makeRequest=function(e){var t=n.parseFragment(e),r={path:t.pathString,query:t.queryString,getPath:function(e){return"undefined"==typeof e?t.path:t.path[e]},getQuery:function(e,r){var a;return"undefined"==typeof e?a=t.query:(a=t.query[e],a&&"undefined"!=typeof r&&(a=a[r])),a},getQueryLast:function(e,t){var a,n=r.getQuery(e);return a=n?n[n.length-1]:t}};return r},n.makeLink=function(e,t,r){e=jQuery.isArray(e)?e.join("/"):e;var a=jQuery.param(t||{});return r=r||"",e+(a.length>0?"?"+a:"")+(r.length>0?"#"+r:"")},n.setPath=function(e,t,r){if("object"==typeof e&&null!==e)for(var a=0,n=t.length;a<n;){var i=t[a++];if(a==n)e[i]=r;else{var s=i in e;(!s||s&&"object"!=typeof e[i]||s&&null===e[i])&&(e[i]={}),e=e[i]}}},n.getPath=function(e,t,r){for(var a=0,n=t.length,i=!0;i&&a<n&&"object"==typeof e&&null!==e;){var s=t[a++];i=s in e,i&&(e=e[s])}return i?e:r},n.deletePath=function(e,t){if("object"==typeof e&&null!==e)for(var r=0,a=t.length;r<a;){var n=t[r++];if(r==a)delete e[n];else{if(!(n in e)||"object"!=typeof e[n]||null===e[n])break;e=e[n]}}},n.isEmpty=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},n.format=function(e){for(var t,r,a=/%./g,n=0,i=[],s=0;t=a.exec(e);){r=e.substring(s,a.lastIndex-2),r.length>0&&i.push(r),s=a.lastIndex;var o=t[0][1];switch(o){case"s":case"o":n<arguments.length?i.push(arguments[n++ +1]):i.push("<?>");break;case"%":i.push("%");break;default:i.push("<%"+o+"?>")}}return i.push(e.substring(s)),i.join("")},n.formatNumber=function(e,t,r,a){var n=e,i=isNaN(t=Math.abs(t))?2:t,s=void 0===r?",":r,o=void 0===a?".":a,u=n<0?"-":"",c=parseInt(n=Math.abs(+n||0).toFixed(i),10)+"",p=c.length>3?c.length%3:0;return u+(p?c.substr(0,p)+o:"")+c.substr(p).replace(/(\d{3})(?=\d)/g,"$1"+o)+(i?s+Math.abs(n-c).toFixed(i).slice(2):"")},n.formatSize=function(e){return e=e>=1073741824?n.formatNumber(e/1073741824,2,".","")+" GiB":e>=1048576?n.formatNumber(e/1048576,2,".","")+" MiB":e>=1024?n.formatNumber(e/1024,0)+" KiB":n.formatNumber(e,0)+" bytes"},n.bytesFromIP=function(e){return e.indexOf(".")!==-1?n.bytesFromIPv4(e):e.indexOf(":")!==-1?n.bytesFromIPv6(e):null},n.bytesFromIPv4=function(e){if(e=e.split("."),4!==e.length)return null;for(var t=n.createBuffer(),r=0;r<e.length;++r){var a=parseInt(e[r],10);if(isNaN(a))return null;t.putByte(a)}return t.getBytes()},n.bytesFromIPv6=function(e){var t=0;e=e.split(":").filter(function(e){return 0===e.length&&++t,!0});for(var r=2*(8-e.length+t),a=n.createBuffer(),i=0;i<8;++i)if(e[i]&&0!==e[i].length){var s=n.hexToBytes(e[i]);s.length<2&&a.putByte(0),a.putBytes(s)}else a.fillWithByte(0,r),r=0;return a.getBytes()},n.bytesToIP=function(e){return 4===e.length?n.bytesToIPv4(e):16===e.length?n.bytesToIPv6(e):null},n.bytesToIPv4=function(e){if(4!==e.length)return null;for(var t=[],r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t.join(".")},n.bytesToIPv6=function(e){if(16!==e.length)return null;for(var t=[],r=[],a=0,i=0;i<e.length;i+=2){for(var s=n.bytesToHex(e[i]+e[i+1]);"0"===s[0]&&"0"!==s;)s=s.substr(1);if("0"===s){var o=r[r.length-1],u=t.length;o&&u===o.end+1?(o.end=u,o.end-o.start>r[a].end-r[a].start&&(a=r.length-1)):r.push({start:u,end:u})}t.push(s)}if(r.length>0){var c=r[a];c.end-c.start>0&&(t.splice(c.start,c.end-c.start+1,""),0===c.start&&t.unshift(""),7===c.end&&t.push(""))}return t.join(":")},n.estimateCores=function(e,t){function r(e,o,u){if(0===o){var c=Math.floor(e.reduce(function(e,t){return e+t},0)/e.length);return n.cores=Math.max(1,c),URL.revokeObjectURL(s),t(null,n.cores)}a(u,function(t,a){e.push(i(u,a)),r(e,o-1,u)})}function a(e,t){for(var r=[],a=[],n=0;n<e;++n){var i=new Worker(s);i.addEventListener("message",function(n){if(a.push(n.data),
a.length===e){for(var i=0;i<e;++i)r[i].terminate();t(null,a)}}),r.push(i)}for(var n=0;n<e;++n)r[n].postMessage(n)}function i(e,t){for(var r=[],a=0;a<e;++a)for(var n=t[a],i=r[a]=[],s=0;s<e;++s)if(a!==s){var o=t[s];(n.st>o.st&&n.st<o.et||o.st>n.st&&o.st<n.et)&&i.push(s)}return r.reduce(function(e,t){return Math.max(e,t.length)},0)}if("function"==typeof e&&(t=e,e={}),e=e||{},"cores"in n&&!e.update)return t(null,n.cores);if(void 0===typeof Worker)return n.cores=1,t(null,n.cores);if(void 0===typeof Blob)return n.cores=2,t(null,n.cores);var s=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(e){for(var t=Date.now(),r=t+4;Date.now()<r;);self.postMessage({st:t,et:r})})}.toString(),")()"],{type:"application/javascript"}));r([],5,16)},e.exports=n},function(e,t,r){function a(e){var t=[];return e.attributes.forEach(function(e){var r=t[e.rdnIndex];"undefined"==typeof r?t[e.rdnIndex]=e.shortName+"="+e.value:t[e.rdnIndex]=r+"+"+e.shortName+"="+e.value}),t.reverse().join(",")}var n,i,s,o=r(40),u=r(46);n=o._asn1,o.pki||(o.pki={}),i=o.pki,u=o.oids,void 0==o.kisa&&(o.kisa={});var s=o.kisa;void 0==o.yessign&&(o.yessign={});var c=o.yessign;n.dateToGeneralizedTime=function(e){var t="",r=[];r.push(""+e.getUTCFullYear()),r.push(""+(e.getUTCMonth()+1)),r.push(""+e.getUTCDate()),r.push(""+e.getUTCHours()),r.push(""+e.getUTCMinutes()),r.push(""+e.getUTCSeconds());for(var a=0;a<r.length;++a)r[a].length<2&&(t+="0"),t+=r[a];return t+="Z"},i.GeneralName={},i.GeneralName.toAsn1=function(e){var t,r=!1;if("rfc822Name"in e)contextID=1,t=e.rfc822Name;else{if(!("directoryName"in e))throw"not supported generalname";contextID=4,r=!0,t=[i.distinguishedNameToAsn1(e.directoryName)]}return n.create(n.Class.CONTEXT_SPECIFIC,contextID,r,t)},i.DNToString=a,i.GeneralName.toObject=function(e){var t={};switch(e.type){case 0:t.type="otherName",t.oid=o._asn1.derToOid(e.value[0].value),t.value=e.value[1];break;case 1:t.type="rfc822Name",t.value=e.value;break;case 2:t.type="dNSName",t.value=e.value;break;case 3:t.type="x400Address",t.value=e.value;break;case 4:t.type="directoryName";var r=ytcrypto.md.sha1.create(),n=i.RDNAttributesAsArray(e.value[0],r);t.value=a({attributes:n});break;case 5:t.type="ediPartyName",t.value=e.value;break;case 6:t.type="uniformResourceIdentifier",t.value=e.value;break;case 7:t.type="iPAddress",t.value=[];for(var s=0;s<e.value.length;++s)t.value.push(e.value.charCodeAt(s));t.value=t.value.join(".");break;case 8:t.type="registeredID";break;default:throw"bad general name"}return t.asn=e.value,t},i.AlgorithmIdentifier={},i.AlgorithmIdentifier.toAsn1=function(e){var t,r;if(0==e.hasOwnProperty("algorithm"))throw"AlgorithmIdentifier.algorithm does not defined as OID";return t=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(e.algorithm).getBytes())]),"parameters"in e&&(r=e.parameters,null==r&&(r=n.create(n.Class.UNIVERSAL,n.Type.NULL,!1,"")),t.value.push(r)),t},i.AlgorithmIdentifier.toObject=function(e){var t,r={};return t=n.derToOid(e.value[0].value),r.algorithm=t,r},i.Validity={},i.Validity.toAsn1=function(e){return n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.UTCTIME,!1,n.dateToUtcTime(e.notBefore)),n.create(n.Class.UNIVERSAL,n.Type.UTCTIME,!1,n.dateToUtcTime(e.notAfter))])};var p={};p.oid="1.2.410.200004.10.1.1.2",p.toAsn1=function(e){var t,r;return t=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[]),r=n.create(n.Class.CONTEXT_SPECIFIC,0,!0,[n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,n.integerToDer(e.version).getBytes())]),t.value.push(r),"vidHashAlg"in e&&(r=n.create(n.Class.CONTEXT_SPECIFIC,1,!0,[i.AlgorithmIdentifier.toAsn1(e.vidEncAlg)]),t.value.push(r)),r=n.create(n.Class.CONTEXT_SPECIFIC,2,!0,[i.AlgorithmIdentifier.toAsn1(e.vidEncAlg)]),t.value.push(r),r=n.create(n.Class.CONTEXT_SPECIFIC,3,!0,[i.IssuerAndSerialNumber.toAsn1(e.certID)]),t.value.push(r),r=n.create(n.Class.CONTEXT_SPECIFIC,4,!0,[n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,e.encryptedVID)]),t.value.push(r),t},i.IssuerAndSerialNumber={},i.IssuerAndSerialNumber.toAsn1=function(e){var t,r;return t=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[]),t.value.push(i.distinguishedNameToAsn1(e.issuer)),r=o.util.hexToBytes(e.serialNumber),t.value.push(n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,r)),t};var l={};l.toAsn1=function(e){return n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.PRINTABLESTRING,!1,e.idn),n.create(n.Class.UNIVERSAL,n.Type.BITSTRING,!1,String.fromCharCode(0)+e.randomNum)])};var f={};f.toAsn1=function(e){return n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[d.toAsn1(e.vid),n.create(n.Class.UNIVERSAL,n.Type.BITSTRING,!1,String.fromCharCode(0)+e.randomNum)])};var d={};d.toAsn1=function(e){return n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[i.AlgorithmIdentifier.toAsn1(e.hashAlg),n.create(n.Class.CONTEXT_SPECIFIC,0,!0,[n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,e.virtualID)])])},d.toObject=function(e){var t={};return t.hashAlg=o.oids[o._asn1.derToOid(e.value[0].value[0].value)],t.virtualID=e.value[1].value[0].value,t};var h={};h.toObject=function(e){var t={};return t.realName=o.util.decodeUTF8(e.value[0].value),e.value.length>1&&e.value[1].value.forEach(function(e){var r=e.value[0],a=e.value[1];if(o._asn1.derToOid(r.value)==u.vid){var n={};n=d.toObject(a),t.vid=n}}),t},s.HashContent=l,s.EncryptedVID=p,s.EncryptContent=f,s.IdentifyData=h,c.VIDCertificate={},c.VIDCertificate.oid="1.2.410.200005.1.10.1";var y={};y.toAsn1=function(e,t){function r(e){return(128&e)>>7|(64&e)>>5|(32&e)>>3|(16&e)>>1|(8&e)<<1|(4&e)<<3|(2&e)<<5|(1&e)<<7}var a,i=0,s=ytcrypto.jsbn.BigInteger.ZERO;e.userAgree.realName&&(s=s.setBit(0)),e.userAgree.gender&&(s=s.setBit(1)),e.userAgree.nationalInfo&&(s=s.setBit(2)),e.userAgree.birthDate&&(s=s.setBit(3)),parseInt(t)>=2&&e.userAgree.ci&&(s=s.setBit(4));var i=8-s.bitLength()%8,o=[],u=s.toByteArray();return u.forEach(function(e){o.unshift(r(e))}),o.unshift(i),o=o.map(function(e){return String.fromCharCode(e)}),o=o.join(""),a=e.userAgreement,n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.UTF8,!1,a),n.create(n.Class.UNIVERSAL,n.Type.BITSTRING,!1,o)])},s.PersonInfoReq=y;var g={};g.toAsn1=function(e){var t=[n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,n.integerToDer(e.major).bytes()),n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,n.integerToDer(e.minor).bytes())];if(e.build){var r=n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,n.integerToDer(e.build).bytes());t.push(n.create(n.Class.CONTEXT_SPECIFIC,0,!0,[r]))}if(e.revision){var r=n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,n.integerToDer(e.revision).bytes());t.push(n.create(n.Class.CONTEXT_SPECIFIC,1,!0,[r]))}return n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,t)};var C={};C.toAsn1=function(e){if("undefined"==typeof e)throw"invalid input - no ModuleInfo";if(!e.hasOwnProperty("moduleName"))throw"no moduleName field";if(!e.hasOwnProperty("moduleVendorName"))throw"no moduleVendorName field";return n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.UTF8,!1,e.moduleName),n.create(n.Class.UNIVERSAL,n.Type.UTF8,!1,e.moduleVendorName),g.toAsn1(e.moduleVersion)])};var v={};v.toAsn1=function(e){var t,r,a,i,s,o;t=n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,n.integerToDer(e.version)),r=n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,e.nonce),a=e.personInfoReq.toAsn1(e.version).getAsn1(),i=C.toAsn1(e.moduleInfo),s=n.create(n.Class.UNIVERSAL,n.Type.UTF8,!1,e.ispURLInfo);var u=[t,r,a,i,s];return"undefined"!=typeof o&&u.push(o),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,u)},s.UCPIDRequestInfo=v,u["1.2.410.200004.10.1.1"]="identifyData",u.identifyData="1.2.410.200004.10.1.1",u["1.2.410.200004.1.15"]="seedCBCWithSHA1",u.seedCBCWithSHA1="1.2.410.200004.1.15",u["1.2.410.200004.1.4"]="seedCBC",u.seedCBC="1.2.410.200004.1.4",u.vid="1.2.410.200004.10.1.1.1",u["1.2.410.200004.10.1.1.1"]="vid",u.randomNum="1.2.410.200004.10.1.1.3",u["1.2.410.200004.10.1.1.3"]="randomNum",u["1.3.6.1.5.5.7.5.1.5"]="oldCertId",u.oldCertId="1.3.6.1.5.5.7.5.1.5",u["1.2.410.100001.1.18"]="aria128",u.aria128="1.2.410.100001.1.18",u["1.2.410.100001.1.19"]="aria128-ECB",u["aria128-ECB"]="1.2.410.100001.1.19",u["1.2.410.100001.1.20"]="aria128-CBC",u["aria128-CBC"]="1.2.410.100001.1.20",u.kcdsa="1.2.410.200004.1.21",u["1.2.410.200004.1.21"]="kcdsa",e.exports=i},function(e,t,r){var a=r(40);a.pki=a.pki||{};var n=a.pki.oids=a.oids=a.oids||{};n["0.9.2342.19200300.100.1.25"]="domainComponent",n.domainComponent="0.9.2342.19200300.100.1.25",n["1.2.840.113549.1.1.1"]="rsaEncryption",n.rsaEncryption="1.2.840.113549.1.1.1",n["1.2.840.113549.1.1.4"]="md5WithRSAEncryption",n.md5WithRSAEncryption="1.2.840.113549.1.1.4",n["1.2.840.113549.1.1.5"]="sha1WithRSAEncryption",n.sha1WithRSAEncryption="1.2.840.113549.1.1.5",n["1.2.840.113549.1.1.7"]="RSAES-OAEP",n["RSAES-OAEP"]="1.2.840.113549.1.1.7",n["1.2.840.113549.1.1.8"]="mgf1",n.mgf1="1.2.840.113549.1.1.8",n["1.2.840.113549.1.1.9"]="pSpecified",n.pSpecified="1.2.840.113549.1.1.9",n["1.2.840.113549.1.1.10"]="RSASSA-PSS",n["RSASSA-PSS"]="1.2.840.113549.1.1.10",n["1.2.840.113549.1.1.11"]="sha256WithRSAEncryption",n.sha256WithRSAEncryption="1.2.840.113549.1.1.11",n["1.2.840.113549.1.1.12"]="sha384WithRSAEncryption",n.sha384WithRSAEncryption="1.2.840.113549.1.1.12",n["1.2.840.113549.1.1.13"]="sha512WithRSAEncryption",n.sha512WithRSAEncryption="1.2.840.113549.1.1.13",n.ecdsa="1.2.840.10045.2.1",n["1.2.840.10045.2.1"]="ecdsa",n.secp256r1="1.2.840.10045.3.1.7",n["1.2.840.10045.3.1.7"]="secp256r1",n["1.3.14.3.2.7"]="desCBC",n.desCBC="1.3.14.3.2.7",n["1.3.14.3.2.26"]="sha1",n.sha1="1.3.14.3.2.26",n["2.16.840.1.101.3.4.2.1"]="sha256",n.sha256="2.16.840.1.101.3.4.2.1",n["2.16.840.1.101.3.4.2.2"]="sha384",n.sha384="2.16.840.1.101.3.4.2.2",n["2.16.840.1.101.3.4.2.3"]="sha512",n.sha512="2.16.840.1.101.3.4.2.3",n["1.2.840.113549.2.5"]="md5",n.md5="1.2.840.113549.2.5",n["1.2.840.113549.1.7.1"]="data",n.data="1.2.840.113549.1.7.1",n["1.2.840.113549.1.7.2"]="signedData",n.signedData="1.2.840.113549.1.7.2",n["1.2.840.113549.1.7.3"]="envelopedData",n.envelopedData="1.2.840.113549.1.7.3",n["1.2.840.113549.1.7.4"]="signedAndEnvelopedData",n.signedAndEnvelopedData="1.2.840.113549.1.7.4",n["1.2.840.113549.1.7.5"]="digestedData",n.digestedData="1.2.840.113549.1.7.5",n["1.2.840.113549.1.7.6"]="encryptedData",n.encryptedData="1.2.840.113549.1.7.6",n["1.2.840.113549.1.9.1"]="emailAddress",n.emailAddress="1.2.840.113549.1.9.1",n["1.2.840.113549.1.9.2"]="unstructuredName",n.unstructuredName="1.2.840.113549.1.9.2",n["1.2.840.113549.1.9.3"]="contentType",n.contentType="1.2.840.113549.1.9.3",n["1.2.840.113549.1.9.4"]="messageDigest",n.messageDigest="1.2.840.113549.1.9.4",n["1.2.840.113549.1.9.5"]="signingTime",n.signingTime="1.2.840.113549.1.9.5",n["1.2.840.113549.1.9.6"]="counterSignature",n.counterSignature="1.2.840.113549.1.9.6",n["1.2.840.113549.1.9.7"]="challengePassword",n.challengePassword="1.2.840.113549.1.9.7",n["1.2.840.113549.1.9.8"]="unstructuredAddress",n.unstructuredAddress="1.2.840.113549.1.9.8",n["1.2.840.113549.1.9.20"]="friendlyName",n.friendlyName="1.2.840.113549.1.9.20",n["1.2.840.113549.1.9.21"]="localKeyId",n.localKeyId="1.2.840.113549.1.9.21",n["1.2.840.113549.1.9.22.1"]="x509Certificate",n.x509Certificate="1.2.840.113549.1.9.22.1",n["1.2.840.113549.1.9.52"]="CMSAlgorithmProtection",n.CMSAlgorithmProtection="1.2.840.113549.1.9.52",n["1.2.840.113549.1.12.10.1.1"]="keyBag",n.keyBag="1.2.840.113549.1.12.10.1.1",n["1.2.840.113549.1.12.10.1.2"]="pkcs8ShroudedKeyBag",n.pkcs8ShroudedKeyBag="1.2.840.113549.1.12.10.1.2",n["1.2.840.113549.1.12.10.1.3"]="certBag",n.certBag="1.2.840.113549.1.12.10.1.3",n["1.2.840.113549.1.12.10.1.4"]="crlBag",n.crlBag="1.2.840.113549.1.12.10.1.4",n["1.2.840.113549.1.12.10.1.5"]="secretBag",n.secretBag="1.2.840.113549.1.12.10.1.5",n["1.2.840.113549.1.12.10.1.6"]="safeContentsBag",n.safeContentsBag="1.2.840.113549.1.12.10.1.6",n["1.2.840.113549.1.5.13"]="pkcs5PBES2",n.pkcs5PBES2="1.2.840.113549.1.5.13",n["1.2.840.113549.1.5.12"]="pkcs5PBKDF2",n.pkcs5PBKDF2="1.2.840.113549.1.5.12",n["1.2.840.113549.1.12.1.1"]="pbeWithSHAAnd128BitRC4",n.pbeWithSHAAnd128BitRC4="1.2.840.113549.1.12.1.1",n["1.2.840.113549.1.12.1.2"]="pbeWithSHAAnd40BitRC4",n.pbeWithSHAAnd40BitRC4="1.2.840.113549.1.12.1.2",n["1.2.840.113549.1.12.1.3"]="pbeWithSHAAnd3-KeyTripleDES-CBC",n["pbeWithSHAAnd3-KeyTripleDES-CBC"]="1.2.840.113549.1.12.1.3",n["1.2.840.113549.1.12.1.4"]="pbeWithSHAAnd2-KeyTripleDES-CBC",n["pbeWithSHAAnd2-KeyTripleDES-CBC"]="1.2.840.113549.1.12.1.4",n["1.2.840.113549.1.12.1.5"]="pbeWithSHAAnd128BitRC2-CBC",n["pbeWithSHAAnd128BitRC2-CBC"]="1.2.840.113549.1.12.1.5",n["1.2.840.113549.1.12.1.6"]="pbewithSHAAnd40BitRC2-CBC",n["pbewithSHAAnd40BitRC2-CBC"]="1.2.840.113549.1.12.1.6",n["1.2.840.113549.3.7"]="des-EDE3-CBC",n["des-EDE3-CBC"]="1.2.840.113549.3.7",n["2.16.840.1.101.3.4.1.2"]="aes128-CBC",n["aes128-CBC"]="2.16.840.1.101.3.4.1.2",n["2.16.840.1.101.3.4.1.22"]="aes192-CBC",n["aes192-CBC"]="2.16.840.1.101.3.4.1.22",n["2.16.840.1.101.3.4.1.42"]="aes256-CBC",n["aes256-CBC"]="2.16.840.1.101.3.4.1.42",n["2.5.4.3"]="commonName",n.commonName="2.5.4.3",n["2.5.4.5"]="serialName",n.serialName="2.5.4.5",n["2.5.4.6"]="countryName",n.countryName="2.5.4.6",n["2.5.4.7"]="localityName",n.localityName="2.5.4.7",n["2.5.4.8"]="stateOrProvinceName",n.stateOrProvinceName="2.5.4.8",n["2.5.4.10"]="organizationName",n.organizationName="2.5.4.10",n["2.5.4.11"]="organizationalUnitName",n.organizationalUnitName="2.5.4.11",n["2.5.4.46"]="dnQualifier",n.dnQualifier="2.5.4.46",n["2.16.840.1.113730.1.1"]="nsCertType",n.nsCertType="2.16.840.1.113730.1.1",n["2.5.29.1"]="authorityKeyIdentifier",n["2.5.29.2"]="keyAttributes",n["2.5.29.3"]="certificatePolicies",n["2.5.29.4"]="keyUsageRestriction",n["2.5.29.5"]="policyMapping",n["2.5.29.6"]="subtreesConstraint",n["2.5.29.7"]="subjectAltName",n["2.5.29.8"]="issuerAltName",n["2.5.29.9"]="subjectDirectoryAttributes",n["2.5.29.10"]="basicConstraints",n["2.5.29.11"]="nameConstraints",n["2.5.29.12"]="policyConstraints",n["2.5.29.13"]="basicConstraints",n["2.5.29.14"]="subjectKeyIdentifier",n.subjectKeyIdentifier="2.5.29.14",n["2.5.29.15"]="keyUsage",n.keyUsage="2.5.29.15",n["2.5.29.16"]="privateKeyUsagePeriod",n["2.5.29.17"]="subjectAltName",n.subjectAltName="2.5.29.17",n["2.5.29.18"]="issuerAltName",n.issuerAltName="2.5.29.18",n["2.5.29.19"]="basicConstraints",n.basicConstraints="2.5.29.19",n["2.5.29.20"]="cRLNumber",n["2.5.29.21"]="cRLReason",n["2.5.29.22"]="expirationDate",n["2.5.29.23"]="instructionCode",n["2.5.29.24"]="invalidityDate",n["2.5.29.25"]="cRLDistributionPoints",n["2.5.29.26"]="issuingDistributionPoint",n["2.5.29.27"]="deltaCRLIndicator",n["2.5.29.28"]="issuingDistributionPoint",n["2.5.29.29"]="certificateIssuer",n["2.5.29.30"]="nameConstraints",n["2.5.29.31"]="cRLDistributionPoints",n["2.5.29.32"]="certificatePolicies",n["2.5.29.33"]="policyMappings",n["2.5.29.34"]="policyConstraints",n["2.5.29.35"]="authorityKeyIdentifier",n["2.5.29.36"]="policyConstraints",n["2.5.29.37"]="extKeyUsage",n.extKeyUsage="2.5.29.37",n["2.5.29.46"]="freshestCRL",n["2.5.29.54"]="inhibitAnyPolicy",n["1.3.6.1.5.5.7.3.1"]="serverAuth",n.serverAuth="1.3.6.1.5.5.7.3.1",n["1.3.6.1.5.5.7.3.2"]="clientAuth",n.clientAuth="1.3.6.1.5.5.7.3.2",n["1.3.6.1.5.5.7.3.3"]="codeSigning",n.codeSigning="1.3.6.1.5.5.7.3.3",n["1.3.6.1.5.5.7.3.4"]="emailProtection",n.emailProtection="1.3.6.1.5.5.7.3.4",n["1.3.6.1.5.5.7.3.8"]="timeStamping",n.timeStamping="1.3.6.1.5.5.7.3.8",e.exports=n},function(e,t,r){function a(e){for(var t=e.name+": ",r=[],a=0;a<e.values.length;++a)r.push(e.values[a].replace(/^(\S+\r\n)/,function(e,t){return" "+t}));t+=r.join(",")+"\r\n";for(var n=0,i=-1,a=0;a<t.length;++a,++n)if(n>65&&i!==-1){var s=t[i];","===s?(++i,t=t.substr(0,i)+"\r\n "+t.substr(i)):t=t.substr(0,i)+"\r\n"+s+t.substr(i+1),n=a-i-1,i=-1,++a}else" "!==t[a]&&"\t"!==t[a]&&","!==t[a]||(i=a);return t}function n(e){return e.replace(/^\s+/,"")}var i=r(40),s={};s.encode=function(e,t){t=t||{};var r,n="-----BEGIN "+e.type+"-----\r\n";if(e.procType&&(r={name:"Proc-Type",values:[String(e.procType.version),e.procType.type]},n+=a(r)),e.contentDomain&&(r={name:"Content-Domain",values:[e.contentDomain]},n+=a(r)),e.dekInfo&&(r={name:"DEK-Info",values:[e.dekInfo.algorithm]},e.dekInfo.parameters&&r.values.push(e.dekInfo.parameters),n+=a(r)),e.headers)for(var s=0;s<e.headers.length;++s)n+=a(e.headers[s]);return e.procType&&(n+="\r\n"),n+=i.util.encode64(e.body,t.maxline||64)+"\r\n",n+="-----END "+e.type+"-----\r\n"},s.decode=function(e){for(var t,r=[],a=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,s=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,o=/\r?\n/;;){if(t=a.exec(e),!t)break;var u={type:t[1],procType:null,contentDomain:null,dekInfo:null,headers:[],body:i.util.decode64(t[3])};if(r.push(u),t[2]){for(var c=t[2].split(o),p=0;t&&p<c.length;){for(var l=c[p].replace(/\s+$/,""),f=p+1;f<c.length;++f){var d=c[f];if(!/\s/.test(d[0]))break;l+=d,p=f}if(t=l.match(s)){for(var h={name:t[1],values:[]},y=t[2].split(","),g=0;g<y.length;++g)h.values.push(n(y[g]));if(u.procType)if(u.contentDomain||"Content-Domain"!==h.name)if(u.dekInfo||"DEK-Info"!==h.name)u.headers.push(h);else{if(0===h.values.length)throw{message:'Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.'};u.dekInfo={algorithm:y[0],parameters:y[1]||null}}else u.contentDomain=y[0]||"";else{if("Proc-Type"!==h.name)throw{message:'Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".'};if(2!==h.values.length)throw{message:'Invalid PEM formatted message. The "Proc-Type" header must have two subfields.'};u.procType={version:y[0],type:y[1]}}}++p}if("ENCRYPTED"===u.procType&&!u.dekInfo)throw{message:'Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".'}}}if(0===r.length)throw{message:"Invalid PEM formatted message."};return r},i.pem=s,e.exports=s},function(e,t,r){var a=r(40),n=a.util||{};n.tableKSC5601=[12288,12289,12290,183,8229,8230,168,12291,173,8213,8741,65340,8764,8216,8217,8220,8221,12308,12309,12296,12297,12298,12299,12300,12301,12302,12303,12304,12305,177,215,247,8800,8804,8805,8734,8756,176,8242,8243,8451,8491,65504,65505,65509,9794,9792,8736,8869,8978,8706,8711,8801,8786,167,8251,9734,9733,9675,9679,9678,9671,9670,9633,9632,9651,9650,9661,9660,8594,8592,8593,8595,8596,12307,8810,8811,8730,8765,8733,8757,8747,8748,8712,8715,8838,8839,8834,8835,8746,8745,8743,8744,65506,8658,8660,8704,8707,180,65374,711,728,733,730,729,184,731,161,191,720,8750,8721,8719,164,8457,8240,9665,9664,9655,9654,9828,9824,9825,9829,9831,9827,8857,9672,9635,9680,9681,9618,9636,9637,9640,9639,9638,9641,9832,9743,9742,9756,9758,182,8224,8225,8597,8599,8601,8598,8600,9837,9833,9834,9836,12927,12828,8470,13255,8482,13250,13272,8481,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,65281,65282,65283,65284,65285,65286,65287,65288,65289,65290,65291,65292,65293,65294,65295,65296,65297,65298,65299,65300,65301,65302,65303,65304,65305,65306,65307,65308,65309,65310,65311,65312,65313,65314,65315,65316,65317,65318,65319,65320,65321,65322,65323,65324,65325,65326,65327,65328,65329,65330,65331,65332,65333,65334,65335,65336,65337,65338,65339,65510,65341,65342,65343,65344,65345,65346,65347,65348,65349,65350,65351,65352,65353,65354,65355,65356,65357,65358,65359,65360,65361,65362,65363,65364,65365,65366,65367,65368,65369,65370,65371,65372,65373,65507,12593,12594,12595,12596,12597,12598,12599,12600,12601,12602,12603,12604,12605,12606,12607,12608,12609,12610,12611,12612,12613,12614,12615,12616,12617,12618,12619,12620,12621,12622,12623,12624,12625,12626,12627,12628,12629,12630,12631,12632,12633,12634,12635,12636,12637,12638,12639,12640,12641,12642,12643,12644,12645,12646,12647,12648,12649,12650,12651,12652,12653,12654,12655,12656,12657,12658,12659,12660,12661,12662,12663,12664,12665,12666,12667,12668,12669,12670,12671,12672,12673,12674,12675,12676,12677,12678,12679,12680,12681,12682,12683,12684,12685,12686,8560,8561,8562,8563,8564,8565,8566,8567,8568,8569,-1,-1,-1,-1,-1,8544,8545,8546,8547,8548,8549,8550,8551,8552,8553,-1,-1,-1,-1,-1,-1,-1,913,914,915,916,917,918,919,920,921,922,923,924,925,926,927,928,929,931,932,933,934,935,936,937,-1,-1,-1,-1,-1,-1,-1,-1,945,946,947,948,949,950,951,952,953,954,955,956,957,958,959,960,961,963,964,965,966,967,968,969,-1,-1,-1,-1,-1,-1,9472,9474,9484,9488,9496,9492,9500,9516,9508,9524,9532,9473,9475,9487,9491,9499,9495,9507,9523,9515,9531,9547,9504,9519,9512,9527,9535,9501,9520,9509,9528,9538,9490,9489,9498,9497,9494,9493,9486,9485,9502,9503,9505,9506,9510,9511,9513,9514,9517,9518,9521,9522,9525,9526,9529,9530,9533,9534,9536,9537,9539,9540,9541,9542,9543,9544,9545,9546,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,13205,13206,13207,8467,13208,13252,13219,13220,13221,13222,13209,13210,13211,13212,13213,13214,13215,13216,13217,13218,13258,13197,13198,13199,13263,13192,13193,13256,13223,13224,13232,13233,13234,13235,13236,13237,13238,13239,13240,13241,13184,13185,13186,13187,13188,13242,13243,13244,13245,13246,13247,13200,13201,13202,13203,13204,8486,13248,13249,13194,13195,13196,13270,13253,13229,13230,13231,13275,13225,13226,13227,13228,13277,13264,13267,13251,13257,13276,13254,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,198,208,170,294,-1,306,-1,319,321,216,338,186,222,358,330,-1,12896,12897,12898,12899,12900,12901,12902,12903,12904,12905,12906,12907,12908,12909,12910,12911,12912,12913,12914,12915,12916,12917,12918,12919,12920,12921,12922,12923,9424,9425,9426,9427,9428,9429,9430,9431,9432,9433,9434,9435,9436,9437,9438,9439,9440,9441,9442,9443,9444,9445,9446,9447,9448,9449,9312,9313,9314,9315,9316,9317,9318,9319,9320,9321,9322,9323,9324,9325,9326,189,8531,8532,188,190,8539,8540,8541,8542,230,273,240,295,305,307,312,320,322,248,339,223,254,359,331,329,12800,12801,12802,12803,12804,12805,12806,12807,12808,12809,12810,12811,12812,12813,12814,12815,12816,12817,12818,12819,12820,12821,12822,12823,12824,12825,12826,12827,9372,9373,9374,9375,9376,9377,9378,9379,9380,9381,9382,9383,9384,9385,9386,9387,9388,9389,9390,9391,9392,9393,9394,9395,9396,9397,9332,9333,9334,9335,9336,9337,9338,9339,9340,9341,9342,9343,9344,9345,9346,185,178,179,8308,8319,8321,8322,8323,8324,12353,12354,12355,12356,12357,12358,12359,12360,12361,12362,12363,12364,12365,12366,12367,12368,12369,12370,12371,12372,12373,12374,12375,12376,12377,12378,12379,12380,12381,12382,12383,12384,12385,12386,12387,12388,12389,12390,12391,12392,12393,12394,12395,12396,12397,12398,12399,12400,12401,12402,12403,12404,12405,12406,12407,12408,12409,12410,12411,12412,12413,12414,12415,12416,12417,12418,12419,12420,12421,12422,12423,12424,12425,12426,12427,12428,12429,12430,12431,12432,12433,12434,12435,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,12449,12450,12451,12452,12453,12454,12455,12456,12457,12458,12459,12460,12461,12462,12463,12464,12465,12466,12467,12468,12469,12470,12471,12472,12473,12474,12475,12476,12477,12478,12479,12480,12481,12482,12483,12484,12485,12486,12487,12488,12489,12490,12491,12492,12493,12494,12495,12496,12497,12498,12499,12500,12501,12502,12503,12504,12505,12506,12507,12508,12509,12510,12511,12512,12513,12514,12515,12516,12517,12518,12519,12520,12521,12522,12523,12524,12525,12526,12527,12528,12529,12530,12531,12532,12533,12534,-1,-1,-1,-1,-1,-1,-1,-1,1040,1041,1042,1043,1044,1045,1025,1046,1047,1048,1049,1050,1051,1052,1053,1054,1055,1056,1057,1058,1059,1060,1061,1062,1063,1064,1065,1066,1067,1068,1069,1070,1071,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1072,1073,1074,1075,1076,1077,1105,1078,1079,1080,1081,1082,1083,1084,1085,1086,1087,1088,1089,1090,1091,1092,1093,1094,1095,1096,1097,1098,1099,1100,1101,1102,1103,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,44032,44033,44036,44039,44040,44041,44042,44048,44049,44050,44051,44052,44053,44054,44055,44057,44058,44059,44060,44061,44064,44068,44076,44077,44079,44080,44081,44088,44089,44092,44096,44107,44109,44116,44120,44124,44144,44145,44148,44151,44152,44154,44160,44161,44163,44164,44165,44166,44169,44170,44171,44172,44176,44180,44188,44189,44191,44192,44193,44200,44201,44202,44204,44207,44208,44216,44217,44219,44220,44221,44225,44228,44232,44236,44245,44247,44256,44257,44260,44263,44264,44266,44268,44271,44272,44273,44275,44277,44278,44284,44285,44288,44292,44294,44300,44301,44303,44305,44312,44316,44320,44329,44332,44333,44340,44341,44344,44348,44356,44357,44359,44361,44368,44372,44376,44385,44387,44396,44397,44400,44403,44404,44405,44406,44411,44412,44413,44415,44417,44418,44424,44425,44428,44432,44444,44445,44452,44471,44480,44481,44484,44488,44496,44497,44499,44508,44512,44516,44536,44537,44540,44543,44544,44545,44552,44553,44555,44557,44564,44592,44593,44596,44599,44600,44602,44608,44609,44611,44613,44614,44618,44620,44621,44622,44624,44628,44630,44636,44637,44639,44640,44641,44645,44648,44649,44652,44656,44664,44665,44667,44668,44669,44676,44677,44684,44732,44733,44734,44736,44740,44748,44749,44751,44752,44753,44760,44761,44764,44776,44779,44781,44788,44792,44796,44807,44808,44813,44816,44844,44845,44848,44850,44852,44860,44861,44863,44865,44866,44867,44872,44873,44880,44892,44893,44900,44901,44921,44928,44932,44936,44944,44945,44949,44956,44984,44985,44988,44992,44999,45e3,45001,45003,45005,45006,45012,45020,45032,45033,45040,45041,45044,45048,45056,45057,45060,45068,45072,45076,45084,45085,45096,45124,45125,45128,45130,45132,45134,45139,45140,45141,45143,45145,45149,45180,45181,45184,45188,45196,45197,45199,45201,45208,45209,45210,45212,45215,45216,45217,45218,45224,45225,45227,45228,45229,45230,45231,45233,45235,45236,45237,45240,45244,45252,45253,45255,45256,45257,45264,45265,45268,45272,45280,45285,45320,45321,45323,45324,45328,45330,45331,45336,45337,45339,45340,45341,45347,45348,45349,45352,45356,45364,45365,45367,45368,45369,45376,45377,45380,45384,45392,45393,45396,45397,45400,45404,45408,45432,45433,45436,45440,45442,45448,45449,45451,45453,45458,45459,45460,45464,45468,45480,45516,45520,45524,45532,45533,45535,45544,45545,45548,45552,45561,45563,45565,45572,45573,45576,45579,45580,45588,45589,45591,45593,45600,45620,45628,45656,45660,45664,45672,45673,45684,45685,45692,45700,45701,45705,45712,45713,45716,45720,45721,45722,45728,45729,45731,45733,45734,45738,45740,45744,45748,45768,45769,45772,45776,45778,45784,45785,45787,45789,45794,45796,45797,45798,45800,45803,45804,45805,45806,45807,45811,45812,45813,45815,45816,45817,45818,45819,45823,45824,45825,45828,45832,45840,45841,45843,45844,45845,45852,45908,45909,45910,45912,45915,45916,45918,45919,45924,45925,45927,45929,45931,45934,45936,45937,45940,45944,45952,45953,45955,45956,45957,45964,45968,45972,45984,45985,45992,45996,46020,46021,46024,46027,46028,46030,46032,46036,46037,46039,46041,46043,46045,46048,46052,46056,46076,46096,46104,46108,46112,46120,46121,46123,46132,46160,46161,46164,46168,46176,46177,46179,46181,46188,46208,46216,46237,46244,46248,46252,46261,46263,46265,46272,46276,46280,46288,46293,46300,46301,46304,46307,46308,46310,46316,46317,46319,46321,46328,46356,46357,46360,46363,46364,46372,46373,46375,46376,46377,46378,46384,46385,46388,46392,46400,46401,46403,46404,46405,46411,46412,46413,46416,46420,46428,46429,46431,46432,46433,46496,46497,46500,46504,46506,46507,46512,46513,46515,46516,46517,46523,46524,46525,46528,46532,46540,46541,46543,46544,46545,46552,46572,46608,46609,46612,46616,46629,46636,46644,46664,46692,46696,46748,46749,46752,46756,46763,46764,46769,46804,46832,46836,46840,46848,46849,46853,46888,46889,46892,46895,46896,46904,46905,46907,46916,46920,46924,46932,46933,46944,46948,46952,46960,46961,46963,46965,46972,46973,46976,46980,46988,46989,46991,46992,46993,46994,46998,46999,47e3,47001,47004,47008,47016,47017,47019,47020,47021,47028,47029,47032,47047,47049,47084,47085,47088,47092,47100,47101,47103,47104,47105,47111,47112,47113,47116,47120,47128,47129,47131,47133,47140,47141,47144,47148,47156,47157,47159,47160,47161,47168,47172,47185,47187,47196,47197,47200,47204,47212,47213,47215,47217,47224,47228,47245,47272,47280,47284,47288,47296,47297,47299,47301,47308,47312,47316,47325,47327,47329,47336,47337,47340,47344,47352,47353,47355,47357,47364,47384,47392,47420,47421,47424,47428,47436,47439,47441,47448,47449,47452,47456,47464,47465,47467,47469,47476,47477,47480,47484,47492,47493,47495,47497,47498,47501,47502,47532,47533,47536,47540,47548,47549,47551,47553,47560,47561,47564,47566,47567,47568,47569,47570,47576,47577,47579,47581,47582,47585,47587,47588,47589,47592,47596,47604,47605,47607,47608,47609,47610,47616,47617,47624,47637,47672,47673,47676,47680,47682,47688,47689,47691,47693,47694,47699,47700,47701,47704,47708,47716,47717,47719,47720,47721,47728,47729,47732,47736,47747,47748,47749,47751,47756,47784,47785,47787,47788,47792,47794,47800,47801,47803,47805,47812,47816,47832,47833,47868,47872,47876,47885,47887,47889,47896,47900,47904,47913,47915,47924,47925,47926,47928,47931,47932,47933,47934,47940,47941,47943,47945,47949,47951,47952,47956,47960,47969,47971,47980,48008,48012,48016,48036,48040,48044,48052,48055,48064,48068,48072,48080,48083,48120,48121,48124,48127,48128,48130,48136,48137,48139,48140,48141,48143,48145,48148,48149,48150,48151,48152,48155,48156,48157,48158,48159,48164,48165,48167,48169,48173,48176,48177,48180,48184,48192,48193,48195,48196,48197,48201,48204,48205,48208,48221,48260,48261,48264,48267,48268,48270,48276,48277,48279,48281,48282,48288,48289,48292,48295,48296,48304,48305,48307,48308,48309,48316,48317,48320,48324,48333,48335,48336,48337,48341,48344,48348,48372,48373,48374,48376,48380,48388,48389,48391,48393,48400,48404,48420,48428,48448,48456,48457,48460,48464,48472,48473,48484,48488,48512,48513,48516,48519,48520,48521,48522,48528,48529,48531,48533,48537,48538,48540,48548,48560,48568,48596,48597,48600,48604,48617,48624,48628,48632,48640,48643,48645,48652,48653,48656,48660,48668,48669,48671,48708,48709,48712,48716,48718,48724,48725,48727,48729,48730,48731,48736,48737,48740,48744,48746,48752,48753,48755,48756,48757,48763,48764,48765,48768,48772,48780,48781,48783,48784,48785,48792,48793,48808,48848,48849,48852,48855,48856,48864,48867,48868,48869,48876,48897,48904,48905,48920,48921,48923,48924,48925,48960,48961,48964,48968,48976,48977,48981,49044,49072,49093,49100,49101,49104,49108,49116,49119,49121,49212,49233,49240,49244,49248,49256,49257,49296,49297,49300,49304,49312,49313,49315,49317,49324,49325,49327,49328,49331,49332,49333,49334,49340,49341,49343,49344,49345,49349,49352,49353,49356,49360,49368,49369,49371,49372,49373,49380,49381,49384,49388,49396,49397,49399,49401,49408,49412,49416,49424,49429,49436,49437,49438,49439,49440,49443,49444,49446,49447,49452,49453,49455,49456,49457,49462,49464,49465,49468,49472,49480,49481,49483,49484,49485,49492,49493,49496,49500,49508,49509,49511,49512,49513,49520,49524,49528,49541,49548,49549,49550,49552,49556,49558,49564,49565,49567,49569,49573,49576,49577,49580,49584,49597,49604,49608,49612,49620,49623,49624,49632,49636,49640,49648,49649,49651,49660,49661,49664,49668,49676,49677,49679,49681,49688,49689,49692,49695,49696,49704,49705,49707,49709,49711,49713,49714,49716,49736,49744,49745,49748,49752,49760,49765,49772,49773,49776,49780,49788,49789,49791,49793,49800,49801,49808,49816,49819,49821,49828,49829,49832,49836,49837,49844,49845,49847,49849,49884,49885,49888,49891,49892,49899,49900,49901,49903,49905,49910,49912,49913,49915,49916,49920,49928,49929,49932,49933,49939,49940,49941,49944,49948,49956,49957,49960,49961,49989,50024,50025,50028,50032,50034,50040,50041,50044,50045,50052,50056,50060,50112,50136,50137,50140,50143,50144,50146,50152,50153,50157,50164,50165,50168,50184,50192,50212,50220,50224,50228,50236,50237,50248,50276,50277,50280,50284,50292,50293,50297,50304,50324,50332,50360,50364,50409,50416,50417,50420,50424,50426,50431,50432,50433,50444,50448,50452,50460,50472,50473,50476,50480,50488,50489,50491,50493,50500,50501,50504,50505,50506,50508,50509,50510,50515,50516,50517,50519,50520,50521,50525,50526,50528,50529,50532,50536,50544,50545,50547,50548,50549,50556,50557,50560,50564,50567,50572,50573,50575,50577,50581,50583,50584,50588,50592,50601,50612,50613,50616,50617,50619,50620,50621,50622,50628,50629,50630,50631,50632,50633,50634,50636,50638,50640,50641,50644,50648,50656,50657,50659,50661,50668,50669,50670,50672,50676,50678,50679,50684,50685,50686,50687,50688,50689,50693,50694,50695,50696,50700,50704,50712,50713,50715,50716,50724,50725,50728,50732,50733,50734,50736,50739,50740,50741,50743,50745,50747,50752,50753,50756,50760,50768,50769,50771,50772,50773,50780,50781,50784,50796,50799,50801,50808,50809,50812,50816,50824,50825,50827,50829,50836,50837,50840,50844,50852,50853,50855,50857,50864,50865,50868,50872,50873,50874,50880,50881,50883,50885,50892,50893,50896,50900,50908,50909,50912,50913,50920,50921,50924,50928,50936,50937,50941,50948,50949,50952,50956,50964,50965,50967,50969,50976,50977,50980,50984,50992,50993,50995,50997,50999,51004,51005,51008,51012,51018,51020,51021,51023,51025,51026,51027,51028,51029,51030,51031,51032,51036,51040,51048,51051,51060,51061,51064,51068,51069,51070,51075,51076,51077,51079,51080,51081,51082,51086,51088,51089,51092,51094,51095,51096,51098,51104,51105,51107,51108,51109,51110,51116,51117,51120,51124,51132,51133,51135,51136,51137,51144,51145,51148,51150,51152,51160,51165,51172,51176,51180,51200,51201,51204,51208,51210,51216,51217,51219,51221,51222,51228,51229,51232,51236,51244,51245,51247,51249,51256,51260,51264,51272,51273,51276,51277,51284,51312,51313,51316,51320,51322,51328,51329,51331,51333,51334,51335,51339,51340,51341,51348,51357,51359,51361,51368,51388,51389,51396,51400,51404,51412,51413,51415,51417,51424,51425,51428,51445,51452,51453,51456,51460,51461,51462,51468,51469,51471,51473,51480,51500,51508,51536,51537,51540,51544,51552,51553,51555,51564,51568,51572,51580,51592,51593,51596,51600,51608,51609,51611,51613,51648,51649,51652,51655,51656,51658,51664,51665,51667,51669,51670,51673,51674,51676,51677,51680,51682,51684,51687,51692,51693,51695,51696,51697,51704,51705,51708,51712,51720,51721,51723,51724,51725,51732,51736,51753,51788,51789,51792,51796,51804,51805,51807,51808,51809,51816,51837,51844,51864,51900,51901,51904,51908,51916,51917,51919,51921,51923,51928,51929,51936,51948,51956,51976,51984,51988,51992,52e3,52001,52033,52040,52041,52044,52048,52056,52057,52061,52068,52088,52089,52124,52152,52180,52196,52199,52201,52236,52237,52240,52244,52252,52253,52257,52258,52263,52264,52265,52268,52270,52272,52280,52281,52283,52284,52285,52286,52292,52293,52296,52300,52308,52309,52311,52312,52313,52320,52324,52326,52328,52336,52341,52376,52377,52380,52384,52392,52393,52395,52396,52397,52404,52405,52408,52412,52420,52421,52423,52425,52432,52436,52452,52460,52464,52481,52488,52489,52492,52496,52504,52505,52507,52509,52516,52520,52524,52537,52572,52576,52580,52588,52589,52591,52593,52600,52616,52628,52629,52632,52636,52644,52645,52647,52649,52656,52676,52684,52688,52712,52716,52720,52728,52729,52731,52733,52740,52744,52748,52756,52761,52768,52769,52772,52776,52784,52785,52787,52789,52824,52825,52828,52831,52832,52833,52840,52841,52843,52845,52852,52853,52856,52860,52868,52869,52871,52873,52880,52881,52884,52888,52896,52897,52899,52900,52901,52908,52909,52929,52964,52965,52968,52971,52972,52980,52981,52983,52984,52985,52992,52993,52996,53e3,53008,53009,53011,53013,53020,53024,53028,53036,53037,53039,53040,53041,53048,53076,53077,53080,53084,53092,53093,53095,53097,53104,53105,53108,53112,53120,53125,53132,53153,53160,53168,53188,53216,53217,53220,53224,53232,53233,53235,53237,53244,53248,53252,53265,53272,53293,53300,53301,53304,53308,53316,53317,53319,53321,53328,53332,53336,53344,53356,53357,53360,53364,53372,53373,53377,53412,53413,53416,53420,53428,53429,53431,53433,53440,53441,53444,53448,53449,53456,53457,53459,53460,53461,53468,53469,53472,53476,53484,53485,53487,53488,53489,53496,53517,53552,53553,53556,53560,53562,53568,53569,53571,53572,53573,53580,53581,53584,53588,53596,53597,53599,53601,53608,53612,53628,53636,53640,53664,53665,53668,53672,53680,53681,53683,53685,53690,53692,53696,53720,53748,53752,53767,53769,53776,53804,53805,53808,53812,53820,53821,53823,53825,53832,53852,53860,53888,53889,53892,53896,53904,53905,53909,53916,53920,53924,53932,53937,53944,53945,53948,53951,53952,53954,53960,53961,53963,53972,53976,53980,53988,53989,54e3,54001,54004,54008,54016,54017,54019,54021,54028,54029,54030,54032,54036,54038,54044,54045,54047,54048,54049,54053,54056,54057,54060,54064,54072,54073,54075,54076,54077,54084,54085,54140,54141,54144,54148,54156,54157,54159,54160,54161,54168,54169,54172,54176,54184,54185,54187,54189,54196,54200,54204,54212,54213,54216,54217,54224,54232,54241,54243,54252,54253,54256,54260,54268,54269,54271,54273,54280,54301,54336,54340,54364,54368,54372,54381,54383,54392,54393,54396,54399,54400,54402,54408,54409,54411,54413,54420,54441,54476,54480,54484,54492,54495,54504,54508,54512,54520,54523,54525,54532,54536,54540,54548,54549,54551,54588,54589,54592,54596,54604,54605,54607,54609,54616,54617,54620,54624,54629,54632,54633,54635,54637,54644,54645,54648,54652,54660,54661,54663,54664,54665,54672,54693,54728,54729,54732,54736,54738,54744,54745,54747,54749,54756,54757,54760,54764,54772,54773,54775,54777,54784,54785,54788,54792,54800,54801,54803,54804,54805,54812,54816,54820,54829,54840,54841,54844,54848,54853,54856,54857,54859,54861,54865,54868,54869,54872,54876,54887,54889,54896,54897,54900,54915,54917,54924,54925,54928,54932,54941,54943,54945,54952,54956,54960,54969,54971,54980,54981,54984,54988,54993,54996,54999,55001,55008,55012,55016,55024,55029,55036,55037,55040,55044,55057,55064,55065,55068,55072,55080,55081,55083,55085,55092,55093,55096,55100,55108,55111,55113,55120,55121,55124,55126,55127,55128,55129,55136,55137,55139,55141,55145,55148,55152,55156,55164,55165,55169,55176,55177,55180,55184,55192,55193,55195,55197,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,20285,20339,20551,20729,21152,21487,21621,21733,22025,23233,23478,26247,26550,26551,26607,27468,29634,30146,31292,33499,33540,34903,34952,35382,36040,36303,36603,36838,39381,21051,21364,21508,24682,24932,27580,29647,33050,35258,35282,38307,20355,21002,22718,22904,23014,24178,24185,25031,25536,26438,26604,26751,28567,30286,30475,30965,31240,31487,31777,32925,33390,33393,35563,38291,20075,21917,26359,28212,30883,31469,33883,35088,34638,38824,21208,22350,22570,23884,24863,25022,25121,25954,26577,27204,28187,29976,30131,30435,30640,32058,37039,37969,37970,40853,21283,23724,30002,32987,37440,38296,21083,22536,23004,23713,23831,24247,24378,24394,24951,27743,30074,30086,31968,32115,32177,32652,33108,33313,34193,35137,35611,37628,38477,40007,20171,20215,20491,20977,22607,24887,24894,24936,25913,27114,28433,30117,30342,30422,31623,33445,33995,63744,37799,38283,21888,23458,22353,63745,31923,32697,37301,20520,21435,23621,24040,25298,25454,25818,25831,28192,28844,31067,36317,36382,63746,36989,37445,37624,20094,20214,20581,24062,24314,24838,26967,33137,34388,36423,37749,39467,20062,20625,26480,26688,20745,21133,21138,27298,30652,37392,40660,21163,24623,36850,20552,25001,25581,25802,26684,27268,28608,33160,35233,38548,22533,29309,29356,29956,32121,32365,32937,35211,35700,36963,40273,25225,27770,28500,32080,32570,35363,20860,24906,31645,35609,37463,37772,20140,20435,20510,20670,20742,21185,21197,21375,22384,22659,24218,24465,24950,25004,25806,25964,26223,26299,26356,26775,28039,28805,28913,29855,29861,29898,30169,30828,30956,31455,31478,32069,32147,32789,32831,33051,33686,35686,36629,36885,37857,38915,38968,39514,39912,20418,21843,22586,22865,23395,23622,24760,25106,26690,26800,26856,28330,30028,30328,30926,31293,31995,32363,32380,35336,35489,35903,38542,40388,21476,21481,21578,21617,22266,22993,23396,23611,24235,25335,25911,25925,25970,26272,26543,27073,27837,30204,30352,30590,31295,32660,32771,32929,33167,33510,33533,33776,34241,34865,34996,35493,63747,36764,37678,38599,39015,39640,40723,21741,26011,26354,26767,31296,35895,40288,22256,22372,23825,26118,26801,26829,28414,29736,34974,39908,27752,63748,39592,20379,20844,20849,21151,23380,24037,24656,24685,25329,25511,25915,29657,31354,34467,36002,38799,20018,23521,25096,26524,29916,31185,33747,35463,35506,36328,36942,37707,38982,24275,27112,34303,37101,63749,20896,23448,23532,24931,26874,27454,28748,29743,29912,31649,32592,33733,35264,36011,38364,39208,21038,24669,25324,36866,20362,20809,21281,22745,24291,26336,27960,28826,29378,29654,31568,33009,37979,21350,25499,32619,20054,20608,22602,22750,24618,24871,25296,27088,39745,23439,32024,32945,36703,20132,20689,21676,21932,23308,23968,24039,25898,25934,26657,27211,29409,30350,30703,32094,32761,33184,34126,34527,36611,36686,37066,39171,39509,39851,19992,20037,20061,20167,20465,20855,21246,21312,21475,21477,21646,22036,22389,22434,23495,23943,24272,25084,25304,25937,26552,26601,27083,27472,27590,27628,27714,28317,28792,29399,29590,29699,30655,30697,31350,32127,32777,33276,33285,33290,33503,34914,35635,36092,36544,36881,37041,37476,37558,39378,39493,40169,40407,40860,22283,23616,33738,38816,38827,40628,21531,31384,32676,35033,36557,37089,22528,23624,25496,31391,23470,24339,31353,31406,33422,36524,20518,21048,21240,21367,22280,25331,25458,27402,28099,30519,21413,29527,34152,36470,38357,26426,27331,28528,35437,36556,39243,63750,26231,27512,36020,39740,63751,21483,22317,22862,25542,27131,29674,30789,31418,31429,31998,33909,35215,36211,36917,38312,21243,22343,30023,31584,33740,37406,63752,27224,20811,21067,21127,25119,26840,26997,38553,20677,21156,21220,25027,26020,26681,27135,29822,31563,33465,33771,35250,35641,36817,39241,63753,20170,22935,25810,26129,27278,29748,31105,31165,33449,34942,34943,35167,63754,37670,20235,21450,24613,25201,27762,32026,32102,20120,20834,30684,32943,20225,20238,20854,20864,21980,22120,22331,22522,22524,22804,22855,22931,23492,23696,23822,24049,24190,24524,25216,26071,26083,26398,26399,26462,26827,26820,27231,27450,27683,27773,27778,28103,29592,29734,29738,29826,29859,30072,30079,30849,30959,31041,31047,31048,31098,31637,32e3,32186,32648,32774,32813,32908,35352,35663,35912,36215,37665,37668,39138,39249,39438,39439,39525,40594,32202,20342,21513,25326,26708,37329,21931,20794,63755,63756,23068,25062,63757,25295,25343,63758,63759,63760,63761,63762,63763,37027,63764,63765,63766,63767,63768,35582,63769,63770,63771,63772,26262,63773,29014,63774,63775,38627,63776,25423,25466,21335,63777,26511,26976,28275,63778,30007,63779,63780,63781,32013,63782,63783,34930,22218,23064,63784,63785,63786,63787,63788,20035,63789,20839,22856,26608,32784,63790,22899,24180,25754,31178,24565,24684,25288,25467,23527,23511,21162,63791,22900,24361,24594,63792,63793,63794,29785,63795,63796,63797,63798,63799,63800,39377,63801,63802,63803,63804,63805,63806,63807,63808,63809,63810,63811,28611,63812,63813,33215,36786,24817,63814,63815,33126,63816,63817,23615,63818,63819,63820,63821,63822,63823,63824,63825,23273,35365,26491,32016,63826,63827,63828,63829,63830,63831,33021,63832,63833,23612,27877,21311,28346,22810,33590,20025,20150,20294,21934,22296,22727,24406,26039,26086,27264,27573,28237,30701,31471,31774,32222,34507,34962,37170,37723,25787,28606,29562,30136,36948,21846,22349,25018,25812,26311,28129,28251,28525,28601,30192,32835,33213,34113,35203,35527,35674,37663,27795,30035,31572,36367,36957,21776,22530,22616,24162,25095,25758,26848,30070,31958,34739,40680,20195,22408,22382,22823,23565,23729,24118,24453,25140,25825,29619,33274,34955,36024,38538,40667,23429,24503,24755,20498,20992,21040,22294,22581,22615,23566,23648,23798,23947,24230,24466,24764,25361,25481,25623,26691,26873,27330,28120,28193,28372,28644,29182,30428,30585,31153,31291,33796,35241,36077,36339,36424,36867,36884,36947,37117,37709,38518,38876,27602,28678,29272,29346,29544,30563,31167,31716,32411,35712,22697,24775,25958,26109,26302,27788,28958,29129,35930,38931,20077,31361,20189,20908,20941,21205,21516,24999,26481,26704,26847,27934,28540,30140,30643,31461,33012,33891,37509,20828,26007,26460,26515,30168,31431,33651,63834,35910,36887,38957,23663,33216,33434,36929,36975,37389,24471,23965,27225,29128,30331,31561,34276,35588,37159,39472,21895,25078,63835,30313,32645,34367,34746,35064,37007,63836,27931,28889,29662,32097,33853,63837,37226,39409,63838,20098,21365,27396,27410,28734,29211,34349,40478,21068,36771,23888,25829,25900,27414,28651,31811,32412,34253,35172,35261,25289,33240,34847,24266,26391,28010,29436,29701,29807,34690,37086,20358,23821,24480,33802,20919,25504,30053,20142,20486,20841,20937,26753,27153,31918,31921,31975,33391,35538,36635,37327,20406,20791,21237,21570,24300,24942,25150,26053,27354,28670,31018,34268,34851,38317,39522,39530,40599,40654,21147,26310,27511,28701,31019,36706,38722,24976,25088,25891,28451,29001,29833,32244,32879,34030,36646,36899,37706,20925,21015,21155,27916,28872,35010,24265,25986,27566,28610,31806,29557,20196,20278,22265,63839,23738,23994,24604,29618,31533,32666,32718,32838,36894,37428,38646,38728,38936,40801,20363,28583,31150,37300,38583,21214,63840,25736,25796,27347,28510,28696,29200,30439,32769,34310,34396,36335,36613,38706,39791,40442,40565,30860,31103,32160,33737,37636,40575,40595,35542,22751,24324,26407,28711,29903,31840,32894,20769,28712,29282,30922,36034,36058,36084,38647,20102,20698,23534,24278,26009,29134,30274,30637,32842,34044,36988,39719,40845,22744,23105,23650,27155,28122,28431,30267,32047,32311,34078,35128,37860,38475,21129,26066,26611,27060,27969,28316,28687,29705,29792,30041,30244,30827,35628,39006,20845,25134,38520,20374,20523,23833,28138,32184,36650,24459,24900,26647,63841,38534,21202,32907,20956,20940,26974,31260,32190,33777,38517,20442,21033,21400,21519,21774,23653,24743,26446,26792,28012,29313,29432,29702,29827,63842,30178,31852,32633,32696,33673,35023,35041,37324,37328,38626,39881,21533,28542,29136,29848,34298,36522,38563,40023,40607,26519,28107,29747,33256,38678,30764,31435,31520,31890,25705,29802,30194,30908,30952,39340,39764,40635,23518,24149,28448,33180,33707,37e3,19975,21325,23081,24018,24398,24930,25405,26217,26364,28415,28459,28771,30622,33836,34067,34875,36627,39237,39995,21788,25273,26411,27819,33545,35178,38778,20129,22916,24536,24537,26395,32178,32596,33426,33579,33725,36638,37017,22475,22969,23186,23504,26151,26522,26757,27599,29028,32629,36023,36067,36993,39749,33032,35978,38476,39488,40613,23391,27667,29467,30450,30431,33804,20906,35219,20813,20885,21193,26825,27796,30468,30496,32191,32236,38754,40629,28357,34065,20901,21517,21629,26126,26269,26919,28319,30399,30609,33559,33986,34719,37225,37528,40180,34946,20398,20882,21215,22982,24125,24917,25720,25721,26286,26576,27169,27597,27611,29279,29281,29761,30520,30683,32791,33468,33541,35584,35624,35980,26408,27792,29287,30446,30566,31302,40361,27519,27794,22818,26406,33945,21359,22675,22937,24287,25551,26164,26483,28218,29483,31447,33495,37672,21209,24043,25006,25035,25098,25287,25771,26080,26969,27494,27595,28961,29687,30045,32326,33310,33538,34154,35491,36031,38695,40289,22696,40664,20497,21006,21563,21839,25991,27766,32010,32011,32862,34442,38272,38639,21247,27797,29289,21619,23194,23614,23883,24396,24494,26410,26806,26979,28220,28228,30473,31859,32654,34183,35598,36855,38753,40692,23735,24758,24845,25003,25935,26107,26108,27665,27887,29599,29641,32225,38292,23494,34588,35600,21085,21338,25293,25615,25778,26420,27192,27850,29632,29854,31636,31893,32283,33162,33334,34180,36843,38649,39361,20276,21322,21453,21467,25292,25644,25856,26001,27075,27886,28504,29677,30036,30242,30436,30460,30928,30971,31020,32070,33324,34784,36820,38930,39151,21187,25300,25765,28196,28497,30332,36299,37297,37474,39662,39747,20515,20621,22346,22952,23592,24135,24439,25151,25918,26041,26049,26121,26507,27036,28354,30917,32033,32938,33152,33323,33459,33953,34444,35370,35607,37030,38450,40848,20493,20467,63843,22521,24472,25308,25490,26479,28227,28953,30403,32972,32986,35060,35061,35097,36064,36649,37197,38506,20271,20336,24091,26575,26658,30333,30334,39748,24161,27146,29033,29140,30058,63844,32321,34115,34281,39132,20240,31567,32624,38309,20961,24070,26805,27710,27726,27867,29359,31684,33539,27861,29754,20731,21128,22721,25816,27287,29863,30294,30887,34327,38370,38713,63845,21342,24321,35722,36776,36783,37002,21029,30629,40009,40712,19993,20482,20853,23643,24183,26142,26170,26564,26821,28851,29953,30149,31177,31453,36647,39200,39432,20445,22561,22577,23542,26222,27493,27921,28282,28541,29668,29995,33769,35036,35091,35676,36628,20239,20693,21264,21340,23443,24489,26381,31119,33145,33583,34068,35079,35206,36665,36667,39333,39954,26412,20086,20472,22857,23553,23791,23792,25447,26834,28925,29090,29739,32299,34028,34562,36898,37586,40179,19981,20184,20463,20613,21078,21103,21542,21648,22496,22827,23142,23386,23413,23500,24220,63846,25206,25975,26023,28014,28325,29238,31526,31807,32566,33104,33105,33178,33344,33433,33705,35331,36e3,36070,36091,36212,36282,37096,37340,38428,38468,39385,40167,21271,20998,21545,22132,22707,22868,22894,24575,24996,25198,26128,27774,28954,30406,31881,31966,32027,33452,36033,38640,63847,20315,24343,24447,25282,23849,26379,26842,30844,32323,40300,19989,20633,21269,21290,21329,22915,23138,24199,24754,24970,25161,25209,26e3,26503,27047,27604,27606,27607,27608,27832,63848,29749,30202,30738,30865,31189,31192,31875,32203,32737,32933,33086,33218,33778,34586,35048,35513,35692,36027,37145,38750,39131,40763,22188,23338,24428,25996,27315,27567,27996,28657,28693,29277,29613,36007,36051,38971,24977,27703,32856,39425,20045,20107,20123,20181,20282,20284,20351,20447,20735,21490,21496,21766,21987,22235,22763,22882,23057,23531,23546,23556,24051,24107,24473,24605,25448,26012,26031,26614,26619,26797,27515,27801,27863,28195,28681,29509,30722,31038,31040,31072,31169,31721,32023,32114,32902,33293,33678,34001,34503,35039,35408,35422,35613,36060,36198,36781,37034,39164,39391,40605,21066,63849,26388,63850,20632,21034,23665,25955,27733,29642,29987,30109,31639,33948,37240,38704,20087,25746,27578,29022,34217,19977,63851,26441,26862,28183,33439,34072,34923,25591,28545,37394,39087,19978,20663,20687,20767,21830,21930,22039,23360,23577,23776,24120,24202,24224,24258,24819,26705,27233,28248,29245,29248,29376,30456,31077,31665,32724,35059,35316,35443,35937,36062,38684,22622,29885,36093,21959,63852,31329,32034,33394,29298,29983,29989,63853,31513,22661,22779,23996,24207,24246,24464,24661,25234,25471,25933,26257,26329,26360,26646,26866,29312,29790,31598,32110,32214,32626,32997,33298,34223,35199,35475,36893,37604,40653,40736,22805,22893,24109,24796,26132,26227,26512,27728,28101,28511,30707,30889,33990,37323,37675,20185,20682,20808,21892,23307,23459,25159,25982,26059,28210,29053,29697,29764,29831,29887,30316,31146,32218,32341,32680,33146,33203,33337,34330,34796,35445,36323,36984,37521,37925,39245,39854,21352,23633,26964,27844,27945,28203,33292,34203,35131,35373,35498,38634,40807,21089,26297,27570,32406,34814,36109,38275,38493,25885,28041,29166,63854,22478,22995,23468,24615,24826,25104,26143,26207,29481,29689,30427,30465,31596,32854,32882,33125,35488,37266,19990,21218,27506,27927,31237,31545,32048,63855,36016,21484,22063,22609,23477,23567,23569,24034,25152,25475,25620,26157,26803,27836,28040,28335,28703,28836,29138,29990,30095,30094,30233,31505,31712,31787,32032,32057,34092,34157,34311,35380,36877,36961,37045,37559,38902,39479,20439,23660,26463,28049,31903,32396,35606,36118,36895,23403,24061,25613,33984,36956,39137,29575,23435,24730,26494,28126,35359,35494,36865,38924,21047,63856,28753,30862,37782,34928,37335,20462,21463,22013,22234,22402,22781,23234,23432,23723,23744,24101,24833,25101,25163,25480,25628,25910,25976,27193,27530,27700,27929,28465,29159,29417,29560,29703,29874,30246,30561,31168,31319,31466,31929,32143,32172,32353,32670,33065,33585,33936,34010,34282,34966,35504,35728,36664,36930,36995,37228,37526,37561,38539,38567,38568,38614,38656,38920,39318,39635,39706,21460,22654,22809,23408,23487,28113,28506,29087,29729,29881,32901,33789,24033,24455,24490,24642,26092,26642,26991,27219,27529,27957,28147,29667,30462,30636,31565,32020,33059,33308,33600,34036,34147,35426,35524,37255,37662,38918,39348,25100,34899,36848,37477,23815,23847,23913,29791,33181,34664,28629,25342,32722,35126,35186,19998,20056,20711,21213,21319,25215,26119,32361,34821,38494,20365,21273,22070,22987,23204,23608,23630,23629,24066,24337,24643,26045,26159,26178,26558,26612,29468,30690,31034,32709,33940,33997,35222,35430,35433,35553,35925,35962,22516,23508,24335,24687,25325,26893,27542,28252,29060,31698,34645,35672,36606,39135,39166,20280,20353,20449,21627,23072,23480,24892,26032,26216,29180,30003,31070,32051,33102,33251,33688,34218,34254,34563,35338,36523,36763,63857,36805,22833,23460,23526,24713,23529,23563,24515,27777,63858,28145,28683,29978,33455,35574,20160,21313,63859,38617,27663,20126,20420,20818,21854,23077,23784,25105,29273,33469,33706,34558,34905,35357,38463,38597,39187,40201,40285,22538,23731,23997,24132,24801,24853,25569,27138,28197,37122,37716,38990,39952,40823,23433,23736,25353,26191,26696,30524,38593,38797,38996,39839,26017,35585,36555,38332,21813,23721,24022,24245,26263,30284,33780,38343,22739,25276,29390,40232,20208,22830,24591,26171,27523,31207,40230,21395,21696,22467,23830,24859,26326,28079,30861,33406,38552,38724,21380,25212,25494,28082,32266,33099,38989,27387,32588,40367,40474,20063,20539,20918,22812,24825,25590,26928,29242,32822,63860,37326,24369,63861,63862,32004,33509,33903,33979,34277,36493,63863,20335,63864,63865,22756,23363,24665,25562,25880,25965,26264,63866,26954,27171,27915,28673,29036,30162,30221,31155,31344,63867,32650,63868,35140,63869,35731,37312,38525,63870,39178,22276,24481,26044,28417,30208,31142,35486,39341,39770,40812,20740,25014,25233,27277,33222,20547,22576,24422,28937,35328,35578,23420,34326,20474,20796,22196,22852,25513,28153,23978,26989,20870,20104,20313,63871,63872,63873,22914,63874,63875,27487,27741,63876,29877,30998,63877,33287,33349,33593,36671,36701,63878,39192,63879,63880,63881,20134,63882,22495,24441,26131,63883,63884,30123,32377,35695,63885,36870,39515,22181,22567,23032,23071,23476,63886,24310,63887,63888,25424,25403,63889,26941,27783,27839,28046,28051,28149,28436,63890,28895,28982,29017,63891,29123,29141,63892,30799,30831,63893,31605,32227,63894,32303,63895,34893,36575,63896,63897,63898,37467,63899,40182,63900,63901,63902,24709,28037,63903,29105,63904,63905,38321,21421,63906,63907,63908,26579,63909,28814,28976,29744,33398,33490,63910,38331,39653,40573,26308,63911,29121,33865,63912,63913,22603,63914,63915,23992,24433,63916,26144,26254,27001,27054,27704,27891,28214,28481,28634,28699,28719,29008,29151,29552,63917,29787,63918,29908,30408,31310,32403,63919,63920,33521,35424,36814,63921,37704,63922,38681,63923,63924,20034,20522,63925,21e3,21473,26355,27757,28618,29450,30591,31330,33454,34269,34306,63926,35028,35427,35709,35947,63927,37555,63928,38675,38928,20116,20237,20425,20658,21320,21566,21555,21978,22626,22714,22887,23067,23524,24735,63929,25034,25942,26111,26212,26791,27738,28595,28879,29100,29522,31613,34568,35492,39986,40711,23627,27779,29508,29577,37434,28331,29797,30239,31337,32277,34314,20800,22725,25793,29934,29973,30320,32705,37013,38605,39252,28198,29926,31401,31402,33253,34521,34680,35355,23113,23436,23451,26785,26880,28003,29609,29715,29740,30871,32233,32747,33048,33109,33694,35916,38446,38929,26352,24448,26106,26505,27754,29579,20525,23043,27498,30702,22806,23916,24013,29477,30031,63930,63931,20709,20985,22575,22829,22934,23002,23525,63932,63933,23970,25303,25622,25747,25854,63934,26332,63935,27208,63936,29183,29796,63937,31368,31407,32327,32350,32768,33136,63938,34799,35201,35616,36953,63939,36992,39250,24958,27442,28020,32287,35109,36785,20433,20653,20887,21191,22471,22665,23481,24248,24898,27029,28044,28263,28342,29076,29794,29992,29996,32883,33592,33993,36362,37780,37854,63940,20110,20305,20598,20778,21448,21451,21491,23431,23507,23588,24858,24962,26100,29275,29591,29760,30402,31056,31121,31161,32006,32701,33419,34261,34398,36802,36935,37109,37354,38533,38632,38633,21206,24423,26093,26161,26671,29020,31286,37057,38922,20113,63941,27218,27550,28560,29065,32792,33464,34131,36939,38549,38642,38907,34074,39729,20112,29066,38596,20803,21407,21729,22291,22290,22435,23195,23236,23491,24616,24895,25588,27781,27961,28274,28304,29232,29503,29783,33489,34945,36677,36960,63942,38498,39e3,40219,26376,36234,37470,20301,20553,20702,21361,22285,22996,23041,23561,24944,26256,28205,29234,29771,32239,32963,33806,33894,34111,34655,34907,35096,35586,36949,38859,39759,20083,20369,20754,20842,63943,21807,21929,23418,23461,24188,24189,24254,24736,24799,24840,24841,25540,25912,26377,63944,26580,26586,63945,26977,26978,27833,27943,63946,28216,63947,28641,29494,29495,63948,29788,30001,63949,30290,63950,63951,32173,33278,33848,35029,35480,35547,35565,36400,36418,36938,36926,36986,37193,37321,37742,63952,63953,22537,63954,27603,32905,32946,63955,63956,20801,22891,23609,63957,63958,28516,29607,32996,36103,63959,37399,38287,63960,63961,63962,63963,32895,25102,28700,32104,34701,63964,22432,24681,24903,27575,35518,37504,38577,20057,21535,28139,34093,38512,38899,39150,25558,27875,37009,20957,25033,33210,40441,20381,20506,20736,23452,24847,25087,25836,26885,27589,30097,30691,32681,33380,34191,34811,34915,35516,35696,37291,20108,20197,20234,63965,63966,22839,23016,63967,24050,24347,24411,24609,63968,63969,63970,63971,29246,29669,63972,30064,30157,63973,31227,63974,32780,32819,32900,33505,33617,63975,63976,36029,36019,36999,63977,63978,39156,39180,63979,63980,28727,30410,32714,32716,32764,35610,20154,20161,20995,21360,63981,21693,22240,23035,23493,24341,24525,28270,63982,63983,32106,33589,63984,34451,35469,63985,38765,38775,63986,63987,19968,20314,20350,22777,26085,28322,36920,37808,39353,20219,22764,22922,23001,24641,63988,63989,31252,63990,33615,36035,20837,21316,63991,63992,63993,20173,21097,23381,33471,20180,21050,21672,22985,23039,23376,23383,23388,24675,24904,28363,28825,29038,29574,29943,30133,30913,32043,32773,33258,33576,34071,34249,35566,36039,38604,20316,21242,22204,26027,26152,28796,28856,29237,32189,33421,37196,38592,40306,23409,26855,27544,28538,30430,23697,26283,28507,31668,31786,34870,38620,19976,20183,21280,22580,22715,22767,22892,23559,24115,24196,24373,25484,26290,26454,27167,27299,27404,28479,29254,63994,29520,29835,31456,31911,33144,33247,33255,33674,33900,34083,34196,34255,35037,36115,37292,38263,38556,20877,21705,22312,23472,25165,26448,26685,26771,28221,28371,28797,32289,35009,36001,36617,40779,40782,29229,31631,35533,37658,20295,20302,20786,21632,22992,24213,25269,26485,26990,27159,27822,28186,29401,29482,30141,31672,32053,33511,33785,33879,34295,35419,36015,36487,36889,37048,38606,40799,21219,21514,23265,23490,25688,25973,28404,29380,63995,30340,31309,31515,31821,32318,32735,33659,35627,36042,36196,36321,36447,36842,36857,36969,37841,20291,20346,20659,20840,20856,21069,21098,22625,22652,22880,23560,23637,24283,24731,25136,26643,27583,27656,28593,29006,29728,3e4,30008,30033,30322,31564,31627,31661,31686,32399,35438,36670,36681,37439,37523,37666,37931,38651,39002,39019,39198,20999,25130,25240,27993,30308,31434,31680,32118,21344,23742,24215,28472,28857,31896,38673,39822,40670,25509,25722,34678,19969,20117,20141,20572,20597,21576,22979,23450,24128,24237,24311,24449,24773,25402,25919,25972,26060,26230,26232,26622,26984,27273,27491,27712,28096,28136,28191,28254,28702,28833,29582,29693,30010,30555,30855,31118,31243,31357,31934,32142,33351,35330,35562,35998,37165,37194,37336,37478,37580,37664,38662,38742,38748,38914,40718,21046,21137,21884,22564,24093,24351,24716,25552,26799,28639,31085,31532,33229,34234,35069,35576,36420,37261,38500,38555,38717,38988,40778,20430,20806,20939,21161,22066,24340,24427,25514,25805,26089,26177,26362,26361,26397,26781,26839,27133,28437,28526,29031,29157,29226,29866,30522,31062,31066,31199,31264,31381,31895,31967,32068,32368,32903,34299,34468,35412,35519,36249,36481,36896,36973,37347,38459,38613,40165,26063,31751,36275,37827,23384,23562,21330,25305,29469,20519,23447,24478,24752,24939,26837,28121,29742,31278,32066,32156,32305,33131,36394,36405,37758,37912,20304,22352,24038,24231,25387,32618,20027,20303,20367,20570,23005,32964,21610,21608,22014,22863,23449,24030,24282,26205,26417,26609,26666,27880,27954,28234,28557,28855,29664,30087,31820,32002,32044,32162,33311,34523,35387,35461,36208,36490,36659,36913,37198,37202,37956,39376,31481,31909,20426,20737,20934,22472,23535,23803,26201,27197,27994,28310,28652,28940,30063,31459,34850,36897,36981,38603,39423,33537,20013,20210,34886,37325,21373,27355,26987,27713,33914,22686,24974,26366,25327,28893,29969,30151,32338,33976,35657,36104,20043,21482,21675,22320,22336,24535,25345,25351,25711,25903,26088,26234,26525,26547,27490,27744,27802,28460,30693,30757,31049,31063,32025,32930,33026,33267,33437,33463,34584,35468,63996,36100,36286,36978,30452,31257,31287,32340,32887,21767,21972,22645,25391,25634,26185,26187,26733,27035,27524,27941,28337,29645,29800,29857,30043,30137,30433,30494,30603,31206,32265,32285,33275,34095,34967,35386,36049,36587,36784,36914,37805,38499,38515,38663,20356,21489,23018,23241,24089,26702,29894,30142,31209,31378,33187,34541,36074,36300,36845,26015,26389,63997,22519,28503,32221,36655,37878,38598,24501,25074,28548,19988,20376,20511,21449,21983,23919,24046,27425,27492,30923,31642,63998,36425,36554,36974,25417,25662,30528,31364,37679,38015,40810,25776,28591,29158,29864,29914,31428,31762,32386,31922,32408,35738,36106,38013,39184,39244,21049,23519,25830,26413,32046,20717,21443,22649,24920,24921,25082,26028,31449,35730,35734,20489,20513,21109,21809,23100,24288,24432,24884,25950,26124,26166,26274,27085,28356,28466,29462,30241,31379,33081,33369,33750,33980,20661,22512,23488,23528,24425,25505,30758,32181,33756,34081,37319,37365,20874,26613,31574,36012,20932,22971,24765,34389,20508,63999,21076,23610,24957,25114,25299,25842,26021,28364,30240,33034,36448,38495,38587,20191,21315,21912,22825,24029,25797,27849,28154,29588,31359,33307,34214,36068,36368,36983,37351,38369,38433,38854,20984,21746,21894,24505,25764,28552,32180,36639,36685,37941,20681,23574,27838,28155,29979,30651,31805,31844,35449,35522,22558,22974,24086,25463,29266,30090,30571,35548,36028,36626,24307,26228,28152,32893,33729,35531,38737,39894,64e3,21059,26367,28053,28399,32224,35558,36910,36958,39636,21021,21119,21736,24980,25220,25307,26786,26898,26970,27189,28818,28966,30813,30977,30990,31186,31245,32918,33400,33493,33609,34121,35970,36229,37218,37259,37294,20419,22225,29165,30679,34560,35320,23544,24534,26449,37032,21474,22618,23541,24740,24961,25696,32317,32880,34085,37507,25774,20652,23828,26368,22684,25277,25512,26894,27e3,27166,28267,30394,31179,33467,33833,35535,36264,36861,37138,37195,37276,37648,37656,37786,38619,39478,39949,19985,30044,31069,31482,31569,31689,32302,33988,36441,36468,36600,36880,26149,26943,29763,20986,26414,40668,20805,24544,27798,34802,34909,34935,24756,33205,33795,36101,21462,21561,22068,23094,23601,28810,32736,32858,33030,33261,36259,37257,39519,40434,20596,20164,21408,24827,28204,23652,20360,20516,21988,23769,24159,24677,26772,27835,28100,29118,30164,30196,30305,31258,31305,32199,32251,32622,33268,34473,36636,38601,39347,40786,21063,21189,39149,35242,19971,26578,28422,20405,23522,26517,27784,28024,29723,30759,37341,37756,34756,31204,31281,24555,20182,21668,21822,22702,22949,24816,25171,25302,26422,26965,33333,38464,39345,39389,20524,21331,21828,22396,64001,25176,64002,25826,26219,26589,28609,28655,29730,29752,35351,37944,21585,22022,22374,24392,24986,27470,28760,28845,32187,35477,22890,33067,25506,30472,32829,36010,22612,25645,27067,23445,24081,28271,64003,34153,20812,21488,22826,24608,24907,27526,27760,27888,31518,32974,33492,36294,37040,39089,64004,25799,28580,25745,25860,20814,21520,22303,35342,24927,26742,64005,30171,31570,32113,36890,22534,27084,33151,35114,36864,38969,20600,22871,22956,25237,36879,39722,24925,29305,38358,22369,23110,24052,25226,25773,25850,26487,27874,27966,29228,29750,30772,32631,33453,36315,38935,21028,22338,26495,29256,29923,36009,36774,37393,38442,20843,21485,25420,20329,21764,24726,25943,27803,28031,29260,29437,31255,35207,35997,24429,28558,28921,33192,24846,20415,20559,25153,29255,31687,32232,32745,36941,38829,39449,36022,22378,24179,26544,33805,35413,21536,23318,24163,24290,24330,25987,32954,34109,38281,38491,20296,21253,21261,21263,21638,21754,22275,24067,24598,25243,25265,25429,64006,27873,28006,30129,30770,32990,33071,33502,33889,33970,34957,35090,36875,37610,39165,39825,24133,26292,26333,28689,29190,64007,20469,21117,24426,24915,26451,27161,28418,29922,31080,34920,35961,39111,39108,39491,21697,31263,26963,35575,35914,39080,39342,24444,25259,30130,30382,34987,36991,38466,21305,24380,24517,27852,29644,30050,30091,31558,33534,39325,20047,36924,19979,20309,21414,22799,24264,26160,27827,29781,33655,34662,36032,36944,38686,39957,22737,23416,34384,35604,40372,23506,24680,24717,26097,27735,28450,28579,28698,32597,32752,38289,38290,38480,38867,21106,36676,20989,21547,21688,21859,21898,27323,28085,32216,33382,37532,38519,40569,21512,21704,30418,34532,38308,38356,38492,20130,20233,23022,23270,24055,24658,25239,26477,26689,27782,28207,32568,32923,33322,64008,64009,38917,20133,20565,21683,22419,22874,23401,23475,25032,26999,28023,28707,34809,35299,35442,35559,36994,39405,39608,21182,26680,20502,24184,26447,33607,34892,20139,21521,22190,29670,37141,38911,39177,39255,39321,22099,22687,34395,35377,25010,27382,29563,36562,27463,38570,39511,22869,29184,36203,38761,20436,23796,24358,25080,26203,27883,28843,29572,29625,29694,30505,30541,32067,32098,32291,33335,34898,64010,36066,37449,39023,23377,31348,34880,38913,23244,20448,21332,22846,23805,25406,28025,29433,33029,33031,33698,37583,38960,20136,20804,21009,22411,24418,27842,28366,28677,28752,28847,29074,29673,29801,33610,34722,34913,36872,37026,37795,39336,20846,24407,24800,24935,26291,34137,36426,37295,38795,20046,20114,21628,22741,22778,22909,23733,24359,25142,25160,26122,26215,27627,28009,28111,28246,28408,28564,28640,28649,28765,29392,29733,29786,29920,30355,31068,31946,32286,32993,33446,33899,33983,34382,34399,34676,35703,35946,37804,38912,39013,24785,25110,37239,23130,26127,28151,28222,29759,39746,24573,24794,31503,21700,24344,27742,27859,27946,28888,32005,34425,35340,40251,21270,21644,23301,27194,28779,30069,31117,31166,33457,33775,35441,35649,36008,38772,64011,25844,25899,30906,30907,31339,20024,21914,22864,23462,24187,24739,25563,27489,26213,26707,28185,29029,29872,32008,36996,39529,39973,27963,28369,29502,35905,38346,20976,24140,24488,24653,24822,24880,24908,26179,26180,27045,27841,28255,28361,28514,29004,29852,30343,31681,31783,33618,34647,36945,38541,40643,21295,22238,24315,24458,24674,24724,25079,26214,26371,27292,28142,28590,28784,29546,32362,33214,33588,34516,35496,36036,21123,29554,23446,27243,37892,21742,22150,23389,25928,25989,26313,26783,28045,28102,29243,32948,37237,39501,20399,20505,21402,21518,21564,21897,21957,24127,24460,26429,29030,29661,36869,21211,21235,22628,22734,28932,29071,29179,34224,35347,26248,34216,21927,26244,29002,33841,21321,21913,27585,24409,24509,25582,26249,28999,35569,36637,40638,20241,25658,28875,30054,34407,24676,35662,40440,20807,20982,21256,27958,33016,40657,26133,27427,28824,30165,21507,23673,32007,35350,27424,27453,27462,21560,24688,27965,32725,33288,20694,20958,21916,22123,22221,23020,23305,24076,24985,24984,25137,26206,26342,29081,29113,29114,29351,31143,31232,32690,35440,0],
n.euckrToUTF8=function(e){var t,r=[];for(t=0;t<e.length;++t){var i,s;if(i=e.charCodeAt(t),0<=i&&i<128)r.push(String.fromCharCode(i));else{var o,u=0;t++,s=e.charCodeAt(t),u=94*(i-161)+s-161,u<0||n.tableKSC5601.length<u?(o="?",a.console.log("unknown euckr code ("+i+":"+s+")")):o=n.tableKSC5601[u],r.push(String.fromCharCode(o))}}return r.join("")},n.decodeEUCKR=function(e){var t,r=[];for(t=0;t<e.length;++t){var i,s;if(i=e.charCodeAt(t),0<=i&&i<128)r.push(String.fromCharCode(i));else{var o,u=0;t++,s=e.charCodeAt(t),u=94*(i-161)+s-161,u<0||n.tableKSC5601.length<u?(o="?",a.console.log("unknown euckr code ("+i+":"+s+")")):o=n.tableKSC5601[u],r.push(String.fromCharCode(o))}}return r.join("")},n.encodeEUCKR=function(e){var t,r=[];for(t=0;t<e.length;++t){var i,s,o;if(i=e.charCodeAt(t),0<=i&&i<128)r.push(String.fromCharCode(i));else{var u,c=0;if(c=n.tableKSC5601.indexOf(i),c==-1){a.console.log("unknown euckr code ("+i+")"),r.push("?");continue}u=Math.floor(c/94),s=u+161,o=c-94*u+161,r.push(String.fromCharCode(s)),r.push(String.fromCharCode(o))}}return r.join("")},n.bytesToHex=function(e){for(var t,r=[],a=0;a<e.length;++a){t="";var n=e.charCodeAt(a);n<16&&(t="0"),t+=n.toString(16),r.push(t)}return r.join("")},n.hexToBytes=function(e){var t=[],r=0;for(e.length&!0&&(r=1,t.push(String.fromCharCode(parseInt(e[0],16))));r<e.length;r+=2)t.push(String.fromCharCode(parseInt(e.substr(r,2),16)));return t.join("")},n.encodeUTF8=function(e){return a.util.encodeUtf8(e)},n.decodeUTF8=function(e){return a.util.decodeUtf8(e)};var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",s=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];n.encode64=function(e,t){for(var r,a,n,s="",o="",u=0;u<e.length;)r=e.charCodeAt(u++),a=e.charCodeAt(u++),n=e.charCodeAt(u++),s+=i.charAt(r>>2),s+=i.charAt((3&r)<<4|a>>4),isNaN(a)?s+="==":(s+=i.charAt((15&a)<<2|n>>6),s+=isNaN(n)?"=":i.charAt(63&n)),t&&s.length>t&&(o+=s.substr(0,t)+"\r\n",s=s.substr(t));return o+=s},n.decode64=function(e){e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var t,r,a,n,i="",o=0;o<e.length;)t=s[e.charCodeAt(o++)-43],r=s[e.charCodeAt(o++)-43],a=s[e.charCodeAt(o++)-43],n=s[e.charCodeAt(o++)-43],i+=String.fromCharCode(t<<2|r>>4),64!==a&&(i+=String.fromCharCode((15&r)<<4|a>>2),64!==n&&(i+=String.fromCharCode((3&a)<<6|n)));return i},n.isUTF16String=function(e){var t;for(t=0;t<e.length;++t)if(e.charCodeAt(t)>256)return!0;return!1},n.encode64url=ytcrypto.crypto.util.encode64url,n.decode64url=ytcrypto.crypto.util.decode64url,e.exports=n},function(e,t,r){function a(e,t){e.values=[],t.value.forEach(function(t){var r;if(r=c.pki.GeneralName.toObject(t),e.values.push(r),"otherName"==r.type)switch(r.oid){case c.oids.identifyData:var a;if(a=c.kisa.IdentifyData.toObject(r.value.value[0]),a.hasOwnProperty("realName")&&(e.realName=a.realName),a.hasOwnProperty("vid")){ytcrypto.md[a.vid.hashAlg].create();e.vid=a.vid}break;case"2.5.4.4":r.surname=r.value.value[0].value}})}function n(e,t){t.value&&t.value.forEach(function(t){switch(t.type){case 0:e.keyIdentifier=c.util.bytesToHex(t.value);break;case 1:;e.authorityCertIssuer=[],t.value.forEach(function(t){e.authorityCertIssuer.push(c.pki.GeneralName.toObject(t).value)});break;case 2:e.authorityCertSerialNumber=c.util.bytesToHex(t.value)}})}function i(e){var t;return t={},e.value.forEach(function(e){var r,a;switch(r=c._asn1.derToOid(e.value[0].value)){case"1.2.410.200004.5.4.1.1":a="odinaryPersonal";break;case"1.2.410.200005.1.1.4":a="restrictedPersonalFinancial";break;default:a=r}t[r]={name:a},e.value.length>1&&e.value[1].value.forEach(function(e){var a=c._asn1.derToOid(e.value[0].value);switch(a){case"1.3.6.1.5.5.7.2.1":t[r].CPSuri=e.value[1].value;break;case"1.3.6.1.5.5.7.2.2":t[r].userNotice=[],e.value[1].value.forEach(function(e){t[r].userNotice.push(e.value)})}})}),t}function s(e,t){switch(t.type){case 0:t.value.forEach(function(t){e.push(c.pki.GeneralName.toObject(t).value)});break;case 1:}}function o(e,t){t.value.forEach(function(t){switch(t.type){case 0:var r=[];s(r,t.value[0]),e.distributionPoint=r}})}function u(e,t){t.value.forEach(function(t){var r={};o(r,t),e.hasOwnProperty("distributionPoints")||(e.distributionPoints=[]),e.distributionPoints.push(r)})}var c=r(40);r(50),r(51),r(1);var p,l=r(55).JobPromise;c.pki||(c.pki={}),p=c.pki;var f=function(e,t){var r=this;this._cert=e,this.serialNumber=e.serialNumber,this.issuer=c.pki.DNToString(e.issuer),this.subject=c.pki.DNToString(e.subject),this.validity=e.validity,void 0!=t?this.publicKey=t:this.publicKey=new ytcrypto.crypto.key(e.publicKey,"public"),this.publicKeyParameter=e.publicKeyParameter,this.signature=e.signature,e.extensions&&(this.extensions={},e.extensions.forEach(function(e){var t={};switch(e.id){case c.oids.keyUsage:t.name="keyUsage",t.dataEncipherment=e.dataEncipherment,t.digitalSignature=e.digitalSignature,t.decipherOnly=e.decipherOnly,t.encipherOnly=e.encipherOnly,t.cRLSign=e.cRLSign,t.keyAgreement=e.keyAgreement,t.keyCertSign=e.keyCertSign,t.keyEncipherment=e.keyEncipherment,t.nonRepudiation=e.nonRepudiation;break;case c.oids.extKeyUsage:for(var s in e)"id"!==s&&"value"!==s&&"critical"!==s&&(t[s]=e[s]);break;case c.oids.basicConstraints:t.name="basicConstraints",e.hasOwnProperty("cA")&&(t.cA=e.cA),e.hasOwnProperty("pathLenConstraint")&&(t.pathLenConstraint=e.pathLenConstraint);break;case"2.5.29.32":var o;o=c._asn1.fromDer(e.value),t.name="certificatePolicies",t.policies=i(o);break;case c.oids.subjectAltName:t.name="subjectAltName",a(t,c._asn1.fromDer(e.value));break;case c.oids.subjectKeyIdentifier:t.name="subjectKeyIdentifier",t.subjectKeyIdentifier=e.subjectKeyIdentifier;break;case"2.5.29.35":t.name="authorityKeyIdentifier",n(t,c._asn1.fromDer(e.value));break;case"2.5.29.31":t.name="cRLDistributionPoints",u(t,c._asn1.fromDer(e.value));break;case"1.3.6.1.5.5.7.1.1":default:return!0}t.value=e.value,r.extensions[t.name]=t}))};f.prototype.verifySignature=function(e,t){var r,a={},n=null,i=c.oids[this._cert.signatureOid];if(i.indexOf("RSAEncryption")==-1)throw"not supported algorithm:"+i;i.indexOf("sha256")!=-1?n="SHA-256":i.indexOf("sha1")!=-1?n="SHA-1":i.indexOf("sha384")!=-1?n="SHA-384":i.indexOf("sha512")!=-1&&(n="SHA-512"),a.name="RSASSA-PKCS1-v1_5",a.hash={name:n},r=c._asn1.toDer(this._cert.tbsCertificate).bytes(),e.publicKey.verify(a,this.signature,r,t)},f.prototype.isCA=function(){return!(!this.extensions||!this.extensions.basicConstraints)&&!!this.extensions.basicConstraints.cA},f.prototype.isRoot=function(){return!(this.issuer!=this.subject||!this.isCA())&&(!this.extensions||!this.extensions.authorityKeyIdentifier)},f.prototype.generateChain=function(e,t){function r(e,t,a,n){var i=new l;t.forEach(function(t){t.subject==e.issuer&&0!=t.isCA()&&i.add(function(r){try{e.verifySignature(t,function(e){r({foundCert:t,result:e})})}catch(e){r(e)}})}),i.fail(function(e){a({error:new c.error(e),chain:n})}),i.then(function(i){for(var s=null,o=0;o<i.length;++o){var u=i[o];if(u.result){s=u.foundCert;break}}return null==s?void a({error:new c.error("not any more issuer cert:"+e.issuer),chain:n}):n.indexOf(s)!=-1?void a({error:null,chain:n}):(n.push(s),void r(s,t,a,n))})}var a=[];e=e.splice(0);var n=this;r(n,e,function(e){return e.error instanceof c.error?void t(e):(0==e.chain[e.chain.length-1].isRoot()&&(e.error=new c.error("root not found")),void t(e))},a)},f.prototype.toAsn1=function(){return c.asn1.fromRaw(c.pki.certificateToAsn1(this._cert))},f.fromRaw=function(e,t){return new f(e,t)},f.fromPem=function(e,t){return this.fromRaw(c.pki.certificateFromPem(e,!0,!0),t)},f.fromAsn1=function(e,t,r){var a,n;if(a=c.pki.certificateFromAsn1(e.getAsn1()),void 0===t)return f.fromRaw(a);var i;i=ytcrypto.pki.publicKeyToAsn1(a.publicKey),n=c._asn1.toDer(i).getBytes(),ytcrypto.crypto.key.fromBytes(n,function(e){t(f.fromRaw(a,e))},r,a.publicKey.oid)},f.fromBytes=function(e,t,r){return f.fromAsn1(c.asn1.fromDer(e),t,r)},f.fromDer=f.fromBytes,f.fromString=function(e,t,r){return f.fromAsn1(c.asn1.fromString(e),t,r)},p.Certificate=f;var d=function(e,t){this.obj={},this.obj.userAgreement=e,this.obj.userAgree={}};d.prototype.request=function(e){var t=null;switch(t=e.toLowerCase()){case"realname":this.obj.userAgree.realName=!0;break;case"gender":this.obj.userAgree.gender=!0;break;case"nationalinfo":this.obj.userAgree.nationalInfo=!0;break;case"birthdate":this.obj.userAgree.birthDate=!0;break;case"ci":this.obj.userAgree.ci=!0;break;default:throw new c.error("unknown field:"+t)}},d.prototype.toAsn1=function(e){return c.util.isUTF16String(this.obj.userAgreement)&&(this.obj.userAgreement=c.util.encodeUTF8(this.obj.userAgreement)),new c.asn1(c.kisa.PersonInfoReq.toAsn1(this.obj,e))},c.pki.PersonInfoReq=d;var h=function(e,t,r,a){if("undefined"==typeof e)throw"invalid input - personInfoReq";if("undefined"==typeof t)throw"invalid input - moduleInfo";if("undefined"==typeof r)throw"invalid input - ispURLInfo";this.obj={},this.obj.version=2,this.obj.nonce=ytcrypto.random.generate(20),this.obj.personInfoReq=e,this.obj.moduleInfo=t,this.obj.ispURLInfo=r};h.prototype.setNonce=function(e){this.obj.nonce=e},h.prototype.toAsn1=function(){return new c.asn1(c.kisa.UCPIDRequestInfo.toAsn1(this.obj))},c.pki.UCPIDRequestInfo=h,e.exports=c.pki},function(e,t,r){function a(e,t){"string"==typeof t&&(t={shortName:t});for(var r,a=null,n=0;null===a&&n<e.attributes.length;++n)r=e.attributes[n],t.type&&t.type===r.type?a=r:t.name&&t.name===r.name?a=r:t.shortName&&t.shortName===r.shortName&&(a=r);return a}function n(e){for(var t,r,a=l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[]),n=e.attributes,i=0;i<n.length;++i){t=n[i];var s=t.value,o=l.Type.PRINTABLESTRING;"valueTagClass"in t&&(o=t.valueTagClass,o===l.Type.UTF8&&(s=p.util.encodeUtf8(s))),r=l.create(l.Class.UNIVERSAL,l.Type.SET,!0,[l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[l.create(l.Class.UNIVERSAL,l.Type.OID,!1,l.oidToDer(t.type).getBytes()),l.create(l.Class.UNIVERSAL,o,!1,s)])]),a.value.push(r)}return a}function i(e){var t=l.create(l.Class.CONTEXT_SPECIFIC,3,!0,[]),r=l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[]);t.value.push(r);for(var a,n,i=0;i<e.length;++i){a=e[i],n=l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[]),r.value.push(n),n.value.push(l.create(l.Class.UNIVERSAL,l.Type.OID,!1,l.oidToDer(a.id).getBytes())),a.critical&&n.value.push(l.create(l.Class.UNIVERSAL,l.Type.BOOLEAN,!1,String.fromCharCode(255)));var s=a.value;"string"!=typeof a.value&&(s=l.toDer(s).getBytes()),n.value.push(l.create(l.Class.UNIVERSAL,l.Type.OCTETSTRING,!1,s))}return t}function s(e){for(var t,r=0;r<e.length;++r){if(t=e[r],"undefined"==typeof t.name&&(t.type&&t.type in f.oids?t.name=f.oids[t.type]:t.shortName&&t.shortName in h&&(t.name=f.oids[h[t.shortName]])),"undefined"==typeof t.type){if(!(t.name&&t.name in f.oids))throw{message:"Attribute type not specified.",attribute:t};t.type=f.oids[t.name]}if("undefined"==typeof t.shortName&&t.name&&t.name in h&&(t.shortName=h[t.name]),"undefined"==typeof t.value)throw{message:"Attribute value not specified.",attribute:t}}}function o(e,t){switch(e){case d["RSASSA-PSS"]:var r=[];return void 0!==t.hash.algorithmOid&&r.push(l.create(l.Class.CONTEXT_SPECIFIC,0,!0,[l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[l.create(l.Class.UNIVERSAL,l.Type.OID,!1,l.oidToDer(t.hash.algorithmOid).getBytes()),l.create(l.Class.UNIVERSAL,l.Type.NULL,!1,"")])])),void 0!==t.mgf.algorithmOid&&r.push(l.create(l.Class.CONTEXT_SPECIFIC,1,!0,[l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[l.create(l.Class.UNIVERSAL,l.Type.OID,!1,l.oidToDer(t.mgf.algorithmOid).getBytes()),l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[l.create(l.Class.UNIVERSAL,l.Type.OID,!1,l.oidToDer(t.mgf.hash.algorithmOid).getBytes()),l.create(l.Class.UNIVERSAL,l.Type.NULL,!1,"")])])])),void 0!==t.saltLength&&r.push(l.create(l.Class.CONTEXT_SPECIFIC,2,!0,[l.create(l.Class.UNIVERSAL,l.Type.INTEGER,!1,l.integerToDer(t.saltLength).getBytes())])),l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,r);default:return l.create(l.Class.UNIVERSAL,l.Type.NULL,!1,"")}}function u(e){var t=l.create(l.Class.CONTEXT_SPECIFIC,0,!0,[]);if(0===e.attributes.length)return t;for(var r=e.attributes,a=0;a<r.length;++a){var n=r[a],i=n.value,s=l.Type.UTF8;"valueTagClass"in n&&(s=n.valueTagClass),s===l.Type.UTF8&&(i=p.util.encodeUtf8(i));var o=l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[l.create(l.Class.UNIVERSAL,l.Type.OID,!1,l.oidToDer(n.type).getBytes()),l.create(l.Class.UNIVERSAL,l.Type.SET,!0,[l.create(l.Class.UNIVERSAL,s,!1,i)])]);t.value.push(o)}return t}var c=r(1),p=r(40);r(46),r(1);var l=p._asn1,f=p.pki=p.pki||{},d=f.oids,h={};h.CN=d.commonName,h.commonName="CN",h.C=d.countryName,h.countryName="C",h.L=d.localityName,h.localityName="L",h.ST=d.stateOrProvinceName,h.stateOrProvinceName="ST",h.O=d.organizationName,h.organizationName="O",h.OU=d.organizationalUnitName,h.organizationalUnitName="OU",h.serialNumber=d.serialNumber,h.serialNumber="serialNumber",h.dnQualifier=d.dnQualifier,h.dnQualifier="dnQualifier",h.DC=d.domainComponent,h.domainComponent="DC",h.E=d.emailAddress,h.emailAddress="E";var y=c.pki.publicKeyValidator,g={name:"Certificate",tagClass:l.Class.UNIVERSAL,type:l.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:l.Class.UNIVERSAL,type:l.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:l.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:l.Class.UNIVERSAL,type:l.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:l.Class.UNIVERSAL,type:l.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:l.Class.UNIVERSAL,type:l.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:l.Class.UNIVERSAL,type:l.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:l.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:l.Class.UNIVERSAL,type:l.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:l.Class.UNIVERSAL,type:l.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:l.Class.UNIVERSAL,type:l.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:l.Class.UNIVERSAL,type:l.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:l.Class.UNIVERSAL,type:l.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:l.Class.UNIVERSAL,type:l.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:l.Class.UNIVERSAL,type:l.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},y,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:l.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:l.Class.UNIVERSAL,type:l.Type.BITSTRING,constructed:!1,capture:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:l.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:l.Class.UNIVERSAL,type:l.Type.BITSTRING,constructed:!1,capture:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:l.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:l.Class.UNIVERSAL,type:l.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:l.Class.UNIVERSAL,type:l.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:l.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:l.Class.UNIVERSAL,type:l.Type.BITSTRING,constructed:!1,capture:"certSignature"}]},C={name:"rsapss",tagClass:l.Class.UNIVERSAL,type:l.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:l.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:l.Class.UNIVERSAL,type:l.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:l.Class.UNIVERSAL,type:l.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:l.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:l.Class.UNIVERSAL,type:l.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:l.Class.UNIVERSAL,type:l.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:l.Class.UNIVERSAL,type:l.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:l.Class.UNIVERSAL,type:l.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:l.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:l.Class.UNIVERSAL,type:l.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:l.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:l.Class.UNIVERSAL,type:l.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},v={name:"CertificationRequestInfo",tagClass:l.Class.UNIVERSAL,type:l.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:l.Class.UNIVERSAL,type:l.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:l.Class.UNIVERSAL,type:l.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},y,{name:"CertificationRequestInfo.attributes",tagClass:l.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:l.Class.UNIVERSAL,type:l.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:l.Class.UNIVERSAL,type:l.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:l.Class.UNIVERSAL,type:l.Type.SET,constructed:!0}]}]}]},m={name:"CertificationRequest",tagClass:l.Class.UNIVERSAL,type:l.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[v,{name:"CertificationRequest.signatureAlgorithm",tagClass:l.Class.UNIVERSAL,type:l.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:l.Class.UNIVERSAL,type:l.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:l.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:l.Class.UNIVERSAL,type:l.Type.BITSTRING,constructed:!1,capture:"csrSignature"}]};f.RDNAttributesAsArray=function(e,t){for(var r,a,n,i=[],s=0;s<e.value.length;++s){r=e.value[s];for(var o=0;o<r.value.length;++o)n={},a=r.value[o],n.type=l.derToOid(a.value[0].value),n.value=a.value[1].value,n.valueTagClass=a.value[1].type,n.type in d&&(n.name=d[n.type],n.name in h&&(n.shortName=h[n.name])),t&&(t.update(n.type),t.update(n.value)),12==n.valueTagClass&&(n.value=p.util.decodeUTF8(n.value)),n.rdnIndex=s,i.push(n)}return i},f.CRIAttributesAsArray=function(e){for(var t=[],r=0;r<e.length;++r)for(var a=e[r],n=l.derToOid(a.value[0].value),i=a.value[1].value,s=0;s<i.length;++s){var o={};o.type=n,o.value=i[s].value,o.valueTagClass=i[s].type,o.type in d&&(o.name=d[o.type],o.name in h&&(o.shortName=h[o.name])),t.push(o)}return t};var E=function(e){for(var t,r,a,n=[],i=0;i<e.value.length;++i){a=e.value[i];for(var s=0;s<a.value.length;++s){if(r=a.value[s],t={},t.id=l.derToOid(r.value[0].value),t.critical=!1,r.value[1].type===l.Type.BOOLEAN?(t.critical=0!==r.value[1].value.charCodeAt(0),t.value=r.value[2].value):t.value=r.value[1].value,t.id in d)if(t.name=d[t.id],"keyUsage"===t.name){var o=l.fromDer(t.value),u=0,c=0;o.value.length>1&&(u=o.value.charCodeAt(1),c=o.value.length>2?o.value.charCodeAt(2):0),t.digitalSignature=128===(128&u),t.nonRepudiation=64===(64&u),t.keyEncipherment=32===(32&u),t.dataEncipherment=16===(16&u),t.keyAgreement=8===(8&u),t.keyCertSign=4===(4&u),t.cRLSign=2===(2&u),t.encipherOnly=1===(1&u),t.decipherOnly=128===(128&c)}else if("basicConstraints"===t.name){var o=l.fromDer(t.value);o.value.length>0&&o.value[0].type===l.Type.BOOLEAN?t.cA=0!==o.value[0].value.charCodeAt(0):t.cA=!1;var f=null;o.value.length>0&&o.value[0].type===l.Type.INTEGER?f=o.value[0].value:o.value.length>1&&(f=o.value[1].value),null!==f&&(t.pathLenConstraint=l.derToInteger(f))}else if("extKeyUsage"===t.name)for(var o=l.fromDer(t.value),h=0;h<o.value.length;++h){var y=l.derToOid(o.value[h].value);y in d?t[d[y]]=!0:t[y]=!0}else if("nsCertType"===t.name){var o=l.fromDer(t.value),u=0;o.value.length>1&&(u=o.value.charCodeAt(1)),t.client=128===(128&u),t.server=64===(64&u),t.email=32===(32&u),t.objsign=16===(16&u),t.reserved=8===(8&u),t.sslCA=4===(4&u),t.emailCA=2===(2&u),t.objCA=1===(1&u)}else if("subjectAltName"===t.name||"issuerAltName"===t.name){t.altNames=[];for(var g,o=l.fromDer(t.value),C=0;C<o.value.length;++C){g=o.value[C];var v={type:g.type,value:g.value};switch(t.altNames.push(v),g.type){case 1:case 2:case 6:break;case 7:v.ip=p.util.bytesToIP(g.value);break;case 8:v.oid=l.derToOid(g.value)}}}else if("subjectKeyIdentifier"===t.name){var o=l.fromDer(t.value);t.subjectKeyIdentifier=p.util.bytesToHex(o.value)}n.push(t)}}return n},S=function(e,t,r){var a={};if(e!==d["RSASSA-PSS"])return a;r&&(a={hash:{algorithmOid:d.sha1},mgf:{algorithmOid:d.mgf1,hash:{algorithmOid:d.sha1}},saltLength:20});var n={},i=[];if(!l.validate(t,C,n,i))throw{message:"Cannot read RSASSA-PSS parameter block.",errors:i};return void 0!==n.hashOid&&(a.hash=a.hash||{},a.hash.algorithmOid=l.derToOid(n.hashOid)),void 0!==n.maskGenOid&&(a.mgf=a.mgf||{},a.mgf.algorithmOid=l.derToOid(n.maskGenOid),a.mgf.hash=a.mgf.hash||{},a.mgf.hash.algorithmOid=l.derToOid(n.maskGenHashOid)),void 0!==n.saltLength&&(a.saltLength=n.saltLength.charCodeAt(0)),a};f.certificateFromPem=function(e,t,r){var a=p.pem.decode(e)[0];if("CERTIFICATE"!==a.type&&"X509 CERTIFICATE"!==a.type&&"TRUSTED CERTIFICATE"!==a.type)throw{message:'Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".',headerType:a.type};if(a.procType&&"ENCRYPTED"===a.procType.type)throw{message:"Could not convert certificate from PEM; PEM is encrypted."};var n=l.fromDer(a.body,r);return f.certificateFromAsn1(n,t)},f.certificateToPem=function(e,t){var r={type:"CERTIFICATE",body:l.toDer(f.certificateToAsn1(e)).getBytes()};return p.pem.encode(r,{maxline:t})},f.publicKeyFromPem=function(e){var t=p.pem.decode(e)[0];if("PUBLIC KEY"!==t.type&&"RSA PUBLIC KEY"!==t.type)throw{message:'Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".',headerType:t.type};if(t.procType&&"ENCRYPTED"===t.procType.type)throw{message:"Could not convert public key from PEM; PEM is encrypted."};var r=l.fromDer(t.body);return c.pki.publicKeyFromAsn1(r)},f.publicKeyToPem=function(e,t){var r={type:"PUBLIC KEY",body:l.toDer(f.publicKeyToAsn1(e)).getBytes()};return p.pem.encode(r,{maxline:t})},f.publicKeyToRSAPublicKeyPem=function(e,t){var r={type:"RSA PUBLIC KEY",body:l.toDer(f.publicKeyToRSAPublicKey(e)).getBytes()};return p.pem.encode(r,{maxline:t})},f.certificationRequestFromPem=function(e,t,r){var a=p.pem.decode(e)[0];if("CERTIFICATE REQUEST"!==a.type)throw{message:'Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".',headerType:a.type};if(a.procType&&"ENCRYPTED"===a.procType.type)throw{message:"Could not convert certification request from PEM; PEM is encrypted."};var n=l.fromDer(a.body,r);return f.certificationRequestFromAsn1(n,t)},f.certificationRequestToPem=function(e,t){var r={type:"CERTIFICATE REQUEST",body:l.toDer(f.certificationRequestToAsn1(e)).getBytes()};return p.pem.encode(r,{maxline:t})},f.createCertificate=function(){var e={};return e.version=2,e.serialNumber="00",e.signatureOid=null,e.signature=null,e.siginfo={},e.siginfo.algorithmOid=null,e.validity={},e.validity.notBefore=new Date,e.validity.notAfter=new Date,e.issuer={},e.issuer.getField=function(t){return a(e.issuer,t)},e.issuer.addField=function(t){s([t]),e.issuer.attributes.push(t)},e.issuer.attributes=[],e.issuer.hash=null,e.subject={},e.subject.getField=function(t){return a(e.subject,t)},e.subject.addField=function(t){s([t]),e.subject.attributes.push(t)},e.subject.attributes=[],e.subject.hash=null,e.extensions=[],e.publicKey=null,e.md=null,e.setSubject=function(t,r){s(t),e.subject.attributes=t,delete e.subject.uniqueId,r&&(e.subject.uniqueId=r),e.subject.hash=null},e.setIssuer=function(t,r){s(t),e.issuer.attributes=t,delete e.issuer.uniqueId,r&&(e.issuer.uniqueId=r),e.issuer.hash=null},e.setExtensions=function(t){for(var r,a=0;a<t.length;++a){if(r=t[a],"undefined"==typeof r.name&&r.id&&r.id in f.oids&&(r.name=f.oids[r.id]),"undefined"==typeof r.id){if(!(r.name&&r.name in f.oids))throw{message:"Extension ID not specified.",extension:r};r.id=f.oids[r.name]}if("undefined"==typeof r.value){if("keyUsage"===r.name){var n=0,i=0,s=0;r.digitalSignature&&(i|=128,n=7),r.nonRepudiation&&(i|=64,n=6),r.keyEncipherment&&(i|=32,n=5),r.dataEncipherment&&(i|=16,n=4),r.keyAgreement&&(i|=8,n=3),r.keyCertSign&&(i|=4,n=2),r.cRLSign&&(i|=2,n=1),r.encipherOnly&&(i|=1,n=0),r.decipherOnly&&(s|=128,n=7);var o=String.fromCharCode(n);0!==s?o+=String.fromCharCode(i)+String.fromCharCode(s):0!==i&&(o+=String.fromCharCode(i)),r.value=l.create(l.Class.UNIVERSAL,l.Type.BITSTRING,!1,o)}else if("basicConstraints"===r.name)r.value=l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[]),r.cA&&r.value.value.push(l.create(l.Class.UNIVERSAL,l.Type.BOOLEAN,!1,String.fromCharCode(255))),"pathLenConstraint"in r&&r.value.value.push(l.create(l.Class.UNIVERSAL,l.Type.INTEGER,!1,l.integerToDer(r.pathLenConstraint).getBytes()));else if("extKeyUsage"===r.name){r.value=l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[]);var u=r.value.value;for(var c in r)r[c]===!0&&(c in d?u.push(l.create(l.Class.UNIVERSAL,l.Type.OID,!1,l.oidToDer(d[c]).getBytes())):c.indexOf(".")!==-1&&u.push(l.create(l.Class.UNIVERSAL,l.Type.OID,!1,l.oidToDer(c).getBytes())))}else if("nsCertType"===r.name){var n=0,i=0;r.client&&(i|=128,n=7),r.server&&(i|=64,n=6),r.email&&(i|=32,n=5),r.objsign&&(i|=16,n=4),r.reserved&&(i|=8,n=3),r.sslCA&&(i|=4,n=2),r.emailCA&&(i|=2,n=1),r.objCA&&(i|=1,n=0);var o=String.fromCharCode(n);0!==i&&(o+=String.fromCharCode(i)),r.value=l.create(l.Class.UNIVERSAL,l.Type.BITSTRING,!1,o)}else if("subjectAltName"===r.name||"issuerAltName"===r.name){r.value=l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[]);for(var h,y=0;y<r.altNames.length;++y){h=r.altNames[y];var o=h.value;if(7===h.type&&h.ip){if(o=p.util.bytesFromIP(h.ip),null===o)throw{message:'Extension "ip" value is not a valid IPv4 or IPv6 address.',extension:r}}else 8===h.type&&(o=h.oid?l.oidToDer(l.oidToDer(h.oid)):l.oidToDer(o));r.value.value.push(l.create(l.Class.CONTEXT_SPECIFIC,h.type,!1,o))}}else if("subjectKeyIdentifier"===r.name){var g=e.generateSubjectKeyIdentifier();r.subjectKeyIdentifier=g.toHex(),r.value=l.create(l.Class.UNIVERSAL,l.Type.OCTETSTRING,!1,g.getBytes())}if("undefined"==typeof r.value)throw{message:"Extension value not specified.",extension:r}}}e.extensions=t},e.getExtension=function(t){"string"==typeof t&&(t={name:t});for(var r,a=null,n=0;null===a&&n<e.extensions.length;++n)r=e.extensions[n],t.id&&r.id===t.id?a=r:t.name&&r.name===t.name&&(a=r);return a},e.sign=function(t,r){e.md=r||c.md.sha1.create();var a=d[e.md.algorithm+"WithRSAEncryption"];if(!a)throw{message:"Could not compute certificate digest. Unknown message digest algorithm OID.",algorithm:e.md.algorithm};e.signatureOid=e.siginfo.algorithmOid=a,e.tbsCertificate=f.getTBSCertificate(e);var n=l.toDer(e.tbsCertificate);e.md.update(n.getBytes()),e.signature=t.sign(e.md)},e.verify=function(t){var r=!1;if(!e.issued(t)){var a=t.issuer,n=e.subject;throw{message:"The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.",expectedIssuer:a.attributes,actualIssuer:n.attributes}}var i=t.md;if(null===i){if(t.signatureOid in d){var s=d[t.signatureOid];switch(s){case"sha1WithRSAEncryption":i=c.md.sha1.create();break;case"md5WithRSAEncryption":i=c.md.md5.create();break;case"sha256WithRSAEncryption":i=c.md.sha256.create();break;case"RSASSA-PSS":i=c.md.sha256.create()}}if(null===i)throw{message:"Could not compute certificate digest. Unknown signature OID.",signatureOid:t.signatureOid};var o=t.tbsCertificate||f.getTBSCertificate(t),u=l.toDer(o);i.update(u.getBytes())}if(null!==i){var h=void 0;switch(t.signatureOid){case d.sha1WithRSAEncryption:h=void 0;break;case d["RSASSA-PSS"]:var y,g;if(y=d[t.signatureParameters.mgf.hash.algorithmOid],void 0===y||void 0===c.md[y])throw{message:"Unsupported MGF hash function.",oid:t.signatureParameters.mgf.hash.algorithmOid,name:y};if(g=d[t.signatureParameters.mgf.algorithmOid],void 0===g||void 0===p.mgf[g])throw{message:"Unsupported MGF function.",oid:t.signatureParameters.mgf.algorithmOid,name:g};if(g=p.mgf[g].create(c.md[y].create()),y=d[t.signatureParameters.hash.algorithmOid],void 0===y||void 0===c.md[y])throw{message:"Unsupported RSASSA-PSS hash function.",oid:t.signatureParameters.hash.algorithmOid,name:y};h=c.pss.create(c.md[y].create(),g,t.signatureParameters.saltLength)}r=e.publicKey.verify(i.digest().getBytes(),t.signature,h)}return r},e.isIssuer=function(t){var r=!1,a=e.issuer,n=t.subject;if(a.hash&&n.hash)r=a.hash===n.hash;else if(a.attributes.length===n.attributes.length){r=!0;for(var i,s,o=0;r&&o<a.attributes.length;++o)i=a.attributes[o],s=n.attributes[o],i.type===s.type&&i.value===s.value||(r=!1)}return r},e.issued=function(t){return t.isIssuer(e)},e.generateSubjectKeyIdentifier=function(){var t=l.toDer(f.publicKeyToRSAPublicKey(e.publicKey)),r=c.md.sha1.create();return r.update(t.getBytes()),r.digest()},e.verifySubjectKeyIdentifier=function(){for(var t=d.subjectKeyIdentifier,r=0;r<e.extensions.length;++r){var a=e.extensions[r];if(a.id===t){var n=e.generateSubjectKeyIdentifier().getBytes();return p.util.hexToBytes(a.subjectKeyIdentifier)===n}}return!1},e},f.certificateFromAsn1=function(e,t){var r={},n=[];if(!l.validate(e,g,r,n))throw{message:"Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.",errors:n};if("string"!=typeof r.certSignature){for(var i="\0",o=0;o<r.certSignature.length;++o)i+=l.toDer(r.certSignature[o]).getBytes();r.certSignature=i}var u=f.createCertificate();u.version=r.certVersion?r.certVersion.charCodeAt(0):0;var h=p.util.createBuffer(r.certSerialNumber);u.serialNumber=h.toHex(),u.signatureOid=p._asn1.derToOid(r.certSignatureOid),u.signatureParameters=S(u.signatureOid,r.certSignatureParams,!0),u.siginfo.algorithmOid=p._asn1.derToOid(r.certinfoSignatureOid),u.siginfo.parameters=S(u.siginfo.algorithmOid,r.certinfoSignatureParams,!1);var y=p.util.createBuffer(r.certSignature);++y.read,u.signature=y.getBytes();var C=[];
if(void 0!==r.certValidity1UTCTime&&C.push(l.utcTimeToDate(r.certValidity1UTCTime)),void 0!==r.certValidity2GeneralizedTime&&C.push(l.generalizedTimeToDate(r.certValidity2GeneralizedTime)),void 0!==r.certValidity3UTCTime&&C.push(l.utcTimeToDate(r.certValidity3UTCTime)),void 0!==r.certValidity4GeneralizedTime&&C.push(l.generalizedTimeToDate(r.certValidity4GeneralizedTime)),C.length>2)throw{message:"Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate."};if(C.length<2)throw{message:"Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime."};if(u.validity.notBefore=C[0],u.validity.notAfter=C[1],u.tbsCertificate=r.tbsCertificate,t){if(u.md=null,u.signatureOid in d){var v=d[u.signatureOid];switch(v){case"sha1WithRSAEncryption":u.md=c.md.sha1.create();break;case"md5WithRSAEncryption":u.md=c.md.md5.create();break;case"sha256WithRSAEncryption":u.md=c.md.sha256.create();break;case"RSASSA-PSS":u.md=c.md.sha256.create()}}if(null===u.md)throw{message:"Could not compute certificate digest. Unknown signature OID.",signatureOid:u.signatureOid};var m=l.toDer(u.tbsCertificate);u.md.update(m.getBytes())}var I=c.md.sha1.create();u.issuer.getField=function(e){return a(u.issuer,e)},u.issuer.addField=function(e){s([e]),u.issuer.attributes.push(e)},u.issuer.attributes=f.RDNAttributesAsArray(r.certIssuer,I),r.certIssuerUniqueId&&(u.issuer.uniqueId=r.certIssuerUniqueId),u.issuer.hash=I.digest().toHex();var T=c.md.sha1.create();return u.subject.getField=function(e){return a(u.subject,e)},u.subject.addField=function(e){s([e]),u.subject.attributes.push(e)},u.subject.attributes=f.RDNAttributesAsArray(r.certSubject,T),r.certSubjectUniqueId&&(u.subject.uniqueId=r.certSubjectUniqueId),u.subject.hash=T.digest().toHex(),r.certExtensions?u.extensions=E(r.certExtensions):u.extensions=[],u.publicKey=c.pki.publicKeyFromAsn1(r.subjectPublicKeyInfo),u.publicKeyParameter=r.subjectPublicKeyInfo.value[0],u.publicKeyParameter.value.length>1?u.publicKeyParameter=c.asn1.toDer(u.publicKeyParameter.value[1]).bytes():delete u.publicKeyParameter,u},f.certificationRequestFromAsn1=function(e,t){var r={},n=[];if(!l.validate(e,m,r,n))throw{message:"Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.",errors:n};if("string"!=typeof r.csrSignature){for(var i="\0",o=0;o<r.csrSignature.length;++o)i+=l.toDer(r.csrSignature[o]).getBytes();r.csrSignature=i}var u=l.derToOid(r.publicKeyOid);if(u!==f.oids.rsaEncryption)throw{message:"Cannot read public key. OID is not RSA."};var h=f.createCertificationRequest();h.version=r.csrVersion?r.csrVersion.charCodeAt(0):0,h.signatureOid=p._asn1.derToOid(r.csrSignatureOid),h.signatureParameters=S(h.signatureOid,r.csrSignatureParams,!0),h.siginfo.algorithmOid=p._asn1.derToOid(r.csrSignatureOid),h.siginfo.parameters=S(h.siginfo.algorithmOid,r.csrSignatureParams,!1);var y=p.util.createBuffer(r.csrSignature);if(++y.read,h.signature=y.getBytes(),h.certificationRequestInfo=r.certificationRequestInfo,t){if(h.md=null,h.signatureOid in d){var u=d[h.signatureOid];switch(u){case"sha1WithRSAEncryption":h.md=c.md.sha1.create();break;case"md5WithRSAEncryption":h.md=c.md.md5.create();break;case"sha256WithRSAEncryption":h.md=c.md.sha256.create();break;case"RSASSA-PSS":h.md=c.md.sha256.create()}}if(null===h.md)throw{message:"Could not compute certification request digest. Unknown signature OID.",signatureOid:h.signatureOid};var g=l.toDer(h.certificationRequestInfo);h.md.update(g.getBytes())}var C=c.md.sha1.create();return h.subject.getField=function(e){return a(h.subject,e)},h.subject.addField=function(e){s([e]),h.subject.attributes.push(e)},h.subject.attributes=f.RDNAttributesAsArray(r.certificationRequestInfoSubject,C),h.subject.hash=C.digest().toHex(),h.publicKey=c.pki.publicKeyFromAsn1(r.subjectPublicKeyInfo),h.getAttribute=function(e){return a(h.attributes,e)},h.addAttribute=function(e){s([e]),h.attributes.push(e)},h.attributes=f.CRIAttributesAsArray(r.certificationRequestInfoAttributes||[]),h},f.createCertificationRequest=function(){var e={};return e.version=0,e.signatureOid=null,e.signature=null,e.siginfo={},e.siginfo.algorithmOid=null,e.subject={},e.subject.getField=function(t){return a(e.subject,t)},e.subject.addField=function(t){s([t]),e.subject.attributes.push(t)},e.subject.attributes=[],e.subject.hash=null,e.publicKey=null,e.attributes=[],e.getAttribute=function(t){return a(e.attributes,t)},e.addAttribute=function(t){s([t]),e.attributes.push(t)},e.md=null,e.setSubject=function(t){s(t),e.subject.attributes=t,e.subject.hash=null},e.setAttributes=function(t){s(t),e.attributes=t},e.sign=function(t,r){e.md=r||c.md.sha1.create();var a=d[e.md.algorithm+"WithRSAEncryption"];if(!a)throw{message:"Could not compute certification request digest. Unknown message digest algorithm OID.",algorithm:e.md.algorithm};e.signatureOid=e.siginfo.algorithmOid=a,e.certificationRequestInfo=f.getCertificationRequestInfo(e);var n=l.toDer(e.certificationRequestInfo);e.md.update(n.getBytes()),e.signature=t.sign(e.md)},e.verify=function(){var t=!1,r=e.md;if(null===r){if(e.signatureOid in d){var a=d[e.signatureOid];switch(a){case"sha1WithRSAEncryption":r=c.md.sha1.create();break;case"md5WithRSAEncryption":r=c.md.md5.create();break;case"sha256WithRSAEncryption":r=c.md.sha256.create();break;case"RSASSA-PSS":r=c.md.sha256.create()}}if(null===r)throw{message:"Could not compute certification request digest. Unknown signature OID.",signatureOid:e.signatureOid};var n=e.certificationRequestInfo||f.getCertificationRequestInfo(e),i=l.toDer(n);r.update(i.getBytes())}if(null!==r){var s;switch(e.signatureOid){case d.sha1WithRSAEncryption:break;case d["RSASSA-PSS"]:var o,u;if(o=d[e.signatureParameters.mgf.hash.algorithmOid],void 0===o||void 0===c.md[o])throw{message:"Unsupported MGF hash function.",oid:e.signatureParameters.mgf.hash.algorithmOid,name:o};if(u=d[e.signatureParameters.mgf.algorithmOid],void 0===u||void 0===p.mgf[u])throw{message:"Unsupported MGF function.",oid:e.signatureParameters.mgf.algorithmOid,name:u};if(u=p.mgf[u].create(c.md[o].create()),o=d[e.signatureParameters.hash.algorithmOid],void 0===o||void 0===c.md[o])throw{message:"Unsupported RSASSA-PSS hash function.",oid:e.signatureParameters.hash.algorithmOid,name:o};s=p.pss.create(c.md[o].create(),u,e.signatureParameters.saltLength)}t=e.publicKey.verify(r.digest().getBytes(),e.signature,s)}return t},e},f.getTBSCertificate=function(e){var t=l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[l.create(l.Class.CONTEXT_SPECIFIC,0,!0,[l.create(l.Class.UNIVERSAL,l.Type.INTEGER,!1,l.integerToDer(e.version).getBytes())]),l.create(l.Class.UNIVERSAL,l.Type.INTEGER,!1,p.util.hexToBytes(e.serialNumber)),l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[l.create(l.Class.UNIVERSAL,l.Type.OID,!1,l.oidToDer(e.siginfo.algorithmOid).getBytes()),o(e.siginfo.algorithmOid,e.siginfo.parameters)]),n(e.issuer),l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[l.create(l.Class.UNIVERSAL,l.Type.UTCTIME,!1,l.dateToUtcTime(e.validity.notBefore)),l.create(l.Class.UNIVERSAL,l.Type.UTCTIME,!1,l.dateToUtcTime(e.validity.notAfter))]),n(e.subject),f.publicKeyToAsn1(e.publicKey)]);return e.issuer.uniqueId&&t.value.push(l.create(l.Class.CONTEXT_SPECIFIC,1,!0,[l.create(l.Class.UNIVERSAL,l.Type.BITSTRING,!1,String.fromCharCode(0)+e.issuer.uniqueId)])),e.subject.uniqueId&&t.value.push(l.create(l.Class.CONTEXT_SPECIFIC,2,!0,[l.create(l.Class.UNIVERSAL,l.Type.BITSTRING,!1,String.fromCharCode(0)+e.subject.uniqueId)])),e.extensions.length>0&&t.value.push(i(e.extensions)),t},f.getCertificationRequestInfo=function(e){var t=l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[l.create(l.Class.UNIVERSAL,l.Type.INTEGER,!1,l.integerToDer(e.version).getBytes()),n(e.subject),f.publicKeyToAsn1(e.publicKey),u(e)]);return t},f.distinguishedNameToAsn1=function(e){return n(e)},f.certificateToAsn1=function(e){var t=e.tbsCertificate||f.getTBSCertificate(e);return l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[t,l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[l.create(l.Class.UNIVERSAL,l.Type.OID,!1,l.oidToDer(e.signatureOid).getBytes()),o(e.signatureOid,e.signatureParameters)]),l.create(l.Class.UNIVERSAL,l.Type.BITSTRING,!1,String.fromCharCode(0)+e.signature)])},f.certificationRequestToAsn1=function(e){var t=e.certificationRequestInfo||f.getCertificationRequestInfo(e);return l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[t,l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[l.create(l.Class.UNIVERSAL,l.Type.OID,!1,l.oidToDer(e.signatureOid).getBytes()),o(e.signatureOid,e.signatureParameters)]),l.create(l.Class.UNIVERSAL,l.Type.BITSTRING,!1,String.fromCharCode(0)+e.signature)])},f.createCaStore=function(e){var t={certs:{}};if(t.getIssuer=function(e){var r=null;if(!e.issuer.hash){var a=c.md.sha1.create();e.issuer.attributes=f.RDNAttributesAsArray(n(e.issuer),a),e.issuer.hash=a.digest().toHex()}if(e.issuer.hash in t.certs&&(r=t.certs[e.issuer.hash],p.util.isArray(r)))throw{message:"Resolving multiple issuer matches not implemented yet."};return r},t.addCertificate=function(e){if("string"==typeof e&&(e=p.pki.certificateFromPem(e)),!e.subject.hash){var r=c.md.sha1.create();e.subject.attributes=f.RDNAttributesAsArray(n(e.subject),r),e.subject.hash=r.digest().toHex()}if(e.subject.hash in t.certs){var a=t.certs[e.subject.hash];p.util.isArray(a)||(a=[a]),a.push(e)}else t.certs[e.subject.hash]=e},e)for(var r=0;r<e.length;++r){var a=e[r];t.addCertificate(a)}return t},f.certificateError={bad_certificate:"yt.pki.BadCertificate",unsupported_certificate:"yt.pki.UnsupportedCertificate",certificate_revoked:"yt.pki.CertificateRevoked",certificate_expired:"yt.pki.CertificateExpired",certificate_unknown:"yt.pki.CertificateUnknown",unknown_ca:"yt.pki.UnknownCertificateAuthority"},f.verifyCertificateChain=function(e,t,r){t=t.slice(0);var a=t.slice(0),n=new Date,i=!0,s=null,o=0,u=null;do{var c=t.shift();if(n<c.validity.notBefore||n>c.validity.notAfter)s={message:"Certificate is not valid yet or has expired.",error:f.certificateError.certificate_expired,notBefore:c.validity.notBefore,notAfter:c.validity.notAfter,now:n};else{var l=!1;if(t.length>0){u=t[0];try{l=u.verify(c)}catch(e){}}else{var d=e.getIssuer(c);if(null===d)s={message:"Certificate is not trusted.",error:f.certificateError.unknown_ca};else for(p.util.isArray(d)||(d=[d]);!l&&d.length>0;){u=d.shift();try{l=u.verify(c)}catch(e){}}}null!==s||l||(s={message:"Certificate signature is invalid.",error:f.certificateError.bad_certificate})}if(null!==s||c.isIssuer(u)||(s={message:"Certificate issuer is invalid.",error:f.certificateError.bad_certificate}),null===s)for(var h={keyUsage:!0,basicConstraints:!0},y=0;null===s&&y<c.extensions.length;++y){var g=c.extensions[y];!g.critical||g.name in h||(s={message:"Certificate has an unsupported critical extension.",error:f.certificateError.unsupported_certificate})}if(!i||0===t.length&&!u){var C=c.getExtension("basicConstraints"),v=c.getExtension("keyUsage");if(null!==v&&(v.keyCertSign&&null!==C||(s={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:f.certificateError.bad_certificate})),null!==s||null===C||C.cA||(s={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:f.certificateError.bad_certificate}),null===s&&null!==v&&"pathLenConstraint"in C){for(var m=0,y=1;y<t.length-1;++y)t[y].isIssuer(t[y])&&++m;var E=C.pathLenConstraint+1;t.length-m>E&&(s={message:"Certificate basicConstraints pathLenConstraint violated.",error:f.certificateError.bad_certificate})}}var S=null===s||s.error,I=r?r(S,o,a):S;if(I!==!0)throw S===!0&&(s={message:"The application rejected the certificate.",error:f.certificateError.bad_certificate}),(I||0===I)&&("object"!=typeof I||p.util.isArray(I)?"string"==typeof I&&(s.error=I):(I.message&&(s.message=I.message),I.error&&(s.error=I.error))),s;s=null,i=!1,++o}while(t.length>0);return!0},e.exports=f},function(e,t,r){var a=r(40);r(42),r(46),r(52),r(47),r(53),r(54),r(44),r(50);var n=a._asn1,i=a.pki=a.pki||{};i.pemToDer=function(e){var t=a.pem.decode(e)[0];if(t.procType&&"ENCRYPTED"===t.procType.type)throw{message:"Could not convert PEM to DER; PEM is encrypted."};return a.util.createBuffer(t.body)},i.privateKeyFromPem=function(e){var t=a.pem.decode(e)[0];if("PRIVATE KEY"!==t.type&&"RSA PRIVATE KEY"!==t.type)throw{message:'Could not convert private key from PEM; PEM header type is not "PRIVATE KEY" or "RSA PRIVATE KEY".',headerType:t.type};if(t.procType&&"ENCRYPTED"===t.procType.type)throw{message:"Could not convert private key from PEM; PEM is encrypted."};var r=n.fromDer(t.body);return i.privateKeyFromAsn1(r)},i.privateKeyToPem=function(e,t){var r={type:"RSA PRIVATE KEY",body:n.toDer(i.privateKeyToAsn1(e)).getBytes()};return a.pem.encode(r,{maxline:t})},i.privateKeyInfoToPem=function(e,t){var r={type:"PRIVATE KEY",body:n.toDer(e).getBytes()};return a.pem.encode(r,{maxline:t})}},function(e,t,r){function a(e,t,r){for(var a=[n(e+t)],i=16,s=1;i<r;++s,i+=16)a.push(n(a[s-1]+e+t));return a.join("").substr(0,r)}function n(e){return i.md.md5.create().update(e).digest().getBytes()}var i=r(1),s=r(40);if("undefined"==typeof o)var o=i.jsbn.BigInteger;var u=s._asn1,c=s.pki=s.pki||{};c.pbe=s.pbe=s.pbe||{};var p=c.oids,l={name:"EncryptedPrivateKeyInfo",tagClass:u.Class.UNIVERSAL,type:u.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:u.Class.UNIVERSAL,type:u.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:u.Class.UNIVERSAL,type:u.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:u.Class.UNIVERSAL,type:u.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:u.Class.UNIVERSAL,type:u.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},f={name:"PBES2Algorithms",tagClass:u.Class.UNIVERSAL,type:u.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:u.Class.UNIVERSAL,type:u.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:u.Class.UNIVERSAL,type:u.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:u.Class.UNIVERSAL,type:u.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:u.Class.UNIVERSAL,type:u.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:u.Class.UNIVERSAL,type:u.Type.INTEGER,onstructed:!0,capture:"kdfIterationCount"}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:u.Class.UNIVERSAL,type:u.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:u.Class.UNIVERSAL,type:u.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:u.Class.UNIVERSAL,type:u.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},d={name:"pkcs-12PbeParams",tagClass:u.Class.UNIVERSAL,type:u.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:u.Class.UNIVERSAL,type:u.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:u.Class.UNIVERSAL,type:u.Type.INTEGER,constructed:!1,capture:"iterations"}]};c.encryptPrivateKeyInfo=function(e,t,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128";var a,n,o,l=i.random.getBytesSync(r.saltSize),f=r.count,d=u.integerToDer(f);if(0===r.algorithm.indexOf("aes")||"des"===r.algorithm||0===r.algorithm.indexOf("aria")||"seed"===r.algorithm){var h,y,g;switch(r.algorithm){case"aes128":a=16,h=16,y=p["aes128-CBC"],g=i.aes.createEncryptionCipher;break;case"aes192":a=24,h=16,y=p["aes192-CBC"],g=i.aes.createEncryptionCipher;break;case"aes256":a=32,h=16,y=p["aes256-CBC"],g=i.aes.createEncryptionCipher;break;case"des":a=8,h=8,y=p.desCBC,g=i.des.createEncryptionCipher;break;case"seed":a=16,h=16,y=p.seedCBC,g=i.aria.createEncryptionCipher;break;case"aria":case"aria128":a=16,h=16,y=p["aria128-CBC"],g=i.aria.createEncryptionCipher;break;default:throw{message:"Cannot encrypt private key. Unknown encryption algorithm.",algorithm:r.algorithm}}var C=s.pkcs5.pbkdf2(t,l,f,a),v=i.random.getBytesSync(h),m=g(C);m.start(v),m.update(u.toDer(e)),m.finish(),o=m.output.getBytes(),n=u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,!0,[u.create(u.Class.UNIVERSAL,u.Type.OID,!1,u.oidToDer(p.pkcs5PBES2).getBytes()),u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,!0,[u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,!0,[u.create(u.Class.UNIVERSAL,u.Type.OID,!1,u.oidToDer(p.pkcs5PBKDF2).getBytes()),u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,!0,[u.create(u.Class.UNIVERSAL,u.Type.OCTETSTRING,!1,l),u.create(u.Class.UNIVERSAL,u.Type.INTEGER,!1,d.getBytes())])]),u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,!0,[u.create(u.Class.UNIVERSAL,u.Type.OID,!1,u.oidToDer(y).getBytes()),u.create(u.Class.UNIVERSAL,u.Type.OCTETSTRING,!1,v)])])])}else{if("3des"!==r.algorithm)throw{message:"Cannot encrypt private key. Unknown encryption algorithm.",algorithm:r.algorithm};a=24;var E=new s.util.ByteBuffer(l),C=c.pbe.generatePkcs12Key(t,E,1,f,a),v=c.pbe.generatePkcs12Key(t,E,2,f,a),m=i.des.createEncryptionCipher(C);m.start(v),m.update(u.toDer(e)),m.finish(),o=m.output.getBytes(),n=u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,!0,[u.create(u.Class.UNIVERSAL,u.Type.OID,!1,u.oidToDer(p["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,!0,[u.create(u.Class.UNIVERSAL,u.Type.OCTETSTRING,!1,l),u.create(u.Class.UNIVERSAL,u.Type.INTEGER,!1,d.getBytes())])])}var S=u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,!0,[n,u.create(u.Class.UNIVERSAL,u.Type.OCTETSTRING,!1,o)]);return S},c.decryptPrivateKeyInfo=function(e,t){var r=null,a={},n=[];if(!u.validate(e,l,a,n))throw{message:"Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.",errors:n};var i=u.derToOid(a.encryptionOid),o=c.pbe.getCipher(i,a.encryptionParams,t),p=s.util.createBuffer(a.encryptedData);return o.update(p),o.finish()&&(r=u.fromDer(o.output)),r},c.encryptedPrivateKeyToPem=function(e,t){var r={type:"ENCRYPTED PRIVATE KEY",body:u.toDer(e).getBytes()};return s.pem.encode(r,{maxline:t})},c.encryptedPrivateKeyFromPem=function(e){var t=s.pem.decode(e)[0];if("ENCRYPTED PRIVATE KEY"!==t.type)throw{message:'Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".',headerType:t.type};if(t.procType&&"ENCRYPTED"===t.procType.type)throw{message:"Could not convert encrypted private key from PEM; PEM is encrypted."};return u.fromDer(t.body)},c.encryptRsaPrivateKey=function(e,t,r){if(r=r||{},!r.legacy){var n=c.wrapRsaPrivateKey(c.privateKeyToAsn1(e));return n=c.encryptPrivateKeyInfo(n,t,r),c.encryptedPrivateKeyToPem(n)}var o,p,l,f;switch(r.algorithm){case"aes128":o="AES-128-CBC",l=16,p=i.random.getBytesSync(16),f=i.aes.createEncryptionCipher;break;case"aes192":o="AES-192-CBC",l=24,p=i.random.getBytesSync(16),f=i.aes.createEncryptionCipher;break;case"aes256":o="AES-256-CBC",l=32,p=i.random.getBytesSync(16),f=i.aes.createEncryptionCipher;break;case"3des":o="DES-EDE3-CBC",l=24,p=i.random.getBytesSync(8),f=i.des.createEncryptionCipher;break;case"des":o="DES-CBC",l=8,p=i.random.getBytesSync(8),f=i.des.createEncryptionCipher;break;default:throw{message:'Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".',algorithm:r.algorithm}}var d=a(t,p.substr(0,8),l),h=f(d);h.start(p),h.update(u.toDer(c.privateKeyToAsn1(e))),h.finish();var y={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:o,parameters:s.util.bytesToHex(p).toUpperCase()},body:h.output.getBytes()};return s.pem.encode(y)},c.decryptRsaPrivateKey=function(e,t){var r=null,n=s.pem.decode(e)[0];if("ENCRYPTED PRIVATE KEY"!==n.type&&"PRIVATE KEY"!==n.type&&"RSA PRIVATE KEY"!==n.type)throw{message:'Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".',headerType:n.type};if(n.procType&&"ENCRYPTED"===n.procType.type){var o,p;switch(n.dekInfo.algorithm){case"DES-CBC":o=8,p=i.des.createDecryptionCipher;break;case"DES-EDE3-CBC":o=24,p=i.des.createDecryptionCipher;break;case"AES-128-CBC":o=16,p=i.aes.createDecryptionCipher;break;case"AES-192-CBC":o=24,p=i.aes.createDecryptionCipher;break;case"AES-256-CBC":o=32,p=i.aes.createDecryptionCipher;break;case"RC2-40-CBC":o=5,p=function(e){return i.rc2.createDecryptionCipher(e,40)};break;case"RC2-64-CBC":o=8,p=function(e){return i.rc2.createDecryptionCipher(e,64)};break;case"RC2-128-CBC":o=16,p=function(e){return i.rc2.createDecryptionCipher(e,128)};break;default:throw{message:'Could not decrypt private key; unsupported encryption algorithm "'+n.dekInfo.algorithm+'".',algorithm:n.dekInfo.algorithm}}var l=s.util.hexToBytes(n.dekInfo.parameters),f=a(t,l.substr(0,8),o),d=p(f);if(d.start(l),d.update(s.util.createBuffer(n.body)),!d.finish())return r;r=d.output.getBytes()}else r=n.body;return r="ENCRYPTED PRIVATE KEY"===n.type?c.decryptPrivateKeyInfo(u.fromDer(r),t):u.fromDer(r),null!==r&&(r=c.privateKeyFromAsn1(r)),r},c.pbe.generatePkcs12Key=function(e,t,r,a,n,o){var u,c;"undefined"!=typeof o&&null!==o||(o=i.md.sha1.create());var p=o.digestLength,l=o.blockLength,f=new s.util.ByteBuffer,d=new s.util.ByteBuffer;for(c=0;c<e.length;c++)d.putInt16(e.charCodeAt(c));d.putInt16(0);var h=d.length(),y=t.length(),g=new s.util.ByteBuffer;g.fillWithByte(r,l);var C=l*Math.ceil(y/l),v=new s.util.ByteBuffer;for(c=0;c<C;c++)v.putByte(t.at(c%y));var m=l*Math.ceil(h/l),E=new s.util.ByteBuffer;for(c=0;c<m;c++)E.putByte(d.at(c%h));var S=v;S.putBuffer(E);for(var I=Math.ceil(n/p),T=1;T<=I;T++){var A=new s.util.ByteBuffer;A.putBytes(g.bytes()),A.putBytes(S.bytes());for(var b=0;b<a;b++)o.start(),o.update(A.getBytes()),A=o.digest();var F=new s.util.ByteBuffer;for(c=0;c<l;c++)F.putByte(A.at(c%p));var B=Math.ceil(y/l)+Math.ceil(h/l),N=new s.util.ByteBuffer;for(u=0;u<B;u++){var R=new s.util.ByteBuffer(S.getBytes(l)),w=511;for(c=F.length()-1;c>=0;c--)w>>=8,w+=F.at(c)+R.at(c),R.setAt(c,255&w);N.putBuffer(R)}S=N,f.putBuffer(A)}return f.truncate(f.length()-n),f},c.pbe.getCipher=function(e,t,r){switch(e){case c.oids.pkcs5PBES2:return c.pbe.getCipherForPBES2(e,t,r);case c.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case c.oids["pbewithSHAAnd40BitRC2-CBC"]:return c.pbe.getCipherForPKCS12PBE(e,t,r);default:throw{message:"Cannot read encrypted PBE data block. Unsupported OID.",oid:e,supportedOids:["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"]}}},c.pbe.getCipherForPBES2=function(e,t,r){var a={},n=[];if(!u.validate(t,f,a,n))throw{message:"Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.",errors:n};if(e=u.derToOid(a.kdfOid),e!==c.oids.pkcs5PBKDF2)throw{message:"Cannot read encrypted private key. Unsupported key derivation function OID.",oid:e,supportedOids:["pkcs5PBKDF2"]};if(e=u.derToOid(a.encOid),e!==c.oids["aes128-CBC"]&&e!==c.oids["aes192-CBC"]&&e!==c.oids["aes256-CBC"]&&e!==c.oids["aria128-CBC"]&&e!==c.oids["aria192-CBC"]&&e!==c.oids["aria256-CBC"]&&e!==c.oids["des-EDE3-CBC"]&&e!==c.oids.desCBC)throw{message:"Cannot read encrypted private key. Unsupported encryption scheme OID.",oid:e,supportedOids:["aes128-CBC","aes192-CBC","aes256-CBC","aria128-CBC","aria192-CBC","aria256-CBC","des-EDE3-CBC","desCBC"]};var o=a.kdfSalt,p=s.util.createBuffer(a.kdfIterationCount);p=p.getInt(p.length()<<3);var l,d;switch(c.oids[e]){case"aes128-CBC":l=16,d=i.aes.createDecryptionCipher;break;case"aes192-CBC":l=24,d=i.aes.createDecryptionCipher;break;case"aes256-CBC":l=32,d=i.aes.createDecryptionCipher;break;case"aria128-CBC":l=16,d=i.aria.createDecryptionCipher;break;case"aria192-CBC":l=24,d=i.aria.createDecryptionCipher;break;case"aria256-CBC":l=32,d=i.aria.createDecryptionCipher;break;case"des-EDE3-CBC":l=24,d=i.des.createDecryptionCipher;break;case"desCBC":l=8,d=i.des.createDecryptionCipher}var h=s.pkcs5.pbkdf2(r,o,p,l),y=a.encIv,g=d(h);return g.start(y),g},c.pbe.getCipherForPKCS12PBE=function(e,t,r){var a={},n=[];if(!u.validate(t,d,a,n))throw{message:"Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.",errors:n};var o=s.util.createBuffer(a.salt),p=s.util.createBuffer(a.iterations);p=p.getInt(p.length()<<3);var l,f,h;switch(e){case c.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:l=24,f=8,h=i.des.startDecrypting;break;case c.oids["pbewithSHAAnd40BitRC2-CBC"]:l=5,f=8,h=function(e,t){var r=i.rc2.createDecryptionCipher(e,40);return r.start(t,null),r};break;default:throw{message:"Cannot read PKCS #12 PBE data block. Unsupported OID.",oid:e}}var y=c.pbe.generatePkcs12Key(r,o,1,p,l),g=c.pbe.generatePkcs12Key(r,o,2,p,f);return h(y,g)},e.exports=s.pbe},function(e,t,r){var a=r(40),n=a.pkcs5=a.pkcs5||{};a.pbkdf2=n.pbkdf2=function(e,t,r,n,i){"undefined"!=typeof i&&null!==i||(i=ytcrypto.md.sha1.create());var s=i.digestLength;if(n>4294967295*s)throw{message:"Derived key is too long."};var o=Math.ceil(n/s),u=n-(o-1)*s,c=ytcrypto.hmac.create();c.start(i,e);for(var p,l,f,d="",h=1;h<=o;++h){c.start(null,null),c.update(t),c.update(a.util.int32ToBytes(h)),p=f=c.digest().getBytes();for(var y=2;y<=r;++y)c.start(null,null),c.update(f),l=c.digest().getBytes(),p=a.util.xorBytes(p,l,s),f=l;d+=h<o?p:p.substr(0,u)}return d},e.exports=a.pbkdf2},function(e,t,r){function a(e,t,r,a){for(var n=[],i=0;i<e.length;i++)for(var s=0;s<e[i].safeBags.length;s++){var o=e[i].safeBags[s];void 0!==a&&o.type!==a||void 0!==o.attributes[t]&&o.attributes[t].indexOf(r)>=0&&n.push(o)}return n}function n(e,t,r,a){if(t=c.fromDer(t,r),t.tagClass!==c.Class.UNIVERSAL||t.type!==c.Type.SEQUENCE||t.constructed!==!0)throw{message:"PKCS#12 AuthenticatedSafe expected to be a SEQUENCE OF ContentInfo"};for(var n=0;n<t.value.length;n++){var o=t.value[n],u={},l=[];if(!c.validate(o,f,u,l))throw{message:"Cannot read ContentInfo.",errors:l};var d={encrypted:!1},h=null,y=u.content.value[0];switch(c.derToOid(u.contentType)){case p.oids.data:if(y.tagClass!==c.Class.UNIVERSAL||y.type!==c.Type.OCTETSTRING)throw{message:"PKCS#12 SafeContents Data is not an OCTET STRING."};h=y.value;break;case p.oids.encryptedData:if(void 0===a)throw{message:"Found PKCS#12 Encrypted SafeContents Data but no password available."};h=i(y,a),d.encrypted=!0;break;default:throw{message:"Unsupported PKCS#12 contentType.",contentType:c.derToOid(u.contentType)}}d.safeBags=s(h,r,a),e.safeContents.push(d)}}function i(e,t){var r={},a=[];if(!c.validate(e,u.pkcs7.asn1.encryptedDataValidator,r,a))throw{message:"Cannot read EncryptedContentInfo. ",errors:a};var n=c.derToOid(r.contentType);if(n!==p.oids.data)throw{message:"PKCS#12 EncryptedContentInfo ContentType is not Data.",oid:n};n=c.derToOid(r.encAlgorithm);var i=p.pbe.getCipher(n,r.encParameter,t),s=u.util.createBuffer(r.encryptedContent);if(i.update(s),!i.finish())throw{message:"Failed to decrypt PKCS#12 SafeContents."};return i.output.getBytes()}function s(e,t,r){if(e=c.fromDer(e,t),e.tagClass!==c.Class.UNIVERSAL||e.type!==c.Type.SEQUENCE||e.constructed!==!0)throw{message:"PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag"};for(var a=[],n=0;n<e.value.length;n++){var i=e.value[n],s={},u=[];if(!c.validate(i,h,s,u))throw{message:"Cannot read SafeBag.",errors:u};var l={type:c.derToOid(s.bagId),attributes:o(s.bagAttributes)};a.push(l);var f,d,y=s.bagValue.value[0];switch(l.type){case p.oids.pkcs8ShroudedKeyBag:if(void 0===r)throw{message:"Found PKCS#8 ShroudedKeyBag but no password available."};if(y=p.decryptPrivateKeyInfo(y,r),null===y)throw{message:"Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?"};case p.oids.keyBag:l.key=p.privateKeyFromAsn1(y);continue;case p.oids.certBag:f=g,d=function(){if(c.derToOid(s.certId)!==p.oids.x509Certificate)throw{message:"Unsupported certificate type, only X.509 supported.",oid:c.derToOid(s.certId)};l.cert=p.certificateFromAsn1(c.fromDer(s.cert,t),!0)};break;default:throw{message:"Unsupported PKCS#12 SafeBag type.",oid:l.type}}if(void 0!==f&&!c.validate(y,f,s,u))throw{message:"Cannot read PKCS#12 "+f.name,errors:u};d()}return a}function o(e){var t={};if(void 0!==e)for(var r=0;r<e.length;++r){var a={},n=[];if(!c.validate(e[r],y,a,n))throw{message:"Cannot read PKCS#12 BagAttribute.",errors:n};var i=c.derToOid(a.oid);if(void 0!==p.oids[i]){t[p.oids[i]]=[];for(var s=0;s<a.values.length;++s)t[p.oids[i]].push(a.values[s].value)}}return t}var u=r(40),c=u._asn1,p=u.pki,l=u.pkcs12=u.pkcs12||{},f={name:"ContentInfo",tagClass:c.Class.UNIVERSAL,type:c.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.contentType",tagClass:c.Class.UNIVERSAL,type:c.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:c.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"content"}]},d={name:"PFX",tagClass:c.Class.UNIVERSAL,type:c.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.version",tagClass:c.Class.UNIVERSAL,type:c.Type.INTEGER,constructed:!1,capture:"version"},f,{name:"PFX.macData",tagClass:c.Class.UNIVERSAL,type:c.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"mac",value:[{name:"PFX.macData.mac",tagClass:c.Class.UNIVERSAL,type:c.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm",tagClass:c.Class.UNIVERSAL,type:c.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm.algorithm",tagClass:c.Class.UNIVERSAL,type:c.Type.OID,constructed:!1,capture:"macAlgorithm"},{name:"PFX.macData.mac.digestAlgorithm.parameters",tagClass:c.Class.UNIVERSAL,captureAsn1:"macAlgorithmParameters"}]},{name:"PFX.macData.mac.digest",tagClass:c.Class.UNIVERSAL,type:c.Type.OCTETSTRING,constructed:!1,capture:"macDigest"}]},{name:"PFX.macData.macSalt",tagClass:c.Class.UNIVERSAL,type:c.Type.OCTETSTRING,constructed:!1,capture:"macSalt"},{name:"PFX.macData.iterations",tagClass:c.Class.UNIVERSAL,type:c.Type.INTEGER,constructed:!1,optional:!0,capture:"macIterations"}]}]},h={name:"SafeBag",tagClass:c.Class.UNIVERSAL,type:c.Type.SEQUENCE,constructed:!0,value:[{name:"SafeBag.bagId",tagClass:c.Class.UNIVERSAL,type:c.Type.OID,constructed:!1,capture:"bagId"},{name:"SafeBag.bagValue",tagClass:c.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"bagValue"},{name:"SafeBag.bagAttributes",tagClass:c.Class.UNIVERSAL,type:c.Type.SET,constructed:!0,optional:!0,capture:"bagAttributes"}]},y={name:"Attribute",tagClass:c.Class.UNIVERSAL,type:c.Type.SEQUENCE,constructed:!0,value:[{name:"Attribute.attrId",tagClass:c.Class.UNIVERSAL,type:c.Type.OID,constructed:!1,capture:"oid"},{name:"Attribute.attrValues",tagClass:c.Class.UNIVERSAL,type:c.Type.SET,constructed:!0,capture:"values"}]},g={name:"CertBag",tagClass:c.Class.UNIVERSAL,type:c.Type.SEQUENCE,constructed:!0,value:[{name:"CertBag.certId",tagClass:c.Class.UNIVERSAL,type:c.Type.OID,constructed:!1,capture:"certId"},{name:"CertBag.certValue",tagClass:c.Class.CONTEXT_SPECIFIC,constructed:!0,value:[{name:"CertBag.certValue[0]",tagClass:c.Class.UNIVERSAL,type:c.Class.OCTETSTRING,constructed:!1,capture:"cert"}]}]};l.pkcs12FromAsn1=function(e,t,r){"string"==typeof t?(r=t,t=!0):void 0===t&&(t=!0);var i={},s=[];if(!c.validate(e,d,i,s))throw{message:"Cannot read PKCS#12 PFX. ASN.1 object is not an PKCS#12 PFX.",errors:s};var o={version:i.version.charCodeAt(0),safeContents:[],getBags:function(e){var t,r={};return"localKeyId"in e?t=e.localKeyId:"localKeyIdHex"in e&&(t=u.util.hexToBytes(e.localKeyIdHex)),void 0!==t&&(r.localKeyId=a(o.safeContents,"localKeyId",t,e.bagType)),"friendlyName"in e&&(r.friendlyName=a(o.safeContents,"friendlyName",e.friendlyName,e.bagType)),r},getBagsByFriendlyName:function(e,t){return a(o.safeContents,"friendlyName",e,t)},getBagsByLocalKeyId:function(e,t){return a(o.safeContents,"localKeyId",e,t)}};if(3!==i.version.charCodeAt(0))throw{message:"PKCS#12 PFX of version other than 3 not supported.",
version:i.version.charCodeAt(0)};if(c.derToOid(i.contentType)!==p.oids.data)throw{message:"Only PKCS#12 PFX in password integrity mode supported.",oid:c.derToOid(i.contentType)};var f=i.content.value[0];if(f.tagClass!==c.Class.UNIVERSAL||f.type!==c.Type.OCTETSTRING)throw{message:"PKCS#12 authSafe content data is not an OCTET STRING."};if(i.mac){var h=null,y=0,g=c.derToOid(i.macAlgorithm);switch(g){case p.oids.sha1:h=ytcrypto.md.sha1.create(),y=20;break;case p.oids.sha256:h=ytcrypto.md.sha256.create(),y=32;break;case p.oids.sha384:h=ytcrypto.md.sha384.create(),y=48;break;case p.oids.sha512:h=ytcrypto.md.sha512.create(),y=64;break;case p.oids.md5:h=ytcrypto.md.md5.create(),y=16}if(null===h)throw{message:"PKCS#12 uses unsupported MAC algorithm: "+g};var C=new u.util.ByteBuffer(i.macSalt),v="macIterations"in i?parseInt(u.util.bytesToHex(i.macIterations),16):1,m=l.generateKey(r||"",C,3,v,y,h),E=u.hmac.create();E.start(h,m),E.update(f.value);var S=E.getMac();if(S.getBytes()!==i.macDigest)throw{message:"PKCS#12 MAC could not be verified. Invalid password?"}}return n(o,f.value,t,r),o},l.toPkcs12Asn1=function(e,t,r,a){a=a||{},a.saltSize=a.saltSize||8,a.count=a.count||2048,a.algorithm=a.algorithm||a.encAlgorithm||"aes128","useMac"in a||(a.useMac=!0),"localKeyId"in a||(a.localKeyId=null),"generateLocalKeyId"in a||(a.generateLocalKeyId=!0);var n,i=a.localKeyId;if(null!==i)i=u.util.hexToBytes(i);else if(a.generateLocalKeyId)if(t){var s=u.util.isArray(t)?t[0]:t;"string"==typeof s&&(s=p.certificateFromPem(s));var o=ytcrypto.md.sha1.create();o.update(c.toDer(p.certificateToAsn1(s)).getBytes()),i=o.digest().getBytes()}else i=ytcrypto.random.getBytes(20);var f=[];null!==i&&f.push(c.create(c.Class.UNIVERSAL,c.Type.SEQUENCE,!0,[c.create(c.Class.UNIVERSAL,c.Type.OID,!1,c.oidToDer(p.oids.localKeyId).getBytes()),c.create(c.Class.UNIVERSAL,c.Type.SET,!0,[c.create(c.Class.UNIVERSAL,c.Type.OCTETSTRING,!1,i)])])),"friendlyName"in a&&f.push(c.create(c.Class.UNIVERSAL,c.Type.SEQUENCE,!0,[c.create(c.Class.UNIVERSAL,c.Type.OID,!1,c.oidToDer(p.oids.friendlyName).getBytes()),c.create(c.Class.UNIVERSAL,c.Type.SET,!0,[c.create(c.Class.UNIVERSAL,c.Type.BMPSTRING,!1,a.friendlyName)])])),f.length>0&&(n=c.create(c.Class.UNIVERSAL,c.Type.SET,!0,f));var d=[],h=[];null!==t&&(h=u.util.isArray(t)?t:[t]);for(var y=[],g=0;g<h.length;++g){t=h[g],"string"==typeof t&&(t=p.certificateFromPem(t));var C=0===g?n:void 0,v=p.certificateToAsn1(t),m=c.create(c.Class.UNIVERSAL,c.Type.SEQUENCE,!0,[c.create(c.Class.UNIVERSAL,c.Type.OID,!1,c.oidToDer(p.oids.certBag).getBytes()),c.create(c.Class.CONTEXT_SPECIFIC,0,!0,[c.create(c.Class.UNIVERSAL,c.Type.SEQUENCE,!0,[c.create(c.Class.UNIVERSAL,c.Type.OID,!1,c.oidToDer(p.oids.x509Certificate).getBytes()),c.create(c.Class.CONTEXT_SPECIFIC,0,!0,[c.create(c.Class.UNIVERSAL,c.Type.OCTETSTRING,!1,c.toDer(v).getBytes())])])]),C]);y.push(m)}if(y.length>0){var E=c.create(c.Class.UNIVERSAL,c.Type.SEQUENCE,!0,y),S=c.create(c.Class.UNIVERSAL,c.Type.SEQUENCE,!0,[c.create(c.Class.UNIVERSAL,c.Type.OID,!1,c.oidToDer(p.oids.data).getBytes()),c.create(c.Class.CONTEXT_SPECIFIC,0,!0,[c.create(c.Class.UNIVERSAL,c.Type.OCTETSTRING,!1,c.toDer(E).getBytes())])]);d.push(S)}var I=null;if(null!==e){var T=p.wrapRsaPrivateKey(p.privateKeyToAsn1(e));I=null===r?c.create(c.Class.UNIVERSAL,c.Type.SEQUENCE,!0,[c.create(c.Class.UNIVERSAL,c.Type.OID,!1,c.oidToDer(p.oids.keyBag).getBytes()),c.create(c.Class.CONTEXT_SPECIFIC,0,!0,[T]),n]):c.create(c.Class.UNIVERSAL,c.Type.SEQUENCE,!0,[c.create(c.Class.UNIVERSAL,c.Type.OID,!1,c.oidToDer(p.oids.pkcs8ShroudedKeyBag).getBytes()),c.create(c.Class.CONTEXT_SPECIFIC,0,!0,[p.encryptPrivateKeyInfo(T,r,a)]),n]);var A=c.create(c.Class.UNIVERSAL,c.Type.SEQUENCE,!0,[I]),b=c.create(c.Class.UNIVERSAL,c.Type.SEQUENCE,!0,[c.create(c.Class.UNIVERSAL,c.Type.OID,!1,c.oidToDer(p.oids.data).getBytes()),c.create(c.Class.CONTEXT_SPECIFIC,0,!0,[c.create(c.Class.UNIVERSAL,c.Type.OCTETSTRING,!1,c.toDer(A).getBytes())])]);d.push(b)}var F,B=c.create(c.Class.UNIVERSAL,c.Type.SEQUENCE,!0,d);if(a.useMac){var o=ytcrypto.md.sha1.create(),N=new u.util.ByteBuffer(ytcrypto.random.getBytes(a.saltSize)),R=a.count,e=l.generateKey(r||"",N,3,R,20),w=u.hmac.create();w.start(o,e),w.update(c.toDer(B).getBytes());var U=w.getMac();F=c.create(c.Class.UNIVERSAL,c.Type.SEQUENCE,!0,[c.create(c.Class.UNIVERSAL,c.Type.SEQUENCE,!0,[c.create(c.Class.UNIVERSAL,c.Type.SEQUENCE,!0,[c.create(c.Class.UNIVERSAL,c.Type.OID,!1,c.oidToDer(p.oids.sha1).getBytes()),c.create(c.Class.UNIVERSAL,c.Type.NULL,!1,"")]),c.create(c.Class.UNIVERSAL,c.Type.OCTETSTRING,!1,U.getBytes())]),c.create(c.Class.UNIVERSAL,c.Type.OCTETSTRING,!1,N.getBytes()),c.create(c.Class.UNIVERSAL,c.Type.INTEGER,!1,c.integerToDer(R).getBytes())])}return c.create(c.Class.UNIVERSAL,c.Type.SEQUENCE,!0,[c.create(c.Class.UNIVERSAL,c.Type.INTEGER,!1,c.integerToDer(3).getBytes()),c.create(c.Class.UNIVERSAL,c.Type.SEQUENCE,!0,[c.create(c.Class.UNIVERSAL,c.Type.OID,!1,c.oidToDer(p.oids.data).getBytes()),c.create(c.Class.CONTEXT_SPECIFIC,0,!0,[c.create(c.Class.UNIVERSAL,c.Type.OCTETSTRING,!1,c.toDer(B).getBytes())])]),F])},l.generateKey=u.pbe.generatePkcs12Key,e.exports=u.p12},function(e,t,r){var a=r(40),n=function(){this.exception=!1,this.lockQueue=!1,this.jobs=[],this.results=[],this.interval=null,this.failCallback=null};n.prototype.add=function(e){if("function"!=typeof e)throw new a.error("job must be function type");if(this.lockQueue)throw"this JobPromise was already started.";this.jobs.push(e)},n.prototype.then=function(e){var t=this;if(this.lockQueue=!0,!this.exception&&null==this.interval){var r=!1;return this.interval=setInterval(function(){var a;if(!r){if(0==t.jobs.length)return e(t.results),void clearInterval(t.interval);r=!0,a=t.jobs.shift();try{a(function(e){t.results.push(e),r=!1})}catch(e){clearInterval(t.interval),t.exception=!0,t.failCallback&&t.failCallback(e)}}},50),this}},n.prototype.fail=function(e){if(null!=this.failCallback)throw new a.error("fail callback has been already set up");return this.failCallback=e,this};var i=function(e,t){var r=new n;return e.forEach(function(e,a){r.add(function(r){t(r,e,a)})}),r};e.exports={JobPromise:n,AsyncForEach:i}},function(e,t,r){var a=r(40),n=a._asn1,i=a.pkcs7asn1=a.pkcs7asn1||{};a.pkcs7=a.pkcs7||{},a.pkcs7.asn1=i;var s={name:"ContentInfo",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:n.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};i.contentInfoValidator=s;var o={name:"EncryptedContentInfo",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:n.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:n.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent"}]};i.envelopedDataValidator={name:"EnvelopedData",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:n.Class.UNIVERSAL,type:n.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(o)},i.encryptedDataValidator={name:"EncryptedData",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"version"}].concat(o)};var u={name:"SignerInfo",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.Version",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1},{name:"SignerInfo.IssuerAndSerialNumber",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0},{name:"SignerInfo.DigestAlgorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0},{name:"SignerInfo.AuthenticatedAttributes",tagClass:n.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.DigestEncryptionAlgorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0},{name:"SignerInfo.EncryptedDigest",tagClass:n.Class.UNIVERSAL,type:n.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.UnauthenticatedAttributes",tagClass:n.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0}]};i.signedDataValidator={name:"SignedData",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:n.Class.UNIVERSAL,type:n.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},s,{name:"SignedData.Certificates",tagClass:n.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:n.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:n.Class.UNIVERSAL,type:n.Type.SET,capture:"signerInfos",optional:!0,value:[u]}]},i.recipientInfoValidator={name:"RecipientInfo",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:n.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter"}]},{name:"RecipientInfo.encryptedKey",tagClass:n.Class.UNIVERSAL,type:n.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]},e.exports=a.pkcs7},function(e,t,r){var a=r(40),n=(a._asn1,a.crypto,a.pkcs7,a.oids,{});a.cms=n,n.createSignedData=r(58),n.createEnvelopedData=r(60),e.exports=a.cms},function(e,t,r){function a(e,t,r,a){var s,o,u,c,p,l=!!t.digestInfo;if(u=t.content||t.digestInfo,p=n.oids[e.digestAlgorithm.algorithm],s=ytcrypto.md.algorithms[p],"undefined"!=typeof u?n.consoleLog:u=t.content,e.signedAttributes){if(l){var f=i.fromDer(u);if(f.value[1].value!==e.signedAttributes.messageDigest[0])return n.consoleLog,a(!1),!1}else if(s=s.create(),s.update(u),s.digest().toHex()!==n.util.bytesToHex(e.signedAttributes.messageDigest[0]))return n.consoleLog,a(!1),!1;c=i.toDer(i.create(i.Class.UNIVERSAL,i.Type.SET,!0,t.rawCapture.authenticatedAttributes)).getBytes()}else c=u;if(t.certificates.forEach(function(t){var a=!1;if(r.hasOwnProperty("useSubjectAndSerialNumber")&&r.useSubjectAndSerialNumber&&(a=!0),a){if(e.issuerAndSerial.issuer.hash!==t._cert.subject.hash)return!0}else if(e.issuerAndSerial.issuer.hash!==t._cert.issuer.hash)return!0;return o=t.publicKey,!1}),!o)throw"not found matched publickey";var d={};switch(e.signatureAlgorithm.algorithm){case n.oids.rsaEncryption:d.name="RSASSA-PKCS1-V1_5";break;case n.oids.kcdsa:d.name="KCDSA";break;default:throw"not supported signatureAlgorithm "+e.signatureAlgorithm.algorithm}switch(d.hash={},p){case"sha256":d.hash.name="SHA-256";break;case"sha224":d.hash.name="SHA-224";break;case"sha1":d.hash.name="SHA-1";break;default:throw"not supported digestAlgorithm "+p}try{e.signedAttributes||(d.inputTypeDigestInfo=l),o.verify(d,e.signature,c,a)}catch(e){return a(new n.error(e)),!1}return!0}var n=r(40),i=n._asn1,s=(n.crypto,n.pkcs7),o=n.oids,u=r(59),c=function(){var e=null;return e={type:n.pki.oids.signedData,version:1,certificates:[],crls:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(t,r,a){function c(t,r){e.rawCapture={};var a;if("undefined"==typeof t.value[0])throw"message does not signedData";if(t.value[0].type==i.Type.OID&&(t=t.value[1].value[0]),!i.validate(t,r,e.rawCapture,a))throw"message does not signedData";e.rawCapture.signerInfos.forEach(function(t){var r,a,s,c=0;if(r={},c=1,s=ytcrypto.sha1.create(),r.issuerAndSerial={},r.issuerAndSerial.issuer={},r.issuerAndSerial.issuer.attributes=n.pki.RDNAttributesAsArray(t.value[c].value[0],s),r.issuerAndSerial.issuer.hash=s.digest().toHex(),r.issuerAndSerial.serialNumber=t.value[c].value[1].value,c++,a=n.pki.AlgorithmIdentifier.toObject(t.value[c]),r.digestAlgorithm=a,t.value[c+1].tagClass==i.Class.CONTEXT_SPECIFIC){var p;c++,p=t.value[c].value;var l={};r.signedAttributes=l,p.forEach(function(e){var t,a=[];switch(t=i.derToOid(e.value[0].value),o[t]){case"contentType":a.push(e.value[1].value[0].value);break;case"messageDigest":a.push(e.value[1].value[0].value);break;case"signingTime":a.push(i.utcTimeToDate(e.value[1].value[0].value));break;case"CMSAlgorithmProtection":var n=u.CMSAlgorithmProtection.fromAsn1(e.value[1].value[0]);a.push(n);break;default:throw"not supported attribute:"+t}r.signedAttributes[o[t]]=a})}c++;var f=t.value[c];f=n.pki.AlgorithmIdentifier.toObject(f),r.signatureAlgorithm=f,c++;var d=t.value[c];r.signature=d.value;var h=[];if(c+1<t.value.length){c++;var y=t.value[c];if(y.tagClass==n._asn1.Class.CONTEXT_SPECIFIC&&1==y.type){var g=y.value;g.forEach(function(e){var t=n._asn1.derToOid(e.value[0].value);h.push({oid:t,values:[e.value[1].value[0].value]})})}}r.unsignedAttributes=h,e.signerInfos||(e.signerInfos=[]),e.signerInfos.push(r)}),e.rawCapture.content&&e.rawCapture.content.value.length>0&&(e.content=e.rawCapture.content.value[0].value)}var p=this;e.certificates=[],e.crls=[],e.digestAlgorithmIdentifiers=[],e.contentInfo=null,e.signerInfos=[],c(t.getAsn1(),s.asn1.signedDataValidator);for(var l=e.rawCapture.certificates.value,f=0;f<l.length;++f){var d=0;n.pki.Certificate.fromAsn1(n.asn1.fromRaw(l[f]),function(t){if(t instanceof n.error)throw f=l.length,new n.error("failed to parse certficate in signed data");e.certificates.push(t),d++,d==l.length&&r(p)},a)}},toAsn1:function(t){e.contentInfo||e.sign();for(var r=[],a=0;a<e.certificates.length;++a)r.push(n.pki.certificateToAsn1(e.certificates[0]._cert));var s;return s=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(e.version).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SET,!0,e.digestAlgorithmIdentifiers),e.contentInfo,i.create(i.Class.CONTEXT_SPECIFIC,0,!0,r),i.create(i.Class.UNIVERSAL,i.Type.SET,!0,e.signerInfos)]),"undefined"!=typeof t&&t?n.asn1.fromRaw(s):n.asn1.fromRaw(i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.type).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[s])]))},sign:function(t,r,a){"undefined"==typeof a&&(a={useSubjectAndSerialNumber:!1,unWrapContentInfo:!1});var s=t.useSubjectAndSerialNumber||a.useSubjectAndSerialNumber||!1;t.unWrapContentInfo||a.unWrapContentInfo||!1;if(e.contentInfo=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(n.pki.oids.data).getBytes())]),"content"in e){var u=i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[]);e.contentInfo.value.push(u),u.value.push(i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,e.content))}var c,p,l;l="undefined"==typeof t.hash?"sha256":t.hash.replace("-","").toLowerCase(),c=ytcrypto.md.algorithms[l].create(),p=n.pki.AlgorithmIdentifier.toAsn1({algorithm:n.oids[l],parameters:null}),e.digestAlgorithmIdentifiers.push(p);var f,d,h;if(!("certificate"in t))throw"no cert";e.addCertificate(t.certificate),f=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[n.pki.distinguishedNameToAsn1({attributes:s?t.certificate._cert.subject.attributes:t.certificate._cert.issuer.attributes}),i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,n.util.hexToBytes(t.certificate._cert.serialNumber))]);var y;if("signedAttributes"in t){var g;d=i.create(i.Class.UNIVERSAL,i.Type.SET,!0,[]),t.signedAttributes.forEach(function(t){var r,a;if(g=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]),a=i.create(i.Class.UNIVERSAL,i.Type.SET,!0,[]),r=i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(o[t]).getBytes()),"contentType"===t)a.value.push(i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(o.data).getBytes()));else if("messageDigest"===t)if(e.digestInfo){var n=i.fromDer(e.digestInfo);a.value.push(n.value[1])}else e.isDigestValue||(c.start(),c.update(e.content)),a.value.push(i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,c.digest().getBytes()));else"signingTime"===t&&a.value.push(i.create(i.Class.UNIVERSAL,i.Type.UTCTIME,!1,i.dateToUtcTime(new Date)));g.value.push(r),g.value.push(a),d.value.push(g)}),y=i.toDer(d).getBytes()}else{if("undefined"!=typeof e.content)y=e.content;else{if("undefined"==typeof e.digestInfo)throw new n.error("can not found sign input (content and digestInfo was empty)");y=e.digestInfo}if("undefined"==typeof y)throw new n.error("signInput is undefined")}h={algorithm:n.oids.rsaEncryption,parameters:null};var C;C={},C.name="RSASSA-PKCS1-v1_5",t.key.raw.oid==o.kcdsa&&(C.name="KCDSA",h.algorithm=o.kcdsa,h.parameters=n._asn1.fromDer(t.certificate.publicKeyParameter)),C.hash={},"undefined"==typeof t.hash?C.hash.name="SHA-256":C.hash.name=t.hash,d||e.digestInfo&&(C.inputTypeDigestInfo=!0),t.key.sign(C,y,function(t){var a=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(1).getBytes()),f,p]);void 0!==d&&(d.tagClass=i.Class.CONTEXT_SPECIFIC,d.type=0,a.value.push(d)),a.value.push(n.pki.AlgorithmIdentifier.toAsn1(h)),a.value.push(i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,t)),e.signerInfos.push(a),r("")})},verify:function(t,r){function i(t){if(s.push(!(t instanceof n.error)&&t),e.signerInfos.length==s.length){for(var a=0;a<s.length;++a)if(!1===s[a])return void r(!1);r(!0)}}var s=[];e.signerInfos.forEach(function(r,n){var s;return s=a(r,e,t,i)})},addCertificate:function(t){"string"==typeof t&&(t=n.pki.certificateFromPem(t)),e.certificates.push(t)},addCertificateRevokationList:function(e){throw"PKCS#7 CRL support not yet implemented."},setContent:function(t,r){e.content=t,r===!0&&(e.isDigestValue=!0)},setDigestInfo:function(t){e.digestInfo=t},getContent:function(){return e.content}}};e.exports=c},function(e,t,r){var a=r(40),n={};n.CMSAlgorithmProtection={toAsn1:function(e){},fromAsn1:function(e){var t={};if(0==e.value.length)throw"no digest algorithm";var r=a.pki.AlgorithmIdentifier.toObject(e.value[0]);t.digestAlgorithm=r;for(var n=1;n<e.value.length;++n){var s=e.value[n];switch(s.type){case 1:r=a.pki.AlgorithmIdentifier.toObject(s),t.signatureAlgorithm=r;break;case 2:r=a.pki.AlgorithmIdentifier.toObject(s),t.macAlgorithm=i}if(t.signatureAlgorithm&&t.macAlgorithm)throw"bad protection algorithm:conflict"}return t}},e.exports=n},function(e,t,r){function a(e){if(void 0===e.encryptedContent.key)throw new Error("Symmetric key not available.");if(void 0===e.content){var t;switch(e.encryptedContent.algorithm){case n.pki.oids["aes128-CBC"]:case n.pki.oids["aes192-CBC"]:case n.pki.oids["aes256-CBC"]:t=ytcrypto.aes.createDecryptionCipher(e.encryptedContent.key.bytes());break;case n.pki.oids.desCBC:case n.pki.oids["des-EDE3-CBC"]:t=ytcrypto.des.createDecryptionCipher(e.encryptedContent.key.bytes());break;case n.pki.oids.seedCBC:t=ytcrypto.seed.createDecryptionCipher(e.encryptedContent.key.bytes(),"CBC");break;default:throw new Error("Unsupported symmetric cipher, OID "+e.encryptedContent.algorithm)}if(t.start(e.encryptedContent.parameter),t.update(e.encryptedContent.content),!t.finish())throw new Error("Symmetric decryption failed.");e.content=t.output}}var n=r(40),i=n._asn1,s=(n.crypto,n.pkcs7),o=n.oids,u=r(55).AsyncForEach,c=function(){function e(e){var t={},r=[];if(!i.validate(e,s.asn1.recipientInfoValidator,t,r)){var a=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw a.errors=r,a}return{version:t.version.charCodeAt(0),issuer:n.pki.RDNAttributesAsArray(t.issuer),serialNumber:n.util.createBuffer(t.serial).toHex(),encryptedContent:{algorithm:i.derToOid(t.encAlgorithm),parameter:t.encParameter.value,content:t.encKey}}}function t(e){return i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(e.version).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[n.pki.distinguishedNameToAsn1({attributes:e.issuer}),i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,n.util.hexToBytes(e.serialNumber))]),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.encryptedContent.algorithm).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")]),i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,e.encryptedContent.content)])}function r(t){for(var r=[],a=0;a<t.length;++a)r.push(e(t[a]));return r}function c(e){return[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(n.pki.oids.data).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.algorithm).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,e.parameter.data)]),i.create(i.Class.CONTEXT_SPECIFIC,0,!1,e.content.data)]}function p(e){for(var r=[],a=0;a<e.length;++a)r.push(t(e[a]));return r}function l(e,t,r){var a={},s=[];if(!i.validate(t,r,a,s)){var o=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw o.errors=o,o}var u=i.derToOid(a.contentType);if(u!==n.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(a.encryptedContent){var c="";if(n.util.isArray(a.encryptedContent))for(var p=0;p<a.encryptedContent.length;++p){if(a.encryptedContent[p].type!==i.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");c+=a.encryptedContent[p].value}else c=a.encryptedContent;e.encryptedContent={algorithm:i.derToOid(a.encAlgorithm),parameter:n.util.createBuffer(a.encParameter.value),content:n.util.createBuffer(c)}}if(a.content){var c="";if(n.util.isArray(a.content))for(var p=0;p<a.content.length;++p){if(a.content[p].type!==i.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");c+=a.content[p].value}else c=a.content;e.content=n.util.createBuffer(c)}return e.version=a.version.charCodeAt(0),e.rawCapture=a,a}var f=null;return f={type:n.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:n.pki.oids["aes256-CBC"]},fromAsn1:function(e){var t=e._asn;t.value&&t.value.length>=2&&t.value[0].type==i.Type.OID&&t.value[0].value==i.oidToDer(o.envelopedData).getBytes()&&t.value[1].value&&t.value[1].value.length>0&&(t=t.value[1].value[0]);var a=l(f,t,s.asn1.envelopedDataValidator);f.recipients=r(a.recipientInfos.value)},toAsn1:function(e){var t=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(f.version).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SET,!0,p(f.recipients)),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,c(f.encryptedContent))]);return"undefined"!=typeof e&&e?n.asn1.fromRaw(t):n.asn1.fromRaw(i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(f.type).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[t])]))},getRecipients:function(){for(var e=[],t=0;t<f.recipients.length;++t){var r={},a=f.recipients[t];a.issuer;r.issuer=n.pki.DNToString({attributes:a.issuer}),r.serialNumber=a.serialNumber,e.push(r)}return e},findRecipient:function(e){if(!(e instanceof n.pki.Certificate))throw"invalid input";e=e._cert;for(var t=e.issuer.attributes,r=0;r<f.recipients.length;++r){var a=f.recipients[r],i=a.issuer;if(a.serialNumber===e.serialNumber&&i.length===t.length){for(var s=!0,o=0;o<t.length;++o)if(i[o].type!==t[o].type||i[o].value!==t[o].value){s=!1;break}if(s)return a}}return null},decrypt:function(e,t,r){function i(e){if(e instanceof ytcrypto.error)return void r(e);f.encryptedContent.key=n.util.createBuffer(e);try{a(f),r(!0)}catch(e){r(!1)}}if(void 0===t||void 0===r)throw"invalid input";if("undefined"==typeof e&&(e=this.recipients[0]),t.webcrypto===!0)throw"webcrypto key is not supported";switch(e.encryptedContent.algorithm){case n.pki.oids.rsaEncryption:case n.pki.oids.desCBC:t.decrypt(e.encryptedContent.content,void 0,i);break;case n.pki.oids["RSAES-OAEP"]:t.decrypt(e.encryptedContent.content,{name:"RSA-OAEP"},i);break;default:throw new Error("Unsupported asymmetric cipher, OID "+e.encryptedContent.algorithm)}},addRecipient:function(e,t){if(!(e instanceof n.pki.Certificate))throw"invalid input";if(t=t||{algorithm:n.pki.oids.rsaEncryption},e.publicKey.webcrypto===!0&&0==e.publicKey.raw.extractable)throw"webcrypto key must be EXTRACTABLE";f.recipients.push({version:0,issuer:e._cert.issuer.attributes,serialNumber:e._cert.serialNumber,encryptedContent:{algorithm:t.algorithm,key:e.publicKey}})},encrypt:function(e,t,r){if("undefined"==typeof r)throw"invalid input";if(void 0===f.encryptedContent.content){t=t||f.encryptedContent.algorithm,e=e||f.encryptedContent.key;var a,i,s;switch(t){case n.pki.oids.seedCBC:a=16,i=16,s=ytcrypto.seed.createEncryptionCipher;break;case n.pki.oids["aes128-CBC"]:a=16,i=16,s=ytcrypto.aes.createEncryptionCipher;break;case n.pki.oids["aes192-CBC"]:a=24,i=16,s=ytcrypto.aes.createEncryptionCipher;break;case n.pki.oids["aes256-CBC"]:a=32,i=16,s=ytcrypto.aes.createEncryptionCipher;break;case n.pki.oids["des-EDE3-CBC"]:a=24,i=8,s=ytcrypto.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+t)}if(void 0===e)e=n.util.createBuffer(ytcrypto.random.getBytes(a));else if("string"==typeof e&&(e=n.util.createBuffer(e)),e.length()!=a)throw new Error("Symmetric key has wrong length; got "+e.length()+" bytes, expected "+a+".");f.encryptedContent.algorithm=t,f.encryptedContent.key=e,f.encryptedContent.parameter=n.util.createBuffer(ytcrypto.random.getBytes(i));var o=s(e.bytes(),"CBC");if(o.start(f.encryptedContent.parameter.copy()),o.update(f.content),!o.finish())throw new Error("Symmetric encryption failed.");f.encryptedContent.content=o.output}var c=u(f.recipients,function(e,t,r){function a(t){i.encryptedContent.content=t,e()}var i=t;if(void 0!==i.encryptedContent.content)return void e();switch(i.encryptedContent.algorithm){case n.pki.oids.rsaEncryption:i.encryptedContent.key.encrypt(f.encryptedContent.key.data,void 0,a);break;case n.pki.oids["RSAES-OAEP"]:i.encryptedContent.key.encrypt(f.encryptedContent.key.data,{name:"RSA-OAEP"},a);break;default:throw new Error("Unsupported asymmetric cipher, OID "+i.encryptedContent.algorithm)}});c.then(function(e){r(!0)})},setContent:function(e){e instanceof n.util.ByteBuffer||(e=n.util.createBuffer(e)),f.content=e}}};e.exports=c},function(e,t,r){var a=r(40),n=ytcrypto.asn1,i=a.oids,s={};a.pkcs8=s;var o={name:"PrivateKeyInfo",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"privateKeyOid"},{name:"AlgorithmIdentifier.parameter",tagClass:n.Class.UNIVERSAL,type:n.Type.ANY,capture:"keyParameter",optional:!0}]},{name:"PrivateKeyInfo",tagClass:n.Class.UNIVERSAL,type:n.Type.OCTETSTRING,constructed:!1,capture:"privateKey"},{name:"PrivateKeyInfo.attributes",tagClass:n.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,captureAsn1:"attributes",optional:!0}]},u={name:"EncryptedPrivateKeyInfo",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:n.Class.UNIVERSAL,type:n.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]};s.PrivateKeyInfo=function(e){var t,r,s=this,u=e,c={},l=[];if(e instanceof a.asn1||(e=new a.asn1(e)),"pkcs5"in a&&(t=a.pkcs5),e.validate(o,c,l))r=new ytcrypto.crypto.key(ytcrypto.pki.privateKeyFromAsn1(ytcrypto.asn1.fromDer(c.privateKey),ytcrypto.asn1.derToOid(c.privateKeyOid),c.keyParameter),"private");else try{r=new ytcrypto.crypto.key(ytcrypto.pki.privateKeyFromAsn1(e.getAsn1()),"private"),c.privateKeyOid=i.rsaEncryption}catch(e){throw"input may not PrivateKeyInfo:"+e}if(this.privateKey=r,this.privateKeyOID=c.privateKeyOid,this.encrypt=function(e,r,a,n){var i;if(void 0===t)throw"pkcs5 module does not loaded.";return i=t.encrypt(u.toBytes(),e,r,a,n),p(i)},this.attributes={},c.attributes){var f,d,h;c.attributes.value.forEach(function(e){switch(f=n.derToOid(e.value[0].value),d=e.value[1].value,f){case i.randomNum:h=a.util.createBuffer(d[0].value),++h.read,h=h.getBytes(),s.attributes.randomNum=h}})}this.envelopeVid=function(e,t){var r,i,o,u,c,p,l,f,d,h,y,g;if(2!==arguments.length)throw"envelopeVid: invalid arguments";if(t instanceof a.pki.Certificate)y=t;else try{y=a.pki.Certificate.fromPem(t)}catch(e){throw"Invalid Server Certificate"}c=s.attributes.randomNum,r="seed",o="CBC",i=ytcrypto.crypto.random.getBytes(16);var C=a.util.createBuffer();for(g=0;g<16;g++)C.putByte(0);u=C.getBytes(),p=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.PRINTABLESTRING,!1,e),n.create(n.Class.UNIVERSAL,n.Type.BITSTRING,!1,String.fromCharCode(0)+c)]);var v=a.asn1.fromDer(n.toDer(p));return l=ytcrypto.crypto.blockCipher.createEncryptionCipher(r,i,o),l.start(u),l.update(v.toBytes()),l.finish(),f=l.output.getBytes(),d=y.publicKey.raw.encrypt(i,"RSAES-PKCS1-V1_5"),h=a.util.createBuffer(),h.putBytes(d),h.putBytes(f),a.util.bytesToHex(h.getBytes())},this.verifyVid=function(e,t){if(0==this.attributes.hasOwnProperty("randomNum"))throw"no vid random number";var r,n=a.kisa.HashContent.toAsn1({idn:t,randomNum:this.attributes.randomNum}),i=ytcrypto.md[e.hashAlg];if("undefined"==typeof i)throw"not supported vid hash algorithm";return n=a._asn1.toDer(n),n=n.getBytes(),i=i.create(),i.update(n),r=i.digest().getBytes(),i.start(),i.update(r),r=i.digest().getBytes(),r===e.virtualID},this.toAsn1=function(){return u}};var c=function(e){return new s.PrivateKeyInfo(e)};s.EncryptedPrivateKeyInfo=function(e){var t,r,n={},i=[];if(!(e instanceof a.asn1))throw"yt.pkcs8: invalid input";if("pkcs5"in a&&(r=a.pkcs5),t=e,!e.validate(u,n,i))throw"input may not EncryptedPrivateKeyInfo";this.encryptionOID=n.encryptionOid,this.encryptionParameters=n.encryptionParams,this.encryptedData=n.encryptedData,this.decrypt=function(e){var t;if(void 0===r)throw"pkcs5 module does not loaded.";if(t=r.decrypt(e,this.encryptionOID,this.encryptionParameters,this.encryptedData),null==t)throw"bad password or private key";return c(t)},this.toAsn1=function(){return t}};var p=function(e){return new s.EncryptedPrivateKeyInfo(e)};s.createPrivateKeyInfoFromAsn1=function(e){return c(e)},s.createPrivateKeyInfo=function(e,t,r,o){
var u,c=!1;if("string"!=typeof e)throw"yt.pkcs8: invalid input privateKey:"+e;switch(r){case"KCDSA":u=i.kcdsa,c=!0;break;case"ECDSA":u=i.ecdsa,c=!0,o=n.create(n.Class.UNIVERSAL,n.Type.OID,!1,o);break;default:case"RSA":u=i.rsaEncryption,o=n.create(n.Class.UNIVERSAL,n.Type.NULL,!1,"")}if(u=n.oidToDer(u).getBytes(),c&&"undefined"==typeof o)throw"this key need key parameter";var p;if(p=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[]),p.value.push(n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,n.integerToDer(0).getBytes())),p.value.push(n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,u),o])),p.value.push(n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,e)),t){var l,f=n.create(n.Class.CONTEXT_SPECIFIC,0,!0,[]);"randomNum"in t&&(l=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(i.randomNum).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.SET,!0,[n.create(n.Class.UNIVERSAL,n.Type.BITSTRING,!1,String.fromCharCode(0)+t.randomNum)])]),f.value.push(l)),p.value.push(f)}return s.createPrivateKeyInfoFromAsn1(a.asn1.fromRaw(p))},s.createEncryptedPrivateKeyInfoFromAsn1=function(e){return p(e)},e.exports=s},function(e,t,r){var a=r(40);r(53);var n=a._asn1,i=a.pki,s=a.oids,o=a.pkcs5||{},u={name:"PBES2Algorithms",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:n.Class.UNIVERSAL,type:n.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,onstructed:!0,capture:"kdfIterationCount"}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:n.Class.UNIVERSAL,type:n.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},c=function(e,t,r){var a,n;a=ytcrypto.md.sha1.create(),a.update(e),a.update(t),n=a.digest().getBytes();for(var i=1;i<r;++i)a.start(),a.update(n),n=a.digest().getBytes();return n},p=function(e,t,r,a,i){var s,o,u,p,l,f,d=16,h=16,y="CBC";s=t.value[0].value,o=n.derToInteger(t.value[1].value),u=c(r,s,o),p=u.substr(0,d),l=i?"0123456789012345":ytcrypto.md.sha1.create().update(u.substr(d)).digest().getBytes().substr(0,h),l=ytcrypto.util.createBuffer(l),f=a?ytcrypto.seed.createEncryptionCipher:ytcrypto.seed.createDecryptionCipher;var g=f(p,y);return g.start(l),g},l=function(e,t,r){var s={},o=[];if(!n.validate(t,u,s,o))throw{message:"Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.",errors:o};if(e=n.derToOid(s.kdfOid),e!==i.oids.pkcs5PBKDF2)throw{message:"Cannot read encrypted private key. Unsupported key derivation function OID.",oid:e,supportedOids:["pkcs5PBKDF2"]};if(e=n.derToOid(s.encOid),e!==i.oids["aes128-CBC"]&&e!==i.oids["aes192-CBC"]&&e!==i.oids["aes256-CBC"]&&e!==i.oids["des-EDE3-CBC"]&&e!==i.oids.desCBC&&e!==i.oids.seedCBC&&e!==i.oids["aria128-CBC"])throw{message:"Cannot read encrypted private key. Unsupported encryption scheme OID.",oid:e,supportedOids:["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC","seedCBC","aria128-CBC"]};var c=s.kdfSalt,p=a.util.createBuffer(s.kdfIterationCount);p=p.getInt(p.length()<<3);var l,f;switch(i.oids[e]){case"aes128-CBC":l=16,f=ytcrypto.aes.createDecryptionCipher;break;case"aes192-CBC":l=24,f=ytcrypto.aes.createDecryptionCipher;break;case"aes256-CBC":l=32,f=ytcrypto.aes.createDecryptionCipher;break;case"des-EDE3-CBC":l=24,f=ytcrypto.des.createDecryptionCipher;break;case"desCBC":l=8,f=ytcrypto.des.createDecryptionCipher;break;case"seedCBC":l=16,f=ytcrypto.seed.createDecryptionCipher;break;case"aria128-CBC":l=16,f=ytcrypto.aria.createDecryptionCipher;break;default:throw"please check cipher oid:"+i.oids[e]}var d=a.pkcs5.pbkdf2(r,c,p,l),h=s.encIv,y=f(d);return y.start(h),y},f=function(e,t,r,a){switch(e){case i.oids.pkcs5PBES2:return l(e,t,r);case i.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case i.oids["pbewithSHAAnd40BitRC2-CBC"]:return i.pbe.getCipherForPKCS12PBE(e,t,r);case i.oids.seedCBC:return p(e,t,r,a,!0);case i.oids.seedCBCWithSHA1:return p(e,t,r,a,!1);default:throw{message:"Cannot read encrypted PBE data block. Unsupported OID.",oid:e,supportedOids:["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC","seedCBCWithSHA1"]}}};o.encrypt=function(e,t,r,i,o){void 0===r&&(r="seedCBCWithSHA1"),void 0===i&&(i=ytcrypto.random.getBytes(8)),void 0===o&&(o=2048);var u,c=s[r];u=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,i),n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,n.integerToDer(o).getBytes())]);var p=f(c,u,t,!0);p.update(a.util.createBuffer(e)),p.finish();var l;return l=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[]),l.value.push(n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(c).getBytes()),u])),l.value.push(n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,p.output.getBytes())),a.asn1.fromRaw(l)},o.decrypt=function(e,t,r,i){var s=null,t=n.derToOid(t),o=f(t,r,e,!1),u=a.util.createBuffer(i);return o.update(u),o.finish()&&(s=a.asn1.fromDer(o.output)),s},a.pkcs5=o,e.exports=a.pkcs5},function(e,t,r){function a(e,t,r,a){for(var n=[],i=0;i<e.length;i++)for(var s=0;s<e[i].safeBags.length;s++){var o=e[i].safeBags[s];void 0!==a&&o.type!==a||void 0!==o.attributes[t]&&o.attributes[t].indexOf(r)>=0&&n.push(o)}return n}function n(e,t,r,a){if(t=y.fromDer(t,r),t.tagClass!==y.Class.UNIVERSAL||t.type!==y.Type.SEQUENCE||t.constructed!==!0)throw{message:"PKCS#12 AuthenticatedSafe expected to be a SEQUENCE OF ContentInfo"};for(var n=0;n<t.value.length;n++){var o=t.value[n],u={},c=[];if(!y.validate(o,v,u,c))throw{message:"Cannot read ContentInfo.",errors:c};var p={encrypted:!1},l=null,f=u.content.value[0];switch(y.derToOid(u.contentType)){case g.oids.data:if(f.tagClass!==y.Class.UNIVERSAL||f.type!==y.Type.OCTETSTRING)throw{message:"PKCS#12 SafeContents Data is not an OCTET STRING."};l=f.value;break;case g.oids.encryptedData:if(void 0===a)continue;l=i(f,a),p.encrypted=!0;break;default:throw{message:"Unsupported PKCS#12 contentType.",contentType:y.derToOid(u.contentType)}}p.safeBags=s(l,r,a),e.safeContents.push(p)}}function i(e,t){var r={},a=[];if(!y.validate(e,h.pkcs7.asn1.encryptedDataValidator,r,a))throw{message:"Cannot read EncryptedContentInfo. ",errors:a};var n=y.derToOid(r.contentType);if(n!==g.oids.data)throw{message:"PKCS#12 EncryptedContentInfo ContentType is not Data.",oid:n};n=y.derToOid(r.encAlgorithm);var i=g.pbe.getCipher(n,r.encParameter,t),s=h.util.createBuffer(r.encryptedContent);if(i.update(s),!i.finish())throw{message:"Failed to decrypt PKCS#12 SafeContents."};return i.output.getBytes()}function s(e,t,r){var a=y.fromDer(e,t);if(a.tagClass!==y.Class.UNIVERSAL||a.type!==y.Type.SEQUENCE||a.constructed!==!0)throw{message:"PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag"};for(var n=[],i=0;i<a.value.length;i++){var s=a.value[i],u={},c=[];if(!y.validate(s,E,u,c))throw{message:"Cannot read SafeBag.",errors:c};var p={type:y.derToOid(u.bagId),attributes:o(u.bagAttributes)};n.push(p);var l,f,d=u.bagValue.value[0];switch(p.type){case g.oids.pkcs8ShroudedKeyBag:if(void 0===r)p.key=d,d=null;else try{p.key=h.pkcs8.createEncryptedPrivateKeyInfoFromAsn1(h.asn1.fromRaw(d)),d=p.key.decrypt(r),d=d.toAsn1()._asn}catch(e){h.consoleLog,h.consoleLog,d=null}if(null===d)continue;delete p.key;case g.oids.keyBag:p.key=h.pkcs8.createPrivateKeyInfoFromAsn1(h.asn1.fromRaw(d));continue;case g.oids.certBag:l=I,f=function(){if(y.derToOid(u.certId)!==g.oids.x509Certificate)throw{message:"Unsupported certificate type, only X.509 supported.",oid:y.derToOid(u.certId)};p.cert=h.pki.Certificate.fromDer(u.cert)};break;default:throw{message:"Unsupported PKCS#12 SafeBag type.",oid:p.type}}if(void 0!==l&&!y.validate(d,l,u,c))throw{message:"Cannot read PKCS#12 "+l.name,errors:c};f()}return n}function o(e){var t={};if(void 0!==e)for(var r=0;r<e.length;++r){var a={},n=[];if(!y.validate(e[r],S,a,n))throw{message:"Cannot read PKCS#12 BagAttribute.",errors:n};var i=y.derToOid(a.oid);if(void 0!==g.oids[i]){t[g.oids[i]]=[];for(var s=0;s<a.values.length;++s)t[g.oids[i]].push(a.values[s].value)}}return t}function u(e,t){var r=e.certificate,a=e.localKeyId||t.localKeyId;if(null!==a)a=h.util.hexToBytes(a);else if(t.generateLocalKeyId)if(r){var n=h.util.isArray(r)?r[0]:r;"string"==typeof n?n=g.certificateFromPem(n):n.constructor===h.pki.Certificate&&(n=n._cert);var i=ytcrypto.md.sha1.create();i.update(y.toDer(g.certificateToAsn1(n)).getBytes()),a=i.digest().getBytes()}else a=ytcrypto.random.getBytes(20);return a}function c(e,t){var r,a=u(e,t),n=[];if(null!==a&&n.push(y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(g.oids.localKeyId).getBytes()),y.create(y.Class.UNIVERSAL,y.Type.SET,!0,[y.create(y.Class.UNIVERSAL,y.Type.OCTETSTRING,!1,a)])])),"friendlyName"in e||t.autoFriendlyName===!0||"friendlyName"in t){var i=e.friendlyName||t.friendlyName;i||t.autoFriendlyName!==!0||(i=e.certificate.subject),n.push(y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(g.oids.friendlyName).getBytes()),y.create(y.Class.UNIVERSAL,y.Type.SET,!0,[y.create(y.Class.UNIVERSAL,y.Type.BMPSTRING,!1,i)])]))}return n.length>0&&(r=y.create(y.Class.UNIVERSAL,y.Type.SET,!0,n)),r}function p(e,t,r){var a,a=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(t).getBytes()),y.create(y.Class.CONTEXT_SPECIFIC,0,!0,[e])]);return r&&a.value.push(r),a}function l(e){var t=g.certificateToAsn1(e),r=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(g.oids.x509Certificate).getBytes()),y.create(y.Class.CONTEXT_SPECIFIC,0,!0,[y.create(y.Class.UNIVERSAL,y.Type.OCTETSTRING,!1,y.toDer(t).getBytes())])]);return r}function f(e,t,r){var a,n=e.toAsn1().getAsn1();return a=null===t?n:g.encryptPrivateKeyInfo(n,t,r)}function d(e,t){var r=this,a=C.pkcs12FromAsn1(e.getAsn1(),t);this.contents={},this.contents.keys=[];var n={},i=[];a.safeContents.forEach(function(e){e.safeBags.forEach(function(e){var t,r,a;switch(e.type){case h.pki.oids.pkcs8ShroudedKeyBag:case h.pki.oids.keyBag:t="key",r=e.key;break;case h.pki.oids.certBag:t="cert",r=e.cert;break;default:throw"not supported safeBag type:"+e.type}var s={};if(s[t]=r,a=e.attributes.localKeyId){if(a=ytcrypto.util.bytesToHex(a[0]),n.hasOwnProperty(a)||(n[a]={},n[a].localKeyId=a),n[a][t])throw"duplicated key:"+t+" is exist";n[a][t]=r}else i.push(s)})});var s=0;for(var o in n)r.contents.keys.push(s),r.contents[s++]=n[o];for(var u in i)r.contents.keys.push(s),r.contents[s++]=i[u]}var h=r(40);r(52);var y=h._asn1,g=h.pki,C={},v={name:"ContentInfo",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.contentType",tagClass:y.Class.UNIVERSAL,type:y.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:y.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"content"}]},m={name:"PFX",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.version",tagClass:y.Class.UNIVERSAL,type:y.Type.INTEGER,constructed:!1,capture:"version"},v,{name:"PFX.macData",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"mac",value:[{name:"PFX.macData.mac",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm.algorithm",tagClass:y.Class.UNIVERSAL,type:y.Type.OID,constructed:!1,capture:"macAlgorithm"},{name:"PFX.macData.mac.digestAlgorithm.parameters",tagClass:y.Class.UNIVERSAL,captureAsn1:"macAlgorithmParameters"}]},{name:"PFX.macData.mac.digest",tagClass:y.Class.UNIVERSAL,type:y.Type.OCTETSTRING,constructed:!1,capture:"macDigest"}]},{name:"PFX.macData.macSalt",tagClass:y.Class.UNIVERSAL,type:y.Type.OCTETSTRING,constructed:!1,capture:"macSalt"},{name:"PFX.macData.iterations",tagClass:y.Class.UNIVERSAL,type:y.Type.INTEGER,constructed:!1,optional:!0,capture:"macIterations"}]}]},E={name:"SafeBag",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,value:[{name:"SafeBag.bagId",tagClass:y.Class.UNIVERSAL,type:y.Type.OID,constructed:!1,capture:"bagId"},{name:"SafeBag.bagValue",tagClass:y.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"bagValue"},{name:"SafeBag.bagAttributes",tagClass:y.Class.UNIVERSAL,type:y.Type.SET,constructed:!0,optional:!0,capture:"bagAttributes"}]},S={name:"Attribute",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,value:[{name:"Attribute.attrId",tagClass:y.Class.UNIVERSAL,type:y.Type.OID,constructed:!1,capture:"oid"},{name:"Attribute.attrValues",tagClass:y.Class.UNIVERSAL,type:y.Type.SET,constructed:!0,capture:"values"}]},I={name:"CertBag",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,value:[{name:"CertBag.certId",tagClass:y.Class.UNIVERSAL,type:y.Type.OID,constructed:!1,capture:"certId"},{name:"CertBag.certValue",tagClass:y.Class.CONTEXT_SPECIFIC,constructed:!0,value:[{name:"CertBag.certValue[0]",tagClass:y.Class.UNIVERSAL,type:y.Class.OCTETSTRING,constructed:!1,capture:"cert"}]}]};C.pkcs12FromAsn1=function(e,t,r){"string"==typeof t?(r=t,t=!0):void 0===t&&(t=!0);var i={},s=[];if(!y.validate(e,m,i,s))throw{message:"Cannot read PKCS#12 PFX. ASN.1 object is not an PKCS#12 PFX.",errors:s};var o={version:i.version.charCodeAt(0),safeContents:[],getBags:function(e){var t,r={};return"localKeyId"in e?t=e.localKeyId:"localKeyIdHex"in e&&(t=h.util.hexToBytes(e.localKeyIdHex)),void 0!==t&&(r.localKeyId=a(o.safeContents,"localKeyId",t,e.bagType)),"friendlyName"in e&&(r.friendlyName=a(o.safeContents,"friendlyName",e.friendlyName,e.bagType)),r},getBagsByFriendlyName:function(e,t){return a(o.safeContents,"friendlyName",e,t)},getBagsByLocalKeyId:function(e,t){return a(o.safeContents,"localKeyId",e,t)}};if(3!==i.version.charCodeAt(0))throw{message:"PKCS#12 PFX of version other than 3 not supported.",version:i.version.charCodeAt(0)};if(y.derToOid(i.contentType)!==g.oids.data)throw{message:"Only PKCS#12 PFX in password integrity mode supported.",oid:y.derToOid(i.contentType)};var u=i.content.value[0];if(u.tagClass!==y.Class.UNIVERSAL||u.type!==y.Type.OCTETSTRING)throw{message:"PKCS#12 authSafe content data is not an OCTET STRING."};if(i.mac&&r){var c=null,p=0,l=y.derToOid(i.macAlgorithm);switch(l){case g.oids.sha1:c=ytcrypto.md.sha1.create(),p=20;break;case g.oids.sha256:c=ytcrypto.md.sha256.create(),p=32;break;case g.oids.sha384:c=ytcrypto.md.sha384.create(),p=48;break;case g.oids.sha512:c=ytcrypto.md.sha512.create(),p=64;break;case g.oids.md5:c=ytcrypto.md.md5.create(),p=16}if(null===c)throw{message:"PKCS#12 uses unsupported MAC algorithm: "+l};var f=new h.util.ByteBuffer(i.macSalt),d="macIterations"in i?parseInt(h.util.bytesToHex(i.macIterations),16):1,v=C.generateKey(r||"",f,3,d,p,c),E=ytcrypto.hmac.create();E.start(c,v),E.update(u.value);var S=E.getMac();if(S.getBytes()!==i.macDigest)throw{message:"PKCS#12 MAC could not be verified. Invalid password?"}}return n(o,u.value,t,r),o};var T=function(e,t,r,a,n,i){var s,o;"undefined"!=typeof i&&null!==i||(i=ytcrypto.md.sha1.create());var u=i.digestLength,c=i.blockLength,p=new h.util.ByteBuffer,l=new h.util.ByteBuffer;for(o=0;o<e.length;o++)l.putInt16(e.charCodeAt(o));l.putInt16(0);var f=l.length(),d=t.length(),y=new h.util.ByteBuffer;y.fillWithByte(r,c);var g=c*Math.ceil(d/c),C=new h.util.ByteBuffer;for(o=0;o<g;o++)C.putByte(t.at(o%d));var v=c*Math.ceil(f/c),m=new h.util.ByteBuffer;for(o=0;o<v;o++)m.putByte(l.at(o%f));var E=C;E.putBuffer(m);for(var S=Math.ceil(n/u),I=1;I<=S;I++){var T=new h.util.ByteBuffer;T.putBytes(y.bytes()),T.putBytes(E.bytes());for(var A=0;A<a;A++)i.start(),i.update(T.getBytes()),T=i.digest();var b=new h.util.ByteBuffer;for(o=0;o<c;o++)b.putByte(T.at(o%u));var F=Math.ceil(d/c)+Math.ceil(f/c),B=new h.util.ByteBuffer;for(s=0;s<F;s++){var N=new h.util.ByteBuffer(E.getBytes(c)),R=511;for(o=b.length()-1;o>=0;o--)R>>=8,R+=b.at(o)+N.at(o),N.setAt(o,255&R);B.putBuffer(N)}E=B,p.putBuffer(T)}return p.truncate(p.length()-n),p};C.generateKey=T;var A={};d.fromAsn1=function(e,t){return new d(e,t)},d.fromString=function(e,t){return d.fromAsn1(h.asn1.fromString(e),t)},d.generateToAsn1=function(e,t,r){var a={};a.saltSize=r.saltSize||8,a.count=r.count||2048,a.algorithm=r.algorithm||r.encAlgorithm||"aes128",a.autoFriendlyName=r.autoFriendlyName||!1,"friendlyName"in r&&(a.friendlyName=r.friendlyName),"useMac"in r||(a.useMac=!0),"localKeyId"in r||(a.localKeyId=null),"generateLocalKeyId"in r||(a.generateLocalKeyId=!0);var n;e=h.util.isArray(e)?e:[e];for(var i=[],s=[],o=0;o<e.length;++o){var u,d,v,m=e[o],E=m.certificate,S=m.key;if(!E||!S)throw"invalid certSetList: certificate and key is MANDATORY field";var n=c(m,a);if(u=l(E._cert),v=p(u,g.oids.certBag,n),i.push(v),d=f(S,t,a),v=p(d,null===t?g.oids.keyBag:g.oids.pkcs8ShroudedKeyBag,n),s.push(v),m.chain&&!(m.chain.length<=0))for(var I=0;I<m.chain.length;++I){var u,v;h.consoleLog,u=l(m.chain[I]._cert),v=p(u,g.oids.certBag),i.push(v)}}var T=[];if(i.length>0){var A=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,i),b=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(g.oids.data).getBytes()),y.create(y.Class.CONTEXT_SPECIFIC,0,!0,[y.create(y.Class.UNIVERSAL,y.Type.OCTETSTRING,!1,y.toDer(A).getBytes())])]);T.push(b)}var F=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,s),B=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(g.oids.data).getBytes()),y.create(y.Class.CONTEXT_SPECIFIC,0,!0,[y.create(y.Class.UNIVERSAL,y.Type.OCTETSTRING,!1,y.toDer(F).getBytes())])]);T.push(B);var N,R=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,T);if(a.useMac){var w=ytcrypto.md.sha1.create(),U=new h.util.ByteBuffer(ytcrypto.random.getBytes(a.saltSize)),P=a.count,S=C.generateKey(t||"",U,3,P,20),L=ytcrypto.hmac.create();L.start(w,S),L.update(y.toDer(R).getBytes());var D=L.getMac();N=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(g.oids.sha1).getBytes()),y.create(y.Class.UNIVERSAL,y.Type.NULL,!1,"")]),y.create(y.Class.UNIVERSAL,y.Type.OCTETSTRING,!1,D.getBytes())]),y.create(y.Class.UNIVERSAL,y.Type.OCTETSTRING,!1,U.getBytes()),y.create(y.Class.UNIVERSAL,y.Type.INTEGER,!1,y.integerToDer(P).getBytes())])}return h.asn1.fromRaw(y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.UNIVERSAL,y.Type.INTEGER,!1,y.integerToDer(3).getBytes()),y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(g.oids.data).getBytes()),y.create(y.Class.CONTEXT_SPECIFIC,0,!0,[y.create(y.Class.UNIVERSAL,y.Type.OCTETSTRING,!1,y.toDer(R).getBytes())])]),N]))},A.PFX=d,h.pkcs12=A,e.exports=h.pkcs12},function(e,t,r){var a=r(40),n=a._asn1,i=a.pki,s=a.oids,o=a.util,u=a.kisa,c={},p=a.cmp=a.cmp||{};c.CertId={},c.CertId.toAsn1=function(e){var t,r;return t=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[]),t.value.push(i.GeneralName.toAsn1(e.issuer)),r=a.util.hexToBytes(e.serialNumber),t.value.push(n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,r)),t},c.AttributeTypeAndValue={},c.AttributeTypeAndValue.toAsn1=function(e){var t,r;switch(t=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[]),t.value.push(n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(e.type).getBytes())),e.type){case u.EncryptedVID.oid:r=u.EncryptedVID.toAsn1(e.value);break;case a.oids.oldCertId:r=c.CertId.toAsn1(e.value);break;default:r=e.value}return t.value.push(r),t},c.CertResponse={},c.CertResponse.toObject=function(e,t){var r={};return r.certReqId=n.derToInteger(e.value[0].value),r.status=p.PKIStatusInfo.toObject(e.value[1],t),e.value.length>2&&(r.certifiedKeyPair=p.CertifiedKeyPair.toObject(e.value[2])),e.value.length>3&&(r.rspInfo=e.value[3].value),r},c.CertRequest={},c.CertRequest.toAsn1=function(e){var t;return t=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,n.integerToDer(e.certReqId).getBytes()),c.CertTemplate.toAsn1(e.certTemplate)]),e.hasOwnProperty("controls")&&t.value.push(c.Controls.toAsn1(e.controls)),t},c.CertTemplate={},c.CertTemplate.toAsn1=function(e){var t;if(t=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[]),e.hasOwnProperty("version")&&t.value.push(n.create(n.Class.CONTEXT_SPECIFIC,0,!0,[n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,n.integerToDer(e.version).getBytes())])),e.hasOwnProperty("serialNumber")){var r;r=a.util.hexToBytes(e.serialNumber),t.value.push(n.create(n.Class.CONTEXT_SPECIFIC,1,!1,r))}if(e.hasOwnProperty("signingAlg")&&t.value.push(n.create(n.Class.CONTEXT_SPECIFIC,2,!0,[i.AlgorithmIdentifier.toAsn1(e.signingAlg)])),e.hasOwnProperty("issuer")&&t.value.push(n.create(n.Class.CONTEXT_SPECIFIC,3,!0,[i.distinguishedNameToAsn1(e.issuer)])),e.hasOwnProperty("validity")&&t.value.push(n.create(n.Class.CONTEXT_SPECIFIC,4,!0,[i.Validity.toAsn1(e.validity)])),e.hasOwnProperty("subject")&&t.value.push(n.create(n.Class.CONTEXT_SPECIFIC,5,!0,[i.distinguishedNameToAsn1(e.subject)])),e.hasOwnProperty("publicKey")&&t.value.push(n.create(n.Class.CONTEXT_SPECIFIC,6,!0,[e.publicKey.value[0],e.publicKey.value[1]])),e.hasOwnProperty("issuerUID")&&t.value.push(n.create(n.Class.CONTEXT_SPECIFIC,7,!0,[n.create(n.Class.UNIVERSAL,n.Type.BITSTRING,!1,String.fromCharCode(0)+e.issuerUID)])),e.hasOwnProperty("subjectUID")&&t.value.push(n.create(n.Class.CONTEXT_SPECIFIC,8,!0,[n.create(n.Class.UNIVERSAL,n.Type.BITSTRING,!1,String.fromCharCode(0)+e.subjectUID)])),e.hasOwnProperty("extentions"))throw"not implemented";return t},c.EncryptedValue={},c.EncryptedValue.toObject=function(e){var t={};return e.value.forEach(function(e){if(e.tagClass==n.Class.CONTEXT_SPECIFIC)switch(e.type){case 2:t.encSymmKey=e.value.substring(1,e.value.length);break;default:throw"unknown EncryptedValue contextID"+e.type}else t.encValue=e.value.substring(1,e.value.length)}),t},c.PBMParameter={},c.PBMParameter.toAsn1=function(e){return n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OCTET_STRING,e.salt),i.AlgorithmIdentifier.toAsn1(e.owf)])},c.POPOSigningKeyInput={},c.POPOSigningKeyInput.toAsn1=function(e){var t,r;if(t=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[]),!("authInfo"in e))throw"authInfo does not exist";if("sender"in e.authInfo)r=n.create(n.Class.CONTEXT_SPECIFIC,0,!0,[i.GeneralName.toAsn1(e.authInfo.sender)]);else{if(!("publicKeyMAC"in e.authInfo))throw"no choice for authInfo";r=c.PKMACValue.toAsn1(e.authInfo.publicKeyMAC)}return t.value.push(r),t.value.push(e.publicKey),t},c.POPOSigningKey={},c.POPOSigningKey.toAsn1=function(e){var t;return t=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[]),"poposkInput"in e&&t.value.push(n.create(n.Class.CONTEXT_SPECIFIC,0,!0,c.POPOSigningKeyInput.toAsn1(e.poposkInput).value)),t.value.push(i.AlgorithmIdentifier.toAsn1(e.algorithmIdentifier)),t.value.push(n.create(n.Class.UNIVERSAL,n.Type.BITSTRING,!1,String.fromCharCode(0)+e.signature)),t},c.ProofOfPossession={},c.ProofOfPossession.toAsn1=function(e){var t,r=0;if("raVerified"in e)r=0,t=[n.create(n.Class.UNIVERSAL,n.Type.NULL,!1,"")];else if("signature"in e)r=1,t=c.POPOSigningKey.toAsn1(e.signature).value;else if("keyEncipherment"in e)r=2,t=e.keyEncipherment;else{if(!("keyAgreement"in e))throw"proofOfPossession does not have any choice.";r=3,t=e.keyAgreement}return n.create(n.Class.CONTEXT_SPECIFIC,r,!0,t)},c.RevDetails={},c.RevDetails.toAsn1=function(e){var t;if(t=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[c.CertTemplate.toAsn1(e.certDetails)]),e.hasOwnProperty("revocationReason")){var r=ytcrypto.asn1.generateBitString("",e.revocationReason);t.value.push(n.create(n.Class.UNIVERSAL,n.Type.BITSTRING,!1,r))}return t},c.RevRepContent={},c.RevRepContent.toObject=function(e,t){var r={};return r.status=[],e.value[0].value.forEach(function(e){r.status.push(p.PKIStatusInfo.toObject(e,t))}),r},c.CertReqMsg={},c.CertReqMsg.toAsn1=function(e){var t;return t=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[c.CertRequest.toAsn1(e.certReq)]),"popo"in e&&t.value.push(c.ProofOfPossession.toAsn1(e.popo)),"regInfo"in e&&null!=e.regInfo&&t.value.push(c.RegInfo.toAsn1(e.regInfo)),t},c.SubsequentMessage={},c.SubsequentMessage.encrCert=0,c.SubsequentMessage.challengeResp=1,c.PKMACValue={},c.PKMACValue.toAsn1=function(e){return n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[i.AlgorithmIdentifier.toAsn1(e.algId),n.create(n.Class.UNIVERSAL,n.Type.BITSTRING,!1,String.fromCharCode(0)+e.value)])},c.POPOPrivKey={},c.POPOPrivKey.toAsn1=function(e){var t,r;if("thisMessage"in e)r=0;else if("subsequentMessage"in e)r=1;else if("dhMAC"in e)r=2;else{if(!("agreeMAC"in e))throw"encryptedKey"in e?(r=4,'not support entry "encryptedKey" in POPOPrivKey'):"cannot found any supported entry in POPOPrivKey";r=3,t=c.PKMACValue.toAsn1(e.agreeMAC)}return n.create(n.Class.CONTEXT_SPECIFIC,r,!0,[t])},c.RegInfo={},c.RegInfo.toAsn1=function(e){var t;return t=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[]),e.forEach(function(e){t.value.push(c.AttributeTypeAndValue.toAsn1(e))}),t},c.Controls={},c.Controls.toAsn1=function(e){var t;return t=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[]),e.forEach(function(e){t.value.push(c.AttributeTypeAndValue.toAsn1(e))}),t},c.CertRequestValidator={name:"CertRequest",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,value:[{name:"CertRequest.certReqId",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1}]};var l=({directoryName:{attributes:[{type:s.countryName,value:"KR"},{type:s.commonName,value:"haha"}]}},{});l.id_it="1.3.6.1.5.5.7.4",l.id_it_caProtEncCert=l.id_it+".1",p=a.cmp=a.cmp||{},p.oids={},p.oids.it_ca_ProtEncCert="1.3.6.1.5.5.7.4.1",p.CertifiedKeyPair={},p.CertifiedKeyPair.toObject=function(e){var t={};if(t.certOrEncCert=p.CertOrEncCert.toObject(e.value[0]),e.value.length>1)throw"this message has not supported entries in CertifiedKeyPair.";return t},p.CertOrEncCert={},p.CertOrEncCert.toObject=function(e){var t={};return 0==e.type?t.certificate=i.certificateFromAsn1(e.value[0]):t.encryptedCert=c.EncryptedValue.toObject(e.value[0]),t},c.CertRepMessage={},c.CertRepMessage.toObject=function(e,t){var r,a,n=[];return r=e.value[0],a=e.value[0],1==r.type&&(n.caPubs=[],r=r.value[0],r.value.forEach(function(e){n.caPubs.push(i.certificateFromAsn1(e))}),a=e.value[1]),n.response=[],a.value.forEach(function(e){n.response.push(c.CertResponse.toObject(e,t))}),n},p.oid=l,p.ErrorMsgContent={},p.ErrorMsgContent.toObject=function(e,t){var r={};return r.pKIStatusInfo=p.PKIStatusInfo.toObject(e.value[0],t),e.value.length>1&&(r.errorCode=e.value[1].value.charCodeAt(0)),e.value.length>2&&(r.errorDetails=p.PKIFreeText.toObject(e.value[2],t)),r},p.GenRepContent={},p.GenRepContent.toObject=function(e){var t=[];return e.value.forEach(function(e){t.push(p.InfoTypeAndValue.toObject(e))}),t},p.InfoTypeAndValue={},p.InfoTypeAndValue.toAsn1=function(e){var t,r;switch(t=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[]),r=n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(e.infoType).getBytes()),t.value.push(r),e.infoType){case l.id_it_caProtEncCert:r=void 0;break;default:throw"not supported oid for InfoTypeAndValue"}return t.value.push(r),t},p.InfoTypeAndValue.toObject=function(e){var t={};return t.infoType=n.derToOid(e.value[0].value),e.value.length>1&&(t.infoValue=n.toDer(e.value[1])),t},p.PKIBody={},p.PKIBody.toAsn1=function(e){var t,r,a;if(e.hasOwnProperty("ir"))r=e.ir,a=0,t=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[]),r.forEach(function(e){t.value.push(c.CertReqMsg.toAsn1(e))});else if(e.hasOwnProperty("kur"))r=e.kur,a=7,t=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[]),r.forEach(function(e){t.value.push(c.CertReqMsg.toAsn1(e))});else if(e.hasOwnProperty("rr"))r=e.rr,a=11,t=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[]),r.forEach(function(e){t.value.push(c.RevDetails.toAsn1(e))});else if(e.hasOwnProperty("conf"))r=e.conf,a=19,t=n.create(n.Class.UNIVERSAL,n.Type.NULL,!1,"");else{if(!e.hasOwnProperty("genm"))throw"not supported PKIBody type";r=e.genm,a=21,t=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[]),void 0!=r&&r.forEach(function(e){t.value.push(p.InfoTypeAndValue.toAsn1(e))})}return n.create(n.Class.CONTEXT_SPECIFIC,a,!0,[t])},p.PKIBody.toObject=function(e,t){var r={};switch(e.type){case 1:r.ip=c.CertRepMessage.toObject(e.value[0],t);break;case 8:r.kup=c.CertRepMessage.toObject(e.value[0],t);break;case 12:r.rp=c.RevRepContent.toObject(e.value[0],t);break;case 22:r.genp=a.cmp.GenRepContent.toObject(e.value[0]);break;case 23:r.error=a.cmp.ErrorMsgContent.toObject(e.value[0],t);break;default:throw"not supported CMP message type:"+e.type}return r},p.PKIFailureInfo={},p.PKIFailureInfo.toObject=function(e){return 0},p.PKIFreeText={},p.PKIFreeText.toAsn1=function(e){var t,r;return t=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[]),e.forEach(function(e){r=n.create(n.Class.UNIVERSAL,n.Type.UTF8,!1,o.encodeUtf8(e)),t.value.push(r)}),t},p.PKIFreeText.toObject=function(e,t){var r,n=[];return e.value.forEach(function(e){r=e.value,r="undefined"!=typeof t&&1==t?a.util.decodeEUCKR(r):a.util.decodeUTF8(r),n.push(r)}),n},p.PKIHeader={},p.PKIHeader.cmp1999=1,p.PKIHeader.cmp2000=2,p.PKIHeader.toAsn1=function(e){var t,r;return t=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,n.integerToDer(e.pvno).getBytes()),i.GeneralName.toAsn1(e.sender),i.GeneralName.toAsn1(e.recipient)]),"messageTime"in e&&(r=n.create(n.Class.CONTEXT_SPECIFIC,0,!0,[n.create(n.Class.UNIVERSAL,n.Type.GENERALIZEDTIME,!1,n.dateToGeneralizedTime(e.messageTime))]),t.value.push(r)),"protectionAlg"in e&&(r=n.create(n.Class.CONTEXT_SPECIFIC,1,!0,[i.AlgorithmIdentifier.toAsn1(e.protectionAlg)]),t.value.push(r)),"senderKID"in e&&(r=n.create(n.Class.CONTEXT_SPECIFIC,2,!0,[n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,e.senderKID)]),t.value.push(r)),"recipKID"in e&&(r=n.create(n.Class.CONTEXT_SPECIFIC,3,!0,[n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,e.recipKID)]),t.value.push(r)),"transactionID"in e&&(r=n.create(n.Class.CONTEXT_SPECIFIC,4,!0,[n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,e.transactionID)]),t.value.push(r)),"senderNonce"in e&&(r=n.create(n.Class.CONTEXT_SPECIFIC,5,!0,[n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,e.senderNonce)]),t.value.push(r)),"recipNonce"in e&&(r=n.create(n.Class.CONTEXT_SPECIFIC,6,!0,[n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,e.recipNonce)]),t.value.push(r)),"freeText"in e&&(r=n.create(n.Class.CONTEXT_SPECIFIC,7,!0,[p.PKIFreeText.toAsn1(e.freeText)]),t.value.push(r)),"generalInfo"in e&&(r=n.create(n.Class.CONTEXT_SPECIFIC,8,!0,[p.PKIFreeText.toAsn1(e.freeText)]),t.value.push(r)),t},p.PKIHeader.toObject=function(e,t){var r,a,n={};for(n.pvno=e.value[0].value.charCodeAt(0),n.sender=e.value[1].value,n.recipient=e.value[2].value,r=3;r<e.value.length;++r)switch(a=e.value[r],a.type){case 7:n.freeText=p.PKIFreeText.toObject(a.value[0],t)}return n},p.PKIMessage={},p.PKIMessage.toAsn1=function(e){var t;if(t=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[p.PKIHeader.toAsn1(e.header),p.PKIBody.toAsn1(e.body)]),"protection"in e){var r;r=n.create(n.Class.UNIVERSAL,n.Type.BITSTRING,!1,String.fromCharCode(0)+e.protection),r=n.create(n.Class.CONTEXT_SPECIFIC,0,!0,[r]),t.value.push(r)}return t;
},p.PKIMessage.toObject=function(e,t){var r={};return r.header=p.PKIHeader.toObject(e.value[0],t),r.body=p.PKIBody.toObject(e.value[1],t),r},p.PKIStatus={},p.PKIStatus.accepted=0,p.PKIStatus.grantedWithMods=1,p.PKIStatus.rejection=2,p.PKIStatus.waiting=3,p.PKIStatus.revocationWarning=4,p.PKIStatus.revocationNotification=5,p.PKIStatus.keyUpdateWarning=6,p.PKIStatusInfo={},p.PKIStatusInfo.toObject=function(e,t){var r={},a="";switch(r.status=e.value[0].value.charCodeAt(0),e.value.length>1&&(r.statusString=p.PKIFreeText.toObject(e.value[1],t)),e.value.length>2&&(r.failInfo=p.PKIFailureInfo.toObject(e.value[2])),r.status){case p.PKIStatus.accepted:a="granted";case p.PKIStatus.grantedWithMods:a="grantedWithMods";case p.PKIStatus.rejection:a="rejection";case p.PKIStatus.waiting:a="waiting";case p.PKIStatus.revocationWarning:a="revocationWarning";case p.PKIStatus.revocationNotification:a="revocationNotification";case p.PKIStatus.keyUpdateWarning:a="keyUpdateWarning"}return r.asnReason=a,r},p.ProtectedPart={},p.ProtectedPart.toAsn1=function(e){return n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[p.PKIHeader.toAsn1(e.header),p.PKIBody.toAsn1(e.body)])},a.crmf=c,e.exports=a.crmf},function(e,t,r){var a=r(40),n=r(55).AsyncForEach,i=r(55).JobPromise,s=a.cmp=a.cmp||{},o=a._asn1;a.crypto;s.catype={CROSSCERT_CA:"crosscert",SIGNKOREA_CA:"signkorea"},s.purpose={ISSUE:"issue",UPDATE:"update",REVOKE:"revoke"},s.presetType={NONE:"NONE",SIGNKOREA_CLOUD:"SIGNKOREA_CLOUD"};var u={NONE:{messageReqType:0},SIGNKOREA:{ir:{},kur:{freeText:["YT_NA_RENEW"]},rr:{},messageReqType:48},SIGNKOREA_CLOUD:{ir:{sender:"SK_CL_NEW"},kur:{freeText:["SK_CL_RENEW"]},messageReqType:64}};s.revocationReason={unused:0,keyCompromise:1,cACompromise:2,affiliationChanged:3,superseded:4,cessationOfOperation:5,certificateHold:6,privilegeWithdrawn:7,aACompromise:8},s.getClient=function(e,t,r){return new c(e,t,r)};var c=function(e,t,r){function l(e,t){N(e,function(e){return e instanceof a.error?void t(e):(data=o.toDer(e).getBytes(),a.consoleLog,void k.http.send(k.url.all?k.url.all:k.url.conf,k.messageReqType,data,function(e,r,n,i){if(e instanceof a.error,3==n)return void t(k.certAndKey);try{v(i,function(){a.consoleLog&&a.console.log("real issuing was done."),t(k.certAndKey)})}catch(e){a.consoleLog,t(e)}}))})}function f(e){A(function(t){data=o.toDer(t).getBytes(),k.http.newSession(),k.http.send(k.url.all?k.url.all:k.url.genmgenp,k.messageReqType,data,function(t,r,n,i){if(t instanceof a.error)return void e(t);a.consoleLog;try{v(i,function(){e(k.revokeResult)})}catch(t){e(new a.error(t))}})})}function d(e,t,r,n){var i,s,u;if(i=a.cmp.ProtectedPart.toAsn1({header:e,body:t}),u=o.toDer(i),a.consoleLog,r.hasOwnProperty("authCode"))s=h(u,"aaaaabbbbb",r.authCode,2,ytcrypto.md.sha1.create(),ytcrypto.cmac.create(),ytcrypto.des),n(s.getBytes());else if(r.hasOwnProperty("signature")){var c={name:"RSASSA-PKCS1-v1_5",hash:{name:r.options.hash}};a.consoleLog,r.signature.sign(c,u.getBytes(),function(e){n(e)})}else n(new a.error("not supported protection algorithm"))}function h(e,t,r,n,i,s,o){var u,c="",p=0;for(u=a.util.createBuffer(),u.putBytes(t),u.putBytes(r),c=u.getBytes(),p=0;p<n;++p)i.start(),i.update(c),c=i.digest().getBytes();return s.start(o,c),s.update(e),s.getMac()}function y(e,t,r,n){return e.hasOwnProperty("certReqId")||n(new a.error("no certReqID on generateKey in args")),k.updateOptions&&k.updateOptions.kmOnly&&0==e.certReqId?void n({privateKey:k.updateTarget[e.certReqId].key,publicKey:k.updateTarget[0].cert.publicKey}):void(k.hasOwnProperty("keyGenerator")?k.keyGenerator(e,t,r,n):ytcrypto.crypto.generateKey(e,t,r,n))}function g(e,t){asn=S(e),data=o.toDer(asn).getBytes(),a.consoleLog,k.http.newSession(),k.http.send(k.url.all?k.url.all:k.url.genmgenp,k.messageReqType,data,function(e,r,n,i){if(e instanceof a.error)return void t(e);a.consoleLog;try{v(i,function(e){t(e)})}catch(e){t(new a.error(e))}})}function C(e,t){if(e.type==s.catype.SIGNKOREA_CA&&e.preset&&e.presetName==s.presetType.SIGNKOREA_CLOUD)switch(t){case s.revocationReason.cACompromise:case s.revocationReason.privilegeWithdrawn:case s.revocationReason.aACompromise:throw new a.error("not support revocation reason this ca:"+e.presetName)}}function v(e,t){var r,n,i=!1;if(k.type==s.catype.SIGNKOREA_CA&&(i=!0),r=o.fromDer(e),n=a.cmp.PKIMessage.toObject(r,i),"error"in n.body){var u,c;if(u=n.body.error.pKIStatusInfo,void 0!=u.statusString)throw c="cmp error from CA reason:"+u.statusString.join(),a.consoleLog,c}else if("genp"in n.body)I(n.header,n.body.genp);else{if("ip"in n.body)return void F(n.body.ip,t);if("kup"in n.body)return void F(n.body.kup,t);if(!("rp"in n.body))throw"unknown cmp message";B(n.body.rp)}"undefined"!=typeof t&&t()}function m(e,t,r){var a;if(t){switch(k.purpose){case s.purpose.ISSUE:if(!t.ir)return;a=t.ir;break;case s.purpose.UPDATE:if(!t.kur)return;a=t.kur;break;case s.purpose.REVOKE:if(!t.rr)return;a=t.rr}a.sender&&(e.sender.rfc822Name=a.sender),a.recipient&&(e.recipient.rfc822Name=a.recipient),a.freeText&&(r&&(r.keyOnly||r.kmOnly)?e.freeText=["SK_KUP"]:e.freeText=a.freeText)}}function E(e){var t={};switch(e=e||{},k.senderNonce=ytcrypto.random.getBytesSync(16),t={pvno:0,sender:{},recipient:{rfc822Name:" "},messageTime:new Date,senderNonce:k.senderNonce},k.purpose){case s.purpose.ISSUE:t.senderKID=k.refNum,t.sender.rfc822Name=" ";break;case s.purpose.UPDATE:;t.freeText=[],t.sender.directoryName=k.updateTarget[0].cert._cert.subject;var r=new ytcrypto.jsbn.BigInteger(k.updateTarget[0].cert.serialNumber,16);t.senderKID=r.toRadix(10);break;case s.purpose.REVOKE:t.sender.directoryName=k.revokeTarget[0].cert._cert.subject}return k.type==s.catype.SIGNKOREA_CA&&(t.recipKID="101029"),m(t,k.preset,e),t}function S(e){var t;return e=e||{},t={},t.header=E(e),t.body={},t.body.genm=[{infoType:a.cmp.oid.id_it_caProtEncCert}],a.cmp.PKIMessage.toAsn1(t)}function I(e,t){k.attrs={},e.freeText&&e.freeText.forEach(function(e){var t;t=e.split("$"),t.forEach(function(e){var t;t=e.split("="),k.attrs[t[0]]=t[1]})}),t.forEach(function(e){e.infoType==a.cmp.oids.it_ca_ProtEncCert?(k.CAProtocolEncryptionCertificate=a.pki.certificateFromAsn1(o.fromDer(e.infoValue)),a.consoleLog):e.infoType==a.yessign.VIDCertificate.oid&&(a.consoleLog,k.VIDEncryptionCertificate=a.pki.certificateFromAsn1(o.fromDer(e.infoValue)))}),null==k.VIDEncryptionCertificate&&(k.VIDEncryptionCertificate=k.CAProtocolEncryptionCertificate),k.type==s.catype.SIGNKOREA_CA&&(k.VIDEncryptionCertificate=k.CAProtocolEncryptionCertificate)}function T(e,t,r){var n;k.keyPair=[],n={},this.senderNonce=ytcrypto.random.getBytesSync(16),n.header={pvno:a.cmp.PKIHeader.cmp1999,sender:{rfc822Name:" "},recipient:{rfc822Name:" "},messageTime:new Date,senderKID:e,senderNonce:this.senderNonce},this.type==s.catype.SIGNKOREA_CA&&(n.header.sender.rfc822Name="YT_NA_NEW"),n.body={},n.body.ir=[],R.call(k,n,function(e){if(e instanceof a.error)throw n;n.body.ir=e,d(n.header,n.body,{authCode:t},function(e){n.protection=e,r(a.cmp.PKIMessage.toAsn1(n))})})}function A(e){var t,r={freeTexts:[]};t={},t.header=E(r),t.body={},t.header.sender.directoryName=k.revokeTarget[0].cert._cert.subject,t.header.freeText=[],t.header.freeText.push("YT_NA_REVOKE"),t.body.rr=[],k.revokeTarget.forEach(function(e){rd={},rd.certDetails={},rd.revocationReason=k.revocationReason,rd.certDetails.serialNumber=e.cert.serialNumber,rd.certDetails.issuer=e.cert._cert.issuer,t.body.rr.push(rd)});var n=a.oids.sha1WithRSAEncryption,i="SHA-1";k.revokeTarget[0].cert.publicKey.getKeySize()>=2048&&(n=a.oids.sha256WithRSAEncryption,i="SHA-256"),a.consoleLog,a.consoleLog,t.header.protectionAlg={algorithm:n,parameters:null},d(t.header,t.body,{signature:k.revokeTarget[0].key,options:{hash:i}},function(r){t.protection=r,e(a.cmp.PKIMessage.toAsn1(t))})}function b(e,t,r){var n,i,s,o;if(0!=t.status.status)throw new a.error("CMP response is error:"+t.status.statusString.join());if(n=t.certifiedKeyPair,i=n.certOrEncCert,"encryptedCert"in i){s=i.encryptedCert;var u,c,p={name:"RSAES-PKCS1-v1_5"};e.decrypt(s.encSymmKey,p,function(e){if(u="01234567",c=ytcrypto.crypto.blockCipher.createDecryptionCipher("des",e,"ofb64"),c.start(u),c.update(a.util.createBuffer(s.encValue)),0==c.finish())throw"failed to decrypt certificate";o=a.pki.certificateFromAsn1(a._asn1.fromDer(c.output.bytes())),r(o)})}else"certificate"in i&&(o=i.certificate,r(o))}function F(e,t){var r;r=e.caPubs,k.certAndKey=[];var i=n(e.response,function(e,t,r){k.certAndKey[r]={privateKey:k.keyPair[r].privateKey,vid:k.keyPair[r].vid},b(k.certAndKey[r].privateKey,t,function(t){return t instanceof a.error?(k.certAndKey[r].error=t,void e(!1)):(k.certAndKey[r].certificate=new a.pki.Certificate(t),void e(!0))})});i.then(function(e){t(!0)}),i.fail(function(e){t(e)})}function B(e){if(0!=e.status[0].status){var t=[];throw e.status.forEach(function(e){t.push(e.statusString.join(""))}),k.revokeResult=!1,"CMP response is error:"+t}k.revokeResult=!0}function N(e,t){var r,n={};if(r={},r.header={pvno:a.cmp.PKIHeader.cmp1999,sender:{rfc822Name:" "},recipient:{rfc822Name:" "},senderKID:""},r.body={},r.body.conf=[],e.hasOwnProperty("pbmac"))r.header.senderKID=e.pbmac.refNum,n.authCode=e.pbmac.authCode;else{if(!e.hasOwnProperty("signature"))throw a.consoleLog,new a.error("not supported conf protection");n.signature=e.signature,n.options=e.options}t(a.cmp.PKIMessage.toAsn1(r))}function R(e,t){var r=new i,n={name:"RSASSA-PKCS1-v1_5",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}};r.add(function(e){n.certReqId=0,y(n,!0,["sign"],function(t){if(t instanceof a.error)throw t.pushReason("generateKeyPair failed"),t;a.consoleLog,k.keyPair.push({publicKey:t.publicKey,privateKey:t.privateKey}),w(0,t.publicKey,t.privateKey,function(t){if(t instanceof a.error)throw t.pushReason("failed to generateCertReqMsg(0)"),t;a.consoleLog,e(t)})})});var s=!1;k.attrs&&k.attrs.hasOwnProperty("km_key_gen")&&"user"==k.attrs.km_key_gen&&(s=!0,a.consoleLog),k.updateOptions&&k.updateOptions.kmOnly&&(s=!0,a.consoleLog),s&&r.add(function(e){n.certReqId=1,y(n,!0,["sign"],function(t){if(t instanceof a.error)throw t.pushReason("generateKeyPair failed"),t;a.consoleLog,k.keyPair.push({publicKey:t.publicKey,privateKey:t.privateKey}),w(1,t.publicKey,t.privateKey,function(t){if(t instanceof a.error)throw t.pushReason("failed to generateCertReqMsg(1)"),t;a.consoleLog,e(t)})})}),r.fail(function(e){throw e}),r.then(function(e){t(e)})}function w(e,t,r,n){var i,u={},c={},p={};t.exportKeyInfo(function(t){if(t instanceof a.error&&(t.pushReason("failed to export publicKey"),n(t)),i=o.fromDer(t),u.certReq=c,c.certReqId=e,c.certTemplate=p,p.publicKey=i,k.purpose==s.purpose.UPDATE){var l={};if(l.issuer={},1==e&&1==k.updateTarget.length){l.issuer.directoryName=k.updateTarget[0].cert._cert.issuer;var f=new ytcrypto.jsbn.BigInteger(k.updateTarget[0].cert.serialNumber,16);f=f.add(ytcrypto.jsbn.BigInteger.ONE),l.serialNumber=f.toRadix(16)}else l.issuer.directoryName=k.updateTarget[e].cert._cert.issuer,l.serialNumber=k.updateTarget[e].cert.serialNumber;c.controls=[],c.controls.push({type:a.oids.oldCertId,value:l})}var d=a.oids.sha256WithRSAEncryption;D(d,i,r,function(t){return t instanceof a.error?(t.pushReason("failed to generate ProofOfPosession"),void n(t)):(u.popo=t,u.regInfo=U(e),void n(u))})})}function U(e){var t=[];return 0!=e?null:(k.keyPair[e].vid=ytcrypto.random.getBytesSync(20),t.push(L("1234561234567",k.keyPair[e].vid,k.VIDEncryptionCertificate)),t)}function P(e,t,r){var n,i;return n={idn:e,randomNum:t},i=o.toDer(a.kisa.HashContent.toAsn1(n)).getBytes(),r.start(),r.update(i),i=r.digest().getBytes(),r.start(),r.update(i),i=r.digest().getBytes()}function L(e,t,r){var n,i,s,u={},c={};return i={hashAlg:{algorithm:a.oids.sha256}},i.virtualID=P(e,t,ytcrypto.md.sha256.create()),n=o.toDer(a.kisa.EncryptContent.toAsn1({vid:i,randomNum:t})),s=r.publicKey.encrypt(n.getBytes()),c.version=0,c.vidEncAlg={algorithm:a.oids.rsaEncryption,parameters:null},c.certID={issuer:r.issuer,serialNumber:r.serialNumber},c.encryptedVID=s,u.type=a.kisa.EncryptedVID.oid,u.value=c,u}function D(e,t,r,n){var i,s,u={},c={},p={};c={authInfo:{sender:{rfc822Name:" "}},publicKey:t},i=a.crmf.POPOSigningKeyInput.toAsn1(c),s=o.toDer(i).getBytes(),r.sign({name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},s,function(t){return t instanceof a.error?(t.pushReason("failed to generate POPSigningKey"),void n(t)):(p.poposkInput=c,p.algorithmIdentifier={algorithm:e},p.signature=t,u.signature=p,void n(u))})}var k=this;if(this.purpose="",this.type=e,this.url=t,this.http=new p,this.VIDEncryptionCertificate=null,r=r||{},r.xhr&&this.http.setOptions(r.xhr),this.presetName=r.preset,this.presetName||(this.presetName="NONE",k.type==s.catype.SIGNKOREA_CA&&(this.presetName="SIGNKOREA")),"NONE"==this.presetName&&k.type==s.catype.SIGNKOREA_CA&&(this.presetName="SIGNKOREA"),!u.hasOwnProperty(this.presetName))throw"not supported preset:"+this.presetName;a.consoleLog,this.preset=u[this.presetName],this.messageReqType=this.preset.messageReqType,c.prototype.setKeyGenerator=function(e){this.keyGenerator=e},c.prototype.issue=function(e,t,r){function n(r){try{T(e,t,function(n){return n instanceof a.error?void r(n):(i=o.toDer(n).getBytes(),a.consoleLog,void u.http.send(u.url.all?u.url.all:u.url.irip,u.messageReqType,i,function(n,i,s,o){if(n instanceof a.error)return void r(n);a.consoleLog;try{v(o,function(n){return n instanceof a.error?void r(n):void(a.cmp.testIssue?(a.consoleLog,r(u.certAndKey)):l({pbmac:{refNum:e,authCode:t}},r))})}catch(e){return void r(new a.error(e))}}))})}catch(e){r(new a.error(e))}}var i,u=this,c={freeTexts:[]};if(void 0==e)throw"reference number is not defined.";if(void 0==t)throw"authentication code is not defined.";if(void 0==r)throw"resultCallback is not defined.";this.purpose=s.purpose.ISSUE,this.refNum=e,this.authCode=t,g(c,function(e){return e instanceof a.error?void r(e):void n(r)})},c.prototype.update=function(e,t,r){function n(e){var t={};c.keyPair=[],t.header=E(r),t.body={},t.body.kur=[],R(t,function(r){if(r instanceof a.error)throw t;t.body.kur=r,d(t.header,t.body,{signature:c.updateTarget[0].key,options:{hash:"SHA-256"}},function(r){t.protection=r,e(a.cmp.PKIMessage.toAsn1(t))})})}function i(e){try{n(function(t){return t instanceof a.error?void e(t):(u=o.toDer(t).getBytes(),a.consoleLog,void c.http.send(c.url.all?c.url.all:c.url.irip,c.messageReqType,u,function(t,r,n,i){if(t instanceof a.error)return void e(t);a.consoleLog;try{v(i,function(t){return t instanceof a.error?void e(t):void(a.cmp.testIssue?(a.consoleLog,e(c.certAndKey)):l({signature:c.updateTarget[0].key,options:{hash:"SHA-256"}},e))})}catch(t){return void e(new a.error(t))}}))})}catch(t){e(new a.error(t))}}var u,c=this,p={freeTexts:[]};if(r=r||{},void 0==e)throw"keycert is not defined.";if(void 0==t)throw"resultCallback is not defined.";if(r.kmOnly&&r.keyOnly)throw new a.error("input option was conflict (kmOnly and keyOnly) ");(r.kmOnly||r.keyOnly)&&p.freeTexts.push("SK_KUP"),this.purpose=s.purpose.UPDATE,this.updateTarget=e,this.updateOptions=r,g(r,function(e){return e instanceof a.error?void t(e):void i(t)})},c.prototype.revoke=function(e,t,r){if("undefined"==typeof e)throw"keycert is not defined";if(0==e.length)throw"keycert is empty.";if("undefined"==typeof t)throw"reason is not defined";if("undefined"==typeof r)throw"resultCallback is not defined";if(t<0||8<t)throw"reason must be 0 ~ 8";try{C(this,t)}catch(e){return void r(e)}this.purpose=s.purpose.REVOKE,this.revokeTarget=e,this.revocationReason=t,f(r)}};s.client=c;var p=function(){this.previousURL=null,this.previousXHR=null,this.identifier="",this.options={withCredentials:!0}};p.pkiReq=0,p.pkiRep=5,p.errorMsgRep=6,p.prototype.setOptions=function(e){for(var t in e)this.options.hasOwnProperty(t)?(this.options[t]=e[t],a.consoleLog):a.consoleLog},p.prototype.newSession=function(){this.identifier=""},p.prototype.send=function(e,t,r,n){var i,s,o=this,u=10,c=0;s=a.util.createBuffer(),s.putInt32(r.length+3),s.putByte(u),s.putByte(c),s.putByte(t),s.putBytes(r),a.consoleLog,i=new XMLHttpRequest,i.withCredentials=this.options.withCredentials,i.open("post",e,!0),""!=this.identifier&&i.setRequestHeader("Identifier",this.identifier),i.onreadystatechange=function(){if(4==i.readyState){var e,t,r,s,u,c;if(o.identifier=i.getResponseHeader("Identifier"),200!=i.status)return void n(new a.error("XHR recieved status code:"+i.status+" with "+i.statusText+" data: "+i.responseText));a.consoleLog,e=a.util.createBuffer(a.util.decode64(decodeURIComponent(i.responseText))),t=e.getInt32(),r=e.getByte(),s=e.getByte(),u=e.getByte(),c=e.getBytes(),n(r,s,u,c)}},s=a.util.encode64(s.getBytes()),s=encodeURIComponent(s),i.setRequestHeader("Content-type","application/pkixcmp");try{i.send(s)}catch(e){n(new a.error(e))}},a.cmp=s,e.exports=a.cmp}]);